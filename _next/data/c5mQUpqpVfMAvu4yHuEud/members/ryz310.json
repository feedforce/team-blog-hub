{"pageProps":{"member":{"name":"ryz310","bio":"ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ã€‚ã‚¯ãƒ©ãƒ­ãƒ¯å¥½ãâš”ï¸","avatarSrc":"https://www.gravatar.com/userimage/47883079/b6f69b2794a96e21e5a037f511603d43?size=256","sources":["https://developer.feedforce.jp/rss/author/ryz310","https://ryz310.hateblo.jp/rss"],"twitterUsername":"ryosuke_sato","githubUsername":"ryz310","websiteUrl":"https://rubygems.org/profiles/ryz310"},"postItems":[{"title":"MAU, DAU ã‚‚è¨ˆæ¸¬ã§ãã‚‹ã‚ˆã†ã«ãªã£ãŸ redis-objects-daily-counter v0.3.0","content":"<p>å‰å›ã®ãƒ–ãƒ­ã‚°ã§ <a href=\"https://github.com/ryz310/redis-objects-daily-counter\">redis-objects-daily-counter</a> ã¨ã„ã† gem ã‚’ä½œã£ãŸã¨ã„ã†è©±ã‚’ã—ã¾ã—ãŸã€‚</p>\n\n<p><iframe src=\"https://hatenablog-parts.com/embed?url=https%3A%2F%2Fryz310.hateblo.jp%2Fentry%2F2021%2F09%2F20%2F172054\" title=\"Redis::Objects ã‚’ä½¿ã£ãŸã‚µãƒ¼ãƒ“ã‚¹æ”¹å–„ã¨æ–°ã—ã„ gem ã‚’ä½œã£ãŸãŠè©± - é€ƒã’ã‚‹8å›ã§ä¼šå¿ƒã®ä¸€æ’ƒ\" class=\"embed-card embed-blogcard\" scrolling=\"no\" frameborder=\"0\" style=\"display: block; width: 100%; height: 190px; max-width: 500px; margin: 10px 0px;\"></iframe><cite class=\"hatena-citation\"><a href=\"https://ryz310.hateblo.jp/entry/2021/09/20/172054\">ryz310.hateblo.jp</a></cite></p>\n\n<p>ä»Šå›ã¯ <code>v0.3.0</code> ã‚’ãƒªãƒªãƒ¼ã‚¹ã—ãŸã®ã§ãã¡ã‚‰ã®ã”ç´¹ä»‹ã§ã™ã€‚</p>\n\n<h2>ã€ãŠã•ã‚‰ã„ã€‘redis-objects-daily-counter ã¯ã©ã†ã„ã† gem ãªã®ã‹</h2>\n\n<p><a href=\"https://github.com/nateware/redis-objects\">redis-objects</a> gem ã®æ‹¡å¼µã¨ã—ã¦ä½œã‚‰ã‚Œã¦ãŠã‚Šã€æ—¥ä»˜ã®å¤‰æ›´æ¯ã«æ–°ã—ã„  counter ã‚’å®šç¾©ã—ã¦ãã‚Œã‚‹ <code>daily_counter</code> æ©Ÿèƒ½ã‚’æä¾›ã™ã‚‹ gem ã§ã™ã€‚</p>\n\n<p>ä¾‹ãˆã°ä»¥ä¸‹ã®ã‚ˆã†ãª <code>Homepage</code> ã¨ã„ã† class ã§ <code>daily_counter :pv</code> ã¨ã„ã†å®šç¾©ã‚’ã—ã¾ã™ã€‚</p>\n\n<pre class=\"code lang-ruby\" data-lang=\"ruby\" data-unlink><span class=\"synPreProc\">class</span> <span class=\"synType\">Homepage</span>\n  <span class=\"synPreProc\">include</span> <span class=\"synType\">Redis</span>::<span class=\"synType\">Objects</span>\n\n  daily_counter <span class=\"synConstant\">:pv</span>, <span class=\"synConstant\">expireat</span>: -&gt; { <span class=\"synType\">Time</span>.now + <span class=\"synConstant\">2_678_400</span> } <span class=\"synComment\"># about a month</span>\n\n  <span class=\"synPreProc\">def</span> <span class=\"synIdentifier\">id</span>\n    <span class=\"synConstant\">1</span>\n  <span class=\"synPreProc\">end</span>\n<span class=\"synPreProc\">end</span>\n</pre>\n\n\n<p>ã™ã‚‹ã¨ä»¥ä¸‹ã®ã‚ˆã†ã« <code>#pv</code> ã¨ã„ã†<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%A4%A5%F3%A5%B9%A5%BF%A5%F3%A5%B9\">ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹</a>ãƒ¡ã‚½ãƒƒãƒ‰ãŒä½¿ãˆã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚\nã“ã‚Œã¯ <code>redis-objects</code> gem ã® <code>counter</code> ã®æ‹¡å¼µã§ã‚ã‚Šã€ <code>#increment</code> ã‚„ <code>#decrement</code> ã¨ã„ã†ãƒ¡ã‚½ãƒƒãƒ‰ã§ Redis ä¸Šã®å€¤ã‚’æ›´æ–°ã™ã‚‹ã“ã¨ãŒå¯èƒ½ã§ã™ã€‚</p>\n\n<pre class=\"code lang-ruby\" data-lang=\"ruby\" data-unlink><span class=\"synComment\"># 2021-04-01</span>\nhomepage = <span class=\"synType\">Homepage</span>.new\nhomepage.id <span class=\"synComment\"># 1</span>\n\nhomepage.pv.increment\nhomepage.pv.increment\nhomepage.pv.increment\nputs homepage.pv.value <span class=\"synComment\"># 3</span>\n</pre>\n\n\n<p><code>daily_counter</code> ãŒ <code>counter</code> ã¨ã©ã®ã‚ˆã†ã«é•ã†ã‹ã¨ã„ã†ã¨ã€æ—¥ä»˜ãŒå¤‰ã‚ã‚‹ã¨Redis ä¸Šã® Key ãŒå¤‰åŒ–ã™ã‚‹ã¨ã„ã†ç‚¹ã§ã™ã€‚</p>\n\n<pre class=\"code lang-ruby\" data-lang=\"ruby\" data-unlink><span class=\"synComment\"># 2021-04-02 (next day)</span>\nputs homepage.pv.value <span class=\"synComment\"># 0</span>\nhomepage.pv.increment\nhomepage.pv.increment\nputs homepage.pv.value <span class=\"synComment\"># 2</span>\n</pre>\n\n\n<p>ã“ã‚Œã¯ã€ <code>daily_counter</code> ãŒä»¥ä¸‹ã®ã‚ˆã†ãªãƒ«ãƒ¼ãƒ«ã«å‰‡ã£ã¦ Redis ã® Key ã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ã‚ˆã†ã«æŒ¯ã‚‹èˆã†ãŸã‚ã§ã™ã€‚</p>\n\n<pre class=\"code\" data-lang=\"\" data-unlink>model_name:id:field_name:yyyy-mm-dd</pre>\n\n\n<p>ãªãŠã€ã“ã®æ™‚ã®<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%BF%A5%A4%A5%E0%A5%BE%A1%BC%A5%F3\">ã‚¿ã‚¤ãƒ ã‚¾ãƒ¼ãƒ³</a>ã¯å®Ÿè¡Œä¸­ã® <a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/Ruby\">Ruby</a> ãƒ—ãƒ­ã‚»ã‚¹ã®æ¨™æº–<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%BF%A5%A4%A5%E0%A5%BE%A1%BC%A5%F3\">ã‚¿ã‚¤ãƒ ã‚¾ãƒ¼ãƒ³</a>ã«å¾“ã„ã¾ã™ãŒã€ <a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/Rails\">Rails</a> ä¸Šã§å®Ÿè¡Œã—ãŸå ´åˆã¯ <code>application.rb</code> ã§æŒ‡å®šã—ãŸ<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%BF%A5%A4%A5%E0%A5%BE%A1%BC%A5%F3\">ã‚¿ã‚¤ãƒ ã‚¾ãƒ¼ãƒ³</a>ã«å¾“ã„ã¾ã™ã€‚</p>\n\n<p>æ—¥ä»˜ãŒå¤‰ã‚ã£ãŸå¾Œã‚‚ã€å‰æ—¥ã¾ã§ã® Key-<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/Value\">Value</a> ã¯å‰Šé™¤ã—ã¦ã„ãªã„ã®ã§ã€ <code>#range</code> ã‚„ <code>#[]</code> ã‚„ <code>#at</code> ã¨ã„ã†ãƒ¡ã‚½ãƒƒãƒ‰ã§ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ã“ã¨ãŒå¯èƒ½ã§ã™ã€‚\nã¡ãªã¿ã« <code>#range</code> ã‚„ <code>#[]</code> ã§ã¯å€¤ãŒè¿”å´ã•ã‚Œã¾ã™ãŒã€ <code>#at</code> ã§ã¯ <code>Redis::Counter</code> <a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%A4%A5%F3%A5%B9%A5%BF%A5%F3%A5%B9\">ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹</a>ãŒè¿”å´ã•ã‚Œã¾ã™ã€‚\n<code>v0.2.0</code> ã¾ã§ã¯ <code>#[]</code> ã¨ <code>#at</code> ã¯åŒã˜æŒ™å‹•ã§ã—ãŸãŒã€ <code>v0.3.0</code> ã‹ã‚‰ãã†ã„ã†å®Ÿè£…ã«å¤‰ã‚ã‚Šã¾ã—ãŸ ğŸ™</p>\n\n<pre class=\"code lang-ruby\" data-lang=\"ruby\" data-unlink><span class=\"synComment\"># 2021-04-01</span>\nhomepage.pv.increment(<span class=\"synConstant\">3</span>)\n\n<span class=\"synComment\"># 2021-04-02 (next day)</span>\nhomepage.pv.increment(<span class=\"synConstant\">2</span>)\n\n<span class=\"synComment\"># 2021-04-03 (next day)</span>\nhomepage.pv.increment(<span class=\"synConstant\">5</span>)\n\nhomepage.pv[<span class=\"synType\">Date</span>.new(<span class=\"synConstant\">2021</span>, <span class=\"synConstant\">4</span>, <span class=\"synConstant\">1</span>)] <span class=\"synComment\"># =&gt; 3</span>\nhomepage.pv[<span class=\"synType\">Date</span>.new(<span class=\"synConstant\">2021</span>, <span class=\"synConstant\">4</span>, <span class=\"synConstant\">1</span>), <span class=\"synConstant\">3</span>] <span class=\"synComment\"># =&gt; [3, 2, 5]</span>\nhomepage.pv[<span class=\"synType\">Date</span>.new(<span class=\"synConstant\">2021</span>, <span class=\"synConstant\">4</span>, <span class=\"synConstant\">1</span>)..<span class=\"synType\">Date</span>.new(<span class=\"synConstant\">2021</span>, <span class=\"synConstant\">4</span>, <span class=\"synConstant\">2</span>)] <span class=\"synComment\"># =&gt; [3, 2]</span>\n\nhomepage.pv.delete_at(<span class=\"synType\">Date</span>.new(<span class=\"synConstant\">2021</span>, <span class=\"synConstant\">4</span>, <span class=\"synConstant\">1</span>))\nhomepage.pv.range(<span class=\"synType\">Date</span>.new(<span class=\"synConstant\">2021</span>, <span class=\"synConstant\">4</span>, <span class=\"synConstant\">1</span>), <span class=\"synType\">Date</span>.new(<span class=\"synConstant\">2021</span>, <span class=\"synConstant\">4</span>, <span class=\"synConstant\">3</span>)) <span class=\"synComment\"># =&gt; [0, 2, 5]</span>\nhomepage.pv.at(<span class=\"synType\">Date</span>.new(<span class=\"synConstant\">2021</span>, <span class=\"synConstant\">4</span>, <span class=\"synConstant\">2</span>)) <span class=\"synComment\"># =&gt; #&lt;Redis::Counter key=&quot;homepage:1:pv:2021-04-02&quot;&gt;</span>\nhomepage.pv.at(<span class=\"synType\">Date</span>.new(<span class=\"synConstant\">2021</span>, <span class=\"synConstant\">4</span>, <span class=\"synConstant\">2</span>)).value <span class=\"synComment\"># 2</span>\n</pre>\n\n\n<h2>v0.3.0 ã§è¿½åŠ ã•ã‚ŒãŸæ©Ÿèƒ½ã¨ã¯</h2>\n\n<p><code>daily_counter</code> ã«åŠ ãˆã¦ <code>daily_set</code> ãŒè¿½åŠ ã•ã‚Œã¾ã—ãŸã€‚\nã“ã¡ã‚‰ã¯ <code>redis-objects</code> gem ã® <code>set</code>ã« <code>daily-</code> æ©Ÿèƒ½ã‚’è¿½åŠ ã—ãŸã‚‚ã®ã«ãªã‚Šã¾ã™ã€‚</p>\n\n<pre class=\"code lang-ruby\" data-lang=\"ruby\" data-unlink><span class=\"synPreProc\">class</span> <span class=\"synType\">Homepage</span>\n  <span class=\"synPreProc\">include</span> <span class=\"synType\">Redis</span>::<span class=\"synType\">Objects</span>\n\n  daily_set <span class=\"synConstant\">:dau</span>, <span class=\"synConstant\">expireat</span>: -&gt; { <span class=\"synType\">Time</span>.now + <span class=\"synConstant\">2_678_400</span> } <span class=\"synComment\"># about a month</span>\n\n  <span class=\"synPreProc\">def</span> <span class=\"synIdentifier\">id</span>\n    <span class=\"synConstant\">1</span>\n  <span class=\"synPreProc\">end</span>\n<span class=\"synPreProc\">end</span>\n\nhomepage.dau &lt;&lt; <span class=\"synSpecial\">'</span><span class=\"synConstant\">user1</span><span class=\"synSpecial\">'</span>\nhomepage.dau &lt;&lt; <span class=\"synSpecial\">'</span><span class=\"synConstant\">user2</span><span class=\"synSpecial\">'</span>\nhomepage.dau &lt;&lt; <span class=\"synSpecial\">'</span><span class=\"synConstant\">user1</span><span class=\"synSpecial\">'</span> <span class=\"synComment\"># dup ignored</span>\nputs homepage.dau.members <span class=\"synComment\"># ['user1', 'user2']</span>\nputs homepage.dau.length <span class=\"synComment\"># 2</span>\nputs homepage.dau.count <span class=\"synComment\"># alias of #length</span>\n</pre>\n\n\n<p><code>set</code> ã¯é‡è¤‡ã‚’å—ã‘ä»˜ã‘ãªã„ <code>Array</code> ã¨è€ƒãˆã¦è‰¯ã„ã¨æ€ã„ã¾ã™ã€‚\nä¸Šè¨˜ã®ä¾‹ã‚’è¦‹ã¦ã‚‚ã‚‰ã†ã¨åˆ†ã‹ã‚Šã¾ã™ãŒ <code>user1</code> ã‚’ 2 å›è¿½åŠ ã—ã¦ã‚‚ <code>#members</code> ã«ã‚ˆã‚‹å–å¾—çµæœã«ã¯ 1 ã¤ã—ã‹å«ã¾ã‚Œã¦ã„ã¾ã›ã‚“ã€‚</p>\n\n<p>ã“ã‚Œã‚’ä½¿ã£ã¦ä½•ãŒå®Ÿç¾ã§ãã‚‹ã‹ã¨ã„ã†ã¨ã€ DAU (Daily Active User) ã®è¨ˆæ¸¬ã§ã™ã€‚\nãƒ­ã‚°ã‚¤ãƒ³ã—ãŸãƒ¦ãƒ¼ã‚¶ãƒ¼ã® ID ã‚’ <code>daily_set</code> ã§å®šç¾©ã—ãŸå¤‰æ•°ã«è¿½åŠ ã—ã¦ã„ãã“ã¨ã§ã€ãã®æ—¥ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ã ã£ãŸãƒ¦ãƒ¼ã‚¶ãƒ¼ä¸€è¦§ã¨ãã®æ•°ã‚’çŸ¥ã‚‹ã“ã¨ãŒå‡ºæ¥ã¾ã™ã€‚</p>\n\n<pre class=\"code lang-ruby\" data-lang=\"ruby\" data-unlink><span class=\"synComment\"># 2021-04-01</span>\nhomepage.dau.merge(<span class=\"synSpecial\">'</span><span class=\"synConstant\">user1</span><span class=\"synSpecial\">'</span>, <span class=\"synSpecial\">'</span><span class=\"synConstant\">user2</span><span class=\"synSpecial\">'</span>)\nputs homepage.dau.members <span class=\"synComment\"># ['user1', 'user2']</span>\n\n<span class=\"synComment\"># 2021-04-02 (next day)</span>\nputs homepage.dau.members <span class=\"synComment\"># []</span>\n\nhomepage.dau.merge(<span class=\"synSpecial\">'</span><span class=\"synConstant\">user2</span><span class=\"synSpecial\">'</span>, <span class=\"synSpecial\">'</span><span class=\"synConstant\">user3</span><span class=\"synSpecial\">'</span>)\nputs homepage.dau.members <span class=\"synComment\"># ['user2', 'user3']</span>\n\n<span class=\"synComment\"># 2021-04-03 (next day)</span>\nhomepage.dau.merge(<span class=\"synSpecial\">'</span><span class=\"synConstant\">user4</span><span class=\"synSpecial\">'</span>)\n\nhomepage.dau.at(<span class=\"synType\">Date</span>.new(<span class=\"synConstant\">2021</span>, <span class=\"synConstant\">4</span>, <span class=\"synConstant\">2</span>)) <span class=\"synComment\"># =&gt; #&lt;Redis::Set key=&quot;homepage:1:dau:2021-04-02&quot;&gt;</span>\nhomepage.dau.at(<span class=\"synType\">Date</span>.new(<span class=\"synConstant\">2021</span>, <span class=\"synConstant\">4</span>, <span class=\"synConstant\">2</span>)).members <span class=\"synComment\"># =&gt; ['user2', 'user3']</span>\nhomepage.dau.at(<span class=\"synType\">Date</span>.new(<span class=\"synConstant\">2021</span>, <span class=\"synConstant\">4</span>, <span class=\"synConstant\">2</span>)).length <span class=\"synComment\"># =&gt; 2</span>\n</pre>\n\n\n<p><code>#range</code> ã‚„ <code>#[]</code> ã‚’ä½¿ã†äº‹ã§æŒ‡å®šã—ãŸæœŸé–“å†…ã®å€¤ã‚’çµåˆã™ã‚‹ã“ã¨ã‚‚å‡ºæ¥ã¾ã™ã€‚\nã“ã‚Œã«ã‚ˆã£ã¦ DAU ç›®çš„ã§è¨˜éŒ²ã—ãŸå€¤ã‹ã‚‰ MAU ã‚’æ±‚ã‚ã‚‹ã“ã¨ã‚‚å¯èƒ½ã§ã™ã€‚</p>\n\n<pre class=\"code lang-ruby\" data-lang=\"ruby\" data-unlink>homepage.dau[<span class=\"synType\">Date</span>.new(<span class=\"synConstant\">2021</span>, <span class=\"synConstant\">4</span>, <span class=\"synConstant\">1</span>)] <span class=\"synComment\"># =&gt; ['user1', 'user2']</span>\nhomepage.dau[<span class=\"synType\">Date</span>.new(<span class=\"synConstant\">2021</span>, <span class=\"synConstant\">4</span>, <span class=\"synConstant\">1</span>), <span class=\"synConstant\">3</span>] <span class=\"synComment\"># =&gt; ['user1', 'user2', 'user3', 'user4']</span>\nhomepage.dau[<span class=\"synType\">Date</span>.new(<span class=\"synConstant\">2021</span>, <span class=\"synConstant\">4</span>, <span class=\"synConstant\">1</span>)..<span class=\"synType\">Date</span>.new(<span class=\"synConstant\">2021</span>, <span class=\"synConstant\">4</span>, <span class=\"synConstant\">2</span>)] <span class=\"synComment\"># =&gt; ['user1', 'user2', 'user3']</span>\n\nhomepage.dau.delete_at(<span class=\"synType\">Date</span>.new(<span class=\"synConstant\">2021</span>, <span class=\"synConstant\">4</span>, <span class=\"synConstant\">1</span>))\nhomepage.dau.range(<span class=\"synType\">Date</span>.new(<span class=\"synConstant\">2021</span>, <span class=\"synConstant\">4</span>, <span class=\"synConstant\">1</span>), <span class=\"synType\">Date</span>.new(<span class=\"synConstant\">2021</span>, <span class=\"synConstant\">4</span>, <span class=\"synConstant\">3</span>)) <span class=\"synComment\"># =&gt; ['user2', 'user3', 'user4']</span>\n</pre>\n\n\n<p><code>#at</code> ã§ä¸€æ—¥ãšã¤å€¤ã‚’å–å¾—ã—ã¦ <a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/Ruby\">Ruby</a> ã® <code>Array#uniq</code> ã‚’ä½¿ã£ã¦ã‚‚åŒã˜çµæœãŒå¾—ã‚‰ã‚Œã¾ã™ãŒã€ <code>#range</code> ã‚„ <code>#[]</code> ã®æ–¹ãŒå†…éƒ¨ã§ <a href=\"https://redis.io/commands/sunion\">Redis ã® <code>SUNION</code></a> ã‚’åˆ©ç”¨ã™ã‚‹ãŸã‚é«˜é€Ÿã ã¨æ€ã„ã¾ã™ã€‚</p>\n\n<p>ã¡ãªã¿ã« <code>#range</code> ã‚„ <code>#[]</code> ã®çµæœã¯ <a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/Ruby\">Ruby</a> ã® Array ãªã®ã§ã€ <code>#length</code> ã‚’ä½¿ã£ã¦é•·ã•ã‚’æ±‚ã‚ã‚‹éš›ã¯å®Ÿè¡Œä¸­ã®ãƒã‚·ãƒ³ãƒªã‚½ãƒ¼ã‚¹ã‚’æ¶ˆè²»ã—ã¾ã™ã€‚\nä¸€æ–¹ <code>#at</code> ã§ã¯ <code>Redis::Set</code> ã‚’è¿”ã—ã¦ãŠã‚Šã€ <code>Redis::Set#length</code> ã¯å†…éƒ¨ã§ <a href=\"https://redis.io/commands/scard\">Redis ã® <code>SCARD</code></a> ã‚’å®Ÿè¡Œã™ã‚‹ãŸã‚ã€ <code>#length</code> ã¯ <code>#at</code> ã‹ã‚‰ã®æ–¹ãŒé«˜é€Ÿã ã¨æ€ã„ã¾ã™ã€‚\nãŸã ã—ä¸€å®šæœŸé–“ã®å€¤ã®çµåˆã¯ <code>#range</code> ã‚„ <code>#[]</code> ã‚’ä½¿ã†å¿…è¦ãŒã‚ã‚‹ã®ã§ã€çµå±€ãƒã‚·ãƒ³ãƒªã‚½ãƒ¼ã‚¹ã®æ¶ˆè²»ã¯é¿ã‘ã‚‰ã‚Œãªã„ã§ã™ã­ã€‚ã€‚</p>\n\n<p>ã“ã®è¾ºã‚Šã®ä»•æ§˜ã¯å®Ÿè£…ã—ã¦ã„ã¦ã‹ãªã‚Šé ­ã‚’æ‚©ã¾ã›ã¾ã—ãŸã€‚ãªã®ã§ä»Šå¾Œã®ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆã§ç ´å£Šçš„ãªå¤‰æ›´ãŒå…¥ã‚‹ã‹ã‚‚çŸ¥ã‚Œã¾ã›ã‚“ã€‚</p>\n\n<h2><code>monthly_set</code> ãªã©ã‚‚å®Ÿè£…ã—ã¦ã‚ã‚Šã¾ã™</h2>\n\n<p>å‰å›ã®è¨˜äº‹ã§ã‚‚ç´¹ä»‹ã—ãŸã‚ˆã†ãª <code>monthly_counter</code> ã«ç›¸å½“ã™ã‚‹ <code>monthly_set</code> ãªã©ã‚‚ä½¿ãˆã¾ã™ã€‚\nMAU, WAU, DAU ã§ä½¿ã„åˆ†ã‘ã‚‹ã¨è‰¯ã„ã‹ã¨æ€ã„ã¾ã™ã€‚</p>\n\n<ul>\n<li><code>annual_set</code>\n\n<ul>\n<li>Key format: <code>model_name:id:field_name:yyyy</code></li>\n<li>Redis is a highly volatile key-<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/value\">value</a> store, so I don't recommend using it.</li>\n</ul>\n</li>\n<li><code>monthly_set</code>\n\n<ul>\n<li>Key format: <code>model_name:id:field_name:yyyy-mm</code></li>\n</ul>\n</li>\n<li><code>weekly_set</code>\n\n<ul>\n<li>Key format: <code>model_name:id:field_name:yyyyWw</code></li>\n</ul>\n</li>\n<li><code>daily_set</code>\n\n<ul>\n<li>Key format: <code>model_name:id:field_name:yyyy-mm-dd</code></li>\n</ul>\n</li>\n<li><code>hourly_set</code>\n\n<ul>\n<li>Key format: <code>model_name:id:field_name:yyyy-mm-ddThh</code></li>\n</ul>\n</li>\n<li><code>minutely_set</code>\n\n<ul>\n<li>Key format: <code>model_name:id:field_name:yyyy-mm-ddThh:mi</code></li>\n</ul>\n</li>\n</ul>\n\n","contentSnippet":"å‰å›ã®ãƒ–ãƒ­ã‚°ã§ redis-objects-daily-counter ã¨ã„ã† gem ã‚’ä½œã£ãŸã¨ã„ã†è©±ã‚’ã—ã¾ã—ãŸã€‚ryz310.hateblo.jpä»Šå›ã¯ v0.3.0 ã‚’ãƒªãƒªãƒ¼ã‚¹ã—ãŸã®ã§ãã¡ã‚‰ã®ã”ç´¹ä»‹ã§ã™ã€‚ã€ãŠã•ã‚‰ã„ã€‘redis-objects-daily-counter ã¯ã©ã†ã„ã† gem ãªã®ã‹redis-objects gem ã®æ‹¡å¼µã¨ã—ã¦ä½œã‚‰ã‚Œã¦ãŠã‚Šã€æ—¥ä»˜ã®å¤‰æ›´æ¯ã«æ–°ã—ã„  counter ã‚’å®šç¾©ã—ã¦ãã‚Œã‚‹ daily_counter æ©Ÿèƒ½ã‚’æä¾›ã™ã‚‹ gem ã§ã™ã€‚ä¾‹ãˆã°ä»¥ä¸‹ã®ã‚ˆã†ãª Homepage ã¨ã„ã† class ã§ daily_counter :pv ã¨ã„ã†å®šç¾©ã‚’ã—ã¾ã™ã€‚class Homepage  include Redis::Objects  daily_counter :pv, expireat: -> { Time.now + 2_678_400 } # about a month  def id    1  endendã™ã‚‹ã¨ä»¥ä¸‹ã®ã‚ˆã†ã« #pv ã¨ã„ã†ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ãƒ¡ã‚½ãƒƒãƒ‰ãŒä½¿ãˆã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚ã“ã‚Œã¯ redis-objects gem ã® counter ã®æ‹¡å¼µã§ã‚ã‚Šã€ #increment ã‚„ #decrement ã¨ã„ã†ãƒ¡ã‚½ãƒƒãƒ‰ã§ Redis ä¸Šã®å€¤ã‚’æ›´æ–°ã™ã‚‹ã“ã¨ãŒå¯èƒ½ã§ã™ã€‚# 2021-04-01homepage = Homepage.newhomepage.id # 1homepage.pv.incrementhomepage.pv.incrementhomepage.pv.incrementputs homepage.pv.value # 3daily_counter ãŒ counter ã¨ã©ã®ã‚ˆã†ã«é•ã†ã‹ã¨ã„ã†ã¨ã€æ—¥ä»˜ãŒå¤‰ã‚ã‚‹ã¨Redis ä¸Šã® Key ãŒå¤‰åŒ–ã™ã‚‹ã¨ã„ã†ç‚¹ã§ã™ã€‚# 2021-04-02 (next day)puts homepage.pv.value # 0homepage.pv.incrementhomepage.pv.incrementputs homepage.pv.value # 2ã“ã‚Œã¯ã€ daily_counter ãŒä»¥ä¸‹ã®ã‚ˆã†ãªãƒ«ãƒ¼ãƒ«ã«å‰‡ã£ã¦ Redis ã® Key ã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ã‚ˆã†ã«æŒ¯ã‚‹èˆã†ãŸã‚ã§ã™ã€‚model_name:id:field_name:yyyy-mm-ddãªãŠã€ã“ã®æ™‚ã®ã‚¿ã‚¤ãƒ ã‚¾ãƒ¼ãƒ³ã¯å®Ÿè¡Œä¸­ã® Ruby ãƒ—ãƒ­ã‚»ã‚¹ã®æ¨™æº–ã‚¿ã‚¤ãƒ ã‚¾ãƒ¼ãƒ³ã«å¾“ã„ã¾ã™ãŒã€ Rails ä¸Šã§å®Ÿè¡Œã—ãŸå ´åˆã¯ application.rb ã§æŒ‡å®šã—ãŸã‚¿ã‚¤ãƒ ã‚¾ãƒ¼ãƒ³ã«å¾“ã„ã¾ã™ã€‚æ—¥ä»˜ãŒå¤‰ã‚ã£ãŸå¾Œã‚‚ã€å‰æ—¥ã¾ã§ã® Key-Value ã¯å‰Šé™¤ã—ã¦ã„ãªã„ã®ã§ã€ #range ã‚„ #[] ã‚„ #at ã¨ã„ã†ãƒ¡ã‚½ãƒƒãƒ‰ã§ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ã“ã¨ãŒå¯èƒ½ã§ã™ã€‚ã¡ãªã¿ã« #range ã‚„ #[] ã§ã¯å€¤ãŒè¿”å´ã•ã‚Œã¾ã™ãŒã€ #at ã§ã¯ Redis::Counter ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ãŒè¿”å´ã•ã‚Œã¾ã™ã€‚v0.2.0 ã¾ã§ã¯ #[] ã¨ #at ã¯åŒã˜æŒ™å‹•ã§ã—ãŸãŒã€ v0.3.0 ã‹ã‚‰ãã†ã„ã†å®Ÿè£…ã«å¤‰ã‚ã‚Šã¾ã—ãŸ ğŸ™# 2021-04-01homepage.pv.increment(3)# 2021-04-02 (next day)homepage.pv.increment(2)# 2021-04-03 (next day)homepage.pv.increment(5)homepage.pv[Date.new(2021, 4, 1)] # => 3homepage.pv[Date.new(2021, 4, 1), 3] # => [3, 2, 5]homepage.pv[Date.new(2021, 4, 1)..Date.new(2021, 4, 2)] # => [3, 2]homepage.pv.delete_at(Date.new(2021, 4, 1))homepage.pv.range(Date.new(2021, 4, 1), Date.new(2021, 4, 3)) # => [0, 2, 5]homepage.pv.at(Date.new(2021, 4, 2)) # => #<Redis::Counter key=\"homepage:1:pv:2021-04-02\">homepage.pv.at(Date.new(2021, 4, 2)).value # 2v0.3.0 ã§è¿½åŠ ã•ã‚ŒãŸæ©Ÿèƒ½ã¨ã¯daily_counter ã«åŠ ãˆã¦ daily_set ãŒè¿½åŠ ã•ã‚Œã¾ã—ãŸã€‚ã“ã¡ã‚‰ã¯ redis-objects gem ã® setã« daily- æ©Ÿèƒ½ã‚’è¿½åŠ ã—ãŸã‚‚ã®ã«ãªã‚Šã¾ã™ã€‚class Homepage  include Redis::Objects  daily_set :dau, expireat: -> { Time.now + 2_678_400 } # about a month  def id    1  endendhomepage.dau << 'user1'homepage.dau << 'user2'homepage.dau << 'user1' # dup ignoredputs homepage.dau.members # ['user1', 'user2']puts homepage.dau.length # 2puts homepage.dau.count # alias of #lengthset ã¯é‡è¤‡ã‚’å—ã‘ä»˜ã‘ãªã„ Array ã¨è€ƒãˆã¦è‰¯ã„ã¨æ€ã„ã¾ã™ã€‚ä¸Šè¨˜ã®ä¾‹ã‚’è¦‹ã¦ã‚‚ã‚‰ã†ã¨åˆ†ã‹ã‚Šã¾ã™ãŒ user1 ã‚’ 2 å›è¿½åŠ ã—ã¦ã‚‚ #members ã«ã‚ˆã‚‹å–å¾—çµæœã«ã¯ 1 ã¤ã—ã‹å«ã¾ã‚Œã¦ã„ã¾ã›ã‚“ã€‚ã“ã‚Œã‚’ä½¿ã£ã¦ä½•ãŒå®Ÿç¾ã§ãã‚‹ã‹ã¨ã„ã†ã¨ã€ DAU (Daily Active User) ã®è¨ˆæ¸¬ã§ã™ã€‚ãƒ­ã‚°ã‚¤ãƒ³ã—ãŸãƒ¦ãƒ¼ã‚¶ãƒ¼ã® ID ã‚’ daily_set ã§å®šç¾©ã—ãŸå¤‰æ•°ã«è¿½åŠ ã—ã¦ã„ãã“ã¨ã§ã€ãã®æ—¥ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ã ã£ãŸãƒ¦ãƒ¼ã‚¶ãƒ¼ä¸€è¦§ã¨ãã®æ•°ã‚’çŸ¥ã‚‹ã“ã¨ãŒå‡ºæ¥ã¾ã™ã€‚# 2021-04-01homepage.dau.merge('user1', 'user2')puts homepage.dau.members # ['user1', 'user2']# 2021-04-02 (next day)puts homepage.dau.members # []homepage.dau.merge('user2', 'user3')puts homepage.dau.members # ['user2', 'user3']# 2021-04-03 (next day)homepage.dau.merge('user4')homepage.dau.at(Date.new(2021, 4, 2)) # => #<Redis::Set key=\"homepage:1:dau:2021-04-02\">homepage.dau.at(Date.new(2021, 4, 2)).members # => ['user2', 'user3']homepage.dau.at(Date.new(2021, 4, 2)).length # => 2#range ã‚„ #[] ã‚’ä½¿ã†äº‹ã§æŒ‡å®šã—ãŸæœŸé–“å†…ã®å€¤ã‚’çµåˆã™ã‚‹ã“ã¨ã‚‚å‡ºæ¥ã¾ã™ã€‚ã“ã‚Œã«ã‚ˆã£ã¦ DAU ç›®çš„ã§è¨˜éŒ²ã—ãŸå€¤ã‹ã‚‰ MAU ã‚’æ±‚ã‚ã‚‹ã“ã¨ã‚‚å¯èƒ½ã§ã™ã€‚homepage.dau[Date.new(2021, 4, 1)] # => ['user1', 'user2']homepage.dau[Date.new(2021, 4, 1), 3] # => ['user1', 'user2', 'user3', 'user4']homepage.dau[Date.new(2021, 4, 1)..Date.new(2021, 4, 2)] # => ['user1', 'user2', 'user3']homepage.dau.delete_at(Date.new(2021, 4, 1))homepage.dau.range(Date.new(2021, 4, 1), Date.new(2021, 4, 3)) # => ['user2', 'user3', 'user4']#at ã§ä¸€æ—¥ãšã¤å€¤ã‚’å–å¾—ã—ã¦ Ruby ã® Array#uniq ã‚’ä½¿ã£ã¦ã‚‚åŒã˜çµæœãŒå¾—ã‚‰ã‚Œã¾ã™ãŒã€ #range ã‚„ #[] ã®æ–¹ãŒå†…éƒ¨ã§ Redis ã® SUNION ã‚’åˆ©ç”¨ã™ã‚‹ãŸã‚é«˜é€Ÿã ã¨æ€ã„ã¾ã™ã€‚ã¡ãªã¿ã« #range ã‚„ #[] ã®çµæœã¯ Ruby ã® Array ãªã®ã§ã€ #length ã‚’ä½¿ã£ã¦é•·ã•ã‚’æ±‚ã‚ã‚‹éš›ã¯å®Ÿè¡Œä¸­ã®ãƒã‚·ãƒ³ãƒªã‚½ãƒ¼ã‚¹ã‚’æ¶ˆè²»ã—ã¾ã™ã€‚ä¸€æ–¹ #at ã§ã¯ Redis::Set ã‚’è¿”ã—ã¦ãŠã‚Šã€ Redis::Set#length ã¯å†…éƒ¨ã§ Redis ã® SCARD ã‚’å®Ÿè¡Œã™ã‚‹ãŸã‚ã€ #length ã¯ #at ã‹ã‚‰ã®æ–¹ãŒé«˜é€Ÿã ã¨æ€ã„ã¾ã™ã€‚ãŸã ã—ä¸€å®šæœŸé–“ã®å€¤ã®çµåˆã¯ #range ã‚„ #[] ã‚’ä½¿ã†å¿…è¦ãŒã‚ã‚‹ã®ã§ã€çµå±€ãƒã‚·ãƒ³ãƒªã‚½ãƒ¼ã‚¹ã®æ¶ˆè²»ã¯é¿ã‘ã‚‰ã‚Œãªã„ã§ã™ã­ã€‚ã€‚ã“ã®è¾ºã‚Šã®ä»•æ§˜ã¯å®Ÿè£…ã—ã¦ã„ã¦ã‹ãªã‚Šé ­ã‚’æ‚©ã¾ã›ã¾ã—ãŸã€‚ãªã®ã§ä»Šå¾Œã®ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆã§ç ´å£Šçš„ãªå¤‰æ›´ãŒå…¥ã‚‹ã‹ã‚‚çŸ¥ã‚Œã¾ã›ã‚“ã€‚monthly_set ãªã©ã‚‚å®Ÿè£…ã—ã¦ã‚ã‚Šã¾ã™å‰å›ã®è¨˜äº‹ã§ã‚‚ç´¹ä»‹ã—ãŸã‚ˆã†ãª monthly_counter ã«ç›¸å½“ã™ã‚‹ monthly_set ãªã©ã‚‚ä½¿ãˆã¾ã™ã€‚MAU, WAU, DAU ã§ä½¿ã„åˆ†ã‘ã‚‹ã¨è‰¯ã„ã‹ã¨æ€ã„ã¾ã™ã€‚annual_setKey format: model_name:id:field_name:yyyyRedis is a highly volatile key-value store, so I don't recommend using it.monthly_setKey format: model_name:id:field_name:yyyy-mmweekly_setKey format: model_name:id:field_name:yyyyWwdaily_setKey format: model_name:id:field_name:yyyy-mm-ddhourly_setKey format: model_name:id:field_name:yyyy-mm-ddThhminutely_setKey format: model_name:id:field_name:yyyy-mm-ddThh:mi","link":"https://ryz310.hateblo.jp/entry/2021/09/23/203804","isoDate":"2021-09-23T11:38:04.000Z","dateMiliSeconds":1632397084000,"imageUrl":"https://cdn.blog.st-hatena.com/images/theme/og-image-1500.png","authorName":"ryz310"},{"title":"Redis::Objects ã‚’ä½¿ã£ãŸã‚µãƒ¼ãƒ“ã‚¹æ”¹å–„ã¨æ–°ã—ã„ gem ã‚’ä½œã£ãŸãŠè©±","content":"<p>åŠå¹´ã¶ã‚Šãã‚‰ã„ã«ä¼šç¤¾ã®å‹‰å¼·ä¼šã§ç™ºè¡¨ã—ã¾ã—ãŸã€‚</p>\n\n<iframe class=\"speakerdeck-iframe\" frameborder=\"0\" src=\"https://speakerdeck.com/player/58bb74a90a8b444e8607850fc76d8eb7\" title=\"Redis::Objects ã§éŠã‚“ã§ã¿ã‚ˆã†\" allowfullscreen=\"true\" mozallowfullscreen=\"true\" webkitallowfullscreen=\"true\" style=\"border: 0px; background: padding-box padding-box rgba(0, 0, 0, 0.1); margin: 0px; padding: 0px; border-radius: 6px; box-shadow: rgba(0, 0, 0, 0.2) 0px 5px 40px; width: 560px; height: 314px;\"></iframe>\n\n\n<p>Redis::Objects ã¨ã„ã† gem ã‚’ä½¿ã£ã¦ RDS ã«ã‹ã‹ã£ã¦ã„ãŸ IO è² è·ã‚’æ”¹å–„ã—ãŸã€ã¨ã„ã†è©±ã¨ã€ Redis::Objects ã‚’æ‹¡å¼µã™ã‚‹ gem ã‚’ä½œã£ãŸã¨ã„ã†è©±ï¼ˆå¾Œè¿°ï¼‰ã§ã™ã€‚</p>\n\n<p><iframe src=\"https://hatenablog-parts.com/embed?url=https%3A%2F%2Fgithub.com%2Fryz310%2Fredis-objects-daily-counter\" title=\"GitHub - ryz310/redis-objects-daily-counter: Daily counter within Redis::Objects. Works with any class or ORM.\" class=\"embed-card embed-webcard\" scrolling=\"no\" frameborder=\"0\" style=\"display: block; width: 100%; height: 155px; max-width: 500px; margin: 10px 0px;\"></iframe><cite class=\"hatena-citation\"><a href=\"https://github.com/ryz310/redis-objects-daily-counter\">github.com</a></cite></p>\n\n<p>Redis ã‚’ä½¿ã£ã¦ DB ã®è² è·ã‚’ä¸‹ã’ã‚‹ç³»ã®ãŠè©±ã£ã¦ 2010 å¹´ä»£ã«ã•ã‚Œå°½ãã—ãŸæ„ŸãŒã‚ã£ã¦ã€ä»Šæ›´ãªæ°—ã‚‚ã™ã‚‹ã‚“ã§ã™ãŒã€ä¸€å‘¨å›ã£ã¦æœ€è¿‘èã‹ãªã„è©±ã ãªãƒ¼ã¨æ€ã£ã¦ã¾ã™ã€‚\nãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ã§æœ€è¿‘ã‚µãƒ¼ãƒãƒ¼ã‚µã‚¤ãƒ‰ã‚‚è§¦ã‚‹æ©Ÿä¼šãŒå¢—ãˆãŸã‚ˆã†ãªæ–¹ã€…ã«ã‚¦ã‚±ãŒè‰¯ã‹ã£ãŸæ„Ÿã˜ãŒã‚ã‚Šã¾ã™ã­ã€‚</p>\n\n<hr />\n\n<p>ä¸€æ–¹ã§ç¤¾å†…ã®ã‚¤ãƒ³ãƒ•ãƒ©ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ã‹ã‚‰ã¯ Redis ã£ã¦ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹ã®æ‰‹é–“ãŒæ›ã‹ã£ã¦è©•åˆ¤æ‚ªã„ã§ã™ã­ã€‚\nä½¿ã†ã ã‘ãªã‚‰æ‰‹è»½ã§æ¥½ãªã‚“ã§ã™ãŒã€<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/AWS\">AWS</a> ã®ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆã§ãƒ€ã‚¦ãƒ³ã‚¿ã‚¤ãƒ ãŒç™ºç”Ÿã™ã‚‹æ™‚ã«åˆ©ç”¨è€…å‘ã‘ã«ã‚¢ãƒŠã‚¦ãƒ³ã‚¹ã—ãªã„ã¨ã„ã‘ãªã‹ã£ãŸã‚Šã€‚\nãƒ€ã‚¦ãƒ³ã‚¿ã‚¤ãƒ ã¨è¨€ã£ã¦ã‚‚æ·±å¤œã«æ•°ç§’ã€œæ•°åˆ†ãªã®ã§å½±éŸ¿ã¯å°‘ãªã„ã¨æ€ã†ã‚“ã§ã™ãŒã€<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%A8%A5%F3%A5%BF%A1%BC%A5%D7%A5%E9%A5%A4%A5%BA\">ã‚¨ãƒ³ã‚¿ãƒ¼ãƒ—ãƒ©ã‚¤ã‚º</a>å‘ã‘ã®ã‚µãƒ¼ãƒ“ã‚¹ã¨ã‹ã‚„ã£ã¦ã‚‹ã¨ã“ã®è¾ºã¯å³ã—ã„ã§ã™ã­ã€‚</p>\n\n<p><a href=\"https://cloud.google.com/blog/ja/products/management-tools/sre-error-budgets-and-maintenance-windows\">SRE ã®ã‚¨ãƒ©ãƒ¼ãƒã‚¸ã‚§ãƒƒãƒˆã®æ¦‚å¿µ</a> ãŒæ—¥æœ¬å…¨ä½“ã«æµ¸é€ã™ã‚Œã°ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢é–‹ç™ºã®ç”Ÿç”£æ€§ã¯åº•ä¸Šã’ã•ã‚Œã‚‹ã‚“ã˜ã‚ƒãªã„ã‹ã¨æ€ã†ã®ã§ã™ãŒã€ã“ã®è¾ºã¯æ™‚é–“ã‚’æ›ã‘ã¦å°‘ã—ãšã¤å•“è’™ã—ã¦ã„ãã—ã‹ç„¡ã„ã§ã™ã­ã€‚ä¾‹ãˆã°æ—¥æœ¬ã®ç”Ÿæ´»ã‚¤ãƒ³ãƒ•ãƒ©ï¼ˆé›»æ°—ãƒ»æ°´é“ãƒ»ã‚¬ã‚¹ã¨ã‹é›»è»Šã¨ã‹ï¼‰ã£ã¦ã‚ã£ã¡ã‚ƒé«˜æ°´æº–ãªã®ã§ã€ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã®ä¸–ç•Œã§ã‚‚100ï¼…ç¨¼åƒã™ã‚‹ã“ã¨ãŒå½“ãŸã‚Šå‰ã¨ã„ã†ä¾¡å€¤è¦³ã«ãªã£ã¦ã—ã¾ã†ã‚“ã˜ã‚ƒãªã„ã‹ãªã€ã¨æ€ã†ã®ã§ã™ãŒã€ã“ã®è¾ºã®ä¾¡å€¤è¦³ã¯è¡¨è£ä¸€ä½“ã¨ã„ã†ã‹ã€å½“ãŸã‚Šå‰ã¨æ„Ÿã˜ã¦ã„ã‚‹ã‹ã‚‰é«˜å“è³ªã«ãªã‚‹ä¸€æ–¹ã§ã€ç”Ÿç”£æ€§ã¯ä¸‹ãŒã£ã¦ã—ã¾ã†ã¨ã„ã†æ§‹å›³ã ã¨æ€ã£ã¦ã„ã¾ã™ã€‚</p>\n\n<p><a href=\"https://www.nic.ad.jp/ja/materials/iw/2017/proceedings/s15/s15-fujisaki.pdf\">https://www.nic.ad.jp/ja/materials/iw/2017/proceedings/s15/s15-fujisaki.pdf</a>\n<figure class=\"figure-image figure-image-fotolife\" title=\"SREã®ä¿¡æ¡ (Google)\"><span itemscope itemtype=\"http://schema.org/Photograph\"><img src=\"https://cdn-ak.f.st-hatena.com/images/fotolife/r/ryz310/20210920/20210920165304.png\" alt=\"f:id:ryz310:20210920165304p:plain\" width=\"963\" height=\"527\" loading=\"lazy\" title=\"\" class=\"hatena-fotolife\" itemprop=\"image\"></span><figcaption>SREã®ä¿¡æ¡ (<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/Google\">Google</a>)</figcaption></figure></p>\n\n<p>ä¸€å¿œãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹ã®æ‰‹é–“ã€ã¨ã„ã†ç‚¹ã§ã¯å¤é ƒã« <a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/AWS\">AWS</a> ã‹ã‚‰ <a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/Amazon\">Amazon</a> MemoryDB for Redis ã¨ã„ã†ãƒ•ãƒ«ãƒãƒãƒ¼ã‚¸ãƒ‰ãª Redis ãŒç™ºè¡¨ã•ã‚Œã¦ã„ã¾ã™ã€‚\næ±äº¬ãƒªãƒ¼ã‚¸ãƒ§ãƒ³ã¯æœªå¯¾å¿œã§ã€æ›¸ãè¾¼ã¿é€Ÿåº¦ãŒé…ããªã£ã¦ã„ãŸã‚Šã€æ–™é‡‘ã‚‚è‹¥å¹²é«˜ããªã£ã¦ã„ãŸã‚Šã—ã¾ã™ãŒã€æ°—ã«ãªã‚‹ã‚µãƒ¼ãƒ“ã‚¹ã§ã¯ã‚ã‚Šã¾ã™ã­ã€‚</p>\n\n<p><iframe src=\"https://hatenablog-parts.com/embed?url=https%3A%2F%2Fdev.classmethod.jp%2Farticles%2Faws-release-durable-redis-amazon-memorydb-for-redis%2F\" title=\"Redisã«è€ä¹…æ€§ãŒåŠ ã‚ã£ãŸAmazon MemoryDB for RedisãŒç™»å ´ | DevelopersIO\" class=\"embed-card embed-webcard\" scrolling=\"no\" frameborder=\"0\" style=\"display: block; width: 100%; height: 155px; max-width: 500px; margin: 10px 0px;\"></iframe><cite class=\"hatena-citation\"><a href=\"https://dev.classmethod.jp/articles/aws-release-durable-redis-amazon-memorydb-for-redis/\">dev.classmethod.jp</a></cite></p>\n\n<hr />\n\n<p>ã•ã¦ã€ã“ã®è¨˜äº‹ã®ãƒ¡ã‚¤ãƒ³ã¯å†’é ­ã§è§¦ã‚ŒãŸ Redis::Objects ã‚’æ‹¡å¼µã™ã‚‹ gem ã‚’ä½œã£ãŸã‚ˆã€ã¨ã„ã†è©±ã§ã™ã€‚</p>\n\n<p><iframe src=\"https://hatenablog-parts.com/embed?url=https%3A%2F%2Fgithub.com%2Fryz310%2Fredis-objects-daily-counter\" title=\"GitHub - ryz310/redis-objects-daily-counter: Daily counter within Redis::Objects. Works with any class or ORM.\" class=\"embed-card embed-webcard\" scrolling=\"no\" frameborder=\"0\" style=\"display: block; width: 100%; height: 155px; max-width: 500px; margin: 10px 0px;\"></iframe><cite class=\"hatena-citation\"><a href=\"https://github.com/ryz310/redis-objects-daily-counter\">github.com</a></cite></p>\n\n<p>ç™ºç«¯ã¯ Redis::Objects ã® <code>counter</code> ã‚’ä½¿ã£ã¦ã‚µãƒ¼ãƒ“ã‚¹ã®åŠ¹æœæ¸¬å®šï¼ˆãƒ¡ãƒ¼ãƒ«é…ä¿¡æ•°ã€CV æ•°ã€ãƒ­ã‚°ã‚¤ãƒ³æ•°ãªã©ï¼‰ã‚’ã—ãŸã„ãªãƒ¼ã¨è€ƒãˆãŸã“ã¨ãªã‚“ã§ã™ãŒã€åŠ¹æœæ¸¬å®šã£ã¦ä¸€å®šã®æœŸé–“æ¯ã«é›†è¨ˆã—ã¦æ”¹å–„ã—ãŸãƒ»ã—ã¦ã„ãªã„ã®æŒ‡æ¨™ã«ã—ãŸã„ã‚„ã¤ã˜ã‚ƒãªã„ã§ã™ã‹ï¼Ÿ\n<code>counter</code> ã§ã‚«ã‚¦ãƒ³ãƒˆã‚¢ãƒƒãƒ—ã—ã¤ã¤ã€æ—¥æ¬¡ã®<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%D0%A5%C3%A5%C1%BD%E8%CD%FD\">ãƒãƒƒãƒå‡¦ç†</a>ã§é›†è¨ˆã™ã‚Œã°è‰¯ã„ã‚“ã§ã™ãŒã€ãã‚Œã ã¨ã‚ã¾ã‚Šæ°—è»½ã˜ã‚ƒãªã„ã¨ã„ã†ã‹ã€æ¸¬å®šå¯¾è±¡ã¨ãªã‚‹ã‚µãƒ¼ãƒ“ã‚¹é–‹ç™ºã®å¾Œã€æ¸¬å®šãƒ­ã‚¸ãƒƒã‚¯ã¨<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%D0%A5%C3%A5%C1%BD%E8%CD%FD\">ãƒãƒƒãƒå‡¦ç†</a>ã€ä¿å­˜å…ˆã® DB ãƒ†ãƒ¼ãƒ–ãƒ«ä½œæˆã¾ã§ã‚»ãƒƒãƒˆã§å®Ÿè£…ã—ãªã„ã¨å®Ÿç¾ã§ããªã„ã§ã™ã‚ˆã­ã€‚</p>\n\n<p>ã“ã‚Œã¯ã‚µã‚¯ãƒƒã¨å®Ÿè£…ã™ã‚‹ã«ã¯ <code>counter</code> ãŒè‡ªå‹•ã§æ—¥æ¬¡ã§ä¿å­˜å…ˆã‚’åˆ‡ã‚Šæ›¿ãˆã¦ãã‚Œã‚Œã°è‰¯ã•ãã†ã€ã¨ã„ã†ã“ã¨ã§ã€ <code>redis-objects-daily-counter</code> ã¨ã„ã† gem ã¯ <code>daily_counter</code> ã¨ã„ã†æ—¥æ¬¡ã§ä¿å­˜å…ˆã‚’åˆ‡ã‚Šæ›¿ãˆã‚‹ã‚«ã‚¦ãƒ³ã‚¿ãƒ¼æ©Ÿèƒ½ã‚’æä¾›ã—ã¾ã™ã€‚\nRedis::Objects ã‚’æ‹¡å¼µã—ã¦ä½œã£ã¦ã‚ã‚‹ã®ã§ã€ä½¿ã„æ–¹ã¯ã»ã¼åŒã˜ã§ã€å¯¾è±¡ã¨ã—ãŸã„ Class ã« <code>include Redis::Objects</code> ã‚’è¿½åŠ ã™ã‚‹ã¨ä½¿ãˆã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚</p>\n\n<pre class=\"code lang-ruby\" data-lang=\"ruby\" data-unlink><span class=\"synComment\"># Gemfile</span>\ngem <span class=\"synSpecial\">'</span><span class=\"synConstant\">redis-objects-daily-counter</span><span class=\"synSpecial\">'</span>\n</pre>\n\n\n\n\n<pre class=\"code lang-ruby\" data-lang=\"ruby\" data-unlink><span class=\"synPreProc\">class</span> <span class=\"synType\">Homepage</span>\n  <span class=\"synPreProc\">include</span> <span class=\"synType\">Redis</span>::<span class=\"synType\">Objects</span>\n\n  daily_counter <span class=\"synConstant\">:pv</span>, <span class=\"synConstant\">expireat</span>: -&gt; { <span class=\"synType\">Time</span>.now + <span class=\"synConstant\">2_678_400</span> } <span class=\"synComment\"># about a month</span>\n\n  <span class=\"synPreProc\">def</span> <span class=\"synIdentifier\">id</span>\n    <span class=\"synConstant\">1</span>\n  <span class=\"synPreProc\">end</span>\n<span class=\"synPreProc\">end</span>\n\n<span class=\"synComment\"># 2021-04-01</span>\nhomepage = <span class=\"synType\">Homepage</span>.new\nhomepage.id <span class=\"synComment\"># 1</span>\n\nhomepage.pv.increment\nhomepage.pv.increment\nhomepage.pv.increment\nputs homepage.pv.value <span class=\"synComment\"># 3</span>\n\n<span class=\"synComment\"># 2021-04-02 (next day)</span>\nputs homepage.pv.value <span class=\"synComment\"># 0</span>\nhomepage.pv.increment\nhomepage.pv.increment\nputs homepage.pv.value <span class=\"synComment\"># 2</span>\n\nstart_date = <span class=\"synType\">Date</span>.new(<span class=\"synConstant\">2021</span>, <span class=\"synConstant\">4</span>, <span class=\"synConstant\">1</span>)\nend_date = <span class=\"synType\">Date</span>.new(<span class=\"synConstant\">2021</span>, <span class=\"synConstant\">4</span>, <span class=\"synConstant\">2</span>)\nhomepage.pv.range(start_date, end_date) <span class=\"synComment\"># [3, 2]</span>\n</pre>\n\n\n<p><code>#increment</code> <code>#decrement</code> ã¯ <code>counter</code> ã¨åŒã˜ä½¿ã„å‹æ‰‹ã§ã™ã€‚ãŸã ã€æ—¥ä»˜ãŒå¤‰ã‚ã‚‹ã¨è‡ªå‹•çš„ã«ä¿å­˜å…ˆãŒåˆ‡ã‚Šæ›¿ã‚ã‚Šã¾ã™ã€‚\nã“ã‚Œã¯ Redis ã§ä¿å­˜ã—ã¦ã„ã‚‹ Key åãŒä»¥ä¸‹ã®ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã«ãªã£ã¦ã„ã‚‹ãŸã‚ã§ã™ã€‚</p>\n\n<pre class=\"code\" data-lang=\"\" data-unlink>model_name:id:field_name:yyyy-mm-dd</pre>\n\n\n<p>æ—¥ä»˜ãŒå¤‰ã‚ã£ãŸå¾Œã‚‚éå»ã®ãƒ¬ã‚³ãƒ¼ãƒ‰ã¯å‰Šé™¤ã•ã‚Œã¦ã„ãªã„ã®ã§ã€ä»¥ä¸‹ã®ã‚³ãƒ¼ãƒ‰ã§ã‚¢ã‚¯ã‚»ã‚¹å‡ºæ¥ã¾ã™ã€‚ã“ã®ä½¿ã„æ–¹ã¯åŒã˜ã Redis::Objects ã® <code>list</code> ã¨ä¼¼ãŸã‚ˆã†ãªä½¿ã„å‹æ‰‹ã«ãªã£ã¦ã„ã¾ã™ã€‚</p>\n\n<pre class=\"code lang-ruby\" data-lang=\"ruby\" data-unlink><span class=\"synComment\"># 2021-04-01</span>\nhomepage.pv.increment(<span class=\"synConstant\">3</span>)\n\n<span class=\"synComment\"># 2021-04-02 (next day)</span>\nhomepage.pv.increment(<span class=\"synConstant\">2</span>)\n\n<span class=\"synComment\"># 2021-04-03 (next day)</span>\nhomepage.pv.increment(<span class=\"synConstant\">5</span>)\n\nhomepage.pv[<span class=\"synType\">Date</span>.new(<span class=\"synConstant\">2021</span>, <span class=\"synConstant\">4</span>, <span class=\"synConstant\">1</span>)] <span class=\"synComment\"># =&gt; 3</span>\nhomepage.pv[<span class=\"synType\">Date</span>.new(<span class=\"synConstant\">2021</span>, <span class=\"synConstant\">4</span>, <span class=\"synConstant\">1</span>), <span class=\"synConstant\">3</span>] <span class=\"synComment\"># =&gt; [3, 2, 5]</span>\nhomepage.pv[<span class=\"synType\">Date</span>.new(<span class=\"synConstant\">2021</span>, <span class=\"synConstant\">4</span>, <span class=\"synConstant\">1</span>)..<span class=\"synType\">Date</span>.new(<span class=\"synConstant\">2021</span>, <span class=\"synConstant\">4</span>, <span class=\"synConstant\">2</span>)] <span class=\"synComment\"># =&gt; [3, 2]</span>\n\nhomepage.pv.delete(<span class=\"synType\">Date</span>.new(<span class=\"synConstant\">2021</span>, <span class=\"synConstant\">4</span>, <span class=\"synConstant\">1</span>))\nhomepage.pv.range(<span class=\"synType\">Date</span>.new(<span class=\"synConstant\">2021</span>, <span class=\"synConstant\">4</span>, <span class=\"synConstant\">1</span>), <span class=\"synType\">Date</span>.new(<span class=\"synConstant\">2021</span>, <span class=\"synConstant\">4</span>, <span class=\"synConstant\">3</span>)) <span class=\"synComment\"># =&gt; [0, 2, 5]</span>\nhomepage.pv.at(<span class=\"synType\">Date</span>.new(<span class=\"synConstant\">2021</span>, <span class=\"synConstant\">4</span>, <span class=\"synConstant\">2</span>)) <span class=\"synComment\"># =&gt; 2</span>\n</pre>\n\n\n<p>ã“ã‚Œã§æ¸¬å®šå¯¾è±¡ã¨ãªã‚‹ã‚µãƒ¼ãƒ“ã‚¹ã‚’é–‹ç™ºã—ãŸå¾Œã€ <code>daily_counter</code> ã§æ¸¬å®šå‡¦ç†ã‚’å®Ÿè£…ã—ã¦ãŠãã ã‘ã§ OKã€‚\nã“ã®çŠ¶æ…‹ã§ãƒªãƒªãƒ¼ã‚¹ã™ã‚Œã°ãƒ‡ãƒ¼ã‚¿ã¯æºœã¾ã£ã¦ã„ãã®ã§ã€é€±æ¬¡ã‚„æœˆæ¬¡ã§é›†è¨ˆã™ã‚‹<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%D0%A5%C3%A5%C1%BD%E8%CD%FD\">ãƒãƒƒãƒå‡¦ç†</a>ã‚’å¾Œã§ã‚†ã£ãã‚Šå®Ÿè£…ã™ã‚Œã°è‰¯ã„ã§ã™ã€‚\n<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%D0%A5%C3%A5%C1%BD%E8%CD%FD\">ãƒãƒƒãƒå‡¦ç†</a>å®Ÿè£…å‰ã«ã‚µãƒ¼ãƒãƒ¼å†…ã§ <code>$ bin/rails console</code> ã‚’å®Ÿè¡Œã—ã¦ <code>daily_counter</code> ã®å€¤ã‚’ç¢ºèªã—ãªãŒã‚‰<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%D0%A5%C3%A5%C1%BD%E8%CD%FD\">ãƒãƒƒãƒå‡¦ç†</a>ã®å®Ÿè£…ã‚’è€ƒãˆã‚‹ã€ã¨ã‹ã‚‚å‡ºæ¥ã¾ã™ã­ã€‚\nå…·ä½“çš„ãªãƒ‡ãƒ¼ã‚¿ã‚’è¦‹ãªãŒã‚‰ã®æ–¹ãŒé–‹ç™ºé›£æ˜“åº¦ã¯ä¸‹ãŒã‚Šã¾ã™ã€‚</p>\n\n<p>ã¡ãªã¿ã«ã§ã™ãŒã€ <strong><code>expireat</code> ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’æŒ‡å®šã—ã¦ãŠãã“ã¨ã‚’ã‚ªã‚¹ã‚¹ãƒ¡ã—ã¾ã™ã€‚</strong>\ngem ã®ä»•æ§˜ä¸Šã€ã©ã‚“ã©ã‚“ Redis ä¸Šã®ãƒ¡ãƒ¢ãƒªã‚’åœ§è¿«ã—ã¦ã„ãã®ã§ã€ä¸€å®šæœŸé–“å¾Œã«è‡ªå‹•çš„ã«å‰Šé™¤ã™ã‚‹ã‚ˆã†ã«ã—ã¾ã—ã‚‡ã†ã€‚</p>\n\n<hr />\n\n<p><code>daily_counter</code> ãŒã‚ã‚‹ãªã‚‰é€±æ¬¡ã€æœˆæ¬¡ã€å¹´æ¬¡ã‚«ã‚¦ãƒ³ã‚¿ãƒ¼ãŒã‚ã£ã¦ã‚‚è‰¯ã„ã‚ˆã­ã€ãªã‚“ã ã£ãŸã‚‰æ¯æ™‚ã€æ¯åˆ†ã‚«ã‚¦ãƒ³ã‚¿ãƒ¼ã‚‚ã‚ã£ãŸã£ã¦è‰¯ã„ã˜ã‚ƒãªã„ã‹ã€ã¨ã„ã†äº‹ã§ <code>v0.2.0</code> ã§ã¯ãã‚Œã‚‰ãŒè¿½åŠ ã•ã‚Œã¦ã„ã¾ã™ã€‚</p>\n\n<p>æ¯æ™‚ãƒ»æ¯åˆ†ã®ã‚«ã‚¦ãƒ³ã‚¿ãƒ¼ã¯ <a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/API\">API</a> rate limit æ©Ÿèƒ½ã®å®Ÿè£…ã«ã‚‚è‰¯ã„ã‹ã‚‚ã—ã‚Œãªã„ã§ã™ã­ã€‚</p>\n\n<ul>\n<li><code>annual_counter</code>\n\n<ul>\n<li>Key format: <code>model_name:id:field_name:yyyy</code></li>\n<li>Redis is a highly volatile key-<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/value\">value</a> store, so I don't recommend using it.</li>\n</ul>\n</li>\n<li><code>monthly_counter</code>\n\n<ul>\n<li>Key format: <code>model_name:id:field_name:yyyy-mm</code></li>\n</ul>\n</li>\n<li><code>weekly_counter</code>\n\n<ul>\n<li>Key format: <code>model_name:id:field_name:yyyyWw</code></li>\n</ul>\n</li>\n<li><code>daily_counter</code>\n\n<ul>\n<li>Key format: <code>model_name:id:field_name:yyyy-mm-dd</code></li>\n</ul>\n</li>\n<li><code>hourly_counter</code>\n\n<ul>\n<li>Key format: <code>model_name:id:field_name:yyyy-mm-ddThh</code></li>\n</ul>\n</li>\n<li><code>minutely_counter</code>\n\n<ul>\n<li>Key format: <code>model_name:id:field_name:yyyy-mm-ddThh:mi</code></li>\n</ul>\n</li>\n</ul>\n\n\n<p>ä¸€å¿œå®Ÿè£…ã¯ã—ã¾ã—ãŸãŒã€ <code>annual_counter</code> ã®ã‚ˆã†ã«æœŸé–“ã®é•·ã„ã‚«ã‚¦ãƒ³ã‚¿ãƒ¼ã®åˆ©ç”¨ã¯ã‚ã¾ã‚Šã‚ªã‚¹ã‚¹ãƒ¡ã—ã¾ã›ã‚“ã€‚\nRedis ã£ã¦ãµã¨ã—ãŸæ‹å­ã«ãƒ‡ãƒ¼ã‚¿ãŒé£›ã‚“ã§ã—ã¾ã†å¯èƒ½æ€§ãŒã‚ã‚‹ã®ã§ã€ã‚ãã¾ã§ã‚­ãƒ£ãƒƒã‚·ãƒ¥çš„ãªä½ç½®ä»˜ã‘ã§åˆ©ç”¨ã™ã‚‹ã®ãŒè‰¯ã„ã¨æ€ã„ã¾ã™ã€‚\n<code>daily_counter</code> ã‚‚é€±æ¬¡ãƒ»æœˆæ¬¡ã§ RDS ã«é›†è¨ˆçµæœã‚’ä¿å­˜ã™ã‚‹é‹ç”¨ã‚’æƒ³å®šã—ã¦ã„ã¾ã™ã®ã§ã€‚</p>\n\n<hr />\n\n<p>ã¨ã„ã†ã‚ã‘ã§ä¹…ã€…ã®ãƒ–ãƒ­ã‚°æ›´æ–°ã§ã¯æ–°ã—ãä½œã£ãŸ <code>redis-objects-daily-counter</code> ã¨ã„ã† gem ã®ç´¹ä»‹ã‚’ã•ã›ã¦é ‚ãã¾ã—ãŸã€‚\nã“ã‚Œã‹ã‚‰å¼Šç¤¾ãƒ—ãƒ­ãƒ€ã‚¯ãƒˆã§ã‚‚åˆ©ç”¨ã—ã¦ã„ãäºˆå®šã§ã™ã—ã€è‰²ã€…ãªã‚µãƒ¼ãƒ“ã‚¹ã§ã‚‚æ´»ç”¨é ‚ã‘ã‚‹ã¨å¬‰ã—ã„ã§ã™ã€‚</p>\n","contentSnippet":"åŠå¹´ã¶ã‚Šãã‚‰ã„ã«ä¼šç¤¾ã®å‹‰å¼·ä¼šã§ç™ºè¡¨ã—ã¾ã—ãŸã€‚Redis::Objects ã¨ã„ã† gem ã‚’ä½¿ã£ã¦ RDS ã«ã‹ã‹ã£ã¦ã„ãŸ IO è² è·ã‚’æ”¹å–„ã—ãŸã€ã¨ã„ã†è©±ã¨ã€ Redis::Objects ã‚’æ‹¡å¼µã™ã‚‹ gem ã‚’ä½œã£ãŸã¨ã„ã†è©±ï¼ˆå¾Œè¿°ï¼‰ã§ã™ã€‚github.comRedis ã‚’ä½¿ã£ã¦ DB ã®è² è·ã‚’ä¸‹ã’ã‚‹ç³»ã®ãŠè©±ã£ã¦ 2010 å¹´ä»£ã«ã•ã‚Œå°½ãã—ãŸæ„ŸãŒã‚ã£ã¦ã€ä»Šæ›´ãªæ°—ã‚‚ã™ã‚‹ã‚“ã§ã™ãŒã€ä¸€å‘¨å›ã£ã¦æœ€è¿‘èã‹ãªã„è©±ã ãªãƒ¼ã¨æ€ã£ã¦ã¾ã™ã€‚ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ã§æœ€è¿‘ã‚µãƒ¼ãƒãƒ¼ã‚µã‚¤ãƒ‰ã‚‚è§¦ã‚‹æ©Ÿä¼šãŒå¢—ãˆãŸã‚ˆã†ãªæ–¹ã€…ã«ã‚¦ã‚±ãŒè‰¯ã‹ã£ãŸæ„Ÿã˜ãŒã‚ã‚Šã¾ã™ã­ã€‚ä¸€æ–¹ã§ç¤¾å†…ã®ã‚¤ãƒ³ãƒ•ãƒ©ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ã‹ã‚‰ã¯ Redis ã£ã¦ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹ã®æ‰‹é–“ãŒæ›ã‹ã£ã¦è©•åˆ¤æ‚ªã„ã§ã™ã­ã€‚ä½¿ã†ã ã‘ãªã‚‰æ‰‹è»½ã§æ¥½ãªã‚“ã§ã™ãŒã€AWS ã®ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆã§ãƒ€ã‚¦ãƒ³ã‚¿ã‚¤ãƒ ãŒç™ºç”Ÿã™ã‚‹æ™‚ã«åˆ©ç”¨è€…å‘ã‘ã«ã‚¢ãƒŠã‚¦ãƒ³ã‚¹ã—ãªã„ã¨ã„ã‘ãªã‹ã£ãŸã‚Šã€‚ãƒ€ã‚¦ãƒ³ã‚¿ã‚¤ãƒ ã¨è¨€ã£ã¦ã‚‚æ·±å¤œã«æ•°ç§’ã€œæ•°åˆ†ãªã®ã§å½±éŸ¿ã¯å°‘ãªã„ã¨æ€ã†ã‚“ã§ã™ãŒã€ã‚¨ãƒ³ã‚¿ãƒ¼ãƒ—ãƒ©ã‚¤ã‚ºå‘ã‘ã®ã‚µãƒ¼ãƒ“ã‚¹ã¨ã‹ã‚„ã£ã¦ã‚‹ã¨ã“ã®è¾ºã¯å³ã—ã„ã§ã™ã­ã€‚SRE ã®ã‚¨ãƒ©ãƒ¼ãƒã‚¸ã‚§ãƒƒãƒˆã®æ¦‚å¿µ ãŒæ—¥æœ¬å…¨ä½“ã«æµ¸é€ã™ã‚Œã°ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢é–‹ç™ºã®ç”Ÿç”£æ€§ã¯åº•ä¸Šã’ã•ã‚Œã‚‹ã‚“ã˜ã‚ƒãªã„ã‹ã¨æ€ã†ã®ã§ã™ãŒã€ã“ã®è¾ºã¯æ™‚é–“ã‚’æ›ã‘ã¦å°‘ã—ãšã¤å•“è’™ã—ã¦ã„ãã—ã‹ç„¡ã„ã§ã™ã­ã€‚ä¾‹ãˆã°æ—¥æœ¬ã®ç”Ÿæ´»ã‚¤ãƒ³ãƒ•ãƒ©ï¼ˆé›»æ°—ãƒ»æ°´é“ãƒ»ã‚¬ã‚¹ã¨ã‹é›»è»Šã¨ã‹ï¼‰ã£ã¦ã‚ã£ã¡ã‚ƒé«˜æ°´æº–ãªã®ã§ã€ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã®ä¸–ç•Œã§ã‚‚100ï¼…ç¨¼åƒã™ã‚‹ã“ã¨ãŒå½“ãŸã‚Šå‰ã¨ã„ã†ä¾¡å€¤è¦³ã«ãªã£ã¦ã—ã¾ã†ã‚“ã˜ã‚ƒãªã„ã‹ãªã€ã¨æ€ã†ã®ã§ã™ãŒã€ã“ã®è¾ºã®ä¾¡å€¤è¦³ã¯è¡¨è£ä¸€ä½“ã¨ã„ã†ã‹ã€å½“ãŸã‚Šå‰ã¨æ„Ÿã˜ã¦ã„ã‚‹ã‹ã‚‰é«˜å“è³ªã«ãªã‚‹ä¸€æ–¹ã§ã€ç”Ÿç”£æ€§ã¯ä¸‹ãŒã£ã¦ã—ã¾ã†ã¨ã„ã†æ§‹å›³ã ã¨æ€ã£ã¦ã„ã¾ã™ã€‚https://www.nic.ad.jp/ja/materials/iw/2017/proceedings/s15/s15-fujisaki.pdfSREã®ä¿¡æ¡ (Google)ä¸€å¿œãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹ã®æ‰‹é–“ã€ã¨ã„ã†ç‚¹ã§ã¯å¤é ƒã« AWS ã‹ã‚‰ Amazon MemoryDB for Redis ã¨ã„ã†ãƒ•ãƒ«ãƒãƒãƒ¼ã‚¸ãƒ‰ãª Redis ãŒç™ºè¡¨ã•ã‚Œã¦ã„ã¾ã™ã€‚æ±äº¬ãƒªãƒ¼ã‚¸ãƒ§ãƒ³ã¯æœªå¯¾å¿œã§ã€æ›¸ãè¾¼ã¿é€Ÿåº¦ãŒé…ããªã£ã¦ã„ãŸã‚Šã€æ–™é‡‘ã‚‚è‹¥å¹²é«˜ããªã£ã¦ã„ãŸã‚Šã—ã¾ã™ãŒã€æ°—ã«ãªã‚‹ã‚µãƒ¼ãƒ“ã‚¹ã§ã¯ã‚ã‚Šã¾ã™ã­ã€‚dev.classmethod.jpã•ã¦ã€ã“ã®è¨˜äº‹ã®ãƒ¡ã‚¤ãƒ³ã¯å†’é ­ã§è§¦ã‚ŒãŸ Redis::Objects ã‚’æ‹¡å¼µã™ã‚‹ gem ã‚’ä½œã£ãŸã‚ˆã€ã¨ã„ã†è©±ã§ã™ã€‚github.comç™ºç«¯ã¯ Redis::Objects ã® counter ã‚’ä½¿ã£ã¦ã‚µãƒ¼ãƒ“ã‚¹ã®åŠ¹æœæ¸¬å®šï¼ˆãƒ¡ãƒ¼ãƒ«é…ä¿¡æ•°ã€CV æ•°ã€ãƒ­ã‚°ã‚¤ãƒ³æ•°ãªã©ï¼‰ã‚’ã—ãŸã„ãªãƒ¼ã¨è€ƒãˆãŸã“ã¨ãªã‚“ã§ã™ãŒã€åŠ¹æœæ¸¬å®šã£ã¦ä¸€å®šã®æœŸé–“æ¯ã«é›†è¨ˆã—ã¦æ”¹å–„ã—ãŸãƒ»ã—ã¦ã„ãªã„ã®æŒ‡æ¨™ã«ã—ãŸã„ã‚„ã¤ã˜ã‚ƒãªã„ã§ã™ã‹ï¼Ÿcounter ã§ã‚«ã‚¦ãƒ³ãƒˆã‚¢ãƒƒãƒ—ã—ã¤ã¤ã€æ—¥æ¬¡ã®ãƒãƒƒãƒå‡¦ç†ã§é›†è¨ˆã™ã‚Œã°è‰¯ã„ã‚“ã§ã™ãŒã€ãã‚Œã ã¨ã‚ã¾ã‚Šæ°—è»½ã˜ã‚ƒãªã„ã¨ã„ã†ã‹ã€æ¸¬å®šå¯¾è±¡ã¨ãªã‚‹ã‚µãƒ¼ãƒ“ã‚¹é–‹ç™ºã®å¾Œã€æ¸¬å®šãƒ­ã‚¸ãƒƒã‚¯ã¨ãƒãƒƒãƒå‡¦ç†ã€ä¿å­˜å…ˆã® DB ãƒ†ãƒ¼ãƒ–ãƒ«ä½œæˆã¾ã§ã‚»ãƒƒãƒˆã§å®Ÿè£…ã—ãªã„ã¨å®Ÿç¾ã§ããªã„ã§ã™ã‚ˆã­ã€‚ã“ã‚Œã¯ã‚µã‚¯ãƒƒã¨å®Ÿè£…ã™ã‚‹ã«ã¯ counter ãŒè‡ªå‹•ã§æ—¥æ¬¡ã§ä¿å­˜å…ˆã‚’åˆ‡ã‚Šæ›¿ãˆã¦ãã‚Œã‚Œã°è‰¯ã•ãã†ã€ã¨ã„ã†ã“ã¨ã§ã€ redis-objects-daily-counter ã¨ã„ã† gem ã¯ daily_counter ã¨ã„ã†æ—¥æ¬¡ã§ä¿å­˜å…ˆã‚’åˆ‡ã‚Šæ›¿ãˆã‚‹ã‚«ã‚¦ãƒ³ã‚¿ãƒ¼æ©Ÿèƒ½ã‚’æä¾›ã—ã¾ã™ã€‚Redis::Objects ã‚’æ‹¡å¼µã—ã¦ä½œã£ã¦ã‚ã‚‹ã®ã§ã€ä½¿ã„æ–¹ã¯ã»ã¼åŒã˜ã§ã€å¯¾è±¡ã¨ã—ãŸã„ Class ã« include Redis::Objects ã‚’è¿½åŠ ã™ã‚‹ã¨ä½¿ãˆã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚# Gemfilegem 'redis-objects-daily-counter'class Homepage  include Redis::Objects  daily_counter :pv, expireat: -> { Time.now + 2_678_400 } # about a month  def id    1  endend# 2021-04-01homepage = Homepage.newhomepage.id # 1homepage.pv.incrementhomepage.pv.incrementhomepage.pv.incrementputs homepage.pv.value # 3# 2021-04-02 (next day)puts homepage.pv.value # 0homepage.pv.incrementhomepage.pv.incrementputs homepage.pv.value # 2start_date = Date.new(2021, 4, 1)end_date = Date.new(2021, 4, 2)homepage.pv.range(start_date, end_date) # [3, 2]#increment #decrement ã¯ counter ã¨åŒã˜ä½¿ã„å‹æ‰‹ã§ã™ã€‚ãŸã ã€æ—¥ä»˜ãŒå¤‰ã‚ã‚‹ã¨è‡ªå‹•çš„ã«ä¿å­˜å…ˆãŒåˆ‡ã‚Šæ›¿ã‚ã‚Šã¾ã™ã€‚ã“ã‚Œã¯ Redis ã§ä¿å­˜ã—ã¦ã„ã‚‹ Key åãŒä»¥ä¸‹ã®ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã«ãªã£ã¦ã„ã‚‹ãŸã‚ã§ã™ã€‚model_name:id:field_name:yyyy-mm-ddæ—¥ä»˜ãŒå¤‰ã‚ã£ãŸå¾Œã‚‚éå»ã®ãƒ¬ã‚³ãƒ¼ãƒ‰ã¯å‰Šé™¤ã•ã‚Œã¦ã„ãªã„ã®ã§ã€ä»¥ä¸‹ã®ã‚³ãƒ¼ãƒ‰ã§ã‚¢ã‚¯ã‚»ã‚¹å‡ºæ¥ã¾ã™ã€‚ã“ã®ä½¿ã„æ–¹ã¯åŒã˜ã Redis::Objects ã® list ã¨ä¼¼ãŸã‚ˆã†ãªä½¿ã„å‹æ‰‹ã«ãªã£ã¦ã„ã¾ã™ã€‚# 2021-04-01homepage.pv.increment(3)# 2021-04-02 (next day)homepage.pv.increment(2)# 2021-04-03 (next day)homepage.pv.increment(5)homepage.pv[Date.new(2021, 4, 1)] # => 3homepage.pv[Date.new(2021, 4, 1), 3] # => [3, 2, 5]homepage.pv[Date.new(2021, 4, 1)..Date.new(2021, 4, 2)] # => [3, 2]homepage.pv.delete(Date.new(2021, 4, 1))homepage.pv.range(Date.new(2021, 4, 1), Date.new(2021, 4, 3)) # => [0, 2, 5]homepage.pv.at(Date.new(2021, 4, 2)) # => 2ã“ã‚Œã§æ¸¬å®šå¯¾è±¡ã¨ãªã‚‹ã‚µãƒ¼ãƒ“ã‚¹ã‚’é–‹ç™ºã—ãŸå¾Œã€ daily_counter ã§æ¸¬å®šå‡¦ç†ã‚’å®Ÿè£…ã—ã¦ãŠãã ã‘ã§ OKã€‚ã“ã®çŠ¶æ…‹ã§ãƒªãƒªãƒ¼ã‚¹ã™ã‚Œã°ãƒ‡ãƒ¼ã‚¿ã¯æºœã¾ã£ã¦ã„ãã®ã§ã€é€±æ¬¡ã‚„æœˆæ¬¡ã§é›†è¨ˆã™ã‚‹ãƒãƒƒãƒå‡¦ç†ã‚’å¾Œã§ã‚†ã£ãã‚Šå®Ÿè£…ã™ã‚Œã°è‰¯ã„ã§ã™ã€‚ãƒãƒƒãƒå‡¦ç†å®Ÿè£…å‰ã«ã‚µãƒ¼ãƒãƒ¼å†…ã§ $ bin/rails console ã‚’å®Ÿè¡Œã—ã¦ daily_counter ã®å€¤ã‚’ç¢ºèªã—ãªãŒã‚‰ãƒãƒƒãƒå‡¦ç†ã®å®Ÿè£…ã‚’è€ƒãˆã‚‹ã€ã¨ã‹ã‚‚å‡ºæ¥ã¾ã™ã­ã€‚å…·ä½“çš„ãªãƒ‡ãƒ¼ã‚¿ã‚’è¦‹ãªãŒã‚‰ã®æ–¹ãŒé–‹ç™ºé›£æ˜“åº¦ã¯ä¸‹ãŒã‚Šã¾ã™ã€‚ã¡ãªã¿ã«ã§ã™ãŒã€ expireat ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’æŒ‡å®šã—ã¦ãŠãã“ã¨ã‚’ã‚ªã‚¹ã‚¹ãƒ¡ã—ã¾ã™ã€‚gem ã®ä»•æ§˜ä¸Šã€ã©ã‚“ã©ã‚“ Redis ä¸Šã®ãƒ¡ãƒ¢ãƒªã‚’åœ§è¿«ã—ã¦ã„ãã®ã§ã€ä¸€å®šæœŸé–“å¾Œã«è‡ªå‹•çš„ã«å‰Šé™¤ã™ã‚‹ã‚ˆã†ã«ã—ã¾ã—ã‚‡ã†ã€‚daily_counter ãŒã‚ã‚‹ãªã‚‰é€±æ¬¡ã€æœˆæ¬¡ã€å¹´æ¬¡ã‚«ã‚¦ãƒ³ã‚¿ãƒ¼ãŒã‚ã£ã¦ã‚‚è‰¯ã„ã‚ˆã­ã€ãªã‚“ã ã£ãŸã‚‰æ¯æ™‚ã€æ¯åˆ†ã‚«ã‚¦ãƒ³ã‚¿ãƒ¼ã‚‚ã‚ã£ãŸã£ã¦è‰¯ã„ã˜ã‚ƒãªã„ã‹ã€ã¨ã„ã†äº‹ã§ v0.2.0 ã§ã¯ãã‚Œã‚‰ãŒè¿½åŠ ã•ã‚Œã¦ã„ã¾ã™ã€‚æ¯æ™‚ãƒ»æ¯åˆ†ã®ã‚«ã‚¦ãƒ³ã‚¿ãƒ¼ã¯ API rate limit æ©Ÿèƒ½ã®å®Ÿè£…ã«ã‚‚è‰¯ã„ã‹ã‚‚ã—ã‚Œãªã„ã§ã™ã­ã€‚annual_counterKey format: model_name:id:field_name:yyyyRedis is a highly volatile key-value store, so I don't recommend using it.monthly_counterKey format: model_name:id:field_name:yyyy-mmweekly_counterKey format: model_name:id:field_name:yyyyWwdaily_counterKey format: model_name:id:field_name:yyyy-mm-ddhourly_counterKey format: model_name:id:field_name:yyyy-mm-ddThhminutely_counterKey format: model_name:id:field_name:yyyy-mm-ddThh:miä¸€å¿œå®Ÿè£…ã¯ã—ã¾ã—ãŸãŒã€ annual_counter ã®ã‚ˆã†ã«æœŸé–“ã®é•·ã„ã‚«ã‚¦ãƒ³ã‚¿ãƒ¼ã®åˆ©ç”¨ã¯ã‚ã¾ã‚Šã‚ªã‚¹ã‚¹ãƒ¡ã—ã¾ã›ã‚“ã€‚Redis ã£ã¦ãµã¨ã—ãŸæ‹å­ã«ãƒ‡ãƒ¼ã‚¿ãŒé£›ã‚“ã§ã—ã¾ã†å¯èƒ½æ€§ãŒã‚ã‚‹ã®ã§ã€ã‚ãã¾ã§ã‚­ãƒ£ãƒƒã‚·ãƒ¥çš„ãªä½ç½®ä»˜ã‘ã§åˆ©ç”¨ã™ã‚‹ã®ãŒè‰¯ã„ã¨æ€ã„ã¾ã™ã€‚daily_counter ã‚‚é€±æ¬¡ãƒ»æœˆæ¬¡ã§ RDS ã«é›†è¨ˆçµæœã‚’ä¿å­˜ã™ã‚‹é‹ç”¨ã‚’æƒ³å®šã—ã¦ã„ã¾ã™ã®ã§ã€‚ã¨ã„ã†ã‚ã‘ã§ä¹…ã€…ã®ãƒ–ãƒ­ã‚°æ›´æ–°ã§ã¯æ–°ã—ãä½œã£ãŸ redis-objects-daily-counter ã¨ã„ã† gem ã®ç´¹ä»‹ã‚’ã•ã›ã¦é ‚ãã¾ã—ãŸã€‚ã“ã‚Œã‹ã‚‰å¼Šç¤¾ãƒ—ãƒ­ãƒ€ã‚¯ãƒˆã§ã‚‚åˆ©ç”¨ã—ã¦ã„ãäºˆå®šã§ã™ã—ã€è‰²ã€…ãªã‚µãƒ¼ãƒ“ã‚¹ã§ã‚‚æ´»ç”¨é ‚ã‘ã‚‹ã¨å¬‰ã—ã„ã§ã™ã€‚","link":"https://ryz310.hateblo.jp/entry/2021/09/20/172054","isoDate":"2021-09-20T08:20:54.000Z","dateMiliSeconds":1632126054000,"imageUrl":"https://cdn-ak.f.st-hatena.com/images/fotolife/r/ryz310/20210920/20210920165304.png","authorName":"ryz310"},{"title":"è‡ªä½œã® gem ã®åå‰ã‚’è€ƒãˆã‚‹ã®ã¯é›£ã—ã„","content":"<h2>è‡ªä½œã® gem ã®åå‰ã‚’å¤‰ãˆãŸã„ã€‚</h2>\n\n<p><code>my_api_client</code> ã¨ã„ã†è‡ªä½œã® gem ãŒã‚ã‚Šã¾ã—ã¦ã€<a href=\"https://ryz310.hateblo.jp/search?q=my_api_clien\">ã“ã®ãƒ–ãƒ­ã‚°ã§ã¯ä½•åº¦ã‚‚ç´¹ä»‹ã—ã¦ã„ã‚‹</a> ã‚“ã§ã™ãŒã€ãƒ‹ãƒƒãƒã™ãã‚‹ã®ã‹å®£ä¼ãŒä¸‹æ‰‹ã™ãã‚‹ã®ã‹ã€ä¸€å‘ã«ä½¿ã£ã¦ã¿ãŸã€ã¨ã„ã†å™‚ã‚’èãã¾ã›ã‚“ (Â´ãƒ»Ï‰ãƒ»ï½€)</p>\n\n<p><iframe src=\"https://hatenablog-parts.com/embed?url=https%3A%2F%2Fgithub.com%2Fryz310%2Fmy_api_client\" title=\"ryz310/my_api_client\" class=\"embed-card embed-webcard\" scrolling=\"no\" frameborder=\"0\" style=\"display: block; width: 100%; height: 155px; max-width: 500px; margin: 10px 0px;\"></iframe><cite class=\"hatena-citation\"><a href=\"https://github.com/ryz310/my_api_client\">github.com</a></cite></p>\n\n<p>ã¾ã‚å¼Šç¤¾ã®ãƒ—ãƒ­ãƒ€ã‚¯ãƒˆã®ä¸­ã§ã¯ã‚¬ãƒƒãƒ„ãƒªä½¿ã£ã¦ã‚‹ã‚“ã§åˆ¥ã«ãã‚Œã¯è‰¯ã„ã‚“ã§ã™ãŒã€ã‚‚ã†å°‘ã—ã¾ã¨ã‚‚ãªåå‰ã«ãªã‚‰ã‚“ã®ã‹ã­ã€ã¨ã„ã†ã‚³ãƒ¡ãƒ³ãƒˆã‚’é ‚ãã¾ã™ã€‚\nã„ã„æ©Ÿä¼šã ã—ã¡ã‚ƒã‚“ã¨è‰¯ã„åå‰ä»˜ã‘ã‚ˆã†ã¨æ€ã£ã¦è€ƒãˆã¾ã—ãŸã€‚ã©ã†ã›ãªã‚‰è‡ªåˆ†ãŒå¥½ããªã‚²ãƒ¼ãƒ ã‹ã‚‰ã„ã„åå‰ä»˜ã‘ãŸã„ãªã€ã¨æ€ã£ã¦ã€Luidaï¼ˆ<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%EB%A5%A4%A1%BC%A5%C0\">ãƒ«ã‚¤ãƒ¼ãƒ€</a>ï¼‰ã€ã¨ã„ã†åå‰ãŒæµ®ã‹ã³ã¾ã—ãŸã€‚<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%C9%A5%E9%A5%AF%A5%A8\">ãƒ‰ãƒ©ã‚¯ã‚¨</a> III ã®ã‚ã‚Œã§ã™ã€‚</p>\n\n<p><figure class=\"figure-image figure-image-fotolife\" title=\"ã“ã“ã¯ãƒ«ã‚¤ãƒ¼ãƒ€ã®åº—\"><span itemscope itemtype=\"http://schema.org/Photograph\"><img src=\"https://cdn-ak.f.st-hatena.com/images/fotolife/r/ryz310/20201004/20201004001621.jpg\" alt=\"f:id:ryz310:20201004001621j:plain:w300\" title=\"\" class=\"hatena-fotolife\" style=\"width:300px\" itemprop=\"image\"></span><figcaption>ã“ã“ã¯<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%EB%A5%A4%A1%BC%A5%C0\">ãƒ«ã‚¤ãƒ¼ãƒ€</a>ã®åº—ã€‚æ—…äººãŸã¡ãŒä»²é–“ã‚’æ±‚ã‚ã¦ã‚ã¤ã¾ã‚‹å‡ºä¼šã„ã¨åˆ¥ã‚Œã®é…’å ´ã‚ˆã€‚</figcaption></figure></p>\n\n<p><code>my_api_client</code> ã¯ <a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/API\">API</a> Client ã‚’ç°¡å˜ã«ä½œã£ãŸã‚Šãƒ†ã‚¹ãƒˆã—ãŸã‚Šã™ã‚‹ãŸã‚ã® gem ãªã®ã§ã€<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%CB%C1%B8%B1%BC%D4\">å†’é™ºè€…</a>ã‚’ç™»éŒ²ã—ã¦ä¸€ç·’ã«æ—…ã™ã‚‹<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%EB%A5%A4%A1%BC%A5%C0\">ãƒ«ã‚¤ãƒ¼ãƒ€</a>ã®åº—ã®ã‚¤ãƒ¡ãƒ¼ã‚¸ãŒãƒ”ãƒƒã‚¿ãƒªã ãªãƒ¼ã¨æ€ã£ãŸã‚“ã§ã™ã‚ˆã­ã€‚ã¨ã¯ã„ãˆ gem ã®åå‰ã‚’å¤‰ãˆã‚‹ã®ã£ã¦é¢å€’ã ã—ãã®ã†ã¡ã‚„ã‚ã†ã€ã£ã¦æ€ã£ã¦ãŸã‚‰åŠå¹´ãã‚‰ã„çµŒã£ã¡ã‚ƒã„ã¾ã—ãŸã‘ã©ã­ã€‚ä¸Šã®<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%EB%A5%A4%A1%BC%A5%C0\">ãƒ«ã‚¤ãƒ¼ãƒ€</a>ã®åº—ã®ç”»åƒã£ã¦ã‚ã–ã‚ã– <a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/iPhone\">iPhone</a> ç‰ˆã®<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%C9%A5%E9%A5%AF%A5%A8III\">ãƒ‰ãƒ©ã‚¯ã‚¨III</a> è²·ã£ã¦ã‚¹ã‚¯ã‚·ãƒ§æ’®ã£ãŸã‚“ã§ã™ãŒã€ãã®æ—¥ä»˜ãŒ 2020/10/04 ã§ã—ãŸ ğŸ˜‡</p>\n\n<p>å¤šåˆ†ãã®ã†ã¡ã‚„ã‚Šã¾ã™ï¼ˆãƒ•ãƒ©ã‚°ï¼‰</p>\n\n<h2>my_<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/api\">api</a>_client v0.20.0 ã‚’ãƒªãƒªãƒ¼ã‚¹ã—ã¾ã—ãŸ ğŸš€</h2>\n\n<p>gem ã®åå‰ã¯å¤‰ã‚ã‚‰ãªã„ã‘ã©ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆã¯ã•ã‚Œã¦ã„ãã€‚</p>\n\n<p><iframe src=\"https://hatenablog-parts.com/embed?url=https%3A%2F%2Fgithub.com%2Fryz310%2Fmy_api_client%2Freleases%2Ftag%2Fv0.20.0\" title=\"Release v0.20.0 (Mar 07, 2021) Â· ryz310/my_api_client\" class=\"embed-card embed-webcard\" scrolling=\"no\" frameborder=\"0\" style=\"display: block; width: 100%; height: 155px; max-width: 500px; margin: 10px 0px;\"></iframe><cite class=\"hatena-citation\"><a href=\"https://github.com/ryz310/my_api_client/releases/tag/v0.20.0\">github.com</a></cite></p>\n\n<p>å…ƒã€… <code>my_api_client</code> ã«ã¯ <code>#pageable_get</code> (alias: <code>#pget</code>) ã¨ã„ã†ãƒ¡ã‚½ãƒƒãƒ‰ãŒã‚ã‚Šã€<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/REST%20API\">REST API</a> ã®ãƒ¬ã‚¹ãƒãƒ³ã‚¹ <a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/JSON\">JSON</a> ã«å«ã¾ã‚Œã‚‹ URL ã‚’é †ã«è¾¿ã£ã¦ãƒªã‚¯<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%A8%A5%B9\">ã‚¨ã‚¹</a>ãƒˆã™ã‚‹ <code>Enumerator</code> ã‚’å–å¾—ã™ã‚‹ã“ã¨ãŒå‡ºæ¥ã¾ã™ã€‚æ©Ÿèƒ½è‡ªä½“ã¯å®Ÿç›¸ã—ã¦ãƒ†ã‚¹ãƒˆã‚‚ã—ã¦ã‚ã‚‹ã‚‚ã®ã®ã€å®Ÿéš›ã®ãƒ—ãƒ­ãƒ€ã‚¯ãƒˆã§ä½¿ã†æ©Ÿä¼šãŒãªãé•·ã„ã“ã¨æ—¥ã®ç›®ã‚’è¦‹ãªã‹ã£ãŸã‚“ã§ã™ãŒã€ã“ã®åº¦ã¤ã„ã«å¼Šãƒ—ãƒ­ãƒ€ã‚¯ãƒˆã§åˆ©ç”¨ã™ã‚‹æ©Ÿä¼šãŒè¨ªã‚ŒãŸã®ã§ãƒãƒ¼ãƒ ã®ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ã«ä½¿ã£ã¦ã‚‚ã‚‰ã£ã¦ã‚‹ã‚“ã§ã™ãŒã€ <a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/RSpec\">RSpec</a> ã‚’æ›¸ãéš›ã®ã‚¹ã‚¿ãƒ–åŒ–ãŒç‰¹ã«ã‚µãƒãƒ¼ãƒˆã•ã‚Œã¦ã„ãªãã¦ãƒ†ã‚¹ãƒˆã—ã¥ã‚‰ã„å•é¡ŒãŒã‚ã‚Šã¾ã—ãŸã€‚</p>\n\n<p>ä»Šå›ã®ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆã§ã¯ã€ã“ã® <code>#pageable_get</code> ã«å¯¾å¿œã™ã‚‹ã‚¹ã‚¿ãƒ–åŒ–ã‚’ã‚µãƒãƒ¼ãƒˆã—ã¦ã„ã¾ã™ã€‚ <a href=\"https://github.com/ryz310/my_api_client/blob/master/README.jp.md#pageable-option\">è©³ã—ã„è§£èª¬ã¯ README.jp.md ã«ã‚‚æ›¸ã„ãŸ</a> ã‚“ã§ã™ãŒã€ã›ã£ã‹ããªã®ã§ãƒ–ãƒ­ã‚°ã«ã‚‚è»¢è¨˜ã—ã¦ãŠãã¾ã™ã€‚ã¾ã‚æ–‡ç« ã§èª¬æ˜ã•ã‚Œã¦ã‚‚å®Ÿéš›ã«ä½¿ã£ã¦ã¿ãªã„ã¨ãƒ”ãƒ³ã¨æ¥ãªã„ã®ã¯ã‚ã‹ã£ã¦ã¾ã™ã‘ã©ã­ã€‚ã€‚ã€‚</p>\n\n<hr />\n\n<p><code>#pageable_get</code>  (<code>#pget</code>) ã‚’ä½¿ã£ãŸå®Ÿè£…ç”¨ã« <code>pageable</code> ã¨ã„ã†ã‚ªãƒ—ã‚·ãƒ§ãƒ³ãŒåˆ©ç”¨ã§ãã¾ã™ã€‚\n<code>pageable</code> ã«è¨­å®šã™ã‚‹å€¤ã¯ <code>Enumerable</code> ã§ã‚ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚</p>\n\n<pre class=\"code lang-ruby\" data-lang=\"ruby\" data-unlink>stub_api_client_all(\n  <span class=\"synType\">MyPaginationApiClient</span>,\n  <span class=\"synConstant\">pagination</span>: {\n    <span class=\"synConstant\">pageable</span>: [\n      { <span class=\"synConstant\">page</span>: <span class=\"synConstant\">1</span> },\n      { <span class=\"synConstant\">page</span>: <span class=\"synConstant\">2</span> },\n      { <span class=\"synConstant\">page</span>: <span class=\"synConstant\">3</span> },\n    ],\n  }\n)\n\n<span class=\"synType\">MyPaginationApiClient</span>.new.pagination.each <span class=\"synStatement\">do</span> |<span class=\"synIdentifier\">response</span>|\n  response.page <span class=\"synComment\">#=&gt; 1, 2, 3</span>\n<span class=\"synStatement\">end</span>\n</pre>\n\n\n<p>ãªãŠã€ <code>Enumerable</code> ã®å„å€¤ã«ã¯ã“ã“ã¾ã§ç´¹ä»‹ã—ãŸ <code>response</code>, <code>raise</code>, <code>Proc</code> ãªã©å…¨ã¦ã®ã‚ªãƒ—ã‚·ãƒ§ãƒ³ãŒåˆ©ç”¨å¯èƒ½ã§ã™ã€‚</p>\n\n<pre class=\"code lang-ruby\" data-lang=\"ruby\" data-unlink>stub_api_client_all(\n  <span class=\"synType\">MyPaginationApiClient</span>,\n  <span class=\"synConstant\">pagination</span>: {\n    <span class=\"synConstant\">pageable</span>: [\n      { <span class=\"synConstant\">response</span>: { <span class=\"synConstant\">page</span>: <span class=\"synConstant\">1</span> } },\n      { <span class=\"synConstant\">page</span>: <span class=\"synConstant\">2</span> },\n      -&gt;(params) { { <span class=\"synConstant\">page</span>: <span class=\"synConstant\">3</span>, <span class=\"synConstant\">user_id</span>: params[<span class=\"synConstant\">:user_id</span>] } },\n      { <span class=\"synConstant\">raise</span>: <span class=\"synType\">MyApiClient</span>::<span class=\"synType\">ClientError</span>::<span class=\"synType\">IamTeapot</span> },\n    ],\n  }\n)\n</pre>\n\n\n<p>ã¾ãŸã€ <code>Enumerator</code> ã‚’ä½¿ãˆã°ç„¡é™ã«ç¶šããƒšãƒ¼ã‚¸ãƒãƒ¼ã‚·ãƒ§ãƒ³ã‚’å®šç¾©ã™ã‚‹ã“ã¨ã‚‚ã§ãã¾ã™ã€‚</p>\n\n<pre class=\"code lang-ruby\" data-lang=\"ruby\" data-unlink>stub_api_client_all(\n  <span class=\"synType\">MyPaginationApiClient</span>,\n  <span class=\"synConstant\">pagination</span>: {\n    <span class=\"synConstant\">pageable</span>: <span class=\"synType\">Enumerator</span>.new <span class=\"synStatement\">do</span> |<span class=\"synIdentifier\">y</span>|\n      <span class=\"synStatement\">loop</span>.with_index(<span class=\"synConstant\">1</span>) <span class=\"synStatement\">do</span> |<span class=\"synIdentifier\">_</span>, <span class=\"synIdentifier\">i</span>|\n        y &lt;&lt; { <span class=\"synConstant\">page</span>: i }\n      <span class=\"synStatement\">end</span>\n    <span class=\"synStatement\">end</span>,\n  }\n)\n</pre>\n\n","contentSnippet":"è‡ªä½œã® gem ã®åå‰ã‚’å¤‰ãˆãŸã„ã€‚my_api_client ã¨ã„ã†è‡ªä½œã® gem ãŒã‚ã‚Šã¾ã—ã¦ã€ã“ã®ãƒ–ãƒ­ã‚°ã§ã¯ä½•åº¦ã‚‚ç´¹ä»‹ã—ã¦ã„ã‚‹ ã‚“ã§ã™ãŒã€ãƒ‹ãƒƒãƒã™ãã‚‹ã®ã‹å®£ä¼ãŒä¸‹æ‰‹ã™ãã‚‹ã®ã‹ã€ä¸€å‘ã«ä½¿ã£ã¦ã¿ãŸã€ã¨ã„ã†å™‚ã‚’èãã¾ã›ã‚“ (Â´ãƒ»Ï‰ãƒ»ï½€)github.comã¾ã‚å¼Šç¤¾ã®ãƒ—ãƒ­ãƒ€ã‚¯ãƒˆã®ä¸­ã§ã¯ã‚¬ãƒƒãƒ„ãƒªä½¿ã£ã¦ã‚‹ã‚“ã§åˆ¥ã«ãã‚Œã¯è‰¯ã„ã‚“ã§ã™ãŒã€ã‚‚ã†å°‘ã—ã¾ã¨ã‚‚ãªåå‰ã«ãªã‚‰ã‚“ã®ã‹ã­ã€ã¨ã„ã†ã‚³ãƒ¡ãƒ³ãƒˆã‚’é ‚ãã¾ã™ã€‚ã„ã„æ©Ÿä¼šã ã—ã¡ã‚ƒã‚“ã¨è‰¯ã„åå‰ä»˜ã‘ã‚ˆã†ã¨æ€ã£ã¦è€ƒãˆã¾ã—ãŸã€‚ã©ã†ã›ãªã‚‰è‡ªåˆ†ãŒå¥½ããªã‚²ãƒ¼ãƒ ã‹ã‚‰ã„ã„åå‰ä»˜ã‘ãŸã„ãªã€ã¨æ€ã£ã¦ã€Luidaï¼ˆãƒ«ã‚¤ãƒ¼ãƒ€ï¼‰ã€ã¨ã„ã†åå‰ãŒæµ®ã‹ã³ã¾ã—ãŸã€‚ãƒ‰ãƒ©ã‚¯ã‚¨ III ã®ã‚ã‚Œã§ã™ã€‚ã“ã“ã¯ãƒ«ã‚¤ãƒ¼ãƒ€ã®åº—ã€‚æ—…äººãŸã¡ãŒä»²é–“ã‚’æ±‚ã‚ã¦ã‚ã¤ã¾ã‚‹å‡ºä¼šã„ã¨åˆ¥ã‚Œã®é…’å ´ã‚ˆã€‚my_api_client ã¯ API Client ã‚’ç°¡å˜ã«ä½œã£ãŸã‚Šãƒ†ã‚¹ãƒˆã—ãŸã‚Šã™ã‚‹ãŸã‚ã® gem ãªã®ã§ã€å†’é™ºè€…ã‚’ç™»éŒ²ã—ã¦ä¸€ç·’ã«æ—…ã™ã‚‹ãƒ«ã‚¤ãƒ¼ãƒ€ã®åº—ã®ã‚¤ãƒ¡ãƒ¼ã‚¸ãŒãƒ”ãƒƒã‚¿ãƒªã ãªãƒ¼ã¨æ€ã£ãŸã‚“ã§ã™ã‚ˆã­ã€‚ã¨ã¯ã„ãˆ gem ã®åå‰ã‚’å¤‰ãˆã‚‹ã®ã£ã¦é¢å€’ã ã—ãã®ã†ã¡ã‚„ã‚ã†ã€ã£ã¦æ€ã£ã¦ãŸã‚‰åŠå¹´ãã‚‰ã„çµŒã£ã¡ã‚ƒã„ã¾ã—ãŸã‘ã©ã­ã€‚ä¸Šã®ãƒ«ã‚¤ãƒ¼ãƒ€ã®åº—ã®ç”»åƒã£ã¦ã‚ã–ã‚ã– iPhone ç‰ˆã®ãƒ‰ãƒ©ã‚¯ã‚¨III è²·ã£ã¦ã‚¹ã‚¯ã‚·ãƒ§æ’®ã£ãŸã‚“ã§ã™ãŒã€ãã®æ—¥ä»˜ãŒ 2020/10/04 ã§ã—ãŸ ğŸ˜‡å¤šåˆ†ãã®ã†ã¡ã‚„ã‚Šã¾ã™ï¼ˆãƒ•ãƒ©ã‚°ï¼‰my_api_client v0.20.0 ã‚’ãƒªãƒªãƒ¼ã‚¹ã—ã¾ã—ãŸ ğŸš€gem ã®åå‰ã¯å¤‰ã‚ã‚‰ãªã„ã‘ã©ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆã¯ã•ã‚Œã¦ã„ãã€‚github.comå…ƒã€… my_api_client ã«ã¯ #pageable_get (alias: #pget) ã¨ã„ã†ãƒ¡ã‚½ãƒƒãƒ‰ãŒã‚ã‚Šã€REST API ã®ãƒ¬ã‚¹ãƒãƒ³ã‚¹ JSON ã«å«ã¾ã‚Œã‚‹ URL ã‚’é †ã«è¾¿ã£ã¦ãƒªã‚¯ã‚¨ã‚¹ãƒˆã™ã‚‹ Enumerator ã‚’å–å¾—ã™ã‚‹ã“ã¨ãŒå‡ºæ¥ã¾ã™ã€‚æ©Ÿèƒ½è‡ªä½“ã¯å®Ÿç›¸ã—ã¦ãƒ†ã‚¹ãƒˆã‚‚ã—ã¦ã‚ã‚‹ã‚‚ã®ã®ã€å®Ÿéš›ã®ãƒ—ãƒ­ãƒ€ã‚¯ãƒˆã§ä½¿ã†æ©Ÿä¼šãŒãªãé•·ã„ã“ã¨æ—¥ã®ç›®ã‚’è¦‹ãªã‹ã£ãŸã‚“ã§ã™ãŒã€ã“ã®åº¦ã¤ã„ã«å¼Šãƒ—ãƒ­ãƒ€ã‚¯ãƒˆã§åˆ©ç”¨ã™ã‚‹æ©Ÿä¼šãŒè¨ªã‚ŒãŸã®ã§ãƒãƒ¼ãƒ ã®ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ã«ä½¿ã£ã¦ã‚‚ã‚‰ã£ã¦ã‚‹ã‚“ã§ã™ãŒã€ RSpec ã‚’æ›¸ãéš›ã®ã‚¹ã‚¿ãƒ–åŒ–ãŒç‰¹ã«ã‚µãƒãƒ¼ãƒˆã•ã‚Œã¦ã„ãªãã¦ãƒ†ã‚¹ãƒˆã—ã¥ã‚‰ã„å•é¡ŒãŒã‚ã‚Šã¾ã—ãŸã€‚ä»Šå›ã®ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆã§ã¯ã€ã“ã® #pageable_get ã«å¯¾å¿œã™ã‚‹ã‚¹ã‚¿ãƒ–åŒ–ã‚’ã‚µãƒãƒ¼ãƒˆã—ã¦ã„ã¾ã™ã€‚ è©³ã—ã„è§£èª¬ã¯ README.jp.md ã«ã‚‚æ›¸ã„ãŸ ã‚“ã§ã™ãŒã€ã›ã£ã‹ããªã®ã§ãƒ–ãƒ­ã‚°ã«ã‚‚è»¢è¨˜ã—ã¦ãŠãã¾ã™ã€‚ã¾ã‚æ–‡ç« ã§èª¬æ˜ã•ã‚Œã¦ã‚‚å®Ÿéš›ã«ä½¿ã£ã¦ã¿ãªã„ã¨ãƒ”ãƒ³ã¨æ¥ãªã„ã®ã¯ã‚ã‹ã£ã¦ã¾ã™ã‘ã©ã­ã€‚ã€‚ã€‚#pageable_get  (#pget) ã‚’ä½¿ã£ãŸå®Ÿè£…ç”¨ã« pageable ã¨ã„ã†ã‚ªãƒ—ã‚·ãƒ§ãƒ³ãŒåˆ©ç”¨ã§ãã¾ã™ã€‚pageable ã«è¨­å®šã™ã‚‹å€¤ã¯ Enumerable ã§ã‚ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚stub_api_client_all(  MyPaginationApiClient,  pagination: {    pageable: [      { page: 1 },      { page: 2 },      { page: 3 },    ],  })MyPaginationApiClient.new.pagination.each do |response|  response.page #=> 1, 2, 3endãªãŠã€ Enumerable ã®å„å€¤ã«ã¯ã“ã“ã¾ã§ç´¹ä»‹ã—ãŸ response, raise, Proc ãªã©å…¨ã¦ã®ã‚ªãƒ—ã‚·ãƒ§ãƒ³ãŒåˆ©ç”¨å¯èƒ½ã§ã™ã€‚stub_api_client_all(  MyPaginationApiClient,  pagination: {    pageable: [      { response: { page: 1 } },      { page: 2 },      ->(params) { { page: 3, user_id: params[:user_id] } },      { raise: MyApiClient::ClientError::IamTeapot },    ],  })ã¾ãŸã€ Enumerator ã‚’ä½¿ãˆã°ç„¡é™ã«ç¶šããƒšãƒ¼ã‚¸ãƒãƒ¼ã‚·ãƒ§ãƒ³ã‚’å®šç¾©ã™ã‚‹ã“ã¨ã‚‚ã§ãã¾ã™ã€‚stub_api_client_all(  MyPaginationApiClient,  pagination: {    pageable: Enumerator.new do |y|      loop.with_index(1) do |_, i|        y << { page: i }      end    end,  })","link":"https://ryz310.hateblo.jp/entry/2021/03/07/202519","isoDate":"2021-03-07T11:25:19.000Z","dateMiliSeconds":1615116319000,"imageUrl":"https://cdn-ak.f.st-hatena.com/images/fotolife/r/ryz310/20201004/20201004001621.jpg","authorName":"ryz310"},{"title":"ActiveJob ã® retry_on ã« jitter ã¨ã„ã†ã‚ªãƒ—ã‚·ãƒ§ãƒ³ãŒã‚ã‚‹ã®çŸ¥ã£ã¦ã¾ã™ã‹ï¼Ÿ","content":"<p>åƒ•ã¯çŸ¥ã‚‰ãªã‹ã£ãŸã§ã™ (ãƒ»âˆ€ãƒ»)</p>\n\n<blockquote class=\"twitter-tweet\"><p lang=\"ja\" dir=\"ltr\"><a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/Rails\">Rails</a> ã§ ActiveJob ã® retry_on ãŒåŒæ™‚ã«ç™ºç«ã•ã‚Œã‚‹ã®ä½•ã¨ã‹ã—ãŸã„ãªãƒ¼ã¨æ€ã£ã¦èª¿ã¹ã¦ãŸã‚‰ã€<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/Rails\">Rails</a> 6 ã‹ã‚‰ã¯ jitter ã¨ã„ã†ã‚ªãƒ—ã‚·ãƒ§ãƒ³ãŒæŒ‡å®šã§ãã‚‹ã‚ˆã†ã«ãªã£ã¦ã¦ã€ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ãƒªãƒˆãƒ©ã‚¤é–“éš”ã‚’ 15% ãƒ©ãƒ³ãƒ€ãƒã‚¤ã‚ºã—ã¦ãã‚Œã‚‹ã¨ã®äº‹ã€‚Rate Limit ã®å›é¿ã¨ã‹ã§ä¾¿åˆ©ã€‚ <a href=\"https://t.co/kpIx6YVFEq\">https://t.co/kpIx6YVFEq</a></p>&mdash; ã‚µãƒˆã‚¦ãƒªãƒ§ã‚¦ã‚¹ã‚± (@ryosuke_sato) <a href=\"https://twitter.com/ryosuke_sato/status/1365707024357466115?ref_src=twsrc%5Etfw\">February 27, 2021</a></blockquote>\n\n\n<p> <script async src=\"https://platform.twitter.com/widgets.js\" charset=\"utf-8\"></script></p>\n\n<h2>jitter ã¨ã¯</h2>\n\n<p><a href=\"https://github.com/rails/rails/blob/5aaaa1630a/activejob/CHANGELOG.md#rails-610-december-09-2020\">Rails 6.1 ã‹ã‚‰è¿½åŠ ã•ã‚ŒãŸã‚ªãƒ—ã‚·ãƒ§ãƒ³</a> ã§ã€ <code>retry_on</code> ã®å¾…ã¡æ™‚é–“ã«å¯¾ã—ã¦ä»»æ„ã®å‰²åˆã§ãƒãƒ©ã‘ã•ã›ã¦ãã‚Œã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ 15% ï¼‰ã€‚</p>\n\n<blockquote><p><a href=\"https://edgeapi.rubyonrails.org/classes/ActiveJob/Exceptions/ClassMethods.html#method-i-retry_on\">ActiveJob::Exceptions::ClassMethods - retry_on</a></p>\n\n<p><code>:jitter</code> - A random delay of wait time used when calculating backoff. The default is 15% (0.15) which represents the upper bound of possible wait time (expressed as a percentage)</p></blockquote>\n\n<h3>å®Ÿè£…ã‚’ç¢ºèªã—ã¦ã¿ãŸ</h3>\n\n<p>ã“ã®ãƒãƒ©ã‘ã•ã›æ–¹ãŒå¾…ã¡æ™‚é–“ã«å¯¾ã—ã¦å¢—ãˆã‚‹ã®ã‹æ¸›ã‚‹ã®ã‹ãŒæ°—ã«ãªã£ã¦å®Ÿè£…ã‚’è¦‹ã¦ã¿ã¾ã—ãŸã€‚å¢—ãˆã‚‹æ–¹å‘ã§ãƒãƒ©ã‘ã‚‹ã‚ˆã†ã§ã™ã€‚\nä¾‹ãˆã° <code>wait: 60.seconds</code> ã§ <code>jitter: 0.5</code> ã®å ´åˆã ã¨ã€æœ€å¤§ <code>90</code> ç§’ã®å¾…ã¡æ™‚é–“ã¨ãªã‚Šã¾ã™ã€‚</p>\n\n<p>ã†ã£ã‹ã‚Š <code>100.0</code> ã¨ã‹æŒ‡å®šã™ã‚‹ã¨æœ€å¤§ 10000% å¾…ã¡æ™‚é–“ãŒåŠ ç®—ã•ã‚Œã¡ã‚ƒã„ãã†ã§ã™ã€‚\né–“é•ãˆã¦æŒ‡å®šã—ãªã„ã‚ˆã†ã«ã”æ³¨æ„ä¸‹ã•ã„ğŸ™</p>\n\n<pre class=\"code rb\" data-lang=\"rb\" data-unlink>delay = seconds_or_duration_or_algorithm.to_i\ndelay_jitter = determine_jitter_for_delay(delay, jitter)\ndelay + delay_jitter</pre>\n\n\n<p>ğŸ“ jitter ã®è¨ˆç®—å‡¦ç†ã¯ <a href=\"https://github.com/rails/rails/blob/35e9812dfcb030d4c986532e7672ad8f8f95286f/activejob/lib/active_job/exceptions.rb#L132-L155\">ã“ã®ã‚ãŸã‚Š</a></p>\n\n<h3>ã©ã†ã„ã†å ´é¢ã§ä½¿ã†ã®ï¼Ÿ</h3>\n\n<p>ã“ã®æ©Ÿèƒ½ãŒç„¡ã‹ã£ãŸå¾“æ¥ã ã¨ã€ãƒªãƒˆãƒ©ã‚¤å‡¦ç†ãŒä¸€æ–‰ã«èµ·å‹•ã—ã¦ã—ã¾ã†ã¨ã„ã†å•é¡ŒãŒã‚ã‚Šã¾ã—ãŸã€‚</p>\n\n<p>ä¾‹ãˆã°å¤–éƒ¨ã®ã‚µãƒ¼ãƒ“ã‚¹ã« <a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/API\">API</a> ãƒªã‚¯<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%A8%A5%B9\">ã‚¨ã‚¹</a>ãƒˆã™ã‚‹ã‚ˆã†ãª Job ã‚’ä½œã£ãŸã¨ã—ã¾ã™ã€‚<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/API\">API</a> Rate Limit è¶…éã®ä¾‹å¤–ã‚’ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã—ã¦ã€ <code>retry_on</code> ã§ N åˆ†å¾Œã«ãƒªãƒˆãƒ©ã‚¤ã™ã‚‹ã‚ˆã†ã«å®Ÿè£…ã—ã¾ã™ã€‚\nã“ã®æ™‚ã€ 1000 ä»¶ã® Job ãŒåŒæ™‚ã«å®Ÿè¡Œã•ã‚Œ 900 ä»¶ãŒ Rate Limit è¶…éã¨ãªã£ãŸå ´åˆã€N åˆ†å¾Œã« 900 ä»¶ã® Job ãŒä¸€æ–‰ã«ãƒªãƒˆãƒ©ã‚¤ã•ã‚Œã¦ã—ã¾ã„ã€å†ã³ 800 ä»¶ãŒã‚¨ãƒ©ãƒ¼ã¨ãªã£ã¦ã—ã¾ã†ã€‚\nã“ã‚ŒãŒä½•åº¦ã‚‚ç¹°ã‚Šè¿”ã•ã‚Œã‚‹ã€ã¨ã„ã†ç¾è±¡ãŒèµ·ã“ã£ã¦ã¾ã—ãŸã€‚</p>\n\n<h3><a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/Rails\">Rails</a> 6.1 ä»¥å‰ã ã¨å›é¿ã§ããªã„ã®ï¼Ÿ</h3>\n\n<p>å¾“æ¥ã® ActiveJob ã§ã‚‚ä¸€å¿œå›é¿ç­–ã¯ã‚ã£ã¦ã€ <code>wait</code> ã« <code>Proc</code> ã‚’ä¸ãˆã¦ãƒ©ãƒ³ãƒ€ãƒ ãªå¾…ã¡æ™‚é–“ã‚’è¿”ã™ã‚ˆã†ãªå‡¦ç†ã‚’æ›¸ãã“ã¨ã§ä¼¼ãŸã‚ˆã†ãªå‹•ä½œã¯å¯èƒ½ã§ã™ã€‚</p>\n\n<pre class=\"code rb\" data-lang=\"rb\" data-unlink>retry_on SomeError, wait: -&gt; { rand(60..90).seconds }</pre>\n\n\n<h2><a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/iPad\">iPad</a> <a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/Air\">Air</a> (ç¬¬4ä¸–ä»£) è²·ã£ã¡ã‚ƒã£ãŸ</h2>\n\n<p><figure class=\"figure-image figure-image-fotolife\" title=\"iPad Air (ç¬¬4ä¸–ä»£)\"><span itemscope itemtype=\"http://schema.org/Photograph\"><img src=\"https://cdn-ak.f.st-hatena.com/images/fotolife/r/ryz310/20210302/20210302102542.jpg\" alt=\"f:id:ryz310:20210302102542j:plain\" title=\"\" class=\"hatena-fotolife\" itemprop=\"image\"></span><figcaption><a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/iPad\">iPad</a> <a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/Air\">Air</a> (ç¬¬4ä¸–ä»£)</figcaption></figure></p>\n\n<p>è¿‘æ—¥ä¸­ã« <a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/iPad\">iPad</a> Pro ã®æ–°å‹ãŒå‡ºã‚‹ã¨ã®å™‚ãŒã‚ã‚‹ãŒã€è»½ã„ <a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/Air\">Air</a> ãŒã»ã—ã‹ã£ãŸã®ã§å•é¡Œ ğŸ† ï¼ˆçŸ¥ã‚‰ãªã‹ã£ãŸã‘ã©ã­ï¼‰</p>\n\n<p>ğŸ”— <a href=\"https://iphone-mania.jp/news-350190/\">æ–°å‹iPad Proæ­è¼‰A14X/A14Zãƒãƒƒãƒ—ã®å‡¦ç†èƒ½åŠ›ã¯M1ãƒãƒƒãƒ—ã«åŒ¹æ•µã‹ - iPhone Mania</a></p>\n","contentSnippet":"åƒ•ã¯çŸ¥ã‚‰ãªã‹ã£ãŸã§ã™ (ãƒ»âˆ€ãƒ»)Rails ã§ ActiveJob ã® retry_on ãŒåŒæ™‚ã«ç™ºç«ã•ã‚Œã‚‹ã®ä½•ã¨ã‹ã—ãŸã„ãªãƒ¼ã¨æ€ã£ã¦èª¿ã¹ã¦ãŸã‚‰ã€Rails 6 ã‹ã‚‰ã¯ jitter ã¨ã„ã†ã‚ªãƒ—ã‚·ãƒ§ãƒ³ãŒæŒ‡å®šã§ãã‚‹ã‚ˆã†ã«ãªã£ã¦ã¦ã€ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ãƒªãƒˆãƒ©ã‚¤é–“éš”ã‚’ 15% ãƒ©ãƒ³ãƒ€ãƒã‚¤ã‚ºã—ã¦ãã‚Œã‚‹ã¨ã®äº‹ã€‚Rate Limit ã®å›é¿ã¨ã‹ã§ä¾¿åˆ©ã€‚ https://t.co/kpIx6YVFEqâ€” ã‚µãƒˆã‚¦ãƒªãƒ§ã‚¦ã‚¹ã‚± (@ryosuke_sato) February 27, 2021 jitter ã¨ã¯Rails 6.1 ã‹ã‚‰è¿½åŠ ã•ã‚ŒãŸã‚ªãƒ—ã‚·ãƒ§ãƒ³ ã§ã€ retry_on ã®å¾…ã¡æ™‚é–“ã«å¯¾ã—ã¦ä»»æ„ã®å‰²åˆã§ãƒãƒ©ã‘ã•ã›ã¦ãã‚Œã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ 15% ï¼‰ã€‚ActiveJob::Exceptions::ClassMethods - retry_on:jitter - A random delay of wait time used when calculating backoff. The default is 15% (0.15) which represents the upper bound of possible wait time (expressed as a percentage)å®Ÿè£…ã‚’ç¢ºèªã—ã¦ã¿ãŸã“ã®ãƒãƒ©ã‘ã•ã›æ–¹ãŒå¾…ã¡æ™‚é–“ã«å¯¾ã—ã¦å¢—ãˆã‚‹ã®ã‹æ¸›ã‚‹ã®ã‹ãŒæ°—ã«ãªã£ã¦å®Ÿè£…ã‚’è¦‹ã¦ã¿ã¾ã—ãŸã€‚å¢—ãˆã‚‹æ–¹å‘ã§ãƒãƒ©ã‘ã‚‹ã‚ˆã†ã§ã™ã€‚ä¾‹ãˆã° wait: 60.seconds ã§ jitter: 0.5 ã®å ´åˆã ã¨ã€æœ€å¤§ 90 ç§’ã®å¾…ã¡æ™‚é–“ã¨ãªã‚Šã¾ã™ã€‚ã†ã£ã‹ã‚Š 100.0 ã¨ã‹æŒ‡å®šã™ã‚‹ã¨æœ€å¤§ 10000% å¾…ã¡æ™‚é–“ãŒåŠ ç®—ã•ã‚Œã¡ã‚ƒã„ãã†ã§ã™ã€‚é–“é•ãˆã¦æŒ‡å®šã—ãªã„ã‚ˆã†ã«ã”æ³¨æ„ä¸‹ã•ã„ğŸ™delay = seconds_or_duration_or_algorithm.to_idelay_jitter = determine_jitter_for_delay(delay, jitter)delay + delay_jitterğŸ“ jitter ã®è¨ˆç®—å‡¦ç†ã¯ ã“ã®ã‚ãŸã‚Šã©ã†ã„ã†å ´é¢ã§ä½¿ã†ã®ï¼Ÿã“ã®æ©Ÿèƒ½ãŒç„¡ã‹ã£ãŸå¾“æ¥ã ã¨ã€ãƒªãƒˆãƒ©ã‚¤å‡¦ç†ãŒä¸€æ–‰ã«èµ·å‹•ã—ã¦ã—ã¾ã†ã¨ã„ã†å•é¡ŒãŒã‚ã‚Šã¾ã—ãŸã€‚ä¾‹ãˆã°å¤–éƒ¨ã®ã‚µãƒ¼ãƒ“ã‚¹ã« API ãƒªã‚¯ã‚¨ã‚¹ãƒˆã™ã‚‹ã‚ˆã†ãª Job ã‚’ä½œã£ãŸã¨ã—ã¾ã™ã€‚API Rate Limit è¶…éã®ä¾‹å¤–ã‚’ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã—ã¦ã€ retry_on ã§ N åˆ†å¾Œã«ãƒªãƒˆãƒ©ã‚¤ã™ã‚‹ã‚ˆã†ã«å®Ÿè£…ã—ã¾ã™ã€‚ã“ã®æ™‚ã€ 1000 ä»¶ã® Job ãŒåŒæ™‚ã«å®Ÿè¡Œã•ã‚Œ 900 ä»¶ãŒ Rate Limit è¶…éã¨ãªã£ãŸå ´åˆã€N åˆ†å¾Œã« 900 ä»¶ã® Job ãŒä¸€æ–‰ã«ãƒªãƒˆãƒ©ã‚¤ã•ã‚Œã¦ã—ã¾ã„ã€å†ã³ 800 ä»¶ãŒã‚¨ãƒ©ãƒ¼ã¨ãªã£ã¦ã—ã¾ã†ã€‚ã“ã‚ŒãŒä½•åº¦ã‚‚ç¹°ã‚Šè¿”ã•ã‚Œã‚‹ã€ã¨ã„ã†ç¾è±¡ãŒèµ·ã“ã£ã¦ã¾ã—ãŸã€‚Rails 6.1 ä»¥å‰ã ã¨å›é¿ã§ããªã„ã®ï¼Ÿå¾“æ¥ã® ActiveJob ã§ã‚‚ä¸€å¿œå›é¿ç­–ã¯ã‚ã£ã¦ã€ wait ã« Proc ã‚’ä¸ãˆã¦ãƒ©ãƒ³ãƒ€ãƒ ãªå¾…ã¡æ™‚é–“ã‚’è¿”ã™ã‚ˆã†ãªå‡¦ç†ã‚’æ›¸ãã“ã¨ã§ä¼¼ãŸã‚ˆã†ãªå‹•ä½œã¯å¯èƒ½ã§ã™ã€‚retry_on SomeError, wait: -> { rand(60..90).seconds }iPad Air (ç¬¬4ä¸–ä»£) è²·ã£ã¡ã‚ƒã£ãŸiPad Air (ç¬¬4ä¸–ä»£)è¿‘æ—¥ä¸­ã« iPad Pro ã®æ–°å‹ãŒå‡ºã‚‹ã¨ã®å™‚ãŒã‚ã‚‹ãŒã€è»½ã„ Air ãŒã»ã—ã‹ã£ãŸã®ã§å•é¡Œ ğŸ† ï¼ˆçŸ¥ã‚‰ãªã‹ã£ãŸã‘ã©ã­ï¼‰ğŸ”— æ–°å‹iPad Proæ­è¼‰A14X/A14Zãƒãƒƒãƒ—ã®å‡¦ç†èƒ½åŠ›ã¯M1ãƒãƒƒãƒ—ã«åŒ¹æ•µã‹ - iPhone Mania","link":"https://ryz310.hateblo.jp/entry/2021/03/02/113927","isoDate":"2021-03-02T02:39:27.000Z","dateMiliSeconds":1614652767000,"imageUrl":"https://cdn-ak.f.st-hatena.com/images/fotolife/r/ryz310/20210302/20210302102542.jpg","authorName":"ryz310"},{"title":"RuboCop ã§é•åã—ã¦ã‚‹ã‚³ãƒ¼ãƒ‰ã‚’è‡ªå‹•çš„ã«ä¿®æ­£ã™ã‚‹ PR ä½œã£ã¦ãã‚ŒãŸã‚‰å¬‰ã—ã„ã‚„ã‚ã€‚ã§ãã‚‹ã§ãã‚Œã€‚","content":"<p>ä¹…ã€…ã®æ›´æ–°ã¯ Rubocop Challenger ã®è©±ã§ã™ã€‚</p>\n\n<p>ã“ã®ãƒ–ãƒ­ã‚°ã§ã¯è§¦ã‚ŒãŸã“ã¨ç„¡ã‹ã£ãŸã§ã™ãŒã€ <a href=\"https://github.com/ryz310/rubocop_challenger\">ãã†ã„ã† gem</a> ã‚‚ä½œã£ã¦ã¾ã™ã€‚\nè‡ªå‹•çš„ã« <code>.rubocop_todo.yml</code> ã‹ã‚‰  <code>Cop supports --auto-correct.</code> ã«ãªã£ã¦ã‚‹ Cop ã‚’æ‹¾ã£ã¦ãã¦ PR ä½œã£ã¦ãã‚Œã‚‹ã‚„ã¤ã§ã™ã€‚</p>\n\n<p>ã¡ã‚‡ã†ã© hey ç¤¾ã® CTO ã®è—¤æ‘ã•ã‚“ãŒåŒã˜äº‹ã‚’ã‚„ã£ã¦ã„ã¦ã¡ã‚‡ã£ã¨ãƒã‚ºã£ã¦ãŸã‚“ã§ã™ãŒã€è‡ªåˆ†ã® gem ä½¿ã£ã¦ã»ã—ã‹ã£ãŸãªãƒ¼ã¨åœ°å‘³ã«æ€ã£ã¦ãŸã‚Šã—ã¾ã™ã€‚è‡ªåˆ†ãŒä¸–ã®ä¸­ã«å¯¾ã—ã¦ã‚¢ãƒ”ãƒ¼ãƒ«ãŒè¶³ã‚Šã¦ãªã•ã™ãã¾ã—ãŸã­ ğŸ˜‡</p>\n\n<p><iframe src=\"https://hatenablog-parts.com/embed?url=https%3A%2F%2Ftech.hey.jp%2Fentry%2F2020%2F10%2F23%2F111200\" title=\"ãŸã¾ã£ã¦ã—ã¾ã£ãŸ .rubocop_todo.yml ã‚’GitHub Actionsã§ç¶™ç¶šçš„ã‹ã¤è‡ªå‹•çš„ã«å€’ã™æ–¹æ³• - STORES Tech Blog\" class=\"embed-card embed-blogcard\" scrolling=\"no\" frameborder=\"0\" style=\"display: block; width: 100%; height: 190px; max-width: 500px; margin: 10px 0px;\"></iframe><cite class=\"hatena-citation\"><a href=\"https://tech.hey.jp/entry/2020/10/23/111200\">tech.hey.jp</a></cite></p>\n\n<p>ä½•å¹´ã‹å‰ã«ä¼šç¤¾ã®ãƒ–ãƒ­ã‚°ã§æ›¸ã„ãŸã‚Šã¯ã—ã¦ãŸã®ã§ãƒªãƒ³ã‚¯è²¼ã£ã¦ãŠã âœ</p>\n\n<p><iframe src=\"https://hatenablog-parts.com/embed?url=https%3A%2F%2Fdeveloper.feedforce.jp%2Fentry%2F2018%2F12%2F05%2F140000\" title=\"ã¾ã  .rubocop_todo.yml ã§æ¶ˆè€—ã—ã¦ã‚‹ã®ï¼Ÿ - Feedforce Developer Blog\" class=\"embed-card embed-blogcard\" scrolling=\"no\" frameborder=\"0\" style=\"display: block; width: 100%; height: 190px; max-width: 500px; margin: 10px 0px;\"></iframe><cite class=\"hatena-citation\"><a href=\"https://developer.feedforce.jp/entry/2018/12/05/140000\">developer.feedforce.jp</a></cite></p>\n\n<h2>Rubocop Challenger v2.3.0 ã‚’ãƒªãƒªãƒ¼ã‚¹ã—ã¾ã—ãŸ ğŸš€</h2>\n\n<p><iframe src=\"https://hatenablog-parts.com/embed?url=https%3A%2F%2Fgithub.com%2Fryz310%2Frubocop_challenger%2Freleases%2Ftag%2Fv2.3.0\" title=\"Release v2.3.0 Â· ryz310/rubocop_challenger\" class=\"embed-card embed-webcard\" scrolling=\"no\" frameborder=\"0\" style=\"display: block; width: 100%; height: 155px; max-width: 500px; margin: 10px 0px;\"></iframe><cite class=\"hatena-citation\"><a href=\"https://github.com/ryz310/rubocop_challenger/releases/tag/v2.3.0\">github.com</a></cite></p>\n\n<p>ã¨ã¯ã„ãˆæ–°æ©Ÿèƒ½ã¯ä¸€ã¤ã ã‘ã§ã€ auto-correct ã•ã‚ŒãŸ Cop ãŒ SafeAutocorrect ã‹ã©ã†ã‹ã‚’æ•™ãˆã¦ãã‚Œã‚‹ã€ã¨ã„ã†ã‚‚ã®ã§ã™ã€‚</p>\n\n<p><a href=\"https://github.com/ryz310/rubocop_challenger/pull/465\">Add description whether the challenge is created by safe autocorrect or not by ryz310 &middot; Pull Request #465 &middot; ryz310/rubocop_challenger &middot; GitHub</a></p>\n\n<p>ã“ã‚“ãªæ„Ÿã˜ã® PR ãŒä½œæˆã•ã‚Œã¾ã™ã€‚ï¼ˆç”»åƒã¯å‹•ä½œç¢ºèªã§ä½œã£ãŸã‚‚ã®ãªã®ã§ã€å®Ÿéš›ã® <code>Style/Alias</code> ã¯å¸¸ã« <code>SafeAutocorrect: true</code> ã«ãªã‚Šã¾ã™ï¼‰</p>\n\n<p><img src=\"https://user-images.githubusercontent.com/3985540/108836759-94096800-7614-11eb-8fb9-cb311711e120.png\" alt=\"Add description whether the challenge is created by safe autocorrect or not by ryz310 Â· Pull Request #465 Â· ryz310/rubocop_challenger\" />\n<img src=\"https://user-images.githubusercontent.com/3985540/108847589-392b3d00-7623-11eb-8c09-e5192edbbd80.png\" alt=\"Add description whether the challenge is created by safe autocorrect or not by ryz310 Â· Pull Request #465 Â· ryz310/rubocop_challenger\" /></p>\n\n<p>ãœã²ãŠè©¦ã—ä¸‹ã•ã„ ğŸ‘</p>\n\n<h2>ã¤ãã‚„ã‚ŠãŸã„ã“ã¨</h2>\n\n<p>å…ˆæ—¥ <a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/GitHub\">GitHub</a> ãŒ auto-merge æ©Ÿèƒ½ã‚’ãƒªãƒªãƒ¼ã‚¹ã—ã¾ã—ãŸã­ã€‚è‡ªåˆ†ã¯å³å…¨éƒ¨ã®<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%EA%A5%DD%A5%B8%A5%C8%A5%EA\">ãƒªãƒã‚¸ãƒˆãƒª</a>ã§æœ‰åŠ¹åŒ–ã—ã¾ã—ãŸ âœ…</p>\n\n<p><iframe src=\"https://hatenablog-parts.com/embed?url=https%3A%2F%2Fgithub.blog%2Fchangelog%2F2021-02-04-pull-request-auto-merge-is-now-generally-available%2F\" title=\"Pull request auto-merge is now generally available - GitHub Changelog\" class=\"embed-card embed-webcard\" scrolling=\"no\" frameborder=\"0\" style=\"display: block; width: 100%; height: 155px; max-width: 500px; margin: 10px 0px;\"></iframe><cite class=\"hatena-citation\"><a href=\"https://github.blog/changelog/2021-02-04-pull-request-auto-merge-is-now-generally-available/\">github.blog</a></cite></p>\n\n<p>æ¬¡ã‚„ã‚ŠãŸã„æ©Ÿèƒ½ã¨ã—ã¦ã¯ <code>SafeAutocorrect: true</code>  ã®å ´åˆã¨ã‹ã¯ auto-merge ã‚’æœ‰åŠ¹åŒ–ã—ãŸ PR ã‚’ä½œã‚‹ã‚ˆã†ã«ã—ãŸã„ã‚“ã§ã™ã‚ˆã­ã€‚</p>\n\n<p><a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/GitHub\">GitHub</a> ã® GraphQL <a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/API\">API</a> ã§ã“ã®æ©Ÿèƒ½ã‚’æœ‰åŠ¹åŒ–ã§ãã‚‹ã‚‰ã—ã„ã§ã™ã€‚</p>\n\n<blockquote><p>GraphQL APIs will be rolling out later this week. The pull request webhook event also now includes actions that indicate when auto-merge is enabled or disabled.</p></blockquote>\n\n<p>ã¾ãŸæ™‚é–“ã‚ã‚‹æ™‚ã«ã§ã‚‚èª¿ã¹ã¾ã™ã€‚</p>\n","contentSnippet":"ä¹…ã€…ã®æ›´æ–°ã¯ Rubocop Challenger ã®è©±ã§ã™ã€‚ã“ã®ãƒ–ãƒ­ã‚°ã§ã¯è§¦ã‚ŒãŸã“ã¨ç„¡ã‹ã£ãŸã§ã™ãŒã€ ãã†ã„ã† gem ã‚‚ä½œã£ã¦ã¾ã™ã€‚è‡ªå‹•çš„ã« .rubocop_todo.yml ã‹ã‚‰  Cop supports --auto-correct. ã«ãªã£ã¦ã‚‹ Cop ã‚’æ‹¾ã£ã¦ãã¦ PR ä½œã£ã¦ãã‚Œã‚‹ã‚„ã¤ã§ã™ã€‚ã¡ã‚‡ã†ã© hey ç¤¾ã® CTO ã®è—¤æ‘ã•ã‚“ãŒåŒã˜äº‹ã‚’ã‚„ã£ã¦ã„ã¦ã¡ã‚‡ã£ã¨ãƒã‚ºã£ã¦ãŸã‚“ã§ã™ãŒã€è‡ªåˆ†ã® gem ä½¿ã£ã¦ã»ã—ã‹ã£ãŸãªãƒ¼ã¨åœ°å‘³ã«æ€ã£ã¦ãŸã‚Šã—ã¾ã™ã€‚è‡ªåˆ†ãŒä¸–ã®ä¸­ã«å¯¾ã—ã¦ã‚¢ãƒ”ãƒ¼ãƒ«ãŒè¶³ã‚Šã¦ãªã•ã™ãã¾ã—ãŸã­ ğŸ˜‡tech.hey.jpä½•å¹´ã‹å‰ã«ä¼šç¤¾ã®ãƒ–ãƒ­ã‚°ã§æ›¸ã„ãŸã‚Šã¯ã—ã¦ãŸã®ã§ãƒªãƒ³ã‚¯è²¼ã£ã¦ãŠã âœdeveloper.feedforce.jpRubocop Challenger v2.3.0 ã‚’ãƒªãƒªãƒ¼ã‚¹ã—ã¾ã—ãŸ ğŸš€github.comã¨ã¯ã„ãˆæ–°æ©Ÿèƒ½ã¯ä¸€ã¤ã ã‘ã§ã€ auto-correct ã•ã‚ŒãŸ Cop ãŒ SafeAutocorrect ã‹ã©ã†ã‹ã‚’æ•™ãˆã¦ãã‚Œã‚‹ã€ã¨ã„ã†ã‚‚ã®ã§ã™ã€‚Add description whether the challenge is created by safe autocorrect or not by ryz310 Â· Pull Request #465 Â· ryz310/rubocop_challenger Â· GitHubã“ã‚“ãªæ„Ÿã˜ã® PR ãŒä½œæˆã•ã‚Œã¾ã™ã€‚ï¼ˆç”»åƒã¯å‹•ä½œç¢ºèªã§ä½œã£ãŸã‚‚ã®ãªã®ã§ã€å®Ÿéš›ã® Style/Alias ã¯å¸¸ã« SafeAutocorrect: true ã«ãªã‚Šã¾ã™ï¼‰ãœã²ãŠè©¦ã—ä¸‹ã•ã„ ğŸ‘ã¤ãã‚„ã‚ŠãŸã„ã“ã¨å…ˆæ—¥ GitHub ãŒ auto-merge æ©Ÿèƒ½ã‚’ãƒªãƒªãƒ¼ã‚¹ã—ã¾ã—ãŸã­ã€‚è‡ªåˆ†ã¯å³å…¨éƒ¨ã®ãƒªãƒã‚¸ãƒˆãƒªã§æœ‰åŠ¹åŒ–ã—ã¾ã—ãŸ âœ…github.blogæ¬¡ã‚„ã‚ŠãŸã„æ©Ÿèƒ½ã¨ã—ã¦ã¯ SafeAutocorrect: true  ã®å ´åˆã¨ã‹ã¯ auto-merge ã‚’æœ‰åŠ¹åŒ–ã—ãŸ PR ã‚’ä½œã‚‹ã‚ˆã†ã«ã—ãŸã„ã‚“ã§ã™ã‚ˆã­ã€‚GitHub ã® GraphQL API ã§ã“ã®æ©Ÿèƒ½ã‚’æœ‰åŠ¹åŒ–ã§ãã‚‹ã‚‰ã—ã„ã§ã™ã€‚GraphQL APIs will be rolling out later this week. The pull request webhook event also now includes actions that indicate when auto-merge is enabled or disabled.ã¾ãŸæ™‚é–“ã‚ã‚‹æ™‚ã«ã§ã‚‚èª¿ã¹ã¾ã™ã€‚","link":"https://ryz310.hateblo.jp/entry/2021/02/23/222720","isoDate":"2021-02-23T13:27:20.000Z","dateMiliSeconds":1614086840000,"imageUrl":"https://user-images.githubusercontent.com/3985540/108836759-94096800-7614-11eb-8fb9-cb311711e120.png","authorName":"ryz310"},{"title":"my_api_client v0.16.0 ã‚’ãƒªãƒªãƒ¼ã‚¹ã—ã¾ã—ãŸğŸš€","content":"<p>å‰å›ã®ãƒªãƒªãƒ¼ã‚¹ã‹ã‚‰ 1 é€±é–“ã»ã©ã§ã™ãŒã€ä»Šæ—¥äºˆå®šã—ã¦ã„ãŸãƒ©ã‚¤ãƒ–ãŒ<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%B3%A5%ED%A5%CA%A5%A6%A5%A4%A5%EB%A5%B9\">ã‚³ãƒ­ãƒŠã‚¦ã‚¤ãƒ«ã‚¹</a>ã®å½±éŸ¿ã§ä¸­æ­¢ã«ãªã£ãŸã®ã§æš‡ã‚’æŒã¦ä½™ã—ã¾ã—ãŸ ğŸ˜·</p>\n\n<p><iframe src=\"https://hatenablog-parts.com/embed?url=https%3A%2F%2Fgithub.com%2Fryz310%2Fmy_api_client%2Freleases%2Ftag%2Fv0.16.0\" title=\"Release v0.16.0 Â· ryz310/my_api_client\" class=\"embed-card embed-webcard\" scrolling=\"no\" frameborder=\"0\" style=\"display: block; width: 100%; height: 155px; max-width: 500px; margin: 10px 0px;\"></iframe><cite class=\"hatena-citation\"><a href=\"https://github.com/ryz310/my_api_client/releases/tag/v0.16.0\">github.com</a></cite></p>\n\n<h2>v0.16.0 ã®æ–°æ©Ÿèƒ½</h2>\n\n<p>2 ã¤ã‚ã‚Šã¾ã™ãŒã€ã©ã¡ã‚‰ã‚‚è‹¥å¹²ã® Breaking Change ã§ã™ã€‚\nã¨ã¯ã„ãˆæ™®é€šã«ä½¿ã£ã¦ã„ãŸã‚‰å…¨ãå½±éŸ¿ã‚’å—ã‘ãªã„ã¨æ€ã„ã¾ã™ã€‚</p>\n\n<h3><a href=\"https://github.com/ryz310/my_api_client/pull/225([@ryz310](https://github.com/ryz310\">æ–°æ©Ÿèƒ½ 1. ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒ©ãŒã‚¨ãƒ©ãƒ¼ã‚’æ¤œå‡ºã—ãŸéš›ã¯å¸¸ã«ä¾‹å¤–ã‚’ raise ã™ã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸ</a></h3>\n\n<p><code>my_api_client</code> ã§ã¯ <a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/JSON\">JSON</a> <a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/API\">API</a> ã‹ã‚‰ã®ãƒ¬ã‚¹ãƒãƒ³ã‚¹å†…å®¹ã«å¿œã˜ã¦ä¾‹å¤–ã‚’ç™ºç”Ÿã•ã›ã‚‹ <code>error_handling</code> ã¨ã„ã†ãƒ¡ã‚½ãƒƒãƒ‰ãŒåˆ©ç”¨ã§ãã¾ã™ã€‚</p>\n\n<p>ä»¥ä¸‹ã« <code>error_handling</code> ã‚’åˆ©ç”¨ã—ãŸä¾‹ã‚’ç¤ºã—ã¾ã™ã€‚</p>\n\n<pre class=\"code lang-ruby\" data-lang=\"ruby\" data-unlink><span class=\"synPreProc\">class</span> <span class=\"synType\">ExampleApiClient</span> &lt; <span class=\"synType\">ApplicationApiClient</span>\n  endpoint <span class=\"synSpecial\">'</span><span class=\"synConstant\">https://example.com</span><span class=\"synSpecial\">'</span>\n\n  error_handling <span class=\"synConstant\">json</span>: { <span class=\"synSpecial\">'</span><span class=\"synConstant\">$.errors.code</span><span class=\"synSpecial\">'</span>: <span class=\"synConstant\">10</span> }\n\n  error_handling <span class=\"synConstant\">json</span>: { <span class=\"synSpecial\">'</span><span class=\"synConstant\">$.errors.code</span><span class=\"synSpecial\">'</span>: <span class=\"synConstant\">20</span> }, <span class=\"synConstant\">raise</span>: <span class=\"synType\">MyErrorClass</span>\n\n  error_handling <span class=\"synConstant\">json</span>: { <span class=\"synSpecial\">'</span><span class=\"synConstant\">$.errors.code</span><span class=\"synSpecial\">'</span>: <span class=\"synConstant\">30</span> }, <span class=\"synConstant\">with</span>: <span class=\"synConstant\">:my_error_handling</span>\n\n  error_handling <span class=\"synConstant\">json</span>: { <span class=\"synSpecial\">'</span><span class=\"synConstant\">$.errors.code</span><span class=\"synSpecial\">'</span>: <span class=\"synConstant\">40</span> } <span class=\"synStatement\">do</span> |<span class=\"synIdentifier\">params</span>, <span class=\"synIdentifier\">logger</span>|\n    <span class=\"synComment\"># Do something.</span>\n  <span class=\"synStatement\">end</span>\n\n  <span class=\"synComment\"># GET error/:code</span>\n  <span class=\"synPreProc\">def</span> <span class=\"synIdentifier\">request</span>\n    get <span class=\"synSpecial\">'</span><span class=\"synConstant\">path/to/resouce</span><span class=\"synSpecial\">'</span>\n  <span class=\"synPreProc\">end</span>\n\n  <span class=\"synStatement\">private</span>\n\n  <span class=\"synPreProc\">def</span> <span class=\"synIdentifier\">my_error_handling</span>(params, logger)\n    <span class=\"synComment\"># Do something.</span>\n  <span class=\"synPreProc\">end</span>\n<span class=\"synPreProc\">end</span>\n</pre>\n\n\n<p>ã“ã®ä¾‹ã®å ´åˆã€ <code>ExampleApiClient#request</code> ã‚’å®Ÿè¡Œã™ã‚‹ã¨ <code>GET https://example.com/path/to/resouce</code> ã«å¯¾ã—ã¦ãƒªã‚¯<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%A8%A5%B9\">ã‚¨ã‚¹</a>ãƒˆãŒå®Ÿè¡Œã•ã‚Œã€ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãƒœãƒ‡ã‚£ãŒ <a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/JSON\">JSON</a> å½¢å¼ã ã£ãŸå ´åˆã€JSONPath <code>$.error.code</code> ã®å€¤ã«å¿œã˜ã¦ä»¥ä¸‹ã®å‡¦ç†ã‚’å®Ÿè¡Œã—ã¾ã™ã€‚</p>\n\n<ul>\n<li><code>10</code> ã ã£ãŸå ´åˆ <code>MyApiClient::Error</code> ã‚’ç™ºç”Ÿã•ã›ã‚‹</li>\n<li><code>20</code> ã ã£ãŸå ´åˆ <code>MyErrorClass</code> ã‚’ç™ºç”Ÿã•ã›ã‚‹</li>\n<li><code>30</code> ã ã£ãŸå ´åˆ <code>#my_error_handling</code> ã‚’å®Ÿè¡Œã™ã‚‹ <strong>ï¼ˆä¾‹å¤–ã¯ç™ºç”Ÿã—ãªã„ï¼‰</strong></li>\n<li><code>40</code> ã ã£ãŸå ´åˆ <code>do ~ end</code> ã‚’å®Ÿè¡Œã™ã‚‹ <strong>ï¼ˆä¾‹å¤–ã¯ç™ºç”Ÿã—ãªã„ï¼‰</strong></li>\n</ul>\n\n\n<p><code>MyApiClient::Error</code> ã¯ <code>raise</code> ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã§ä¾‹å¤–ã‚¯ãƒ©ã‚¹ã‚’æŒ‡å®šã—ãªã‹ã£ãŸå ´åˆã®ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®ä¾‹å¤–ã‚¯ãƒ©ã‚¹ã§ã™ã€‚</p>\n\n<p>ã“ã®æ™‚ã€å¾“æ¥ã¯ <code>30</code> ã¨ <code>40</code> ã®ã‚ˆã†ã« <code>with</code> ã‚„ <code>block</code> ã‚’åˆ©ç”¨ã—ãŸå ´åˆã¯ã€å‡¦ç†ã®ä¸­ã§æ˜ç¤ºçš„ã« <code>raise</code> ã‚’å®Ÿè¡Œã—ãªã„é™ã‚Šã€ä¾‹å¤–ã¯ç™ºç”Ÿã—ã¾ã›ã‚“ã§ã—ãŸã€‚\nã‚¨ãƒ©ãƒ¼æ¤œå‡ºæ™‚ã«ä¾‹å¤–ã‚’ç™ºç”Ÿã•ã›ã‚‹ã‹ã©ã†ã‹ã¯ã€ <code>my_api_client</code> ã®åˆ©ç”¨è€…ã«å§”ã­ã‚‰ã‚Œã¦ã„ãŸå½¢ã«ãªã‚Šã¾ã™ã€‚</p>\n\n<p>ã—ã‹ã—ãªãŒã‚‰ã€ã“ã“ã«è‡ªç”±åº¦ã‚’æŒãŸã›ã‚‹ã‚ˆã‚Šã‚‚ã€ <strong>ã‚¨ãƒ©ãƒ¼æ¤œå‡ºæ™‚ã«ã¯å¿…ãš <code>raise</code> ã•ã›ã¦ <code>rescue</code> ã§ç•°å¸¸æ™‚ã®å‡¦ç†ã‚’è¨˜è¿°ã™ã‚‹</strong> ã€ã¨ã„ã†æ–¹å¼ã«çµ±ä¸€ã—ãŸæ–¹ãŒ <code>my_api_client</code> ã®åˆ©ç”¨æ–¹æ³•ã¨ã—ã¦ã‚‚ç†è§£ã—ã‚„ã™ãã€ç‰¹ã«å›°ã‚‹ã‚±ãƒ¼ã‚¹ã‚‚æƒ³å®šã•ã‚Œãªã‹ã£ãŸã“ã¨ã‹ã‚‰ã€ä»¥ä¸‹ã®ã‚ˆã†ã«å¤‰æ›´ã™ã‚‹ã“ã¨ã«ã—ã¾ã—ãŸã€‚</p>\n\n<ul>\n<li><code>10</code> ã ã£ãŸå ´åˆ <code>MyApiClient::Error</code> ã‚’ç™ºç”Ÿã•ã›ã‚‹ <strong>ï¼ˆå¤‰æ›´ãªã—ï¼‰</strong></li>\n<li><code>20</code> ã ã£ãŸå ´åˆ <code>MyErrorClass</code> ã‚’ç™ºç”Ÿã•ã›ã‚‹ <strong>ï¼ˆå¤‰æ›´ãªã—ï¼‰</strong></li>\n<li><code>30</code> ã ã£ãŸå ´åˆ <code>#my_error_handling</code> ã‚’å®Ÿè¡Œã—ã€ <strong><code>MyApiClient::Error</code> ã‚’ç™ºç”Ÿã•ã›ã‚‹</strong></li>\n<li><code>40</code> ã ã£ãŸå ´åˆ <code>do ~ end</code> ã‚’å®Ÿè¡Œã—ã€ <strong><code>MyApiClient::Error</code> ã‚’ç™ºç”Ÿã•ã›ã‚‹</strong></li>\n</ul>\n\n\n<p>ä»Šå¾Œã¯ã‚¨ãƒ©ãƒ¼æ¤œå‡ºæ™‚ã«ã¯å¸¸ã«ä½•ã‚‰ã‹ã®ä¾‹å¤–ãŒ <code>raise</code> ã•ã‚Œã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚\nä¸Šè¨˜ã®ä¾‹ã§ã¯ <code>MyApiClient::Error</code> ãŒç™ºç”Ÿã—ã¾ã™ãŒã€ <code>with</code> ã‚„ <code>block</code> ã¨åŒæ™‚ã« <code>raise</code> ã‚’æŒ‡å®šã™ã‚Œã°ã€ä»»æ„ã®ä¾‹å¤–ã‚¯ãƒ©ã‚¹ãŒç™ºç”Ÿã™ã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚</p>\n\n<p>ã“ã‚Œã«ã‚ˆã‚Šã€ <code>with</code> ã‚„ <code>block</code> ã¯ä¾‹å¤–ã®å‰å‡¦ç†ã¨ã„ã†ä½ç½®ä»˜ã‘ã«ãªã‚Šã¾ã™ã€‚<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%E6%A1%BC%A5%B9%A5%B1%A1%BC%A5%B9\">ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹</a>ã¨ã—ã¦ã¯ãƒ­ã‚°å‡ºåŠ›ã‚„ slack ã¸ã®é€šçŸ¥ãªã©ãŒè€ƒãˆã‚‰ã‚Œã¾ã™ã€‚</p>\n\n<h3><a href=\"https://github.com/ryz310/my_api_client/pull/226\">æ–°æ©Ÿèƒ½ 2. æ¨™æº–ã®ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒ©ãŒç”¨æ„ã•ã‚Œã¾ã—ãŸ</a></h3>\n\n<p><code>my_api_client</code> ã§ã¯ <a href=\"https://github.com/ryz310/my_api_client/blob/e6e4d2265fc834925d45e023c7d43590f98b7171/README.jp.md#installation\">generator æ©Ÿèƒ½</a> ãŒç”¨æ„ã•ã‚Œã¦ãŠã‚Šã€ <code>$ rails g api_client path/to/resource get:path/to/resource</code> ã‚’å®Ÿè¡Œã™ã‚‹ã¨ä»¥ä¸‹ã®ãƒ•ã‚¡ã‚¤ãƒ«ãŒä½œæˆã•ã‚Œã¾ã™ã€‚</p>\n\n<pre class=\"code\" data-lang=\"\" data-unlink>create  app/api_clients/application_api_client.rb\ncreate  app/api_clients/path/to/resource_api_client.rb\ninvoke  rspec\ncreate    spec/api_clients/path/to/resource_api_client_spec.rb` </pre>\n\n\n<p>ã“ã®æ™‚ã€ <code>application_api_client.rb</code> ã«æ¨™æº–ã®ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒ©ã®ä¾‹ãŒã„ãã¤ã‹è¨˜è¼‰ã•ã‚Œã‚‹ã®ã§ã™ãŒã€ä¾‹ã¨ã„ã†ã‚ˆã‚Šå¿…é ˆã®ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒ©ã ã‚ˆã­ã€ã¨ã„ã†ã“ã¨ã§ã€ <code>my_api_client</code> ã®å†…éƒ¨ã§æ¨™æº–å®Ÿè£…ã™ã‚‹ã‚ˆã†ã«ã—ã¾ã—ãŸã€‚\nã“ã‚Œã«ã‚ˆã‚Šã€<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%B9%A5%C6%A1%BC%A5%BF%A5%B9%A5%B3%A1%BC%A5%C9\">ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚³ãƒ¼ãƒ‰</a> 4xx ã¨ 5xx ã®ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã«å¯¾ã—ã¦ã¯æ¨™æº–ã§ä¾‹å¤–ãŒç™ºç”Ÿã™ã‚‹ã‚ˆã†ãªã‚Šã¾ã™ã€‚ã¾ãŸã€ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ç³»ã®ã‚¨ãƒ©ãƒ¼ã«å¯¾ã—ã¦ã‚‚æ¨™æº–ã§ <code>300 msec</code> é–“éš”ã‚’ç©ºã‘ã¦ 3 å›ãƒªãƒˆãƒ©ã‚¤ãŒè©¦è¡Œã•ã‚Œã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚ï¼ˆãƒªãƒˆãƒ©ã‚¤å‡¦ç†ã‚‚å¾“æ¥ã¯æ˜ç¤ºçš„ãªå®šç¾©ãŒå¿…é ˆã§ã—ãŸï¼‰</p>\n\n<pre class=\"code lang-ruby\" data-lang=\"ruby\" data-unlink><span class=\"synComment\"># å¾“æ¥ã® `application_api_client.rb` ã«å‡ºåŠ›ã•ã‚Œã¦ã„ãŸæ¨™æº–ã®ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒ©ä¾‹</span>\nerror_handling <span class=\"synConstant\">status_code</span>: <span class=\"synConstant\">400</span>..<span class=\"synConstant\">499</span>, <span class=\"synConstant\">raise</span>: <span class=\"synType\">MyApiClient</span>::<span class=\"synType\">ClientError</span>\nerror_handling <span class=\"synConstant\">status_code</span>: <span class=\"synConstant\">500</span>..<span class=\"synConstant\">599</span>, <span class=\"synConstant\">raise</span>: <span class=\"synType\">MyApiClient</span>::<span class=\"synType\">ServerError</span>\n\n<span class=\"synComment\"># å¾“æ¥ã® `application_api_client.rb` ã«å‡ºåŠ›ã•ã‚Œã¦ã„ãŸæ¨™æº–ã®ãƒªãƒˆãƒ©ã‚¤å‡¦ç†ä¾‹</span>\nretry_on <span class=\"synType\">MyApiClient</span>::<span class=\"synType\">NetworkError</span>, <span class=\"synConstant\">wait</span>: <span class=\"synConstant\">5</span>.seconds, <span class=\"synConstant\">attempts</span>: <span class=\"synConstant\">3</span>\n</pre>\n\n\n<p>æ¨™æº–ã§å®šç¾©ã•ã‚Œã¦ã„ã‚‹ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒ©ã¯ <a href=\"https://github.com/ryz310/my_api_client/blob/e6e4d2265fc834925d45e023c7d43590f98b7171/lib/my_api_client/default_error_handlers.rb\">my_api_client/default_error_handlers.rb</a> ã‹ã‚‰å‚ç…§ã§ãã¾ã™ã€‚</p>\n\n<p><code>error_handling</code> ã¯å¾Œã‹ã‚‰å®šç¾©ã—ãŸç‰©ãŒå„ªå…ˆã•ã‚Œã¾ã™ã®ã§ã€ä¾‹ãˆã°<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%B9%A5%C6%A1%BC%A5%BF%A5%B9%A5%B3%A1%BC%A5%C9\">ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚³ãƒ¼ãƒ‰</a> <code>400</code> ã«å¯¾ã—ã¦ã¯ç‹¬è‡ªã®ä¾‹å¤–ã‚¯ãƒ©ã‚¹ã‚’ç™ºç”Ÿã•ã›ã‚‹ã‚ˆã†ã«ã—ãŸã„å ´åˆã€ç¶™æ‰¿å…ˆã®ã‚¯ãƒ©ã‚¹ã§ <code>error_handling status_code: 400, raise: MyErrorClass</code> ã®ã‚ˆã†ã«å®šç¾©ã™ã‚Œã°ã€ <code>MyErrorClass</code> ãŒä¾‹å¤–ã¨ã—ã¦ç™ºç”Ÿã™ã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚</p>\n\n<h2>æ‰€æ„Ÿ</h2>\n\n<p>ç¤¾å†…ã®ãƒ—ãƒ­ãƒ€ã‚¯ãƒˆç”¨ã«ä½œã£ãŸ gem ã§ã™ãŒã€å°‘ã—ãšã¤è‡ªåˆ†ä»¥å¤–ã®ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ã‚‚åˆ©ç”¨ã—ã¦ãã‚Œã‚‹ã‚ˆã†ã«ãªã£ã¦ãã¾ã—ãŸã€‚\nä¸€æ–¹ã§ã€è‡ªç”±åº¦ãŒé«˜éãã‚‹ã¨ç†ŸçŸ¥ã—ã¦ã„ãªã„ã¨ä½¿ãˆãªã„æ©Ÿèƒ½ãŒå¢—ãˆã¦ã—ã¾ã†ç‚¹ã‚’èª²é¡Œæ„Ÿã¨ã—ã¦æ„Ÿã˜ã‚‹ã‚ˆã†ã«ãªã£ã¦ãã¾ã—ãŸã€‚</p>\n\n<p>ãªã‚‹ã¹ãè‡ªç”±åº¦ã®é«˜ã„ gem ã‚’æ„è­˜ã—ã¤ã¤ã€æ¨™æº–ã®çŠ¶æ…‹ã§ã‚‚é«˜åº¦ãªæ©Ÿèƒ½ã®æ©æµã‚’å—ã‘ã‚‰ã‚Œã‚‹çŠ¶æ…‹ã‚’ç›®æŒ‡ã—ã¦ã„ããŸã„ã¨æ€ã„ã¾ã™ã€‚</p>\n\n<p>æã‚‰ãæ¬¡ã®æ–°æ©Ÿèƒ½ã¯ <code>async/await</code> ã£ã½ã„æ©Ÿèƒ½ã€ã¾ãŸã¯ <code>sawyer</code> gem ã®ä¾å­˜ã‹ã‚‰ã®è„±å´ãªã‚‹ã¨æ€ã„ã¾ã™ã€‚</p>\n","contentSnippet":"å‰å›ã®ãƒªãƒªãƒ¼ã‚¹ã‹ã‚‰ 1 é€±é–“ã»ã©ã§ã™ãŒã€ä»Šæ—¥äºˆå®šã—ã¦ã„ãŸãƒ©ã‚¤ãƒ–ãŒã‚³ãƒ­ãƒŠã‚¦ã‚¤ãƒ«ã‚¹ã®å½±éŸ¿ã§ä¸­æ­¢ã«ãªã£ãŸã®ã§æš‡ã‚’æŒã¦ä½™ã—ã¾ã—ãŸ ğŸ˜·github.comv0.16.0 ã®æ–°æ©Ÿèƒ½2 ã¤ã‚ã‚Šã¾ã™ãŒã€ã©ã¡ã‚‰ã‚‚è‹¥å¹²ã® Breaking Change ã§ã™ã€‚ã¨ã¯ã„ãˆæ™®é€šã«ä½¿ã£ã¦ã„ãŸã‚‰å…¨ãå½±éŸ¿ã‚’å—ã‘ãªã„ã¨æ€ã„ã¾ã™ã€‚æ–°æ©Ÿèƒ½ 1. ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒ©ãŒã‚¨ãƒ©ãƒ¼ã‚’æ¤œå‡ºã—ãŸéš›ã¯å¸¸ã«ä¾‹å¤–ã‚’ raise ã™ã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸmy_api_client ã§ã¯ JSON API ã‹ã‚‰ã®ãƒ¬ã‚¹ãƒãƒ³ã‚¹å†…å®¹ã«å¿œã˜ã¦ä¾‹å¤–ã‚’ç™ºç”Ÿã•ã›ã‚‹ error_handling ã¨ã„ã†ãƒ¡ã‚½ãƒƒãƒ‰ãŒåˆ©ç”¨ã§ãã¾ã™ã€‚ä»¥ä¸‹ã« error_handling ã‚’åˆ©ç”¨ã—ãŸä¾‹ã‚’ç¤ºã—ã¾ã™ã€‚class ExampleApiClient < ApplicationApiClient  endpoint 'https://example.com'  error_handling json: { '$.errors.code': 10 }  error_handling json: { '$.errors.code': 20 }, raise: MyErrorClass  error_handling json: { '$.errors.code': 30 }, with: :my_error_handling  error_handling json: { '$.errors.code': 40 } do |params, logger|    # Do something.  end  # GET error/:code  def request    get 'path/to/resouce'  end  private  def my_error_handling(params, logger)    # Do something.  endendã“ã®ä¾‹ã®å ´åˆã€ ExampleApiClient#request ã‚’å®Ÿè¡Œã™ã‚‹ã¨ GET https://example.com/path/to/resouce ã«å¯¾ã—ã¦ãƒªã‚¯ã‚¨ã‚¹ãƒˆãŒå®Ÿè¡Œã•ã‚Œã€ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãƒœãƒ‡ã‚£ãŒ JSON å½¢å¼ã ã£ãŸå ´åˆã€JSONPath $.error.code ã®å€¤ã«å¿œã˜ã¦ä»¥ä¸‹ã®å‡¦ç†ã‚’å®Ÿè¡Œã—ã¾ã™ã€‚10 ã ã£ãŸå ´åˆ MyApiClient::Error ã‚’ç™ºç”Ÿã•ã›ã‚‹20 ã ã£ãŸå ´åˆ MyErrorClass ã‚’ç™ºç”Ÿã•ã›ã‚‹30 ã ã£ãŸå ´åˆ #my_error_handling ã‚’å®Ÿè¡Œã™ã‚‹ ï¼ˆä¾‹å¤–ã¯ç™ºç”Ÿã—ãªã„ï¼‰40 ã ã£ãŸå ´åˆ do ~ end ã‚’å®Ÿè¡Œã™ã‚‹ ï¼ˆä¾‹å¤–ã¯ç™ºç”Ÿã—ãªã„ï¼‰MyApiClient::Error ã¯ raise ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã§ä¾‹å¤–ã‚¯ãƒ©ã‚¹ã‚’æŒ‡å®šã—ãªã‹ã£ãŸå ´åˆã®ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®ä¾‹å¤–ã‚¯ãƒ©ã‚¹ã§ã™ã€‚ã“ã®æ™‚ã€å¾“æ¥ã¯ 30 ã¨ 40 ã®ã‚ˆã†ã« with ã‚„ block ã‚’åˆ©ç”¨ã—ãŸå ´åˆã¯ã€å‡¦ç†ã®ä¸­ã§æ˜ç¤ºçš„ã« raise ã‚’å®Ÿè¡Œã—ãªã„é™ã‚Šã€ä¾‹å¤–ã¯ç™ºç”Ÿã—ã¾ã›ã‚“ã§ã—ãŸã€‚ã‚¨ãƒ©ãƒ¼æ¤œå‡ºæ™‚ã«ä¾‹å¤–ã‚’ç™ºç”Ÿã•ã›ã‚‹ã‹ã©ã†ã‹ã¯ã€ my_api_client ã®åˆ©ç”¨è€…ã«å§”ã­ã‚‰ã‚Œã¦ã„ãŸå½¢ã«ãªã‚Šã¾ã™ã€‚ã—ã‹ã—ãªãŒã‚‰ã€ã“ã“ã«è‡ªç”±åº¦ã‚’æŒãŸã›ã‚‹ã‚ˆã‚Šã‚‚ã€ ã‚¨ãƒ©ãƒ¼æ¤œå‡ºæ™‚ã«ã¯å¿…ãš raise ã•ã›ã¦ rescue ã§ç•°å¸¸æ™‚ã®å‡¦ç†ã‚’è¨˜è¿°ã™ã‚‹ ã€ã¨ã„ã†æ–¹å¼ã«çµ±ä¸€ã—ãŸæ–¹ãŒ my_api_client ã®åˆ©ç”¨æ–¹æ³•ã¨ã—ã¦ã‚‚ç†è§£ã—ã‚„ã™ãã€ç‰¹ã«å›°ã‚‹ã‚±ãƒ¼ã‚¹ã‚‚æƒ³å®šã•ã‚Œãªã‹ã£ãŸã“ã¨ã‹ã‚‰ã€ä»¥ä¸‹ã®ã‚ˆã†ã«å¤‰æ›´ã™ã‚‹ã“ã¨ã«ã—ã¾ã—ãŸã€‚10 ã ã£ãŸå ´åˆ MyApiClient::Error ã‚’ç™ºç”Ÿã•ã›ã‚‹ ï¼ˆå¤‰æ›´ãªã—ï¼‰20 ã ã£ãŸå ´åˆ MyErrorClass ã‚’ç™ºç”Ÿã•ã›ã‚‹ ï¼ˆå¤‰æ›´ãªã—ï¼‰30 ã ã£ãŸå ´åˆ #my_error_handling ã‚’å®Ÿè¡Œã—ã€ MyApiClient::Error ã‚’ç™ºç”Ÿã•ã›ã‚‹40 ã ã£ãŸå ´åˆ do ~ end ã‚’å®Ÿè¡Œã—ã€ MyApiClient::Error ã‚’ç™ºç”Ÿã•ã›ã‚‹ä»Šå¾Œã¯ã‚¨ãƒ©ãƒ¼æ¤œå‡ºæ™‚ã«ã¯å¸¸ã«ä½•ã‚‰ã‹ã®ä¾‹å¤–ãŒ raise ã•ã‚Œã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚ä¸Šè¨˜ã®ä¾‹ã§ã¯ MyApiClient::Error ãŒç™ºç”Ÿã—ã¾ã™ãŒã€ with ã‚„ block ã¨åŒæ™‚ã« raise ã‚’æŒ‡å®šã™ã‚Œã°ã€ä»»æ„ã®ä¾‹å¤–ã‚¯ãƒ©ã‚¹ãŒç™ºç”Ÿã™ã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€ with ã‚„ block ã¯ä¾‹å¤–ã®å‰å‡¦ç†ã¨ã„ã†ä½ç½®ä»˜ã‘ã«ãªã‚Šã¾ã™ã€‚ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹ã¨ã—ã¦ã¯ãƒ­ã‚°å‡ºåŠ›ã‚„ slack ã¸ã®é€šçŸ¥ãªã©ãŒè€ƒãˆã‚‰ã‚Œã¾ã™ã€‚æ–°æ©Ÿèƒ½ 2. æ¨™æº–ã®ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒ©ãŒç”¨æ„ã•ã‚Œã¾ã—ãŸmy_api_client ã§ã¯ generator æ©Ÿèƒ½ ãŒç”¨æ„ã•ã‚Œã¦ãŠã‚Šã€ $ rails g api_client path/to/resource get:path/to/resource ã‚’å®Ÿè¡Œã™ã‚‹ã¨ä»¥ä¸‹ã®ãƒ•ã‚¡ã‚¤ãƒ«ãŒä½œæˆã•ã‚Œã¾ã™ã€‚create  app/api_clients/application_api_client.rbcreate  app/api_clients/path/to/resource_api_client.rbinvoke  rspeccreate    spec/api_clients/path/to/resource_api_client_spec.rb` ã“ã®æ™‚ã€ application_api_client.rb ã«æ¨™æº–ã®ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒ©ã®ä¾‹ãŒã„ãã¤ã‹è¨˜è¼‰ã•ã‚Œã‚‹ã®ã§ã™ãŒã€ä¾‹ã¨ã„ã†ã‚ˆã‚Šå¿…é ˆã®ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒ©ã ã‚ˆã­ã€ã¨ã„ã†ã“ã¨ã§ã€ my_api_client ã®å†…éƒ¨ã§æ¨™æº–å®Ÿè£…ã™ã‚‹ã‚ˆã†ã«ã—ã¾ã—ãŸã€‚ã“ã‚Œã«ã‚ˆã‚Šã€ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚³ãƒ¼ãƒ‰ 4xx ã¨ 5xx ã®ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã«å¯¾ã—ã¦ã¯æ¨™æº–ã§ä¾‹å¤–ãŒç™ºç”Ÿã™ã‚‹ã‚ˆã†ãªã‚Šã¾ã™ã€‚ã¾ãŸã€ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ç³»ã®ã‚¨ãƒ©ãƒ¼ã«å¯¾ã—ã¦ã‚‚æ¨™æº–ã§ 300 msec é–“éš”ã‚’ç©ºã‘ã¦ 3 å›ãƒªãƒˆãƒ©ã‚¤ãŒè©¦è¡Œã•ã‚Œã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚ï¼ˆãƒªãƒˆãƒ©ã‚¤å‡¦ç†ã‚‚å¾“æ¥ã¯æ˜ç¤ºçš„ãªå®šç¾©ãŒå¿…é ˆã§ã—ãŸï¼‰# å¾“æ¥ã® `application_api_client.rb` ã«å‡ºåŠ›ã•ã‚Œã¦ã„ãŸæ¨™æº–ã®ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒ©ä¾‹error_handling status_code: 400..499, raise: MyApiClient::ClientErrorerror_handling status_code: 500..599, raise: MyApiClient::ServerError# å¾“æ¥ã® `application_api_client.rb` ã«å‡ºåŠ›ã•ã‚Œã¦ã„ãŸæ¨™æº–ã®ãƒªãƒˆãƒ©ã‚¤å‡¦ç†ä¾‹retry_on MyApiClient::NetworkError, wait: 5.seconds, attempts: 3æ¨™æº–ã§å®šç¾©ã•ã‚Œã¦ã„ã‚‹ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒ©ã¯ my_api_client/default_error_handlers.rb ã‹ã‚‰å‚ç…§ã§ãã¾ã™ã€‚error_handling ã¯å¾Œã‹ã‚‰å®šç¾©ã—ãŸç‰©ãŒå„ªå…ˆã•ã‚Œã¾ã™ã®ã§ã€ä¾‹ãˆã°ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚³ãƒ¼ãƒ‰ 400 ã«å¯¾ã—ã¦ã¯ç‹¬è‡ªã®ä¾‹å¤–ã‚¯ãƒ©ã‚¹ã‚’ç™ºç”Ÿã•ã›ã‚‹ã‚ˆã†ã«ã—ãŸã„å ´åˆã€ç¶™æ‰¿å…ˆã®ã‚¯ãƒ©ã‚¹ã§ error_handling status_code: 400, raise: MyErrorClass ã®ã‚ˆã†ã«å®šç¾©ã™ã‚Œã°ã€ MyErrorClass ãŒä¾‹å¤–ã¨ã—ã¦ç™ºç”Ÿã™ã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚æ‰€æ„Ÿç¤¾å†…ã®ãƒ—ãƒ­ãƒ€ã‚¯ãƒˆç”¨ã«ä½œã£ãŸ gem ã§ã™ãŒã€å°‘ã—ãšã¤è‡ªåˆ†ä»¥å¤–ã®ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ã‚‚åˆ©ç”¨ã—ã¦ãã‚Œã‚‹ã‚ˆã†ã«ãªã£ã¦ãã¾ã—ãŸã€‚ä¸€æ–¹ã§ã€è‡ªç”±åº¦ãŒé«˜éãã‚‹ã¨ç†ŸçŸ¥ã—ã¦ã„ãªã„ã¨ä½¿ãˆãªã„æ©Ÿèƒ½ãŒå¢—ãˆã¦ã—ã¾ã†ç‚¹ã‚’èª²é¡Œæ„Ÿã¨ã—ã¦æ„Ÿã˜ã‚‹ã‚ˆã†ã«ãªã£ã¦ãã¾ã—ãŸã€‚ãªã‚‹ã¹ãè‡ªç”±åº¦ã®é«˜ã„ gem ã‚’æ„è­˜ã—ã¤ã¤ã€æ¨™æº–ã®çŠ¶æ…‹ã§ã‚‚é«˜åº¦ãªæ©Ÿèƒ½ã®æ©æµã‚’å—ã‘ã‚‰ã‚Œã‚‹çŠ¶æ…‹ã‚’ç›®æŒ‡ã—ã¦ã„ããŸã„ã¨æ€ã„ã¾ã™ã€‚æã‚‰ãæ¬¡ã®æ–°æ©Ÿèƒ½ã¯ async/await ã£ã½ã„æ©Ÿèƒ½ã€ã¾ãŸã¯ sawyer gem ã®ä¾å­˜ã‹ã‚‰ã®è„±å´ãªã‚‹ã¨æ€ã„ã¾ã™ã€‚","link":"https://ryz310.hateblo.jp/entry/2020/03/29/220805","isoDate":"2020-03-29T13:08:05.000Z","dateMiliSeconds":1585487285000,"imageUrl":"https://cdn.blog.st-hatena.com/images/theme/og-image-1500.png","authorName":"ryz310"},{"title":"my_api_client v0.15.0 ã‚’ãƒªãƒªãƒ¼ã‚¹ã—ã¾ã—ãŸğŸš€","content":"<p>ãã®å‰ã« <code>v0.14.0</code> ã‚‚ãƒªãƒªãƒ¼ã‚¹ã—ã¦ã„ã‚‹ã®ã§ã™ãŒã€ã“ã¡ã‚‰ã¯<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%EA%A5%D5%A5%A1%A5%AF%A5%BF%A5%EA%A5%F3%A5%B0\">ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°</a>ã¨ Integration Test ã®å®Ÿè£…ã ã‘ã§æ–°æ©Ÿèƒ½ã¯ã‚ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚\nå·®åˆ†ãŒ <code>+2,799 -1,246</code> ã‚‚ã‚ã‚‹ã®ã§ä¸­èº«ã¯çµæ§‹æ›¸ãæ›ã‚ã£ã¦ã„ã¾ã™ã€‚</p>\n\n<p><a href=\"https://github.com/ryz310/my_api_client/releases/tag/v0.14.0\">Release v0.14.0 &middot; ryz310/my_api_client &middot; GitHub</a></p>\n\n<p>Integration Test ã§ã¯ <a href=\"https://rubyonjets.com/\">Ruby on Jets</a> ã‚’ä½¿ã£ã¦ <a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/AWS\">AWS</a> Lambda ã§ã‚µãƒ¼ãƒãƒ¼ã‚’å»ºã¦ã¦ã€CI ã§ã®ãƒ†ã‚¹ãƒˆã§ <code>my_api_client</code> ã‚’ä½¿ã£ã¦å®Ÿéš›ã« HTTP ãƒªã‚¯<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%A8%A5%B9\">ã‚¨ã‚¹</a>ãƒˆãŒæˆåŠŸã™ã‚‹ã“ã¨ã‚’ç¢ºèªã—ã¦ã„ã‚‹ã®ã§ã€<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%C7%A5%B0%A5%EC\">ãƒ‡ã‚°ãƒ¬</a>ã®å¿ƒé…ãŒéšåˆ†ã¨ç·©å’Œã•ã‚Œã¾ã—ãŸ ğŸ˜Œ</p>\n\n<h2>æ–°æ©Ÿèƒ½: Pagination <a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/API\">API</a> ã®ã‚µãƒãƒ¼ãƒˆ</h2>\n\n<p>ã“ã“ã‹ã‚‰ã¯ <code>v0.15.0</code> ã®è©±ã«ãªã‚Šã¾ã™ã€‚</p>\n\n<p><a href=\"https://github.com/ryz310/my_api_client/releases/tag/v0.15.0\">Release v0.15.0 &middot; ryz310/my_api_client &middot; GitHub</a></p>\n\n<p><code>v0.15.0</code> ã®ãƒ¡ã‚¤ãƒ³æ©Ÿèƒ½ãŒ Pagination <a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/API\">API</a> ã®ã‚µãƒãƒ¼ãƒˆã«ãªã‚Šã¾ã™ã€‚<a href=\"https://jsonapi.org/\">JSON:API</a> ã¨ã„ã†ã—ã£ã‹ã‚Šã¨ã—ãŸä»•æ§˜ã‚‚ã‚ã‚‹ã‚ˆã†ã§ã™ãŒã€ <code>my_api_client</code> ã§ã¯ãã“ã¾ã§å³å¯†ãªä»•æ§˜ã«å‰‡ã£ã¦ã„ã‚‹è¨³ã§ã¯ãªãã€ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã«å«ã¾ã‚Œã‚‹ URL ã‚’èªè­˜ã—ã¦ enumerable ã« HTTP ãƒªã‚¯<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%A8%A5%B9\">ã‚¨ã‚¹</a>ãƒˆã‚’å®Ÿè¡Œã™ã‚‹ã€ã¨ã„ã†ã–ã£ãã‚Šã—ãŸæ©Ÿèƒ½ã«ãªã‚Šã¾ã™ã€‚\nãƒ¬ã‚¹ãƒãƒ³ã‚¹ãƒ˜ãƒƒãƒ€ã® <code>Link</code> ãªã©ã§æ¬¡ã®ãƒšãƒ¼ã‚¸ã® URL ã‚’è¿”ã™ã‚±ãƒ¼ã‚¹ã‚‚ã‚ã‚‹ã‚ˆã†ã§ã™ãŒã€ãã¡ã‚‰ã¯ç¾æ™‚ç‚¹ã§ã¯æœªå¯¾å¿œã§ã™ ğŸ™</p>\n\n<p>Pagination <a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/API\">API</a> ã¨ã„ã†å˜èªã¯ <a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/Django\">Django</a> REST Framework ã® Pagination æ©Ÿèƒ½ã®èª¬æ˜ã§å‡ºã¦ãã¾ã™ã€‚</p>\n\n<p><iframe src=\"https://hatenablog-parts.com/embed?url=https%3A%2F%2Fwww.django-rest-framework.org%2Fapi-guide%2Fpagination%2F\" title=\"Pagination - Django REST framework\" class=\"embed-card embed-webcard\" scrolling=\"no\" frameborder=\"0\" style=\"display: block; width: 100%; height: 155px; max-width: 500px; margin: 10px 0px;\"></iframe><cite class=\"hatena-citation\"><a href=\"https://www.django-rest-framework.org/api-guide/pagination/\">www.django-rest-framework.org</a></cite></p>\n\n<p>è¦ã™ã‚‹ã«ä¸€åº¦ã®ãƒªã‚¯<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%A8%A5%B9\">ã‚¨ã‚¹</a>ãƒˆã§çµæœã‚’å…¨ä»¶å–å¾—ã•ã›ã‚‹ã®ã§ã¯ãªãã€ä¸€å®šã®ä»¶æ•°ã‚’è¿”å´ã—ã€ç¶šãã‚’å–å¾—ã§ãã‚‹ Link ã‚’ä¸€ç·’ã«è¿”å´ã™ã‚‹ <a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/API\">API</a> ã®ã“ã¨ã§ã™ã­ã€‚</p>\n\n<p><strong>Request:</strong></p>\n\n<pre class=\"code\" data-lang=\"\" data-unlink>GET https://api.example.org/accounts/?page=4</pre>\n\n\n<p><strong>Response:</strong></p>\n\n<pre class=\"code lang-json\" data-lang=\"json\" data-unlink><span class=\"synError\">HTTP</span> 200 <span class=\"synError\">OK</span>\n<span class=\"synSpecial\">{</span>\n    &quot;<span class=\"synStatement\">count</span>&quot;: 1023\n    &quot;<span class=\"synStatement\">next</span>&quot;: &quot;<span class=\"synConstant\">https://api.example.org/accounts/?page=5</span>&quot;,\n    &quot;<span class=\"synStatement\">previous</span>&quot;: &quot;<span class=\"synConstant\">https://api.example.org/accounts/?page=3</span>&quot;,\n    &quot;<span class=\"synStatement\">results</span>&quot;: <span class=\"synSpecial\">[</span>\n       â€¦\n    <span class=\"synSpecial\">]</span>\n<span class=\"synSpecial\">}</span>\n</pre>\n\n\n<h3>ä½¿ã„æ–¹</h3>\n\n<p><code>my_api_client</code> ã§ã®ä½¿ã„æ–¹ã¯ä»¥ä¸‹ã®ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚</p>\n\n<pre class=\"code lang-ruby\" data-lang=\"ruby\" data-unlink><span class=\"synPreProc\">class</span> <span class=\"synType\">MyPaginationApiClient</span> &lt; <span class=\"synType\">ApplicationApiClient</span>\n  endpoint <span class=\"synSpecial\">'</span><span class=\"synConstant\">https://example.com/v1</span><span class=\"synSpecial\">'</span>\n\n  <span class=\"synComment\"># GET pagination?page=1</span>\n  <span class=\"synPreProc\">def</span> <span class=\"synIdentifier\">pagination</span>\n    pageable_get <span class=\"synSpecial\">'</span><span class=\"synConstant\">pagination</span><span class=\"synSpecial\">'</span>, <span class=\"synConstant\">paging</span>: <span class=\"synSpecial\">'</span><span class=\"synConstant\">$.links.next</span><span class=\"synSpecial\">'</span>, <span class=\"synConstant\">headers</span>: headers, <span class=\"synConstant\">query</span>: { <span class=\"synConstant\">page</span>: <span class=\"synConstant\">1</span> }\n  <span class=\"synPreProc\">end</span>\n\n  <span class=\"synStatement\">private</span>\n\n  <span class=\"synPreProc\">def</span> <span class=\"synIdentifier\">headers</span>\n    { <span class=\"synSpecial\">'</span><span class=\"synConstant\">Content-Type</span><span class=\"synSpecial\">'</span>: <span class=\"synSpecial\">'</span><span class=\"synConstant\">application/json;charset=UTF-8</span><span class=\"synSpecial\">'</span> }\n  <span class=\"synPreProc\">end</span>\n<span class=\"synPreProc\">end</span>\n</pre>\n\n\n<p>é€šå¸¸ã§ã‚ã‚Œã° <code>#get</code> ã‚’ä½¿ã£ã¦ HTTP ãƒªã‚¯<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%A8%A5%B9\">ã‚¨ã‚¹</a>ãƒˆã‚’å®Ÿè¡Œã•ã›ã‚‹ã®ã§ã™ãŒã€ã“ã“ã§ã¯ <code>#pageable_get</code> ã¨ã„ã†ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ä½¿ç”¨ã—ã¦ã„ã¾ã™ã€‚ <code>#pageable_get</code> ã ã¨é•·ã„ã®ã§ <code>#pget</code> ã¨ã„ã†<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%A8%A5%A4%A5%EA%A5%A2%A5%B9\">ã‚¨ã‚¤ãƒªã‚¢ã‚¹</a>ã‚‚ç”¨æ„ã—ã¦ã„ã¾ã™ã€‚\nã¾ãŸã€ <code>paging</code> ã¨ã„ã†ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰å¼•æ•°ã‚‚æ–°ãŸã«å‡ºã¦ãã¾ã—ãŸã€‚ <code>paging</code> ã§ã¯ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã®ã©ã®éƒ¨åˆ†ã«æ¬¡ã®ãƒšãƒ¼ã‚¸ã® URL ãŒå«ã¾ã‚Œã‚‹ã‹ã‚’ JSONPath expression ã§æŒ‡å®šã—ã¾ã™ã€‚</p>\n\n<p><iframe src=\"https://hatenablog-parts.com/embed?url=https%3A%2F%2Fgoessner.net%2Farticles%2FJsonPath%2Findex.html%23e2\" title=\"JSONPath - XPath for JSON\" class=\"embed-card embed-webcard\" scrolling=\"no\" frameborder=\"0\" style=\"display: block; width: 100%; height: 155px; max-width: 500px; margin: 10px 0px;\"></iframe><cite class=\"hatena-citation\"><a href=\"https://goessner.net/articles/JsonPath/index.html#e2\">goessner.net</a></cite></p>\n\n<p>ä»¥ä¸‹ã®ã‚ˆã†ãª <a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/JSON\">JSON</a> ã§ã‚ã‚Œã°ã€ <code>$.links.next</code> ã¨ã„ã† JSONPath expression ã¯ <code>\"https://example.com/pagination?page=3\"</code> ã‚’å–å¾—ã—ã¾ã™ã€‚</p>\n\n<pre class=\"code lang-json\" data-lang=\"json\" data-unlink><span class=\"synSpecial\">{</span>\n  &quot;<span class=\"synStatement\">links</span>&quot;: <span class=\"synSpecial\">{</span>\n    &quot;<span class=\"synStatement\">next</span>&quot;: &quot;<span class=\"synConstant\">https://example.com/pagination?page=3</span>&quot;,\n    &quot;<span class=\"synStatement\">previous</span>&quot;: &quot;<span class=\"synConstant\">https://example.com/pagination?page=1</span>&quot;<span class=\"synError\">,</span>\n<span class=\"synError\">  }</span>,\n  &quot;<span class=\"synStatement\">page</span>&quot;: <span class=\"synConstant\">2</span>\n}\n</pre>\n\n\n<p>ä½œæˆã—ãŸ <a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/API\">API</a> Client ã¯ä»¥ä¸‹ã®ã‚ˆã†ã«ä½¿ç”¨ã§ãã¾ã™ã€‚</p>\n\n<pre class=\"code lang-ruby\" data-lang=\"ruby\" data-unlink>api_clinet = <span class=\"synType\">MyPaginationApiClient</span>.new\napi_clinet.pagination.each <span class=\"synStatement\">do</span> |<span class=\"synIdentifier\">response</span>|\n  <span class=\"synComment\"># Do something.</span>\n<span class=\"synStatement\">end</span>\n\np = api_clinet.pagination\np.next <span class=\"synComment\"># =&gt; 1st page result</span>\np.next <span class=\"synComment\"># =&gt; 2nd page result</span>\np.next <span class=\"synComment\"># =&gt; 3rd page result</span>\n</pre>\n\n\n<h3>çµæœã¯ <code>Enumerator::Lazy</code> ã§è¿”å´ã•ã‚Œã‚‹</h3>\n\n<p><code>#pageable_get</code> ã¯ <code>Enumerator::Lazy</code> ã‚’è¿”å´ã™ã‚‹ã®ã§ã€ <code>Enumerable</code> ã§å®šç¾©ã•ã‚Œã¦ã„ã‚‹ãƒ¡ã‚½ãƒƒãƒ‰ã¯ä¸€é€šã‚Šåˆ©ç”¨å¯èƒ½ã§ã™ã€‚</p>\n\n<p><iframe src=\"https://hatenablog-parts.com/embed?url=https%3A%2F%2Fdocs.ruby-lang.org%2Fja%2Flatest%2Fclass%2FEnumerator%3D3a%3D3aLazy.html\" title=\"class Enumerator::Lazy (Ruby 2.7.0 ãƒªãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹ãƒãƒ‹ãƒ¥ã‚¢ãƒ«)\" class=\"embed-card embed-webcard\" scrolling=\"no\" frameborder=\"0\" style=\"display: block; width: 100%; height: 155px; max-width: 500px; margin: 10px 0px;\"></iframe><cite class=\"hatena-citation\"><a href=\"https://docs.ruby-lang.org/ja/latest/class/Enumerator=3a=3aLazy.html\">docs.ruby-lang.org</a></cite></p>\n\n<p><code>Enumerator</code> ã§è¿”ã—ã¦ã—ã¾ã†ã¨ <code>#take</code> ã§ 100 ãƒšãƒ¼ã‚¸ç›®ã¾ã§çµæœã‚’å–å¾—ã™ã‚‹ã‚ˆã†ãªå‡¦ç†ã‚’è¨˜è¿°ã—ãŸã¨ãã«ã€</p>\n\n<ol>\n<li>100 ãƒšãƒ¼ã‚¸åˆ†ã® HTTP ãƒªã‚¯<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%A8%A5%B9\">ã‚¨ã‚¹</a>ãƒˆã‚’å®Ÿè¡Œ</li>\n<li>çµæœã‚’ <code>#each</code> ã§å›ã™</li>\n</ol>\n\n\n<p>ã¨ã„ã†å‹•ãã«ãªã‚Šã€ 100 å›åˆ†ã® HTTP ãƒªã‚¯<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%A8%A5%B9\">ã‚¨ã‚¹</a>ãƒˆãŒå®Œäº†ã™ã‚‹ã¾ã§æ¬¡ã®å‡¦ç†ã«ç§»ã‚‹ã“ã¨ãŒã§ãã¾ã›ã‚“ã€‚</p>\n\n<p><code>Enumerator::Lazy</code> ã§ã‚ã‚Œã°ã€</p>\n\n<ol>\n<li>1 ãƒšãƒ¼ã‚¸ç›®ã® HTTP ãƒªã‚¯<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%A8%A5%B9\">ã‚¨ã‚¹</a>ãƒˆã‚’å®Ÿè¡Œ</li>\n<li>çµæœã‚’å‡¦ç†ã™ã‚‹</li>\n<li>2ãƒšãƒ¼ã‚¸ç›®ã® HTTP ãƒªã‚¯<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%A8%A5%B9\">ã‚¨ã‚¹</a>ãƒˆã‚’å®Ÿè¡Œ</li>\n<li>çµæœã‚’å‡¦ç†ã™ã‚‹</li>\n<li>...</li>\n</ol>\n\n\n<p>ã¨ã„ã†å‹•ãã«ãªã£ã¦ãã‚Œã¾ã™ã€‚ä¾¿åˆ©ã§ã™ã­ âœ¨</p>\n\n<p><code>Enumerator</code> ã¨ <code>Enumerator::Lazy</code> ã®é•ã„ã¯ä»¥ä¸‹ã®è¨˜äº‹ãŒå‚è€ƒã«ãªã‚‹ã¨æ€ã„ã¾ã™ã€‚</p>\n\n<p><iframe src=\"https://hatenablog-parts.com/embed?url=https%3A%2F%2Fqiita.com%2Fgam0022%2Fitems%2F8acfc0c674b96060c03f\" title=\"Enumeratorã¨Enumerator::Lazyã®é•ã„ - Qiita\" class=\"embed-card embed-webcard\" scrolling=\"no\" frameborder=\"0\" style=\"display: block; width: 100%; height: 155px; max-width: 500px; margin: 10px 0px;\"></iframe><cite class=\"hatena-citation\"><a href=\"https://qiita.com/gam0022/items/8acfc0c674b96060c03f\">qiita.com</a></cite></p>\n","contentSnippet":"ãã®å‰ã« v0.14.0 ã‚‚ãƒªãƒªãƒ¼ã‚¹ã—ã¦ã„ã‚‹ã®ã§ã™ãŒã€ã“ã¡ã‚‰ã¯ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°ã¨ Integration Test ã®å®Ÿè£…ã ã‘ã§æ–°æ©Ÿèƒ½ã¯ã‚ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚å·®åˆ†ãŒ +2,799 -1,246 ã‚‚ã‚ã‚‹ã®ã§ä¸­èº«ã¯çµæ§‹æ›¸ãæ›ã‚ã£ã¦ã„ã¾ã™ã€‚Release v0.14.0 Â· ryz310/my_api_client Â· GitHubIntegration Test ã§ã¯ Ruby on Jets ã‚’ä½¿ã£ã¦ AWS Lambda ã§ã‚µãƒ¼ãƒãƒ¼ã‚’å»ºã¦ã¦ã€CI ã§ã®ãƒ†ã‚¹ãƒˆã§ my_api_client ã‚’ä½¿ã£ã¦å®Ÿéš›ã« HTTP ãƒªã‚¯ã‚¨ã‚¹ãƒˆãŒæˆåŠŸã™ã‚‹ã“ã¨ã‚’ç¢ºèªã—ã¦ã„ã‚‹ã®ã§ã€ãƒ‡ã‚°ãƒ¬ã®å¿ƒé…ãŒéšåˆ†ã¨ç·©å’Œã•ã‚Œã¾ã—ãŸ ğŸ˜Œæ–°æ©Ÿèƒ½: Pagination API ã®ã‚µãƒãƒ¼ãƒˆã“ã“ã‹ã‚‰ã¯ v0.15.0 ã®è©±ã«ãªã‚Šã¾ã™ã€‚Release v0.15.0 Â· ryz310/my_api_client Â· GitHubv0.15.0 ã®ãƒ¡ã‚¤ãƒ³æ©Ÿèƒ½ãŒ Pagination API ã®ã‚µãƒãƒ¼ãƒˆã«ãªã‚Šã¾ã™ã€‚JSON:API ã¨ã„ã†ã—ã£ã‹ã‚Šã¨ã—ãŸä»•æ§˜ã‚‚ã‚ã‚‹ã‚ˆã†ã§ã™ãŒã€ my_api_client ã§ã¯ãã“ã¾ã§å³å¯†ãªä»•æ§˜ã«å‰‡ã£ã¦ã„ã‚‹è¨³ã§ã¯ãªãã€ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã«å«ã¾ã‚Œã‚‹ URL ã‚’èªè­˜ã—ã¦ enumerable ã« HTTP ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’å®Ÿè¡Œã™ã‚‹ã€ã¨ã„ã†ã–ã£ãã‚Šã—ãŸæ©Ÿèƒ½ã«ãªã‚Šã¾ã™ã€‚ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãƒ˜ãƒƒãƒ€ã® Link ãªã©ã§æ¬¡ã®ãƒšãƒ¼ã‚¸ã® URL ã‚’è¿”ã™ã‚±ãƒ¼ã‚¹ã‚‚ã‚ã‚‹ã‚ˆã†ã§ã™ãŒã€ãã¡ã‚‰ã¯ç¾æ™‚ç‚¹ã§ã¯æœªå¯¾å¿œã§ã™ ğŸ™Pagination API ã¨ã„ã†å˜èªã¯ Django REST Framework ã® Pagination æ©Ÿèƒ½ã®èª¬æ˜ã§å‡ºã¦ãã¾ã™ã€‚www.django-rest-framework.orgè¦ã™ã‚‹ã«ä¸€åº¦ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆã§çµæœã‚’å…¨ä»¶å–å¾—ã•ã›ã‚‹ã®ã§ã¯ãªãã€ä¸€å®šã®ä»¶æ•°ã‚’è¿”å´ã—ã€ç¶šãã‚’å–å¾—ã§ãã‚‹ Link ã‚’ä¸€ç·’ã«è¿”å´ã™ã‚‹ API ã®ã“ã¨ã§ã™ã­ã€‚Request:GET https://api.example.org/accounts/?page=4Response:HTTP 200 OK{    \"count\": 1023    \"next\": \"https://api.example.org/accounts/?page=5\",    \"previous\": \"https://api.example.org/accounts/?page=3\",    \"results\": [       â€¦    ]}ä½¿ã„æ–¹my_api_client ã§ã®ä½¿ã„æ–¹ã¯ä»¥ä¸‹ã®ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚class MyPaginationApiClient < ApplicationApiClient  endpoint 'https://example.com/v1'  # GET pagination?page=1  def pagination    pageable_get 'pagination', paging: '$.links.next', headers: headers, query: { page: 1 }  end  private  def headers    { 'Content-Type': 'application/json;charset=UTF-8' }  endendé€šå¸¸ã§ã‚ã‚Œã° #get ã‚’ä½¿ã£ã¦ HTTP ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’å®Ÿè¡Œã•ã›ã‚‹ã®ã§ã™ãŒã€ã“ã“ã§ã¯ #pageable_get ã¨ã„ã†ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ä½¿ç”¨ã—ã¦ã„ã¾ã™ã€‚ #pageable_get ã ã¨é•·ã„ã®ã§ #pget ã¨ã„ã†ã‚¨ã‚¤ãƒªã‚¢ã‚¹ã‚‚ç”¨æ„ã—ã¦ã„ã¾ã™ã€‚ã¾ãŸã€ paging ã¨ã„ã†ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰å¼•æ•°ã‚‚æ–°ãŸã«å‡ºã¦ãã¾ã—ãŸã€‚ paging ã§ã¯ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã®ã©ã®éƒ¨åˆ†ã«æ¬¡ã®ãƒšãƒ¼ã‚¸ã® URL ãŒå«ã¾ã‚Œã‚‹ã‹ã‚’ JSONPath expression ã§æŒ‡å®šã—ã¾ã™ã€‚goessner.netä»¥ä¸‹ã®ã‚ˆã†ãª JSON ã§ã‚ã‚Œã°ã€ $.links.next ã¨ã„ã† JSONPath expression ã¯ \"https://example.com/pagination?page=3\" ã‚’å–å¾—ã—ã¾ã™ã€‚{  \"links\": {    \"next\": \"https://example.com/pagination?page=3\",    \"previous\": \"https://example.com/pagination?page=1\",  },  \"page\": 2}ä½œæˆã—ãŸ API Client ã¯ä»¥ä¸‹ã®ã‚ˆã†ã«ä½¿ç”¨ã§ãã¾ã™ã€‚api_clinet = MyPaginationApiClient.newapi_clinet.pagination.each do |response|  # Do something.endp = api_clinet.paginationp.next # => 1st page resultp.next # => 2nd page resultp.next # => 3rd page resultçµæœã¯ Enumerator::Lazy ã§è¿”å´ã•ã‚Œã‚‹#pageable_get ã¯ Enumerator::Lazy ã‚’è¿”å´ã™ã‚‹ã®ã§ã€ Enumerable ã§å®šç¾©ã•ã‚Œã¦ã„ã‚‹ãƒ¡ã‚½ãƒƒãƒ‰ã¯ä¸€é€šã‚Šåˆ©ç”¨å¯èƒ½ã§ã™ã€‚docs.ruby-lang.orgEnumerator ã§è¿”ã—ã¦ã—ã¾ã†ã¨ #take ã§ 100 ãƒšãƒ¼ã‚¸ç›®ã¾ã§çµæœã‚’å–å¾—ã™ã‚‹ã‚ˆã†ãªå‡¦ç†ã‚’è¨˜è¿°ã—ãŸã¨ãã«ã€100 ãƒšãƒ¼ã‚¸åˆ†ã® HTTP ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’å®Ÿè¡Œçµæœã‚’ #each ã§å›ã™ã¨ã„ã†å‹•ãã«ãªã‚Šã€ 100 å›åˆ†ã® HTTP ãƒªã‚¯ã‚¨ã‚¹ãƒˆãŒå®Œäº†ã™ã‚‹ã¾ã§æ¬¡ã®å‡¦ç†ã«ç§»ã‚‹ã“ã¨ãŒã§ãã¾ã›ã‚“ã€‚Enumerator::Lazy ã§ã‚ã‚Œã°ã€1 ãƒšãƒ¼ã‚¸ç›®ã® HTTP ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’å®Ÿè¡Œçµæœã‚’å‡¦ç†ã™ã‚‹2ãƒšãƒ¼ã‚¸ç›®ã® HTTP ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’å®Ÿè¡Œçµæœã‚’å‡¦ç†ã™ã‚‹...ã¨ã„ã†å‹•ãã«ãªã£ã¦ãã‚Œã¾ã™ã€‚ä¾¿åˆ©ã§ã™ã­ âœ¨Enumerator ã¨ Enumerator::Lazy ã®é•ã„ã¯ä»¥ä¸‹ã®è¨˜äº‹ãŒå‚è€ƒã«ãªã‚‹ã¨æ€ã„ã¾ã™ã€‚qiita.com","link":"https://ryz310.hateblo.jp/entry/2020/03/21/163849","isoDate":"2020-03-21T07:38:49.000Z","dateMiliSeconds":1584776329000,"imageUrl":"https://cdn.blog.st-hatena.com/images/theme/og-image-1500.png","authorName":"ryz310"},{"title":"é§†ã‘è¾¼ã¿ã§ Chrome 80 ã® SameSite=None; Secure ã®å¯¾å¿œã‚’ã‚„ã£ãŸğŸª","content":"<p>ã”å­˜çŸ¥ã®æ–¹ã‚‚å¤šã„ã‹ã¨æ€ã„ã¾ã™ãŒã€ <a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/Chrome\">Chrome</a> 80 ã‹ã‚‰ 3rd Party <a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/Cookie\">Cookie</a> ã®å–ã‚Šæ‰±ã„ãŒå³ã—ããªã‚Šã€ç‰¹ã«æŒ‡å®šãŒãªã„ã¨å¤–éƒ¨ã‚µã‚¤ãƒˆã® <a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/Cookie\">Cookie</a> ã¯ <strong>POSTãƒ»iframeãƒ»XHR ç­‰ã®ãƒªã‚¯<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%A8%A5%B9\">ã‚¨ã‚¹</a>ãƒˆ</strong>  ã§é€ã‚‰ã‚Œãªããªã‚Šã¾ã™ã€‚</p>\n\n<p><iframe src=\"https://hatenablog-parts.com/embed?url=https%3A%2F%2Fdevelopers-jp.googleblog.com%2F2019%2F11%2Fcookie-samesitenone-secure.html\" title=\"æ–°ã—ã„ Cookie è¨­å®š SameSite=None; Secure ã®æº–å‚™ã‚’å§‹ã‚ã¾ã—ã‚‡ã†\" class=\"embed-card embed-webcard\" scrolling=\"no\" frameborder=\"0\" style=\"display: block; width: 100%; height: 155px; max-width: 500px; margin: 10px 0px;\"></iframe><cite class=\"hatena-citation\"><a href=\"https://developers-jp.googleblog.com/2019/11/cookie-samesitenone-secure.html\">developers-jp.googleblog.com</a></cite></p>\n\n<blockquote><p>2 æœˆã® <a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/Chrome\">Chrome</a> 80 ä»¥é™ã€SameSite å€¤ãŒå®£è¨€ã•ã‚Œã¦ã„ãªã„ <a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/Cookie\">Cookie</a> ã¯ SameSite=Lax ã¨ã—ã¦æ‰±ã‚ã‚Œã¾ã™ã€‚å¤–éƒ¨ã‚¢ã‚¯ã‚»ã‚¹ã¯ã€SameSite=None; Secure è¨­å®šã®ã‚ã‚‹ <a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/Cookie\">Cookie</a> ã®ã¿å¯èƒ½ã«ãªã‚Šã¾ã™ã€‚ãŸã ã—ã€ã“ã‚Œã‚‰ãŒå®‰å…¨ãªæ¥ç¶šã‹ã‚‰ã‚¢ã‚¯ã‚»ã‚¹ã•ã‚Œã‚‹ã“ã¨ãŒæ¡ä»¶ã§ã™ã€‚</p></blockquote>\n\n<p>ã¨ã¯ã„ãˆå®Œå…¨ã«ç„¡åŠ¹ã«ãªã‚‹ã‚ã‘ã§ã¯ãªãã€ <code>SameSite</code> ã¨ã„ã†å±æ€§ãŒå®£è¨€ã•ã‚Œã¦ã„ãªã„ <a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/Cookie\">Cookie</a> ã¯ <code>Lax</code> ã¨ã„ã†åŒºåˆ†ãŒãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§é©ç”¨ã•ã‚Œã‚‹ã¨ã„ã†ç‰©ãªã®ã§ã€ã‚µãƒ¼ãƒãƒ¼ã‹ã‚‰è¿”ã™ <a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/Cookie\">Cookie</a> ã«å¯¾ã—ã¦æ˜ç¤ºçš„ã« <code>SameSite</code> ã‚’ <code>None</code> ã«æŒ‡å®šã—ã¦ã€ã‹ã¤ <code>Secure</code> ã¨ã„ã†å±æ€§ã‚’ä»˜ä¸ã™ã‚Œã°ã€å¾“æ¥ã©ãŠã‚Š <a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/Cookie\">Cookie</a> ãŒé€ä¿¡ã•ã‚Œã¾ã™ã€‚</p>\n\n<p>å»å¹´ã®ç§‹ãã‚‰ã„ã«ã‚‚ã“ã® <a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/Cookie\">Cookie</a> ã®å¯¾å¿œãŒå¿…è¦ã‹ã©ã†ã‹ã€ä¼šç¤¾ã§èª¿æŸ»ã—ã¦ã„ãŸã‚“ã§ã™ãŒã€ãã®æ™‚ç‚¹ã§ã¯å½±éŸ¿ã‚’å—ã‘ã‚‹ç®‡æ‰€ãŒç„¡ãã¦ã€ç‰¹ã«ä½•ã‚‚å¯¾å¿œã›ãšã«ã‚¹ãƒ«ãƒ¼ã—ã¦ã„ãŸã‚“ã§ã™ãŒã€ç¾åœ¨é–‹ç™ºã—ã¦ã‚‹æ–°æ©Ÿèƒ½ãŒ<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A4%BF%A4%DE%A4%BF%A4%DE%A4%B3\">ãŸã¾ãŸã¾ã“</a>ã®å½±éŸ¿ã‚’å—ã‘ã‚‹æ©Ÿèƒ½ã ã£ãŸãŸã‚ã€æ€¥é½å¯¾å¿œã™ã‚‹ã“ã¨ã«ãªã‚Šã¾ã—ãŸã€‚</p>\n\n<p>çµæ§‹å³ã—ã„ãªã€ã¨æ€ã£ãŸã®ã¯ã€ã“ã‚ŒãŒåŸå› ã§å‹•ã‹ãªã„ã“ã¨ã«æ°—ä»˜ãã®ãŒçµæ§‹é›£ã—ã„ã‚“ã§ã™ã‚ˆã­ã€‚\n<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%B7%A5%F3%A5%B0%A5%EB%A5%B5%A5%A4%A5%F3%A5%AA%A5%F3\">ã‚·ãƒ³ã‚°ãƒ«ã‚µã‚¤ãƒ³ã‚ªãƒ³</a>ã¿ãŸã„ãªæ©Ÿèƒ½ã‚’ä½œã£ã¦ã‚‹ã¨<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%C9%A5%E1%A5%A4%A5%F3\">ãƒ‰ãƒ¡ã‚¤ãƒ³</a>ãŒç•°ãªã‚‹ã®ã§ 3rd Party <a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/Cookie\">Cookie</a> ã®æ‰±ã„ã«ãªã‚Šã¾ã™ã€‚\nãã—ã¦ <a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/Cookie\">Cookie</a> ã«å…¥ã£ã¦ã„ã‚‹ã¯ãšã® Session ID ãŒé€ã‚‰ã‚Œã¦ã“ãªã„ã®ã§ã€ã‚µãƒ¼ãƒãƒ¼å´ã§ Session ãŒè¦‹ã¤ã‹ã‚‰ãšã«ã‚¨ãƒ©ãƒ¼ã€‚</p>\n\n<p>è‡ªåˆ†ã®æ‰‹å…ƒã® <a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/Chrome\">Chrome</a> ã¯ 79 ã§ã€ã¾ã ä¸Šè¨˜ã®åˆ¶é™ãŒå…¥ã£ã¦ã„ãªã‹ã£ãŸã‚“ã§ã™ãŒã€ä»¥å‰å½±éŸ¿ç¯„å›²ã‚’èª¿æŸ»ã—ãŸæ™‚ã« <code>chrome://flags</code> ã‹ã‚‰æœ‰åŠ¹ã«ã™ã‚‹ãƒ•ãƒ©ã‚°ã‚’ ON ã«ã—ã¦ã„ãŸã®ã§ã€ä»–ã®ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ã®ç’°å¢ƒã§ã¯å‹•ä½œã™ã‚‹ã‘ã©ã€è‡ªåˆ†ã ã‘å‹•ã‹ãªã„ã¨ã„ã†ã“ã¨ã«ãªã‚Šã€ã‚‚ã—ã‹ã—ã¦ã€ã¨æ€ã£ã¦æ°—ä»˜ã„ãŸæ„Ÿã˜ã§ã™ã€‚</p>\n\n<p>ãƒªãƒªãƒ¼ã‚¹å¾Œã«æ°—ä»˜ã„ã¦ãŸã‚‰ãƒ¤ãƒã‹ã£ãŸã§ã™ã­ã€‚ã€‚</p>\n\n<p>ã§ã€ã“ã†ã„ã†å•é¡Œã¯ <a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/Rails\">Rails</a> ã¿ãŸã„ãª<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%D5%A5%EC%A1%BC%A5%E0%A5%EF%A1%BC%A5%AF\">ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯</a>ã§å¯¾å¿œã—ã¦ãã‚Œã‚ˆã£ã¦æ°—æŒã¡ã«ãªã‚‹ã‚“ã§ã™ãŒã€ã¡ã‚ƒã‚“ã¨å¯¾å¿œã™ã‚‹ PR ã¯ä½œã‚‰ã‚Œã¦ã„ã¦ã€ã™ã§ã« merge ã‚‚ã•ã‚Œã¦ã„ã¾ã™ã€‚</p>\n\n<p><iframe src=\"https://hatenablog-parts.com/embed?url=https%3A%2F%2Fgithub.com%2Frails%2Frails%2Fpull%2F28297\" title=\"Add SameSite to Cookies by cfabianski Â· Pull Request #28297 Â· rails/rails\" class=\"embed-card embed-webcard\" scrolling=\"no\" frameborder=\"0\" style=\"display: block; width: 100%; height: 155px; max-width: 500px; margin: 10px 0px;\"></iframe><cite class=\"hatena-citation\"><a href=\"https://github.com/rails/rails/pull/28297\">github.com</a></cite></p>\n\n<p>ã§ã™ãŒã€ 2020/2/20 ç¾åœ¨ã€ã“ã‚Œã‚’åæ˜ ã—ãŸ <a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/Rails\">Rails</a> ã¯ã¾ã ãƒªãƒªãƒ¼ã‚¹ã•ã‚Œã¦ã„ãªã„ã¿ãŸã„ã§ã™ã­ã€‚ï¼ˆæœ€æ–°ãŒ 2019/12/19 ã«ãƒªãƒªãƒ¼ã‚¹ã•ã‚ŒãŸ <code>6.0.2.1</code> ï¼‰\nã¾ãŸã€ <a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/Rails\">Rails</a> 5.2 ã«åæ˜ ã•ã‚Œã‚‹ã‹ã©ã†ã‹ã¯å¾®å¦™ãªæ„Ÿã˜ã«ãªã£ã¦ã„ã¾ã™ã€‚</p>\n\n<p><a href=\"https://github.com/rails/rails/pull/28297#issuecomment-577414543\">https://github.com/rails/rails/pull/28297#issuecomment-577414543</a></p>\n\n<blockquote><p>We will backport to 6.0 as a bug fix, but I don't know this warrants a backport to a security only release like 5.2. <a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/Rails\">Rails</a> 6.0 was released 6 months ago, and upgrading applications could be high, high priority if that problem is so important.</p>\n\n<p>ãƒã‚°ä¿®æ­£ã¨ã—ã¦6.0ã«ãƒãƒƒã‚¯ãƒãƒ¼ãƒˆã—ã¾ã™ãŒã€ã“ã‚ŒãŒ5.2ã®ã‚ˆã†ãªã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã®ã¿ã®ãƒªãƒªãƒ¼ã‚¹ã¸ã®ãƒãƒƒã‚¯ãƒãƒ¼ãƒˆã‚’ä¿è¨¼ã™ã‚‹ã‹ã©ã†ã‹ã‚ã‹ã‚Šã¾ã›ã‚“ã€‚ <a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/Rails\">Rails</a> 6.0ã¯6ã‹æœˆå‰ã«ãƒªãƒªãƒ¼ã‚¹ã•ã‚Œã¾ã—ãŸã€‚ãã®å•é¡ŒãŒéå¸¸ã«é‡è¦ãªå ´åˆã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ã‚¢ãƒƒãƒ—ã‚°ãƒ¬ãƒ¼ãƒ‰ã¯å„ªå…ˆåº¦ãŒé«˜ããªã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚</p></blockquote>\n\n<p>è‡ªåˆ†ã®é–‹ç™ºç’°å¢ƒã¯æ¥ãšã‹ã—ãªãŒã‚‰ <a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/Rails\">Rails</a> 4.2 ï¼ˆä»Šå¹´ä¸­ã«ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆã—ã¾ã™ï¼ï¼‰ãªã®ã§ã€å½“ç„¶åæ˜ ã•ã‚Œã‚‹ã¯ãšã‚‚ãªã„ã®ã§ã€è‡ªå‰ã§ Rack ã‚’ä½œæˆã—ã¦å¯¾å¿œã—ã¾ã—ãŸã€‚\nå‚è€ƒã¾ã§ä»¥ä¸‹ã®ã‚ˆã†ãªã‚³ãƒ¼ãƒ‰ã«ãªã‚Šã¾ã™ã€‚</p>\n\n<pre class=\"code lang-ruby\" data-lang=\"ruby\" data-unlink><span class=\"synComment\"># config/initializers/custom_rack_middleware.rb</span>\n\n<span class=\"synComment\"># </span><span class=\"synTodo\">NOTE</span><span class=\"synComment\">: Rails 6.0.x ã§ã‚ã‚Œã°ä»¥ä¸‹ã®å‡¦ç†ã¯ä¸è¦ã¨ãªã‚‹ã€‚</span>\n<span class=\"synType\">Rails</span>.application.config.middleware.insert_before(\n  <span class=\"synType\">ActionDispatch</span>::<span class=\"synType\">Cookies</span>,\n  <span class=\"synType\">CustomRackMiddleware</span>::<span class=\"synType\">SetSameSiteOptionOnCookie</span>\n)\n</pre>\n\n\n\n\n<pre class=\"code lang-ruby\" data-lang=\"ruby\" data-unlink><span class=\"synComment\"># lib/custom_rack_middleware/set_same_site_option_on_cookie.rb</span>\n\n<span class=\"synComment\"># </span><span class=\"synTodo\">TODO</span><span class=\"synComment\">: Rails 6.0.x ã«ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆã—ãŸã‚‰å‰Šé™¤ã™ã‚‹</span>\n<span class=\"synPreProc\">module</span> <span class=\"synType\">CustomRackMiddleware</span>\n  <span class=\"synPreProc\">class</span> <span class=\"synType\">SetSameSiteOptionOnCookie</span>\n    <span class=\"synPreProc\">def</span> <span class=\"synIdentifier\">initialize</span>(app)\n      <span class=\"synIdentifier\">@app</span> = app\n    <span class=\"synPreProc\">end</span>\n\n    <span class=\"synPreProc\">def</span> <span class=\"synIdentifier\">call</span>(env)\n      status, headers, body = <span class=\"synIdentifier\">@app</span>.call(env)\n\n      cookies = headers[<span class=\"synSpecial\">'</span><span class=\"synConstant\">Set-Cookie</span><span class=\"synSpecial\">'</span>]\n      <span class=\"synStatement\">if</span> cookies.present?\n        processed_cookies = cookies.split(<span class=\"synSpecial\">&quot;\\n&quot;</span>).map <span class=\"synStatement\">do</span> |<span class=\"synIdentifier\">cookie</span>|\n          <span class=\"synSpecial\">&quot;#{</span>cookie<span class=\"synSpecial\">}</span><span class=\"synConstant\">; SameSite=None; Secure</span><span class=\"synSpecial\">&quot;</span>\n        <span class=\"synStatement\">end</span>\n        headers[<span class=\"synSpecial\">'</span><span class=\"synConstant\">Set-Cookie</span><span class=\"synSpecial\">'</span>] = processed_cookies.join(<span class=\"synSpecial\">&quot;\\n&quot;</span>)\n      <span class=\"synStatement\">end</span>\n\n      [status, headers, body]\n    <span class=\"synPreProc\">end</span>\n  <span class=\"synPreProc\">end</span>\n<span class=\"synPreProc\">end</span>\n</pre>\n\n\n<p><strong>2020/02/22 è¿½è¨˜</strong></p>\n\n<p>ãƒ­ãƒ¼ã‚«ãƒ«ã®é–‹ç™ºç’°å¢ƒãªã© HTTP ãƒªã‚¯<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%A8%A5%B9\">ã‚¨ã‚¹</a>ãƒˆã‚’ã™ã‚‹ç’°å¢ƒã ã¨ã€ <code>SameSite=None</code> ã®è¨­å®šã‚’å…¥ã‚Œã‚‹ã¨ <a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/Cookie\">Cookie</a> ãŒé€ã‚‰ã‚Œãªããªã‚‹ã‚ˆã†ã§ã™ã€‚</p>\n\n<p>ãƒ­ãƒ¼ã‚«ãƒ«ã§ã¯ä¸Šè¿°ã® Rack ã‚’èª­ã¿è¾¼ã¾ã›ãªã„ã‚ˆã†ã«ã™ã‚‹ãªã©ã®å·¥å¤«ãŒå¿…è¦ã ã¨æ€ã„ã¾ã™ã€‚</p>\n","contentSnippet":"ã”å­˜çŸ¥ã®æ–¹ã‚‚å¤šã„ã‹ã¨æ€ã„ã¾ã™ãŒã€ Chrome 80 ã‹ã‚‰ 3rd Party Cookie ã®å–ã‚Šæ‰±ã„ãŒå³ã—ããªã‚Šã€ç‰¹ã«æŒ‡å®šãŒãªã„ã¨å¤–éƒ¨ã‚µã‚¤ãƒˆã® Cookie ã¯ POSTãƒ»iframeãƒ»XHR ç­‰ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆ  ã§é€ã‚‰ã‚Œãªããªã‚Šã¾ã™ã€‚developers-jp.googleblog.com2 æœˆã® Chrome 80 ä»¥é™ã€SameSite å€¤ãŒå®£è¨€ã•ã‚Œã¦ã„ãªã„ Cookie ã¯ SameSite=Lax ã¨ã—ã¦æ‰±ã‚ã‚Œã¾ã™ã€‚å¤–éƒ¨ã‚¢ã‚¯ã‚»ã‚¹ã¯ã€SameSite=None; Secure è¨­å®šã®ã‚ã‚‹ Cookie ã®ã¿å¯èƒ½ã«ãªã‚Šã¾ã™ã€‚ãŸã ã—ã€ã“ã‚Œã‚‰ãŒå®‰å…¨ãªæ¥ç¶šã‹ã‚‰ã‚¢ã‚¯ã‚»ã‚¹ã•ã‚Œã‚‹ã“ã¨ãŒæ¡ä»¶ã§ã™ã€‚ã¨ã¯ã„ãˆå®Œå…¨ã«ç„¡åŠ¹ã«ãªã‚‹ã‚ã‘ã§ã¯ãªãã€ SameSite ã¨ã„ã†å±æ€§ãŒå®£è¨€ã•ã‚Œã¦ã„ãªã„ Cookie ã¯ Lax ã¨ã„ã†åŒºåˆ†ãŒãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§é©ç”¨ã•ã‚Œã‚‹ã¨ã„ã†ç‰©ãªã®ã§ã€ã‚µãƒ¼ãƒãƒ¼ã‹ã‚‰è¿”ã™ Cookie ã«å¯¾ã—ã¦æ˜ç¤ºçš„ã« SameSite ã‚’ None ã«æŒ‡å®šã—ã¦ã€ã‹ã¤ Secure ã¨ã„ã†å±æ€§ã‚’ä»˜ä¸ã™ã‚Œã°ã€å¾“æ¥ã©ãŠã‚Š Cookie ãŒé€ä¿¡ã•ã‚Œã¾ã™ã€‚å»å¹´ã®ç§‹ãã‚‰ã„ã«ã‚‚ã“ã® Cookie ã®å¯¾å¿œãŒå¿…è¦ã‹ã©ã†ã‹ã€ä¼šç¤¾ã§èª¿æŸ»ã—ã¦ã„ãŸã‚“ã§ã™ãŒã€ãã®æ™‚ç‚¹ã§ã¯å½±éŸ¿ã‚’å—ã‘ã‚‹ç®‡æ‰€ãŒç„¡ãã¦ã€ç‰¹ã«ä½•ã‚‚å¯¾å¿œã›ãšã«ã‚¹ãƒ«ãƒ¼ã—ã¦ã„ãŸã‚“ã§ã™ãŒã€ç¾åœ¨é–‹ç™ºã—ã¦ã‚‹æ–°æ©Ÿèƒ½ãŒãŸã¾ãŸã¾ã“ã®å½±éŸ¿ã‚’å—ã‘ã‚‹æ©Ÿèƒ½ã ã£ãŸãŸã‚ã€æ€¥é½å¯¾å¿œã™ã‚‹ã“ã¨ã«ãªã‚Šã¾ã—ãŸã€‚çµæ§‹å³ã—ã„ãªã€ã¨æ€ã£ãŸã®ã¯ã€ã“ã‚ŒãŒåŸå› ã§å‹•ã‹ãªã„ã“ã¨ã«æ°—ä»˜ãã®ãŒçµæ§‹é›£ã—ã„ã‚“ã§ã™ã‚ˆã­ã€‚ã‚·ãƒ³ã‚°ãƒ«ã‚µã‚¤ãƒ³ã‚ªãƒ³ã¿ãŸã„ãªæ©Ÿèƒ½ã‚’ä½œã£ã¦ã‚‹ã¨ãƒ‰ãƒ¡ã‚¤ãƒ³ãŒç•°ãªã‚‹ã®ã§ 3rd Party Cookie ã®æ‰±ã„ã«ãªã‚Šã¾ã™ã€‚ãã—ã¦ Cookie ã«å…¥ã£ã¦ã„ã‚‹ã¯ãšã® Session ID ãŒé€ã‚‰ã‚Œã¦ã“ãªã„ã®ã§ã€ã‚µãƒ¼ãƒãƒ¼å´ã§ Session ãŒè¦‹ã¤ã‹ã‚‰ãšã«ã‚¨ãƒ©ãƒ¼ã€‚è‡ªåˆ†ã®æ‰‹å…ƒã® Chrome ã¯ 79 ã§ã€ã¾ã ä¸Šè¨˜ã®åˆ¶é™ãŒå…¥ã£ã¦ã„ãªã‹ã£ãŸã‚“ã§ã™ãŒã€ä»¥å‰å½±éŸ¿ç¯„å›²ã‚’èª¿æŸ»ã—ãŸæ™‚ã« chrome://flags ã‹ã‚‰æœ‰åŠ¹ã«ã™ã‚‹ãƒ•ãƒ©ã‚°ã‚’ ON ã«ã—ã¦ã„ãŸã®ã§ã€ä»–ã®ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ã®ç’°å¢ƒã§ã¯å‹•ä½œã™ã‚‹ã‘ã©ã€è‡ªåˆ†ã ã‘å‹•ã‹ãªã„ã¨ã„ã†ã“ã¨ã«ãªã‚Šã€ã‚‚ã—ã‹ã—ã¦ã€ã¨æ€ã£ã¦æ°—ä»˜ã„ãŸæ„Ÿã˜ã§ã™ã€‚ãƒªãƒªãƒ¼ã‚¹å¾Œã«æ°—ä»˜ã„ã¦ãŸã‚‰ãƒ¤ãƒã‹ã£ãŸã§ã™ã­ã€‚ã€‚ã§ã€ã“ã†ã„ã†å•é¡Œã¯ Rails ã¿ãŸã„ãªãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã§å¯¾å¿œã—ã¦ãã‚Œã‚ˆã£ã¦æ°—æŒã¡ã«ãªã‚‹ã‚“ã§ã™ãŒã€ã¡ã‚ƒã‚“ã¨å¯¾å¿œã™ã‚‹ PR ã¯ä½œã‚‰ã‚Œã¦ã„ã¦ã€ã™ã§ã« merge ã‚‚ã•ã‚Œã¦ã„ã¾ã™ã€‚github.comã§ã™ãŒã€ 2020/2/20 ç¾åœ¨ã€ã“ã‚Œã‚’åæ˜ ã—ãŸ Rails ã¯ã¾ã ãƒªãƒªãƒ¼ã‚¹ã•ã‚Œã¦ã„ãªã„ã¿ãŸã„ã§ã™ã­ã€‚ï¼ˆæœ€æ–°ãŒ 2019/12/19 ã«ãƒªãƒªãƒ¼ã‚¹ã•ã‚ŒãŸ 6.0.2.1 ï¼‰ã¾ãŸã€ Rails 5.2 ã«åæ˜ ã•ã‚Œã‚‹ã‹ã©ã†ã‹ã¯å¾®å¦™ãªæ„Ÿã˜ã«ãªã£ã¦ã„ã¾ã™ã€‚https://github.com/rails/rails/pull/28297#issuecomment-577414543We will backport to 6.0 as a bug fix, but I don't know this warrants a backport to a security only release like 5.2. Rails 6.0 was released 6 months ago, and upgrading applications could be high, high priority if that problem is so important.ãƒã‚°ä¿®æ­£ã¨ã—ã¦6.0ã«ãƒãƒƒã‚¯ãƒãƒ¼ãƒˆã—ã¾ã™ãŒã€ã“ã‚ŒãŒ5.2ã®ã‚ˆã†ãªã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã®ã¿ã®ãƒªãƒªãƒ¼ã‚¹ã¸ã®ãƒãƒƒã‚¯ãƒãƒ¼ãƒˆã‚’ä¿è¨¼ã™ã‚‹ã‹ã©ã†ã‹ã‚ã‹ã‚Šã¾ã›ã‚“ã€‚ Rails 6.0ã¯6ã‹æœˆå‰ã«ãƒªãƒªãƒ¼ã‚¹ã•ã‚Œã¾ã—ãŸã€‚ãã®å•é¡ŒãŒéå¸¸ã«é‡è¦ãªå ´åˆã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ã‚¢ãƒƒãƒ—ã‚°ãƒ¬ãƒ¼ãƒ‰ã¯å„ªå…ˆåº¦ãŒé«˜ããªã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚è‡ªåˆ†ã®é–‹ç™ºç’°å¢ƒã¯æ¥ãšã‹ã—ãªãŒã‚‰ Rails 4.2 ï¼ˆä»Šå¹´ä¸­ã«ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆã—ã¾ã™ï¼ï¼‰ãªã®ã§ã€å½“ç„¶åæ˜ ã•ã‚Œã‚‹ã¯ãšã‚‚ãªã„ã®ã§ã€è‡ªå‰ã§ Rack ã‚’ä½œæˆã—ã¦å¯¾å¿œã—ã¾ã—ãŸã€‚å‚è€ƒã¾ã§ä»¥ä¸‹ã®ã‚ˆã†ãªã‚³ãƒ¼ãƒ‰ã«ãªã‚Šã¾ã™ã€‚# config/initializers/custom_rack_middleware.rb# NOTE: Rails 6.0.x ã§ã‚ã‚Œã°ä»¥ä¸‹ã®å‡¦ç†ã¯ä¸è¦ã¨ãªã‚‹ã€‚Rails.application.config.middleware.insert_before(  ActionDispatch::Cookies,  CustomRackMiddleware::SetSameSiteOptionOnCookie)# lib/custom_rack_middleware/set_same_site_option_on_cookie.rb# TODO: Rails 6.0.x ã«ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆã—ãŸã‚‰å‰Šé™¤ã™ã‚‹module CustomRackMiddleware  class SetSameSiteOptionOnCookie    def initialize(app)      @app = app    end    def call(env)      status, headers, body = @app.call(env)      cookies = headers['Set-Cookie']      if cookies.present?        processed_cookies = cookies.split(\"\\n\").map do |cookie|          \"#{cookie}; SameSite=None; Secure\"        end        headers['Set-Cookie'] = processed_cookies.join(\"\\n\")      end      [status, headers, body]    end  endend2020/02/22 è¿½è¨˜ãƒ­ãƒ¼ã‚«ãƒ«ã®é–‹ç™ºç’°å¢ƒãªã© HTTP ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’ã™ã‚‹ç’°å¢ƒã ã¨ã€ SameSite=None ã®è¨­å®šã‚’å…¥ã‚Œã‚‹ã¨ Cookie ãŒé€ã‚‰ã‚Œãªããªã‚‹ã‚ˆã†ã§ã™ã€‚ãƒ­ãƒ¼ã‚«ãƒ«ã§ã¯ä¸Šè¿°ã® Rack ã‚’èª­ã¿è¾¼ã¾ã›ãªã„ã‚ˆã†ã«ã™ã‚‹ãªã©ã®å·¥å¤«ãŒå¿…è¦ã ã¨æ€ã„ã¾ã™ã€‚","link":"https://ryz310.hateblo.jp/entry/2020/02/20/235548","isoDate":"2020-02-20T14:55:48.000Z","dateMiliSeconds":1582210548000,"imageUrl":"https://cdn.blog.st-hatena.com/images/theme/og-image-1500.png","authorName":"ryz310"},{"title":"my_api_client v0.13.0 ã‚’ãƒªãƒªãƒ¼ã‚¹ã—ã¾ã—ãŸğŸš€","content":"<p><a href=\"https://ryz310.hateblo.jp/entry/2020/01/19/152826\">ã¤ã„å…ˆæ—¥ã€v0.12.0 ã‚’ãƒªãƒªãƒ¼ã‚¹ã—ãŸã°ã‹ã‚Š</a> ã§ã™ãŒã€ v0.13.0 ã‚’ãƒªãƒªãƒ¼ã‚¹ã—ã¾ã—ãŸã®ã§ã€å«ã¾ã‚Œã‚‹ PR ã®å†…å®¹ã«ã¤ã„ã¦è§£èª¬ã—ã¦ã„ãã¾ã™ã€‚ ã‚ˆã‚Šè©³ã—ã„ä½¿ã„æ–¹ã¯ <a href=\"https://github.com/ryz310/my_api_client/blob/master/README.jp.md\">README.jp.md</a> ã‚’ã”å‚ç…§ãã ã•ã„ã€‚</p>\n\n<p><iframe src=\"https://hatenablog-parts.com/embed?url=https%3A%2F%2Fgithub.com%2Fryz310%2Fmy_api_client%2Fblob%2Fmaster%2FCHANGELOG.md%23v0130-jan-21-2020\" title=\"ryz310/my_api_client\" class=\"embed-card embed-webcard\" scrolling=\"no\" frameborder=\"0\" style=\"display: block; width: 100%; height: 155px; max-width: 500px; margin: 10px 0px;\"></iframe><cite class=\"hatena-citation\"><a href=\"https://github.com/ryz310/my_api_client/blob/master/CHANGELOG.md#v0130-jan-21-2020\">github.com</a></cite></p>\n\n<h2><a href=\"https://github.com/ryz310/my_api_client/pull/180\">#180</a> Stub response on raising error (<a href=\"https://github.com/ryz310\">@ryz310</a>)</h2>\n\n<p>ä»Šå›ã¯ã“ã® PR ã®ã¿ã®æ›´æ–°ã§ã™ã€‚\nä»•äº‹ã§ spec æ›¸ã„ã¦ã‚‹æœ€ä¸­ã«ã€Œ<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/API\">API</a> ãƒªã‚¯<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%A8%A5%B9\">ã‚¨ã‚¹</a>ãƒˆã§ä¾‹å¤–ãŒç™ºç”Ÿã—ãŸéš›ã«ãƒ¬ã‚¹ãƒãƒ³ã‚¹å†…å®¹ã‚’ä¿å­˜ã™ã‚‹å‡¦ç†ã®ã‚¹ã‚¿ãƒ–åŒ–ã§ããªã„ã˜ã‚ƒã‚“ã€ã£ã¦ãªã£ã¦ä½œã‚Šã¾ã—ãŸã€‚</p>\n\n<p><code>my_api_client</code> ã§ã¯ä½œæˆã—ãŸ <a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/API\">API</a> Client ã‚¯ãƒ©ã‚¹ã‚’ <code>stub_api_client</code> ã¾ãŸã¯ <code>stub_api_client_all</code> ã¨ã„ã†ãƒ¡ã‚½ãƒƒãƒ‰ã§ã‚¹ã‚¿ãƒ–åŒ–ã§ãã¾ã™ã€‚\nä¾‹ãˆã°ä»¥ä¸‹ã®ã‚ˆã†ãª <code>ExampleApiClient</code> ã¨ã„ã†ã‚¯ãƒ©ã‚¹ã‚’å®šç¾©ã—ãŸæ™‚:</p>\n\n<pre class=\"code lang-ruby\" data-lang=\"ruby\" data-unlink><span class=\"synPreProc\">class</span> <span class=\"synType\">ExampleApiClient</span> &lt; <span class=\"synType\">MyApiClient</span>::<span class=\"synType\">Base</span>\n  endpoint <span class=\"synSpecial\">'</span><span class=\"synConstant\">https://example.com</span><span class=\"synSpecial\">'</span>\n\n  error_handling <span class=\"synConstant\">status_code</span>: <span class=\"synConstant\">400</span>..<span class=\"synConstant\">499</span>, <span class=\"synConstant\">raise</span>: <span class=\"synType\">MyApiClient</span>::<span class=\"synType\">ClientError</span>\n  error_handling <span class=\"synConstant\">status_code</span>: <span class=\"synConstant\">500</span>..<span class=\"synConstant\">599</span>, <span class=\"synConstant\">raise</span>: <span class=\"synType\">MyApiClient</span>::<span class=\"synType\">ServerError</span>\n\n  <span class=\"synComment\"># GET https://example.com/path/to/resouce</span>\n  <span class=\"synPreProc\">def</span> <span class=\"synIdentifier\">request</span>\n     get <span class=\"synSpecial\">'</span><span class=\"synConstant\">path/to/resouce</span><span class=\"synSpecial\">'</span>\n  <span class=\"synPreProc\">end</span>\n<span class=\"synPreProc\">end</span>\n</pre>\n\n\n<p><code>stub_api_client_all</code> ã‚’å®Ÿè¡Œã™ã‚‹ã¨ <code>ExampleApiClient</code> ã®<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%A4%A5%F3%A5%B9%A5%BF%A5%F3%A5%B9\">ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹</a>ãŒå…¨ã¦ã‚¹ã‚¿ãƒ–åŒ–ã•ã‚Œã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚\nä»¥ä¸‹ã®ä¾‹ã ã¨ã€ <code>#request</code> ã‚’å®Ÿè¡Œã—ãŸæ™‚ã€<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/API\">API</a> ã‹ã‚‰ <code>{ \"message\": \"Hello world!\" }</code> ã¨ã„ã† <a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/JSON\">JSON</a> ãŒè¿”ã£ã¦ããŸæ™‚ã¨åŒã˜æŒ¯ã‚‹èˆã„ã‚’ã™ã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚</p>\n\n<pre class=\"code lang-ruby\" data-lang=\"ruby\" data-unlink>stub_api_client_all(\n  <span class=\"synType\">ExampleApiClient</span>,\n  <span class=\"synConstant\">request</span>: { <span class=\"synConstant\">response</span>: { <span class=\"synConstant\">message</span>: <span class=\"synSpecial\">'</span><span class=\"synConstant\">Hello world!</span><span class=\"synSpecial\">'</span> } }\n)\n\napi_client = <span class=\"synType\">ExampleApiClient</span>.new\nresponse = api_client.request\nresponse.message <span class=\"synComment\"># =&gt; 'Hello world!'</span>\n</pre>\n\n\n<p>ã§ã€ <code>error_handling</code> ã§<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%B9%A5%C6%A1%BC%A5%BF%A5%B9%A5%B3%A1%BC%A5%C9\">ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚³ãƒ¼ãƒ‰</a>ãŒ <code>400..499</code> ã®æ™‚ã¯ <code>MyApiClient::ClientError</code> ã¨ã„ã†ä¾‹å¤–ãŒç™ºç”Ÿã™ã‚‹ã€ã¨ã„ã†å®šç¾©ã«ãªã£ã¦ã„ã‚‹ã®ã§ã™ãŒã€ã“ã®ã‚ˆã†ãªä¾‹å¤–ãŒç™ºç”Ÿã—ãŸæ™‚ã®ãƒ†ã‚¹ãƒˆã‚’æ›¸ããŸã‚ã«ã€ <code>raise</code> ã®ã‚¹ã‚¿ãƒ–åŒ–ã‚‚å‡ºæ¥ã‚‹ã‚ˆã†ã«ãªã£ã¦ã„ã¾ã™ã€‚</p>\n\n<pre class=\"code lang-ruby\" data-lang=\"ruby\" data-unlink>stub_api_client_all(\n  <span class=\"synType\">ExampleApiClient</span>,\n  <span class=\"synConstant\">request</span>: { <span class=\"synConstant\">raise</span>: <span class=\"synType\">MyApiClient</span>::<span class=\"synType\">ClientError</span> }\n)\n\n<span class=\"synStatement\">begin</span>\n  api_client = <span class=\"synType\">ExampleApiClient</span>.new\n  response = api_client.request\n<span class=\"synStatement\">rescue</span> <span class=\"synType\">MyApiClient</span>::<span class=\"synType\">ClientError</span>\n  puts <span class=\"synSpecial\">'</span><span class=\"synConstant\">4xx error!</span><span class=\"synSpecial\">'</span>\n<span class=\"synStatement\">end</span>\n</pre>\n\n\n<p>å¤§æŠµã®å ´åˆã€ã“ã‚Œã‚‰ã®ã‚¹ã‚¿ãƒ–åŒ–ãŒã§ãã‚Œã°å•é¡Œãªã„ã®ã§ã™ãŒã€ä¾‹å¤–ç™ºç”Ÿæ™‚ã®ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’è¦‹ãŸã„ã€ã¨ã„ã†ã‚±ãƒ¼ã‚¹ã‚‚ç„¡ãã¯ãªã„ã‹ã¨æ€ã„ã¾ã™ã€‚\nä»•æ§˜ã¨ã—ã¦ã€ä¾‹å¤–<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%A4%A5%F3%A5%B9%A5%BF%A5%F3%A5%B9\">ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹</a>ã® <code>#params</code> ã‚„ <code>#matadata</code> ã¨ã„ã†ãƒ¡ã‚½ãƒƒãƒ‰ã‹ã‚‰ãƒªã‚¯<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%A8%A5%B9\">ã‚¨ã‚¹</a>ãƒˆãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¨ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’å‚ç…§ã§ãã‚‹ã‚ˆã†ã«ãªã£ã¦ã„ã¾ã™ã€‚</p>\n\n<p>å¾“æ¥ã®ã‚¹ã‚¿ãƒ–åŒ–ãƒ¡ã‚½ãƒƒãƒ‰ã§ã‚‚ä¸€å¿œæŒ‡å®šã§ããªãã¯ãªã‹ã£ãŸã‚“ã§ã™ãŒã€çµæ§‹æ‰‹é–“ã ã£ãŸã®ã§ <code>raise</code> ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã®æŒ‡å®šã‚’ä»¥ä¸‹ã®ã‚ˆã†ã«æ‹¡å¼µã—ã¾ã—ãŸã€‚\n<code>raise</code> ã¨ä¸€ç·’ã«æŒ‡å®šã—ãŸ <code>response</code> ãŒ <a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/API\">API</a> ã®ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã¨ã—ã¦è¿”ã•ã‚Œã¦ã€ãã‚ŒãŒä¾‹å¤–ã¨ã—ã¦å‡¦ç†ã•ã‚ŒãŸã€ã¨ã„ã†ã‚¹ã‚¿ãƒ–åŒ–ã«ãªã‚Šã¾ã™ã€‚</p>\n\n<pre class=\"code lang-ruby\" data-lang=\"ruby\" data-unlink>stub_api_client_all(\n  <span class=\"synType\">ExampleApiClient</span>,\n  <span class=\"synConstant\">request</span>: { \n    <span class=\"synConstant\">raise</span>: <span class=\"synType\">MyApiClient</span>::<span class=\"synType\">ClientError</span>,\n    <span class=\"synConstant\">response</span>: { <span class=\"synConstant\">error_code</span>: <span class=\"synConstant\">10</span> }\n  }\n)\n\n<span class=\"synStatement\">begin</span>\n  api_client = <span class=\"synType\">ExampleApiClient</span>.new\n  response = api_client.request\n<span class=\"synStatement\">rescue</span> <span class=\"synType\">MyApiClient</span>::<span class=\"synType\">ClientError</span> =&gt; e\n  e.params.response.data.error_code <span class=\"synComment\">#=&gt; 10</span>\n<span class=\"synStatement\">end</span>\n</pre>\n\n\n<p><code>my_api_client</code> ã¯å†…éƒ¨ã§ <a href=\"https://github.com/lostisland/sawyer\">Sawyer</a> ã‚’ä½¿ã£ã¦ã„ã¾ã™ã€‚</p>\n\n<p><iframe src=\"https://hatenablog-parts.com/embed?url=https%3A%2F%2Fgithub.com%2Flostisland%2Fsawyer\" title=\"lostisland/sawyer\" class=\"embed-card embed-webcard\" scrolling=\"no\" frameborder=\"0\" style=\"display: block; width: 100%; height: 155px; max-width: 500px; margin: 10px 0px;\"></iframe><cite class=\"hatena-citation\"><a href=\"https://github.com/lostisland/sawyer\">github.com</a></cite></p>\n\n<p><code>e.params.response</code> ãŒ <code>Sawyer::Response</code> ã‚’ãã®ã¾ã¾è¿”ã—ã¦ã„ã‚‹ã®ã§ã€<code>Sawyer::Response#data</code> ã‹ã‚‰ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãƒœãƒ‡ã‚£ã‚’å‚ç…§ã§ãã¾ã™ã€‚\n<code>Sawyer::Response#data</code> ã§ã¯ã€ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã® <a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/JSON\">JSON</a> ã‚’ <a href=\"https://docs.ruby-lang.org/ja/latest/class/OpenStruct.html\">OpenStruct)</a> ã®ã‚ˆã†ã«ãƒ¡ã‚½ãƒƒãƒ‰ã‚¢ã‚¯ã‚»ã‚¹ã§ãã‚‹ã‚ˆã†ã«å¤‰æ›ã—ã¦ãã‚Œã¾ã™ã€‚</p>\n\n<p>ãŸã ã—ã€ <code>V1.0.0</code> ã§ <code>Sawyer</code> ã®ä¾å­˜ã‚’ç„¡ãã—ãŸã„ã¨è€ƒãˆã¦ã„ã‚‹ã®ã§ã€ã„ãšã‚Œ <code>#data</code> ã‚’æŒŸã‚€æ›¸ãæ–¹ã¯å¤‰æ›´ã«ãªã‚‹ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚\nä¸€å¿œã“ã†ã„ã†ä½¿ã„æ–¹ã‚‚ã§ãã¾ã™ã‚ˆã€ã¨ã„ã†æ–°æ©Ÿèƒ½ã§ã—ãŸã€‚</p>\n","contentSnippet":"ã¤ã„å…ˆæ—¥ã€v0.12.0 ã‚’ãƒªãƒªãƒ¼ã‚¹ã—ãŸã°ã‹ã‚Š ã§ã™ãŒã€ v0.13.0 ã‚’ãƒªãƒªãƒ¼ã‚¹ã—ã¾ã—ãŸã®ã§ã€å«ã¾ã‚Œã‚‹ PR ã®å†…å®¹ã«ã¤ã„ã¦è§£èª¬ã—ã¦ã„ãã¾ã™ã€‚ ã‚ˆã‚Šè©³ã—ã„ä½¿ã„æ–¹ã¯ README.jp.md ã‚’ã”å‚ç…§ãã ã•ã„ã€‚github.com#180 Stub response on raising error (@ryz310)ä»Šå›ã¯ã“ã® PR ã®ã¿ã®æ›´æ–°ã§ã™ã€‚ä»•äº‹ã§ spec æ›¸ã„ã¦ã‚‹æœ€ä¸­ã«ã€ŒAPI ãƒªã‚¯ã‚¨ã‚¹ãƒˆã§ä¾‹å¤–ãŒç™ºç”Ÿã—ãŸéš›ã«ãƒ¬ã‚¹ãƒãƒ³ã‚¹å†…å®¹ã‚’ä¿å­˜ã™ã‚‹å‡¦ç†ã®ã‚¹ã‚¿ãƒ–åŒ–ã§ããªã„ã˜ã‚ƒã‚“ã€ã£ã¦ãªã£ã¦ä½œã‚Šã¾ã—ãŸã€‚my_api_client ã§ã¯ä½œæˆã—ãŸ API Client ã‚¯ãƒ©ã‚¹ã‚’ stub_api_client ã¾ãŸã¯ stub_api_client_all ã¨ã„ã†ãƒ¡ã‚½ãƒƒãƒ‰ã§ã‚¹ã‚¿ãƒ–åŒ–ã§ãã¾ã™ã€‚ä¾‹ãˆã°ä»¥ä¸‹ã®ã‚ˆã†ãª ExampleApiClient ã¨ã„ã†ã‚¯ãƒ©ã‚¹ã‚’å®šç¾©ã—ãŸæ™‚:class ExampleApiClient < MyApiClient::Base  endpoint 'https://example.com'  error_handling status_code: 400..499, raise: MyApiClient::ClientError  error_handling status_code: 500..599, raise: MyApiClient::ServerError  # GET https://example.com/path/to/resouce  def request     get 'path/to/resouce'  endendstub_api_client_all ã‚’å®Ÿè¡Œã™ã‚‹ã¨ ExampleApiClient ã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ãŒå…¨ã¦ã‚¹ã‚¿ãƒ–åŒ–ã•ã‚Œã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚ä»¥ä¸‹ã®ä¾‹ã ã¨ã€ #request ã‚’å®Ÿè¡Œã—ãŸæ™‚ã€API ã‹ã‚‰ { \"message\": \"Hello world!\" } ã¨ã„ã† JSON ãŒè¿”ã£ã¦ããŸæ™‚ã¨åŒã˜æŒ¯ã‚‹èˆã„ã‚’ã™ã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚stub_api_client_all(  ExampleApiClient,  request: { response: { message: 'Hello world!' } })api_client = ExampleApiClient.newresponse = api_client.requestresponse.message # => 'Hello world!'ã§ã€ error_handling ã§ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚³ãƒ¼ãƒ‰ãŒ 400..499 ã®æ™‚ã¯ MyApiClient::ClientError ã¨ã„ã†ä¾‹å¤–ãŒç™ºç”Ÿã™ã‚‹ã€ã¨ã„ã†å®šç¾©ã«ãªã£ã¦ã„ã‚‹ã®ã§ã™ãŒã€ã“ã®ã‚ˆã†ãªä¾‹å¤–ãŒç™ºç”Ÿã—ãŸæ™‚ã®ãƒ†ã‚¹ãƒˆã‚’æ›¸ããŸã‚ã«ã€ raise ã®ã‚¹ã‚¿ãƒ–åŒ–ã‚‚å‡ºæ¥ã‚‹ã‚ˆã†ã«ãªã£ã¦ã„ã¾ã™ã€‚stub_api_client_all(  ExampleApiClient,  request: { raise: MyApiClient::ClientError })begin  api_client = ExampleApiClient.new  response = api_client.requestrescue MyApiClient::ClientError  puts '4xx error!'endå¤§æŠµã®å ´åˆã€ã“ã‚Œã‚‰ã®ã‚¹ã‚¿ãƒ–åŒ–ãŒã§ãã‚Œã°å•é¡Œãªã„ã®ã§ã™ãŒã€ä¾‹å¤–ç™ºç”Ÿæ™‚ã®ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’è¦‹ãŸã„ã€ã¨ã„ã†ã‚±ãƒ¼ã‚¹ã‚‚ç„¡ãã¯ãªã„ã‹ã¨æ€ã„ã¾ã™ã€‚ä»•æ§˜ã¨ã—ã¦ã€ä¾‹å¤–ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã® #params ã‚„ #matadata ã¨ã„ã†ãƒ¡ã‚½ãƒƒãƒ‰ã‹ã‚‰ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¨ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’å‚ç…§ã§ãã‚‹ã‚ˆã†ã«ãªã£ã¦ã„ã¾ã™ã€‚å¾“æ¥ã®ã‚¹ã‚¿ãƒ–åŒ–ãƒ¡ã‚½ãƒƒãƒ‰ã§ã‚‚ä¸€å¿œæŒ‡å®šã§ããªãã¯ãªã‹ã£ãŸã‚“ã§ã™ãŒã€çµæ§‹æ‰‹é–“ã ã£ãŸã®ã§ raise ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã®æŒ‡å®šã‚’ä»¥ä¸‹ã®ã‚ˆã†ã«æ‹¡å¼µã—ã¾ã—ãŸã€‚raise ã¨ä¸€ç·’ã«æŒ‡å®šã—ãŸ response ãŒ API ã®ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã¨ã—ã¦è¿”ã•ã‚Œã¦ã€ãã‚ŒãŒä¾‹å¤–ã¨ã—ã¦å‡¦ç†ã•ã‚ŒãŸã€ã¨ã„ã†ã‚¹ã‚¿ãƒ–åŒ–ã«ãªã‚Šã¾ã™ã€‚stub_api_client_all(  ExampleApiClient,  request: {     raise: MyApiClient::ClientError,    response: { error_code: 10 }  })begin  api_client = ExampleApiClient.new  response = api_client.requestrescue MyApiClient::ClientError => e  e.params.response.data.error_code #=> 10endmy_api_client ã¯å†…éƒ¨ã§ Sawyer ã‚’ä½¿ã£ã¦ã„ã¾ã™ã€‚github.come.params.response ãŒ Sawyer::Response ã‚’ãã®ã¾ã¾è¿”ã—ã¦ã„ã‚‹ã®ã§ã€Sawyer::Response#data ã‹ã‚‰ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãƒœãƒ‡ã‚£ã‚’å‚ç…§ã§ãã¾ã™ã€‚Sawyer::Response#data ã§ã¯ã€ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã® JSON ã‚’ OpenStruct) ã®ã‚ˆã†ã«ãƒ¡ã‚½ãƒƒãƒ‰ã‚¢ã‚¯ã‚»ã‚¹ã§ãã‚‹ã‚ˆã†ã«å¤‰æ›ã—ã¦ãã‚Œã¾ã™ã€‚ãŸã ã—ã€ V1.0.0 ã§ Sawyer ã®ä¾å­˜ã‚’ç„¡ãã—ãŸã„ã¨è€ƒãˆã¦ã„ã‚‹ã®ã§ã€ã„ãšã‚Œ #data ã‚’æŒŸã‚€æ›¸ãæ–¹ã¯å¤‰æ›´ã«ãªã‚‹ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚ä¸€å¿œã“ã†ã„ã†ä½¿ã„æ–¹ã‚‚ã§ãã¾ã™ã‚ˆã€ã¨ã„ã†æ–°æ©Ÿèƒ½ã§ã—ãŸã€‚","link":"https://ryz310.hateblo.jp/entry/2020/01/21/230012","isoDate":"2020-01-21T14:00:12.000Z","dateMiliSeconds":1579615212000,"imageUrl":"https://cdn.blog.st-hatena.com/images/theme/og-image-1500.png","authorName":"ryz310"},{"title":"my_api_client v0.12.0 ã‚’ãƒªãƒªãƒ¼ã‚¹ã—ã¾ã—ãŸğŸš€","content":"<p><a href=\"https://github.com/ryz310/my_api_client\">my_api_client v0.12.0</a> ã«å«ã¾ã‚Œã‚‹ PR ã®å†…å®¹ã«ã¤ã„ã¦è§£èª¬ã—ã¦ã„ãã¾ã™ã€‚\nã‚ˆã‚Šè©³ã—ã„ä½¿ã„æ–¹ã¯ <a href=\"https://github.com/ryz310/my_api_client/blob/master/README.jp.md\">README.jp.md</a> ã‚’ã”å‚ç…§ãã ã•ã„ã€‚</p>\n\n<h2><a href=\"https://github.com/ryz310/my_api_client/pull/173\">#173</a> Avoid sleep on testing</h2>\n\n<p>my_<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/api\">api</a>_client ã§ã¯ä»¥ä¸‹ã®ã‚ˆã†ã«æ›¸ãã¨ã€ä»»æ„ã®ä¾‹å¤–ã‚’è£œè¶³ã—ã¦è‡ªå‹•çš„ã« <a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/API\">API</a> ãƒªã‚¯<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%A8%A5%B9\">ã‚¨ã‚¹</a>ãƒˆã‚’ãƒªãƒˆãƒ©ã‚¤ã—ã¦ãã‚Œã¾ã™ã€‚\nãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ç³»ã®ã‚¨ãƒ©ãƒ¼ã¨ã‹ã€ <a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/API\">API</a> Rate Limit ã«å¼•ã£ã‹ã‹ã£ãŸæ™‚ã¨ã‹ã«ä¾¿åˆ©ãªã‚„ã¤ã§ã™ã­ã€‚</p>\n\n<p><a href=\"https://edgeapi.rubyonrails.org/classes/ActiveJob/Exceptions/ClassMethods.html#method-i-retry_on\">ActiveJob ã® <code>retry_on</code></a> ã¨ã»ã¼åŒã˜ä½¿ã„æ–¹ã«ãªã£ã¦ã„ã¾ã™ã€‚</p>\n\n<pre class=\"code lang-ruby\" data-lang=\"ruby\" data-unlink><span class=\"synPreProc\">class</span> <span class=\"synType\">ExampleApiClient</span> &lt; <span class=\"synType\">MyApiClient</span>::<span class=\"synType\">Base</span>\n  endpoint <span class=\"synSpecial\">'</span><span class=\"synConstant\">https://example.com</span><span class=\"synSpecial\">'</span>\n\n  retry_on <span class=\"synType\">MyApiClient</span>::<span class=\"synType\">ApiLimitError</span>, <span class=\"synConstant\">wait</span>: <span class=\"synConstant\">1</span>.minute, <span class=\"synConstant\">attempts</span>: <span class=\"synConstant\">3</span>\n  error_handling <span class=\"synConstant\">json</span>: { <span class=\"synSpecial\">'</span><span class=\"synConstant\">$.errors.code</span><span class=\"synSpecial\">'</span>: <span class=\"synConstant\">20</span> }, <span class=\"synConstant\">raise</span>: <span class=\"synType\">MyApiClient</span>::<span class=\"synType\">ApiLimitError</span>\n\n  <span class=\"synComment\"># GET https://example.com/users</span>\n  <span class=\"synPreProc\">def</span> <span class=\"synIdentifier\">get_users</span>\n    get <span class=\"synSpecial\">'</span><span class=\"synConstant\">users</span><span class=\"synSpecial\">'</span>\n  <span class=\"synPreProc\">end</span>\n<span class=\"synPreProc\">end</span>\n</pre>\n\n\n<p>ãã‚Œã¯è‰¯ã„ã‚“ã§ã™ãŒã€ <a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/rspec\">rspec</a> ä¸Šã§ <code>wait</code> ãŒåŠ¹ã„ã¦ã—ã¾ã£ã¦ã„ãŸã®ã§ã€ä¸Šè¨˜ã®ã‚³ãƒ¼ãƒ‰ã ã¨ãƒªãƒˆãƒ©ã‚¤3å›åˆ† wait ã™ã‚‹ã®ã§ã€åˆè¨ˆ 3 åˆ†ã‚‚å¾…ãŸã•ã‚Œã¦ã—ã¾ã£ã¦ã„ã¾ã—ãŸã€‚\nä¸€å¿œ <a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/rspec\">rspec</a> ã§ <code>sleep</code> ã‚’ stub ã™ã‚‹ã¨ã‹ã‚„ã‚Œã°å›é¿ã§ãã¾ã™ãŒã€ãã‚‚ãã‚‚ãƒ†ã‚¹ãƒˆã§ã¯ wait ã‚’ç„¡è¦–ã—ã¦æ¬²ã—ã„ã§ã™ã‚ˆã­ã€‚</p>\n\n<p>my_<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/api\">api</a>_client ã§ã¯ <code>be_handled_as_an_error</code> ã¨ã„ã† <a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/rspec\">rspec</a> ã® matcher ã‚’ç”¨æ„ã—ã¦ã„ã‚‹ã®ã§ã™ãŒã€ä»Šå›ã®å¯¾å¿œã§ã€ã“ã® macher ã‚’çµŒç”±ã—ã¦ãƒªãƒˆãƒ©ã‚¤ãŒå®Ÿè¡Œã•ã‚ŒãŸå ´åˆã¯ wait ã‚’ç„¡è¦–ã™ã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸã€‚</p>\n\n<pre class=\"code lang-ruby\" data-lang=\"ruby\" data-unlink><span class=\"synType\">RSpec</span>.describe <span class=\"synType\">ExampleApiClient</span>, <span class=\"synConstant\">type</span>: <span class=\"synConstant\">:api_client</span> <span class=\"synStatement\">do</span>\n  let(<span class=\"synConstant\">:api_client</span>) { described_class.new }\n\n  <span class=\"synComment\"># </span><span class=\"synTodo\">NOTE</span><span class=\"synComment\">: ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã§ `{ &quot;errors&quot;: { &quot;code&quot;: 20 } }` ã‚’å—è¨ºã—ãŸéš›ã€3 å›ãƒªãƒˆãƒ©ã‚¤ãŒå®Ÿè¡Œã•ã‚ŒãŸå¾Œã« `MyApiClient::ApiLimitError` ã¨ã—ã¦ä¾‹å¤–å‡¦ç†ã•ã‚Œã‚‹ã€‚</span>\n  it <span class=\"synStatement\">do</span>\n    expect { api_request! }\n      .to be_handled_as_an_error(<span class=\"synType\">MyApiClient</span>::<span class=\"synType\">ApiLimitError</span>)\n      .after_retry(<span class=\"synConstant\">3</span>).times\n      .when_receive(<span class=\"synConstant\">body</span>: { <span class=\"synConstant\">errors</span>: { <span class=\"synConstant\">code</span>: <span class=\"synConstant\">20</span> } }.to_json)\n  <span class=\"synStatement\">end</span>\n<span class=\"synStatement\">end</span>\n</pre>\n\n\n<p>ã¾ãŸã€ <code>ExampleApiClient</code> ã¯ <code>stub_api_client</code> ã‚„ <code>stub_api_client_all</code> ã‚’ä½¿ç”¨ã™ã‚‹ã¨ã‚¹ã‚¿ãƒ–åŒ–ã§ãã¾ã™ã€‚\nã‚¹ã‚¿ãƒ–åŒ–ã—ãŸçŠ¶æ…‹ã ã¨ä»»æ„ã® <a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/API\">API</a> ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’è¿”ã™ã‹ã€ä»»æ„ã®ä¾‹å¤–ã‚’ç™ºç”Ÿã•ã›ã‚‹ã€ã¨ã„ã†å‹•ä½œã«ãªã£ã¦ãƒªãƒˆãƒ©ã‚¤ãŒç™ºç”Ÿã—ãªããªã‚‹ã®ã§ã€ä¸Šè¨˜ã®å•é¡Œã¯ã‚ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚</p>\n\n<pre class=\"code lang-ruby\" data-lang=\"ruby\" data-unlink>stub_api_client_all(<span class=\"synType\">ExampleApiClient</span>, <span class=\"synConstant\">get_users</span>: { <span class=\"synConstant\">users</span>: [{ <span class=\"synConstant\">id</span>: <span class=\"synConstant\">1</span> }, { <span class=\"synConstant\">id</span>: <span class=\"synConstant\">2</span> }, { <span class=\"synConstant\">id</span>: <span class=\"synConstant\">3</span> }] })\n\nresponse = <span class=\"synType\">ExampleApiClient</span>.new.get_users\nresponse.users <span class=\"synComment\"># =&gt; [{ id: 1 }, { id: 2 }, { id: 3 }]</span>\n</pre>\n\n\n<h2><a href=\"https://github.com/ryz310/my_api_client/pull/175\">#175</a> Verify arguments on error handling definition</h2>\n\n<p><code>error_handling</code> ã®å®šç¾©ã§ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã®<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%B9%A5%C6%A1%BC%A5%BF%A5%B9%A5%B3%A1%BC%A5%C9\">ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚³ãƒ¼ãƒ‰</a>ã‚’æŒ‡å®šã™ã‚‹ã“ã¨ãŒã§ãã‚‹ã‚“ã§ã™ãŒã€ã“ã®ã‚ªãƒ—ã‚·ãƒ§ãƒ³åãŒ <code>status_code</code> ãªã®ã‹ <code>status</code> ãªã®ã‹ã‚’ã‚ˆãé–“é•ãˆã‚‹ã€ã¨ã„ã†å•é¡ŒãŒã‚ã‚Šã¾ã—ãŸã€‚<code>$ rails g api_client</code> ã‚’ä½¿ç”¨ã™ã‚‹ã¨ãƒ†ãƒ³ãƒ—ãƒ¬ãŒä½œæˆã•ã‚Œã‚‹ã®ã§ã€ãã“ã‹ã‚‰ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã®å®šç¾©ã‚’è¡Œã†ã¨é–“é•ãˆã«ãã„ã®ã§ã™ãŒã€å¾Œã‹ã‚‰ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã‚’è¿½åŠ ã™ã‚‹æ™‚ã¨ã‹ã«ã‚„ã‚‰ã‹ã—ã¾ã™ã€‚ä½œè€…è‡ªèº«ã‚‚ãŸã¾ã«ã‚„ã‚‰ã‹ã—ã¦ã¾ã—ãŸğŸ˜‡</p>\n\n<pre class=\"code lang-ruby\" data-lang=\"ruby\" data-unlink><span class=\"synComment\"># æ­£è§£</span>\nerror_handling <span class=\"synConstant\">status_code</span>: <span class=\"synConstant\">400</span>..<span class=\"synConstant\">499</span>, <span class=\"synConstant\">raise</span>: <span class=\"synType\">MyApiClient</span>::<span class=\"synType\">ClientError</span>\n\n<span class=\"synComment\"># é–“é•ã„</span>\nerror_handling <span class=\"synConstant\">status</span>: <span class=\"synConstant\">400</span>..<span class=\"synConstant\">499</span>, <span class=\"synConstant\">raise</span>: <span class=\"synType\">MyApiClient</span>::<span class=\"synType\">ClientError</span>\n</pre>\n\n\n<p>ã“ã® PR ã®å¯¾å¿œã§é–“é•ã£ãŸã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’æŒ‡å®šã™ã‚‹ã¨ä»¥ä¸‹ã®ã‚ˆã†ãªä¾‹å¤–ãŒç™ºç”Ÿã™ã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸã€‚</p>\n\n<pre class=\"code\" data-lang=\"\" data-unlink>RuntimeError:\n  Specified an incorrect option: `status`\n  You can use options that: [:response, :status_code, :json, :with, :raise, :block]</pre>\n\n\n<h2><a href=\"https://github.com/ryz310/my_api_client/pull/176\">#176</a> Provides a syntax sugar of <code>retry_on</code> on <code>error_handling</code></h2>\n\n<p>æœ€åˆã® PR ã§ã‚‚å‡ºã¦ããŸ <code>retry_on</code> ã§ã™ãŒã€ <code>error_handling raise: MyApiClient::ApiLimitError</code> ã§ã‚‚åŒã˜ä¾‹å¤–ã‚’æŒ‡å®šã—ã¦ã„ã¦ DRY ãªæ„Ÿã˜ã˜ã‚ƒãªã‹ã£ãŸã‚Šã€<code>retry_on</code> ã¨ <code>error_handling</code> ã‚’ãã‚Œãã‚Œå®šç¾©ã—ã¦ã‚‹ã¨ãŠäº’ã„ã®é–¢é€£ãŒå®Ÿæ„Ÿã—ã¥ã‚‰ã„ã€ã¨ã„ã†ä¸æº€ãŒã‚ã‚Šã¾ã—ãŸã€‚</p>\n\n<pre class=\"code lang-ruby\" data-lang=\"ruby\" data-unlink><span class=\"synPreProc\">class</span> <span class=\"synType\">ExampleApiClient</span> &lt; <span class=\"synType\">MyApiClient</span>::<span class=\"synType\">Base</span>\n  endpoint <span class=\"synSpecial\">'</span><span class=\"synConstant\">https://example.com</span><span class=\"synSpecial\">'</span>\n\n  retry_on <span class=\"synType\">MyApiClient</span>::<span class=\"synType\">ApiLimitError</span>, <span class=\"synConstant\">wait</span>: <span class=\"synConstant\">1</span>.minute, <span class=\"synConstant\">attempts</span>: <span class=\"synConstant\">3</span>\n  error_handling <span class=\"synConstant\">json</span>: { <span class=\"synSpecial\">'</span><span class=\"synConstant\">$.errors.code</span><span class=\"synSpecial\">'</span>: <span class=\"synConstant\">20</span> }, <span class=\"synConstant\">raise</span>: <span class=\"synType\">MyApiClient</span>::<span class=\"synType\">ApiLimitError</span>\n\n  <span class=\"synComment\"># GET https://example.com/users</span>\n  <span class=\"synPreProc\">def</span> <span class=\"synIdentifier\">get_users</span>\n    get <span class=\"synSpecial\">'</span><span class=\"synConstant\">users</span><span class=\"synSpecial\">'</span>\n  <span class=\"synPreProc\">end</span>\n<span class=\"synPreProc\">end</span>\n</pre>\n\n\n<p>ã“ã® <code>PR</code> ã§ã¯ <code>retry</code> ã¨ã„ã†ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’ <code>error_handling</code> ã«è¿½åŠ ã—ã¦ã„ã¾ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€ä»¥ä¸‹ã® 2 ã¤ã®ã‚³ãƒ¼ãƒ‰ã¯ç­‰ä¾¡ã«ãªã‚Šã¾ã™ã€‚</p>\n\n<pre class=\"code lang-ruby\" data-lang=\"ruby\" data-unlink>retry_on <span class=\"synType\">MyApiClient</span>::<span class=\"synType\">ApiLimitError</span>, <span class=\"synConstant\">wait</span>: <span class=\"synConstant\">1</span>.minute, <span class=\"synConstant\">attempts</span>: <span class=\"synConstant\">3</span>\nerror_handling <span class=\"synConstant\">json</span>: { <span class=\"synSpecial\">'</span><span class=\"synConstant\">$.errors.code</span><span class=\"synSpecial\">'</span>: <span class=\"synConstant\">20</span> }, <span class=\"synConstant\">raise</span>: <span class=\"synType\">MyApiClient</span>::<span class=\"synType\">ApiLimitError</span>\n</pre>\n\n\n\n\n<pre class=\"code lang-ruby\" data-lang=\"ruby\" data-unlink>error_handling <span class=\"synConstant\">json</span>: { <span class=\"synSpecial\">'</span><span class=\"synConstant\">$.errors.code</span><span class=\"synSpecial\">'</span>: <span class=\"synConstant\">20</span> }, \n                          <span class=\"synConstant\">raise</span>: <span class=\"synType\">MyApiClient</span>::<span class=\"synType\">ApiLimitError</span>, \n                          <span class=\"synConstant\">retry</span>: { <span class=\"synConstant\">wait</span>: <span class=\"synConstant\">1</span>.minute, <span class=\"synConstant\">attempts</span>: <span class=\"synConstant\">3</span> }\n</pre>\n\n\n<p><code>retry_on</code> ã«ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’æŒ‡å®šã™ã‚‹å¿…è¦ãŒãªã‘ã‚Œã° <code>retry: true</code> ã¨æ›¸ã‘ã° OK ã§ã™ã€‚</p>\n\n<pre class=\"code lang-ruby\" data-lang=\"ruby\" data-unlink>error_handling <span class=\"synConstant\">json</span>: { <span class=\"synSpecial\">'</span><span class=\"synConstant\">$.errors.code</span><span class=\"synSpecial\">'</span>: <span class=\"synConstant\">20</span> }, \n                          <span class=\"synConstant\">raise</span>: <span class=\"synType\">MyApiClient</span>::<span class=\"synType\">ApiLimitError</span>, \n                          <span class=\"synConstant\">retry</span>: <span class=\"synConstant\">true</span>\n</pre>\n\n\n<p>ãŸã ã—ã€ <code>retry</code> ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’ä½¿ç”¨ã™ã‚‹éš›ã¯ä»¥ä¸‹ã®ç‚¹ã«æ³¨æ„ãŒå¿…è¦ã§ã™ã€‚</p>\n\n<ul>\n<li><code>error_handling</code> ã« <code>raise</code> ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã®æŒ‡å®šãŒå¿…é ˆã¨ãªã‚Šã¾ã™ã€‚</li>\n<li>Block ã‚’ä½¿ã£ãŸ <code>error_handling</code> ã®å®šç¾©ã¯ç¦æ­¢ã•ã‚Œã¾ã™ã€‚</li>\n</ul>\n\n","contentSnippet":"my_api_client v0.12.0 ã«å«ã¾ã‚Œã‚‹ PR ã®å†…å®¹ã«ã¤ã„ã¦è§£èª¬ã—ã¦ã„ãã¾ã™ã€‚ã‚ˆã‚Šè©³ã—ã„ä½¿ã„æ–¹ã¯ README.jp.md ã‚’ã”å‚ç…§ãã ã•ã„ã€‚#173 Avoid sleep on testingmy_api_client ã§ã¯ä»¥ä¸‹ã®ã‚ˆã†ã«æ›¸ãã¨ã€ä»»æ„ã®ä¾‹å¤–ã‚’è£œè¶³ã—ã¦è‡ªå‹•çš„ã« API ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’ãƒªãƒˆãƒ©ã‚¤ã—ã¦ãã‚Œã¾ã™ã€‚ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ç³»ã®ã‚¨ãƒ©ãƒ¼ã¨ã‹ã€ API Rate Limit ã«å¼•ã£ã‹ã‹ã£ãŸæ™‚ã¨ã‹ã«ä¾¿åˆ©ãªã‚„ã¤ã§ã™ã­ã€‚ActiveJob ã® retry_on ã¨ã»ã¼åŒã˜ä½¿ã„æ–¹ã«ãªã£ã¦ã„ã¾ã™ã€‚class ExampleApiClient < MyApiClient::Base  endpoint 'https://example.com'  retry_on MyApiClient::ApiLimitError, wait: 1.minute, attempts: 3  error_handling json: { '$.errors.code': 20 }, raise: MyApiClient::ApiLimitError  # GET https://example.com/users  def get_users    get 'users'  endendãã‚Œã¯è‰¯ã„ã‚“ã§ã™ãŒã€ rspec ä¸Šã§ wait ãŒåŠ¹ã„ã¦ã—ã¾ã£ã¦ã„ãŸã®ã§ã€ä¸Šè¨˜ã®ã‚³ãƒ¼ãƒ‰ã ã¨ãƒªãƒˆãƒ©ã‚¤3å›åˆ† wait ã™ã‚‹ã®ã§ã€åˆè¨ˆ 3 åˆ†ã‚‚å¾…ãŸã•ã‚Œã¦ã—ã¾ã£ã¦ã„ã¾ã—ãŸã€‚ä¸€å¿œ rspec ã§ sleep ã‚’ stub ã™ã‚‹ã¨ã‹ã‚„ã‚Œã°å›é¿ã§ãã¾ã™ãŒã€ãã‚‚ãã‚‚ãƒ†ã‚¹ãƒˆã§ã¯ wait ã‚’ç„¡è¦–ã—ã¦æ¬²ã—ã„ã§ã™ã‚ˆã­ã€‚my_api_client ã§ã¯ be_handled_as_an_error ã¨ã„ã† rspec ã® matcher ã‚’ç”¨æ„ã—ã¦ã„ã‚‹ã®ã§ã™ãŒã€ä»Šå›ã®å¯¾å¿œã§ã€ã“ã® macher ã‚’çµŒç”±ã—ã¦ãƒªãƒˆãƒ©ã‚¤ãŒå®Ÿè¡Œã•ã‚ŒãŸå ´åˆã¯ wait ã‚’ç„¡è¦–ã™ã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸã€‚RSpec.describe ExampleApiClient, type: :api_client do  let(:api_client) { described_class.new }  # NOTE: ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã§ `{ \"errors\": { \"code\": 20 } }` ã‚’å—è¨ºã—ãŸéš›ã€3 å›ãƒªãƒˆãƒ©ã‚¤ãŒå®Ÿè¡Œã•ã‚ŒãŸå¾Œã« `MyApiClient::ApiLimitError` ã¨ã—ã¦ä¾‹å¤–å‡¦ç†ã•ã‚Œã‚‹ã€‚  it do    expect { api_request! }      .to be_handled_as_an_error(MyApiClient::ApiLimitError)      .after_retry(3).times      .when_receive(body: { errors: { code: 20 } }.to_json)  endendã¾ãŸã€ ExampleApiClient ã¯ stub_api_client ã‚„ stub_api_client_all ã‚’ä½¿ç”¨ã™ã‚‹ã¨ã‚¹ã‚¿ãƒ–åŒ–ã§ãã¾ã™ã€‚ã‚¹ã‚¿ãƒ–åŒ–ã—ãŸçŠ¶æ…‹ã ã¨ä»»æ„ã® API ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’è¿”ã™ã‹ã€ä»»æ„ã®ä¾‹å¤–ã‚’ç™ºç”Ÿã•ã›ã‚‹ã€ã¨ã„ã†å‹•ä½œã«ãªã£ã¦ãƒªãƒˆãƒ©ã‚¤ãŒç™ºç”Ÿã—ãªããªã‚‹ã®ã§ã€ä¸Šè¨˜ã®å•é¡Œã¯ã‚ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚stub_api_client_all(ExampleApiClient, get_users: { users: [{ id: 1 }, { id: 2 }, { id: 3 }] })response = ExampleApiClient.new.get_usersresponse.users # => [{ id: 1 }, { id: 2 }, { id: 3 }]#175 Verify arguments on error handling definitionerror_handling ã®å®šç¾©ã§ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã®ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚³ãƒ¼ãƒ‰ã‚’æŒ‡å®šã™ã‚‹ã“ã¨ãŒã§ãã‚‹ã‚“ã§ã™ãŒã€ã“ã®ã‚ªãƒ—ã‚·ãƒ§ãƒ³åãŒ status_code ãªã®ã‹ status ãªã®ã‹ã‚’ã‚ˆãé–“é•ãˆã‚‹ã€ã¨ã„ã†å•é¡ŒãŒã‚ã‚Šã¾ã—ãŸã€‚$ rails g api_client ã‚’ä½¿ç”¨ã™ã‚‹ã¨ãƒ†ãƒ³ãƒ—ãƒ¬ãŒä½œæˆã•ã‚Œã‚‹ã®ã§ã€ãã“ã‹ã‚‰ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã®å®šç¾©ã‚’è¡Œã†ã¨é–“é•ãˆã«ãã„ã®ã§ã™ãŒã€å¾Œã‹ã‚‰ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã‚’è¿½åŠ ã™ã‚‹æ™‚ã¨ã‹ã«ã‚„ã‚‰ã‹ã—ã¾ã™ã€‚ä½œè€…è‡ªèº«ã‚‚ãŸã¾ã«ã‚„ã‚‰ã‹ã—ã¦ã¾ã—ãŸğŸ˜‡# æ­£è§£error_handling status_code: 400..499, raise: MyApiClient::ClientError# é–“é•ã„error_handling status: 400..499, raise: MyApiClient::ClientErrorã“ã® PR ã®å¯¾å¿œã§é–“é•ã£ãŸã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’æŒ‡å®šã™ã‚‹ã¨ä»¥ä¸‹ã®ã‚ˆã†ãªä¾‹å¤–ãŒç™ºç”Ÿã™ã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸã€‚RuntimeError:  Specified an incorrect option: `status`  You can use options that: [:response, :status_code, :json, :with, :raise, :block]#176 Provides a syntax sugar of retry_on on error_handlingæœ€åˆã® PR ã§ã‚‚å‡ºã¦ããŸ retry_on ã§ã™ãŒã€ error_handling raise: MyApiClient::ApiLimitError ã§ã‚‚åŒã˜ä¾‹å¤–ã‚’æŒ‡å®šã—ã¦ã„ã¦ DRY ãªæ„Ÿã˜ã˜ã‚ƒãªã‹ã£ãŸã‚Šã€retry_on ã¨ error_handling ã‚’ãã‚Œãã‚Œå®šç¾©ã—ã¦ã‚‹ã¨ãŠäº’ã„ã®é–¢é€£ãŒå®Ÿæ„Ÿã—ã¥ã‚‰ã„ã€ã¨ã„ã†ä¸æº€ãŒã‚ã‚Šã¾ã—ãŸã€‚class ExampleApiClient < MyApiClient::Base  endpoint 'https://example.com'  retry_on MyApiClient::ApiLimitError, wait: 1.minute, attempts: 3  error_handling json: { '$.errors.code': 20 }, raise: MyApiClient::ApiLimitError  # GET https://example.com/users  def get_users    get 'users'  endendã“ã® PR ã§ã¯ retry ã¨ã„ã†ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’ error_handling ã«è¿½åŠ ã—ã¦ã„ã¾ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€ä»¥ä¸‹ã® 2 ã¤ã®ã‚³ãƒ¼ãƒ‰ã¯ç­‰ä¾¡ã«ãªã‚Šã¾ã™ã€‚retry_on MyApiClient::ApiLimitError, wait: 1.minute, attempts: 3error_handling json: { '$.errors.code': 20 }, raise: MyApiClient::ApiLimitErrorerror_handling json: { '$.errors.code': 20 },                           raise: MyApiClient::ApiLimitError,                           retry: { wait: 1.minute, attempts: 3 }retry_on ã«ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’æŒ‡å®šã™ã‚‹å¿…è¦ãŒãªã‘ã‚Œã° retry: true ã¨æ›¸ã‘ã° OK ã§ã™ã€‚error_handling json: { '$.errors.code': 20 },                           raise: MyApiClient::ApiLimitError,                           retry: trueãŸã ã—ã€ retry ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’ä½¿ç”¨ã™ã‚‹éš›ã¯ä»¥ä¸‹ã®ç‚¹ã«æ³¨æ„ãŒå¿…è¦ã§ã™ã€‚error_handling ã« raise ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã®æŒ‡å®šãŒå¿…é ˆã¨ãªã‚Šã¾ã™ã€‚Block ã‚’ä½¿ã£ãŸ error_handling ã®å®šç¾©ã¯ç¦æ­¢ã•ã‚Œã¾ã™ã€‚","link":"https://ryz310.hateblo.jp/entry/2020/01/19/152826","isoDate":"2020-01-19T06:28:26.000Z","dateMiliSeconds":1579415306000,"imageUrl":"https://cdn.blog.st-hatena.com/images/theme/og-image-1500.png","authorName":"ryz310"},{"title":"ç§ã¨ gem","content":"<p>ã©ãƒ¼ã‚‚ã€ã‚µãƒˆã‚¦ãƒªãƒ§ã‚¦ã‚¹ã‚±ã§ã™ã€‚\n<a href=\"https://ginza-rails.connpass.com/event/155467\">é‡‘æ›œæ—¥ã«ç™»å£‡ã—ãŸå‹‰å¼·ä¼š</a> ã§ <del>ã†ã£ã‹ã‚Š</del> ãƒ–ãƒ­ã‚°ä½œã‚‹ã£ã¦è¨€ã£ã¦ã—ã¾ã£ãŸã®ã§ 10 å¹´ã¶ã‚Šãã‚‰ã„ã«ãƒ–ãƒ­ã‚°ã‚’å¾©æ´»ã•ã›ã¦ã¿ã¾ã—ãŸã€‚ãƒ–ãƒ­ã‚°ã®ã‚¿ã‚¤ãƒˆãƒ«ã‚‚ 10 å¹´å‰ã®ã‚¿ã‚¤ãƒˆãƒ«ã¨åŒã˜ã§ã™ï¼ˆå…ƒãƒã‚¿ã¯<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%D5%A5%A1%A5%DF%A5%B3%A5%F3\">ãƒ•ã‚¡ãƒŸã‚³ãƒ³</a>æ™‚ä»£ã®<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%C9%A5%E9%A5%AF%A5%A8\">ãƒ‰ãƒ©ã‚¯ã‚¨</a> IVï¼‰</p>\n\n<p>å‹‰å¼·ä¼šã®æ„Ÿæƒ³è¨˜äº‹ã¯è¿‘æ—¥ä¸­ã«æ›¸ã“ã†ã¨æ€ã„ã¾ã™âœï¸</p>\n\n<h2>ã“ã®è¨˜äº‹ã¯ Feedforce Advent Calendar 2019 ã® 15 æ—¥ç›®ã§ã™ã€‚</h2>\n\n<p>ã•ã¦ã€æœ€åˆã®è¨˜äº‹ã‹ã‚‰ã„ããªã‚Šä¼šç¤¾ã®<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%A2%A5%C9%A5%D9%A5%F3%A5%C8%A5%AB%A5%EC%A5%F3%A5%C0%A1%BC\">ã‚¢ãƒ‰ãƒ™ãƒ³ãƒˆã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼</a>è¨˜äº‹ã«ãªã‚Šã¾ã™ğŸ™</p>\n\n<p><iframe src=\"https://hatenablog-parts.com/embed?url=https%3A%2F%2Fadventar.org%2Fcalendars%2F4169\" title=\"feedforce Advent Calendar 2019 - Adventar\" class=\"embed-card embed-webcard\" scrolling=\"no\" frameborder=\"0\" style=\"display: block; width: 100%; height: 155px; max-width: 500px; margin: 10px 0px;\"></iframe><cite class=\"hatena-citation\"><a href=\"https://adventar.org/calendars/4169\">adventar.org</a></cite></p>\n\n<p>æ˜¨æ—¥ã¯ Yutaka KAWAI ã•ã‚“ã®ã€Œã‚³ãƒ¼ãƒ’ãƒ¼ã¯ç§‘å­¦ã§ã‚ã‚‹ ~æŠ½å‡ºå™¨å…·ã«ã‚ˆã‚‹å‘³ã®é•ã„~ <a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%DA%A1%BC%A5%D1%A1%BC%A5%C9%A5%EA%A5%C3%A5%D7\">ãƒšãƒ¼ãƒ‘ãƒ¼ãƒ‰ãƒªãƒƒãƒ—</a>ç·¨ã€ã§ã—ãŸã€‚</p>\n\n<p><iframe src=\"https://hatenablog-parts.com/embed?url=https%3A%2F%2Fnote.com%2Futahca%2Fn%2Fn30594094e406\" title=\"ã‚³ãƒ¼ãƒ’ãƒ¼ã¯ç§‘å­¦ã§ã‚ã‚‹ ~æŠ½å‡ºå™¨å…·ã«ã‚ˆã‚‹å‘³ã®é•ã„~ ãƒšãƒ¼ãƒ‘ãƒ¼ãƒ‰ãƒªãƒƒãƒ—ç·¨ï½œYutaka KAWAIï½œnote\" class=\"embed-card embed-webcard\" scrolling=\"no\" frameborder=\"0\" style=\"display: block; width: 100%; height: 155px; max-width: 500px; margin: 10px 0px;\"></iframe><cite class=\"hatena-citation\"><a href=\"https://note.com/utahca/n/n30594094e406\">note.com</a></cite></p>\n\n<p>çˆç²å±‹ã•ã‚“ã‹ãªï¼Ÿã£ã¦ãã‚‰ã„å‡„ã„è¨˜äº‹ã§ã—ãŸã­â˜•ï¸\nè¨˜äº‹ã«å‡ºã¦ããŸãƒ‰ãƒªãƒƒãƒ‘ãƒ¼ã¯å…¨ç¨®é¡æŒã£ã¦ã‚‹ã£ã¦ãƒ¤ãƒããªã„ã§ã™ã‹ï¼Ÿï¼Ÿï¼Ÿï¼ˆã‚‚ã¡ã‚ã‚“è‰¯ã„æ„å‘³ã§ï¼‰</p>\n\n<p><a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%DA%A1%BC%A5%D1%A1%BC%A5%C9%A5%EA%A5%C3%A5%D7\">ãƒšãƒ¼ãƒ‘ãƒ¼ãƒ‰ãƒªãƒƒãƒ—</a>ç·¨ã£ã¦ã“ã¨ã¯ç¶šç·¨ã‚‚ã‚ã‚‹ã®ã‹ãªï¼Ÿ\nã“ã®æ„Ÿã˜ã§è¨˜äº‹ãŒé‡ç”£ã•ã‚ŒãŸã‚‰ãã®ã†ã¡æ›¸ç±åŒ–ã•ã‚Œã‚‹ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ğŸ“š</p>\n\n<h2>æœ¬ç·¨</h2>\n\n<p>äºˆå‘Šé€šã‚Šå€‹äººã§ gem ã‚’ä½œã‚‹æµã‚Œã«ã¤ã„ã¦è©±ãã†ã¨æ€ã†ã®ã§ã™ãŒã€<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%A2%A5%C9%A5%D9%A5%F3%A5%C8%A5%AB%A5%EC%A5%F3%A5%C0%A1%BC\">ã‚¢ãƒ‰ãƒ™ãƒ³ãƒˆã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼</a>ã‹ã‚‰æµã‚Œã¦ãã‚‹ã¨éã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ã®æ–¹ã‚‚ãã£ã¨èª­ã¾ã‚Œã‚‹ã¨æ€ã†ã®ã§ã€ã‚ã‚“ã¾ã‚ŠæŠ€è¡“çš„ãªè©±é¡Œã«ã›ãšã«ãƒ•ãƒ¯ãƒƒã¨ã—ãŸè©±ã§ã‚‚ã—ã‚ˆã†ã‹ã¨æ€ã„ã¾ã™ã€‚</p>\n\n<h3>ãã‚‚ãã‚‚ gem ã£ã¦ãªã‚“ã ã£ã‘ï¼Ÿ</h3>\n\n<p>ãã‚‚ãã‚‚ gem ã£ã¦ã„ã†ã®ã¯ <a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/Ruby\">Ruby</a> ã§ã§ããŸãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®äº‹ã§ã—ã¦ã€ä¾‹ãˆã°åƒ•ãŒå‡„ãä¾¿åˆ©ãªãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’æ›¸ã„ã¦ã€ãã‚Œã‚’ gem ã¨ã—ã¦å…¬é–‹ã™ã‚Œã°ã€ä¸–ç•Œä¸­ã®äººãŒåƒ•ã®ã‚¤ã‚±ã¦ã‚‹ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’ä½¿ãˆã‚‹ã‚ˆã†ã«ãªã‚‹ã€ã¨ã„ã†ã‚‚ã®ã§ã™ã€‚ã¾ã•ã« <a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/Win-Win\">Win-Win</a> ã—ã‹ãªã„ä»•çµ„ã¿ã€‚gem ã¯ä¸–ç•Œã‚’æ•‘ã„ã¾ã™ã€‚</p>\n\n<p>ä¸€æ–¹ã§ã€ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã£ã¦ã®ã¯æ–°æ©Ÿèƒ½ãŒè¿½åŠ ã•ã‚ŒãŸã‚Šã€ä¸å…·åˆãŒä¿®æ­£ã•ã‚ŒãŸã‚Šã—ã¦æ—¥ã€…ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆãŒç¹°ã‚Šè¿”ã•ã‚Œã¦ã„ã¾ã™ã€‚\nã€Œã“ã®æ©Ÿèƒ½ã«ã¯ãƒãƒ¼ã‚¸ãƒ§ãƒ³ 1.3 ä»¥é™ã§ãªã„ã¨ä½¿ãˆã¾ã›ã‚“ã€ã¨ã‹ã€Œè‰²ã€…ã‚¤ã‚±ã¦ãªã„éƒ¨åˆ†ãŒå¤šã„ã‹ã‚‰ã“ã®æ©Ÿèƒ½ã¯å»ƒæ­¢ã—ã¾ã™ã€ã¨ã„ã†å¤‰æ›´ã‚‚ã‚ã‚‹ã®ã§ã€è‡ªåˆ†ã®ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã¯ä¸€ä½“ã©ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã® gem ã‚’ä½¿ã£ã¦ã„ã‚‹ã®ã‹ã€ã¨ã„ã†è©±ãŒç‰©å‡„ãé‡è¦ã ã£ãŸã‚Šã—ã¾ã™ã€‚</p>\n\n<p>gem ã«ã¯ã©ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’ä½¿ã£ã¦ã„ã‚‹ã®ã‹ï¼ˆä¾å­˜ã—ã¦ã„ã‚‹ã®ã‹ï¼‰ã¨ã„ã†æƒ…å ±ã‚’ç®¡ç†ã™ã‚‹æ©Ÿèƒ½ã‚‚å‚™ã‚ã£ã¦ã„ã¾ã™ã®ã§ã€ã‚ã‚‹æ—¥çªç„¶æ–°ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã§æŒ™å‹•ãŒå¤‰ã‚ã£ã¦ã‚‚ã€Œã†ã¡ã¯ä¸€å€‹å‰ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ä½¿ã£ã¦ã¾ã™ï¼ã€ã¨ã„ã†ç®¡ç†ãŒã§ãã¦ã„ã‚Œã°å‹•ã‹ãªããªã‚‹ã“ã¨ã¯ãªã„ã®ã§ã™ã€‚</p>\n\n<p>ã¨ã¯ã„ãˆæ–°ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã§ã„ããªã‚Šãã‚“ãªãƒˆãƒ³ãƒ‡ãƒ¢å¤‰æ›´ã•ã‚ŒãŸã‚‰å›°ã‚Šã¾ã™ã‘ã©ã‚‚ã€‚</p>\n\n<h3>åƒ•ãŒåˆã‚ã¦ä½œã£ãŸ gem</h3>\n\n<p>è‡ªåˆ†ãŒç”Ÿã¾ã‚Œã¦åˆã‚ã¦ä½œã£ãŸ gem ã¯ã“ã® <code>rubocop_challenger</code> ã¨ã„ã† gem ã§ã™ã€‚</p>\n\n<p><iframe src=\"https://hatenablog-parts.com/embed?url=https%3A%2F%2Fgithub.com%2Fryz310%2Frubocop_challenger\" title=\"ryz310/rubocop_challenger\" class=\"embed-card embed-webcard\" scrolling=\"no\" frameborder=\"0\" style=\"display: block; width: 100%; height: 155px; max-width: 500px; margin: 10px 0px;\"></iframe><cite class=\"hatena-citation\"><a href=\"https://github.com/ryz310/rubocop_challenger\">github.com</a></cite></p>\n\n<p>ä¸€èˆ¬çš„ã« gem ã¯ä»–ã®ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã¨çµ„ã¿åˆã‚ã›ã¦ä½¿ã†äº‹ãŒå¤šã„ã®ã§ã™ãŒã€ <code>rubocop_challenger</code> ã¯å˜ä½“ã§å‹•ä½œã™ã‚‹ã‚„ã¤ã§ã—ã¦ã€å®Ÿè¡Œã—ãŸ<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%C7%A5%A3%A5%EC%A5%AF%A5%C8\">ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆ</a>ãƒªï¼ˆãƒ•ã‚©ãƒ«ãƒ€ï¼‰ã«ã‚ã‚‹ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã®<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%BD%A1%BC%A5%B9%A5%B3%A1%BC%A5%C9\">ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰</a>ã‚’å°‘ã—ãšã¤ç¶ºéº—ã«ï¼ˆäººé–“ã«ã¨ã£ã¦èª­ã¿ã‚„ã™ãã—ãŸã‚Šã€æ›¸ãæ–¹ã®ãƒ«ãƒ¼ãƒ«ã‚’çµ±ä¸€ã—ãŸã‚Šï¼‰ã—ã¦ãã‚Œã‚‹ã€ã¨ã„ã† gem ã§ã™ã€‚</p>\n\n<p>ã¨ã„ã†ã¨ç‰©å‡„ã„ç¥ gem ã§ã™ãŒã€RuboCop ã¨ã„ã†<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%BD%A1%BC%A5%B9%A5%B3%A1%BC%A5%C9\">ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰</a>ã‚’è§£æã—ã¦ãã‚Œã‚‹ä¾¿åˆ©ãª gem ã‚’å†…éƒ¨ã§å‘¼ã³å‡ºã—ã¦ãƒ—ãƒ«ãƒªã‚¯ï¼ˆãƒ—ãƒ«ãƒªã‚¯ãŒä½•ãªã®ã‹ã¯ã‚°ã‚°ã£ã¦ãã ã•ã„ï¼‰ä½œã£ã¦ãã‚Œã‚‹ã€ã¨ã„ã†ä»•çµ„ã¿ã«ãªã£ã¦ã„ã‚‹ã®ã§ã€ã€Œäººé–“ãŒæ¯æ—¥æ‰‹ä½œæ¥­ã§ã‚„ã‚‰ãªã„ã¨ã„ã‘ãªã‹ã£ãŸäº‹ã‚’è‡ªå‹•çš„ã«ã‚„ã‚‹ã€ã¨ã„ã†ã®ãŒ <code>rubocop_challenger</code> ã®æä¾›ã™ã‚‹ä¾¡å€¤ã«ãªã‚Šã¾ã™ ğŸ¤–</p>\n\n<p>è©³ã—ãã¯ã¡ã‚‡ã†ã©ä¸€å¹´ãã‚‰ã„å‰ã«ä¼šç¤¾ã®ãƒ–ãƒ­ã‚°ã«æ›¸ã„ãŸã®ã§ã€ã”èˆˆå‘³ã‚ã‚Šã¾ã—ãŸã‚‰æ˜¯éã€‚å¤ã„å†…å®¹ãªã®ã§ã€ç¾åœ¨ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‹ã‚‰ã¯å°‘ã—ãšã‚Œã¦ã¾ã™ã‘ã©ã€‚</p>\n\n<p><iframe src=\"https://hatenablog-parts.com/embed?url=https%3A%2F%2Fdeveloper.feedforce.jp%2Fentry%2F2018%2F12%2F05%2F140000\" title=\"ã¾ã  .rubocop_todo.yml ã§æ¶ˆè€—ã—ã¦ã‚‹ã®ï¼Ÿ - Feedforce Developer Blog\" class=\"embed-card embed-blogcard\" scrolling=\"no\" frameborder=\"0\" style=\"display: block; width: 100%; height: 190px; max-width: 500px; margin: 10px 0px;\"></iframe><cite class=\"hatena-citation\"><a href=\"https://developer.feedforce.jp/entry/2018/12/05/140000\">developer.feedforce.jp</a></cite></p>\n\n<p>ã¡ãªã¿ã«ã‚‚ã†ã™ã <code>v2.0.0</code> ã‚’ãƒªãƒªãƒ¼ã‚¹ã™ã‚‹äºˆå®šã§ã™ã€‚ï¼ˆpre ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã§ã™ãŒã€ç¾æ™‚ç‚¹ã§ã‚‚ã™ã§ã«ä½¿ãˆã¾ã™ï¼‰</p>\n\n<h3>ãƒ‹ãƒƒãƒãª gem</h3>\n\n<p>åˆã‚ã¦ä½œã£ãŸã®ã¯ <code>rubocop_challenger</code> ã¨ã„ã†ã€Œäººé–“ãŒæ¯æ—¥æ‰‹ä½œæ¥­ã§ã‚„ã‚‰ãªã„ã¨ã„ã‘ãªã‹ã£ãŸäº‹ã‚’è‡ªå‹•çš„ã«ã‚„ã‚‹ã€ gem ã§ã—ãŸã€‚\nå®Œå…¨ã«è‡ªåˆ†ã®ä¼šç¤¾ã®ãƒ—ãƒ­ãƒ€ã‚¯ãƒˆç”¨ã«ä½œã£ãŸ gem ã§ã—ãŸãŒã€ <a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/Twitter\">Twitter</a> ãªã©ã‚’<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%A8%A5%B4%A5%B5\">ã‚¨ã‚´ã‚µ</a>ã—ã¦ã‚‹ã¨ã€ã¼ã¡ã¼ã¡ä½¿ã£ã¦é ‚ã‘ã¦ã„ã‚‹ã‚ˆã†ã§ã™ã€‚\nåŒã˜ã‚ˆã†ãªæ‚©ã¿ã‚’æŠ±ãˆã¦ã„ã‚‹äººã¯ä¸–ã®ä¸­ã«ã¯ã„ã‚‹ã‚‚ã‚“ã§ã™ã­âœ¨</p>\n\n<p>ã¨ã¯ã„ãˆã€ gem ã‚’å…¬é–‹ã—ãŸã‚‰ä¸–ç•Œä¸­ã®äººãŸã¡ãŒä½¿ã£ã¦ãã‚Œã‚‹ã€ã¨ã„ã†ã“ã¨ã«ã¯ä¸­ã€…ãªã‚‰ãªã„ã§ã™ã€‚\nä¸€å¿œé ‘å¼µã£ã¦è‹±èªã§èª¬æ˜ã‚’æ›¸ã„ãŸã‚Šã¯ã—ã¦ã„ã¾ã™ãŒã€å€‹äººã®ç™ºä¿¡åŠ›ã«ã¯é™ç•Œã‚‚ã‚ã‚Šã¾ã™ã—ã€ä½•ã‚ˆã‚Šãƒ‹ãƒƒãƒã§ã™ã€‚</p>\n\n<p>ã¨ã„ã†ã‹ã€å€‹äººãŒä½œã‚‹ gem ãªã‚“ã¦å¤§æŠµã¯ãƒ‹ãƒƒãƒãªã‚‚ã®ã«ãªã‚Šã¾ã™ã€‚\nã€Œã‚ãƒ¼ã€ã“ã‚“ãª gem ã‚ã£ãŸã‚‰ã‚ã£ã¡ã‚ƒä¾¿åˆ©ã‚„ã‚“ï¼Ÿã€ã¨ã„ã† gem ã¯å¤§æŠµä¸–ç•Œã®ã©ã“ã‹ã®èª°ã‹ãŒä½œã£ã¦ã¾ã™ã€‚\nãªã®ã§ã€ä»Šã¾ã§ã«ãªã„ã‚ˆã†ãªæ–°ã—ã„gem ã‚’ä½œã‚ã†ã¨æ€ã£ãŸã‚‰å¤§æŠµãƒ‹ãƒƒãƒã«ãªã‚Šã¾ã™ã€‚</p>\n\n<p>ã˜ã‚ƒã‚ gem ã‚’å…¬é–‹ã—ã¦ã‚‚å¤§ã—ã¦ä½¿ã£ã¦ã‚‚ã‚‰ãˆãªã„ã—ã€ã‚ã‚“ã¾ã‚Šæ„å‘³ãªã„ã˜ã‚ƒã‚“ã€ã£ã¦æ€ã†ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ãŒã€æ„å‘³ç„¡ãã¯ãªã„ã‚“ã§ã™ã‚ˆã­ğŸ‘</p>\n\n<h3>åŠ¹èƒ½ 1. <a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%B9%A5%AD%A5%EB%A5%A2%A5%C3%A5%D7\">ã‚¹ã‚­ãƒ«ã‚¢ãƒƒãƒ—</a></h3>\n\n<p>ã¾ãšã€ã‚ã£ã¡ã‚ƒãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’æ›¸ãå‹‰å¼·ã«ãªã‚Šã¾ã™ã€‚</p>\n\n<p><a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/Ruby\">Ruby</a> ã§ Web é–‹ç™ºã‚’ã—ã¦ã„ã‚‹äººã¯å¤§æŠµ <a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/Ruby%20on%20Rails\">Ruby on Rails</a> ã‚’ä½¿ã£ã¦æ›¸ã„ã¦ã‚‹ã¨æ€ã„ã¾ã™ã€‚ã¡ãªã¿ã« <a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/Ruby%20on%20Rails\">Ruby on Rails</a> ã‚‚ gem ã§ã™ã€‚\n<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/Ruby%20on%20Rails\">Ruby on Rails</a> ã¯å‡„ãã‚ˆãå‡ºæ¥ã¦ã„ã‚‹ã®ã§ã€Web é–‹ç™ºã®é›£ã—ã„éƒ¨åˆ†ã‚’ 9 å‰²ãã‚‰ã„ã®è‚©ä»£ã‚ã‚Šã—ã¦ãã‚Œã¾ã™ã€‚</p>\n\n<p>ã¨ã“ã‚ãŒã€è‡ªåˆ†ã§ä¸€ã‹ã‚‰ gem ã‚’ä½œã‚ã†ã¨ã™ã‚‹ã¨ã€è‡ªåˆ†ã®åŠ›ã§è§£æ±ºã—ãªã„ã¨ã„ã‘ãªã„ãƒ—ãƒ­ã‚°ãƒ©ãƒ çš„ãªèª²é¡ŒãŒã‚ã£ã¡ã‚ƒã‚ã‚Šã¾ã™ã€‚\nWeb é–‹ç™ºã¯ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆç‰¹æœ‰ã®èª²é¡ŒãŒå¤šã„ã§ã™ãŒã€ gem ã®é–‹ç™ºã«ã¯ Web é–‹ç™ºä»¥å¤–ã®çŸ¥è­˜ã‚‚è‰²ã€…è¦æ±‚ã•ã‚ŒãŸã‚Šã—ã¾ã™ã€‚</p>\n\n<p>ä½•ã‚ˆã‚Šã€è‡ªåˆ†è‡ªèº«ã§ä»•æ§˜ã‚’ä¸€ã‹ã‚‰è€ƒãˆãªã„ã¨ã„ã‘ãªã„ã®ã§ã€æ™®æ®µã®é–‹ç™ºä»¥ä¸Šã«æ„æ€æ±º<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%C4%EA%CE%CC\">å®šé‡</a>ãŒã‚ã£ã¡ã‚ƒå¤šã„ã§ã™ã€‚\nè‡ªåˆ†ã¯ <code>rubocop_challenger</code> ä»¥å¤–ã«ã‚‚ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹ã—ã¦ã„ã‚‹ gem ãŒ 3 ã¤ã»ã©ã‚ã‚Šã¾ã™ãŒã€ã“ã‚Œã‚‰ã®é–‹ç™ºã‚’é€šã—ã¦æ—¥é ƒã® Web é–‹ç™ºã®å“è³ªã‚‚ä¸€æ®µãƒ¬ãƒ™ãƒ«ãŒä¸ŠãŒã£ãŸãªã€ã¨æ„Ÿã˜ã‚‹äº‹ãŒå¤šã„ã§ã™ã€‚</p>\n\n<p>ãªã®ã§ã€gem ã®é–‹ç™ºã¯è‡ªåˆ†è‡ªèº«ã®ä¿®è¡Œã®ãŸã‚ã ã¨æ€ã£ã¦ã‚„ã‚‹ã¨è‰¯ã„ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚èª°ã‹ã«ä½¿ãˆã¦ã‚‚ã‚‰ãˆãŸã‚‰ãƒ©ãƒƒã‚­ãƒ¼ã€ã¿ãŸã„ãªã€‚</p>\n\n<p>é€†ã«ä½¿ã£ã¦ã‚‚ã‚‰ãˆã‚‹äº‹ã‚’ãƒ¢ãƒãƒ™ãƒ¼ã‚·ãƒ§ãƒ³ã«ã™ã‚‹ã¨ã¡ã‚‡ã£ã¨è¾›ã„ã‹ã‚‚ã—ã‚Œãªã„ã§ã™ã€‚æ€ã£ãŸä»¥ä¸Šã«æµè¡Œã‚‰ãªã„ã€‚ã‚‚ã£ã¨æµè¡Œã‚Œï¼</p>\n\n<h3>åŠ¹èƒ½ 2. <a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%DD%A1%BC%A5%C8%A5%D5%A5%A9%A5%EA%A5%AA\">ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒªã‚ª</a></h3>\n\n<p>gem ã‚’å…¬é–‹ã—ã¦ã‚‹ã›ã„ã‹ã€ä¼æ¥­ã‹ã‚‰ã®ã‚¹ã‚«ã‚¦ãƒˆãŒã‚ã£ã¡ã‚ƒæ¥ã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚</p>\n\n<p>è‡ªåˆ†è‡ªèº«ã€ä¼šç¤¾ã®æ¡ç”¨æ´»å‹•ã«é–¢ã‚ã‚‹æ©Ÿä¼šãŒå¤šã„ã®ã§ã™ãŒã€ä¾‹ãˆã°ã‚¹ã‚«ã‚¦ãƒˆå€™è£œã‚’æ¢ã™éš›ã«å€™è£œè€…ã® <a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/GitHub\">GitHub</a> ã¯å¿…ãšè¦‹ã‚‹ã‚ˆã†ã«ã—ã¦ã„ã¾ã™ã€‚\nãã®çµŒé¨“ã‹ã‚‰ã§ã™ãŒè‡ªåˆ†ã§ gem æ›¸ã„ã¦å…¬é–‹ã—ã¦ã„ã‚‹ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ã¯ä¸–ã®ä¸­ã® 1 å‰²ã‚‚ã„ãªã„ã‚“ã˜ã‚ƒãªã„ã‹ãªã€ã£ã¦æ€ã£ã¦ã„ã¾ã™ã€‚</p>\n\n<p>è‡ªåˆ†ã‚‚ gem ã‚’ä½œã‚‹ã‚ˆã†ã«ãªã£ãŸã®ã¯ã“ã“ 1 ~ 2 å¹´ã§ã™ã—ã€å‰è·ã«ã„ãŸé ƒã ã¨æ™®æ®µã®ä»•äº‹ã®å¸°ã‚ŠãŒé…ã‹ã£ãŸã‚Šã‚‚ã—ãŸã®ã§å®¶ã«å¸°ã£ã¦ã‹ã‚‰ gem ã‚’ä½œã‚‹ã‚ˆã†ãªä½™è£•ã‚‚ã‚ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚ãªã®ã§ã€æœ¬äººã®ç†±é‡ã‚„ç’°å¢ƒãŒæ•´ã‚ãªã„ã¨ gem ã®é–‹ç™ºã¯é›£ã—ã„ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚</p>\n\n<p>ã—ã‹ã—ãªãŒã‚‰ã€è‡ªåˆ†ã‚‚æ¡ç”¨æ´»å‹•ã—ã¦ã„ã¦ã€ŒãŠã€‚ã“ã®äººã™ã”ã„ã‚„ã‚“ã€ã£ã¦ãªã‚‹ã®ã¯ <a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/GitHub\">GitHub</a> ã‚„ Qiita ã¨ã‹ã§ä½•ã‹ã—ã‚‰ã‚¢ã‚¦ãƒˆãƒ—ãƒƒãƒˆã®ã‚ã‚‹æ–¹ãªã‚“ã§ã™ã‚ˆã­ã€‚\nã‚‚ã¡ã‚ã‚“ã‚¢ã‚¦ãƒˆãƒ—ãƒƒãƒˆãŒç„¡ãã¦ã‚‚å®Ÿéš›ä¼šã£ã¦ã¿ãŸã‚‰å‡„ã‹ã£ãŸã£ã¦äººã¯æ²¢å±±ã„ã‚‹ã‚“ã§ã™ãŒã€æ¡ç”¨æ´»å‹•ã ã¨ãã®äººã®ä»•äº‹ã§ã®ã‚¢ã‚¦ãƒˆãƒ—ãƒƒãƒˆã£ã¦è¦‹ãˆãªã„ã‚‚ã‚“ã§ã™ã‹ã‚‰ã€‚ã€‚</p>\n\n<p>åˆ¥ã« gem ã˜ã‚ƒãªãã¦ã‚‚è‰¯ã„ã‚“ã§ã™ãŒã€è‡ªåˆ†è‡ªèº«ã®ã‚­ãƒ£ãƒªã‚¢å½¢æˆã‚’æ„è­˜ã™ã‚‹ãŸã‚ã®ã‚¢ã‚¦ãƒˆãƒ—ãƒƒãƒˆã®ä¸€ç’°ã¨ã—ã¦ã¨ã¦ã‚‚æœ‰ç”¨ã ã¨æ€ã„ã¾ã™ã€‚</p>\n\n<h3>åŠ¹èƒ½ 3. é­”æ³•ã®ã‚¢ã‚¤ãƒ†ãƒ </h3>\n\n<p>è‡ªåˆ†ãŒä»Šå¹´ä½œã£ãŸ gem ã« <code>my_api_client</code> ã¨ã„ã† gem ãŒã‚ã‚Šã¾ã—ã¦ã€<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/API\">API</a> Client ã‚’ä½œã‚‹ãŸã‚ã®<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%D5%A5%EC%A1%BC%A5%E0%A5%EF%A1%BC%A5%AF\">ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯</a>ãªã‚“ã§ã™ãŒã€ã“ã‚Œã¯ãƒ—ãƒ­ãƒ€ã‚¯ãƒˆã®<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%BD%A1%BC%A5%B9%A5%B3%A1%BC%A5%C9\">ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰</a>ã«ã‚‚ä½¿ã£ã¦ã„ã¾ã™ã€‚</p>\n\n<p>è‡ªåˆ†ãŒæºã‚ã£ã¦ã‚‹ã‚µãƒ¼ãƒ“ã‚¹ã¯ <a href=\"https://socialplus.jp/\">ã‚½ãƒ¼ã‚·ãƒ£ãƒ«PLUS</a> ã¨ã„ã†ã‚‚ã®ã§ã—ã¦ã€ä¼æ¥­ã® Web ã‚µãƒ¼ãƒ“ã‚¹ã¨ã‚½ãƒ¼ã‚·ãƒ£ãƒ«ãƒ­ã‚°ã‚¤ãƒ³ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼ï¼ˆ LINE ã¨ã‹ <a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/Twitter\">Twitter</a> ã¨ã‹ï¼‰ã®ãƒãƒ–ã«ãªã£ã¦ã‚‹ã‚µãƒ¼ãƒ“ã‚¹ãªã‚“ã§ã™ã­ã€‚ãã®ã›ã„ã‚‚ã‚ã£ã¦ã€å¤–éƒ¨ã® Web <a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/API\">API</a> ã¸ãƒªã‚¯<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%A8%A5%B9\">ã‚¨ã‚¹</a>ãƒˆã™ã‚‹ã¨ã„ã†å‡¦ç†ãŒå¤šãã€æ¯å›åŒã˜ã‚ˆã†ãªã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã‚„ãƒªãƒˆãƒ©ã‚¤ã®å‡¦ç†ã‚’ä½•åº¦ã‚‚æ›¸ã‹ãªã„ã¨ã„ã‘ãªãã¦å¤§å¤‰ã ã£ãŸè¨³ã§ã™ã€‚</p>\n\n<p>ã‚ã¨ã€ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ãŸéš›ã«ã€Œã‚½ãƒ¼ã‚·ãƒ£ãƒ«PLUSã€ã€Œã‚½ãƒ¼ã‚·ãƒ£ãƒ«PLUSã‚’åˆ©ç”¨ã—ã¦ã„ã‚‹ä¼æ¥­ã€ã€Œã‚½ãƒ¼ã‚·ãƒ£ãƒ«ãƒ­ã‚°ã‚¤ãƒ³ãƒ—ãƒ­ãƒã‚¤ãƒ€ã€ã®èª°ãŒåŸå› ãªã®ã‹ã‚’ç‰¹å®šã™ã‚‹ãŸã‚ã®æƒ…å ±ã‚’ãƒ­ã‚°ã«æ®‹ã™ã¨ã‹ã‚‚éƒ½åº¦å¯¾å¿œã—ãªã„ã¨ã„ã‘ãªãã¦è¶…å¤§å¤‰ã§ã—ãŸã€‚</p>\n\n<p><code>my_api_client</code> ã¯ãã®è¾ºã®å‡¦ç†ã‚’ã™ã£ãã‚Šç°¡å˜ã«æ›¸ã‘ã‚‹ã‚ˆã†ã«ã™ã‚‹ãŸã‚ã® gem ã§ã—ã¦ã€ã™ã£ãã‚Šç°¡å˜ãªã‚‚ã‚“ã ã‹ã‚‰ã€ãƒãƒ¼ãƒ ãƒ¡ã‚¤ãƒˆãŒ <code>my_api_client</code> ã‚’æ´»ç”¨ã—ã¦è‡ªç™ºçš„ã«ã‚¬ãƒ³ã‚¬ãƒ³èª²é¡Œã‚’è§£æ±ºã—ã¦ãã‚Œã‚‹ã€ã¨ã„ã†æœ€é«˜ã«ãƒ›ãƒƒãƒˆãªçŠ¶æ³ã‚’ç”£ã¿å‡ºã™ã“ã¨ã«ä¸€å½¹è²·ã£ã¦ãŠã‚Šã¾ã™ã€‚</p>\n\n<p>ã‚„ã£ã±ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ã‚‚äººé–“ãªã®ã§ã€æ™®æ®µã®æ¥­å‹™ã§å¿™ã—ã„ä¸­ã§æ”¹å–„æ´»å‹•ã‚‚åŒæ™‚ã«ã‚„ã‚ã†ãªã‚“ã¦ãƒ¢ãƒãƒ™ãƒ¼ã‚·ãƒ§ãƒ³ã¯æ™®é€šã¯æ¹§ã„ã¦ã“ãªã„è¨³ã§ã™ã€‚ã§ã‚‚ã€ã“ã‚Œã‚’ä½¿ãˆã°ã™ã£ãã‚Šç°¡å˜ã ã‚ˆã€ã£ã¦ã„ã†é­”æ³•ã®ã‚¢ã‚¤ãƒ†ãƒ ãŒã‚ã‚Œã°ã€ã¿ã‚“ãªã®é‡ã„è…°ã‚’å°‘ã—ã ã‘è»½ãã™ã‚‹äº‹ãŒã§ãã¾ã™ã€‚</p>\n\n<p><code>my_api_client</code> ã¯è‡ªåˆ†ã®ä¸­ã§ã‚‚å‰²ã¨ã‚ˆãã§ããŸ gem ãªã®ã§ã€æ¯å›ã“ã‚“ãªè‰¯ã„ gem ãŒä½œã‚Œã‚‹è¨³ã˜ã‚ƒãªã„ã§ã™ã‘ã©ã€ gem ã‚’ä½œã£ã¦ãƒãƒ¼ãƒ ã®ç”Ÿç”£æ€§ãŒä¸ŠãŒã‚‹ã£ã¦ã®ã¯ã‚„ã£ã±é­”æ³•ã®ã‚¢ã‚¤ãƒ†ãƒ ã ãªãã£ã¦æ€ã†ã‚“ã§ã™ã€‚gem ã¯ä¸–ç•Œã‚’æ•‘ã„ã¾ã™ï¼ï¼ˆï¼’å›ç›®ï¼‰</p>\n\n<p>ãªãŠã€ <code>my_api_client</code> ã«ã¤ã„ã¦ã¯ <a href=\"https://ginza-rails.connpass.com/event/133628/\">éŠ€åº§ Rails #10</a> ã§ç™»å£‡ã—ãŸã¨ãã®è³‡æ–™ãŒã‚ã‚‹ã®ã§è²¼ã£ã¦ãŠãã¾ã™ã€‚ã“ã‚Œã‚‚è‹¥å¹²å¤ã„ã®ã§ã€æœ€æ–°ã®ä»•æ§˜ã¨ã¯å°‘ã—ç•°ãªã‚‹ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚\næœ€æ–°ã®ä»•æ§˜ã¯ <a href=\"https://github.com/ryz310/my_api_client/blob/master/README.jp.md\">ã“ã¡ã‚‰</a> ã‚’ã”è¦§ä¸‹ã•ã„ã€‚</p>\n\n<script async class=\"speakerdeck-embed\" data-id=\"75d691da45b041deb3db8e6748d81638\" data-ratio=\"1.37081659973226\" src=\"//speakerdeck.com/assets/embed.js\"></script>\n\n\n<h3>åŠ¹èƒ½ 4. ãŸã®ã—ã„</h3>\n\n<p>æœ€å¾Œã¯ã“ã“ã«å¸°ã£ã¦ãã‚‹ã‚“ã§ã™ãŒã€è‡ªåˆ†ã® gem ã‚’ä½œã‚‹ã®ã¯ã‚„ã£ã±æ¥½ã—ã„ã®ã§ã™ã€‚ã„ããªã‚Šé ­æ‚ªã„æ–‡ç« ã«ãªã‚Šã¾ã—ãŸã€‚ã„ã¤ã‹ã‚‰é ­è‰¯ã„æ–‡ç« æ›¸ã„ã¦ã‚‹ã¨éŒ¯è¦šã—ã¦ã„ãŸï¼Ÿ</p>\n\n<p>ä»¥å‰å‹‰å¼·ä¼šã§ã€Œã“ã‚Œã¾ã§ã©ã†ã„ã†ã‚­ãƒ£ãƒªã‚¢ã‚’æ„è­˜ã—ã¦ã‚„ã£ã¦ãã¾ã—ãŸã‹ï¼Ÿã€ã£ã¦è‹¥æ‰‹ã®ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ã‹ã‚‰èã‹ã‚ŒãŸã®ã§ã™ãŒã€è‡ªåˆ†ã¿ãŸã„ãª 30 åŠã°ã®ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ã£ã¦ã€ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ã«ãªã£ãŸå½“åˆã¯ä»Šã¿ãŸã„ã«ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ãŒæŒã¦å›ƒã•ã‚Œã‚‹æ™‚ä»£ã§ã‚‚ãªã‹ã£ãŸã®ã§ã€è‡ªåˆ†ã‹ã‚‰ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ã«ãªã‚ã†ã£ã¦æ€ã£ãŸäººã¯å°‘ãªã‹ã‚‰ãšã€ŒãŸã ãƒ—ãƒ­ã‚°ãƒ©ãƒ ãŒå¥½ãã ã£ãŸã€ã£ã¦ã„ã†äººãŒå¤šã„ã‚“ã˜ã‚ƒãªã„ã§ã™ã‹ã­ï¼Ÿã‚ã‹ã‚“ãªã„ã§ã™ã‘ã©è‡ªåˆ†ã¯ãã†ã§ã—ãŸã€‚</p>\n\n<p>è‡ªä½œã® gem ã‚’ä½œã£ã¦ã‚‹ã¨ã€Œã‚„ã£ã±ãƒ—ãƒ­ã‚°ãƒ©ãƒ æ›¸ãã®ã£ã¦æ¥½ã—ã„ã€ã£ã¦ã®ã‚’æ€ã„å‡ºã•ã›ã¦ãã‚Œã¾ã™ã€‚\nè‡ªåˆ†ã¯ä»–ã«ã‚‚è¶£å‘³ã§ãƒãƒ³ãƒ‰ã‚„ã£ãŸã‚Šçµµã‚’æã„ãŸã‚Šã—ã¦ã„ã¾ã™ãŒã€ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°ãŒå­ä¾›ã®é ƒã«å¥½ãã ã£ãŸå·¥ä½œã«ä¸€ç•ªè¿‘ã„ã‚ˆã†ãªæ°—ãŒã—ã¦ã„ã¾ã™ã€‚</p>\n\n<p>ä¸­ã€…ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆã§æ™‚é–“ã‚’ä½œã‚‹ã®ã¯é›£ã—ã„ã‚“ã§ã™ãŒã€ã‚„ã¯ã‚Šæ¥½ã—ã•ãŒä¸€ç•ªæ ¹åº•ã®åŸå‹•åŠ›ã«ãªã£ã¦ã„ã‚‹ã®ã‹ã‚‚ã—ã‚Œãªã„ã§ã™ã­ã€‚</p>\n\n<h2>ã¾ã¨ã¾ã‚‰ãªã„ã¾ã¨ã‚</h2>\n\n<p>ä¼šç¤¾ã®<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%A2%A5%C9%A5%D9%A5%F3%A5%C8%A5%AB%A5%EC%A5%F3%A5%C0%A1%BC\">ã‚¢ãƒ‰ãƒ™ãƒ³ãƒˆã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼</a>å‘ã‘ã ã—ã€éã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ã«ã‚‚ä¼ã‚ã‚‹ã‚ˆã†ãªãƒ•ãƒ¯ãƒƒã¨ã—ãŸæ–‡ç« ã«ã—ã‚ˆã†ã¨æ€ã£ã¦æ›¸ã„ã¦ãŸã‚‰ã€é€”ä¸­ã‹ã‚‰ä¿ºã®ãƒã‚¨ãƒ ã‚’æ›¸ãæ®´ã£ã¦ãŸã ã‘ã«ãªã£ãŸæ°—ãŒã—ã¾ã™ãŒã€å½¹ã«ç«‹ã¤ã‹ã©ã†ã‹ã¯ 2 ã®æ¬¡ã«ã—ã¦ã€ã¨ã‚Šã‚ãˆãš gem ä½œã£ã¦ã¿ã‚‹ã¨æ¥½ã—ã<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%B9%A5%AD%A5%EB%A5%A2%A5%C3%A5%D7\">ã‚¹ã‚­ãƒ«ã‚¢ãƒƒãƒ—</a>ã§ãã‚‹ã—ã€ã‚‚ã—ã‹ã—ãŸã‚‰èª°ã‹ã®é­”æ³•ã®ã‚¢ã‚¤ãƒ†ãƒ ã«ãªã£ã¦ã‚‹ã‹ã‚‚ã—ã‚Œãªã„ã‚ˆã€ã¨ã„ã†ãŠè©±ã§ã—ãŸã€‚</p>\n\n<p>ä¹…ã€…ã«ã‚†ã‚‹ã€œã„æ–‡ç« æ›¸ã„ã¦ã¦è‡ªåˆ†çš„ã«ã¯æ¥½ã—ã‹ã£ãŸã§ã™ ç¬‘</p>\n\n<h2>ã•ã¦ã€æ˜æ—¥ã® Advent Calendar ã¯ï¼Ÿï¼ˆCV. <a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%B2%C3%C6%A3%A4%DF%A4%C9%A4%EA\">åŠ è—¤ã¿ã©ã‚Š</a>ï¼‰</h2>\n\n<p><a href=\"https://adventar.org/calendars/4169\">Feedforce Advent Calendar 2019</a>ã€æ˜æ—¥ã¯ä¸Šå²¡å›ãŒã€Œé‡çƒã«ã¤ã„ã¦oré éš”<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%A4%A5%F3%A5%BF%A1%BC%A5%F3\">ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ³</a>ã«ã¤ã„ã¦ã€æ›¸ã„ã¦ãã‚Œã‚‹ã¿ãŸã„ã§ã™ã€‚</p>\n\n<p>æœ€è¿‘ã¯<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%A4%A5%F3%A5%BF%A1%BC%A5%F3\">ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ³</a>ã‚‚é éš”ã§å‡ºæ¥ã‚‹ã‚“ã§ã™ã­ã€‚é‡çƒã‚‚é éš”<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%A4%A5%F3%A5%BF%A1%BC%A5%F3\">ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ³</a>ã‚‚æœªçµŒé¨“ã®ã¾ã¾ãŠã˜ã•ã‚“ã«ãªã£ã¦ã—ã¾ã£ãŸã®ã§è‡ªåˆ†ã«ã¯æœªçŸ¥ã®é ˜åŸŸã§ã™âš¾ï¸ğŸ’¨</p>\n\n<p>ä¹ã†ã”æœŸå¾…ï¼</p>\n","contentSnippet":"ã©ãƒ¼ã‚‚ã€ã‚µãƒˆã‚¦ãƒªãƒ§ã‚¦ã‚¹ã‚±ã§ã™ã€‚é‡‘æ›œæ—¥ã«ç™»å£‡ã—ãŸå‹‰å¼·ä¼š ã§ ã†ã£ã‹ã‚Š ãƒ–ãƒ­ã‚°ä½œã‚‹ã£ã¦è¨€ã£ã¦ã—ã¾ã£ãŸã®ã§ 10 å¹´ã¶ã‚Šãã‚‰ã„ã«ãƒ–ãƒ­ã‚°ã‚’å¾©æ´»ã•ã›ã¦ã¿ã¾ã—ãŸã€‚ãƒ–ãƒ­ã‚°ã®ã‚¿ã‚¤ãƒˆãƒ«ã‚‚ 10 å¹´å‰ã®ã‚¿ã‚¤ãƒˆãƒ«ã¨åŒã˜ã§ã™ï¼ˆå…ƒãƒã‚¿ã¯ãƒ•ã‚¡ãƒŸã‚³ãƒ³æ™‚ä»£ã®ãƒ‰ãƒ©ã‚¯ã‚¨ IVï¼‰å‹‰å¼·ä¼šã®æ„Ÿæƒ³è¨˜äº‹ã¯è¿‘æ—¥ä¸­ã«æ›¸ã“ã†ã¨æ€ã„ã¾ã™âœï¸ã“ã®è¨˜äº‹ã¯ Feedforce Advent Calendar 2019 ã® 15 æ—¥ç›®ã§ã™ã€‚ã•ã¦ã€æœ€åˆã®è¨˜äº‹ã‹ã‚‰ã„ããªã‚Šä¼šç¤¾ã®ã‚¢ãƒ‰ãƒ™ãƒ³ãƒˆã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼è¨˜äº‹ã«ãªã‚Šã¾ã™ğŸ™adventar.orgæ˜¨æ—¥ã¯ Yutaka KAWAI ã•ã‚“ã®ã€Œã‚³ãƒ¼ãƒ’ãƒ¼ã¯ç§‘å­¦ã§ã‚ã‚‹ ~æŠ½å‡ºå™¨å…·ã«ã‚ˆã‚‹å‘³ã®é•ã„~ ãƒšãƒ¼ãƒ‘ãƒ¼ãƒ‰ãƒªãƒƒãƒ—ç·¨ã€ã§ã—ãŸã€‚note.comçˆç²å±‹ã•ã‚“ã‹ãªï¼Ÿã£ã¦ãã‚‰ã„å‡„ã„è¨˜äº‹ã§ã—ãŸã­â˜•ï¸è¨˜äº‹ã«å‡ºã¦ããŸãƒ‰ãƒªãƒƒãƒ‘ãƒ¼ã¯å…¨ç¨®é¡æŒã£ã¦ã‚‹ã£ã¦ãƒ¤ãƒããªã„ã§ã™ã‹ï¼Ÿï¼Ÿï¼Ÿï¼ˆã‚‚ã¡ã‚ã‚“è‰¯ã„æ„å‘³ã§ï¼‰ãƒšãƒ¼ãƒ‘ãƒ¼ãƒ‰ãƒªãƒƒãƒ—ç·¨ã£ã¦ã“ã¨ã¯ç¶šç·¨ã‚‚ã‚ã‚‹ã®ã‹ãªï¼Ÿã“ã®æ„Ÿã˜ã§è¨˜äº‹ãŒé‡ç”£ã•ã‚ŒãŸã‚‰ãã®ã†ã¡æ›¸ç±åŒ–ã•ã‚Œã‚‹ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ğŸ“šæœ¬ç·¨äºˆå‘Šé€šã‚Šå€‹äººã§ gem ã‚’ä½œã‚‹æµã‚Œã«ã¤ã„ã¦è©±ãã†ã¨æ€ã†ã®ã§ã™ãŒã€ã‚¢ãƒ‰ãƒ™ãƒ³ãƒˆã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã‹ã‚‰æµã‚Œã¦ãã‚‹ã¨éã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ã®æ–¹ã‚‚ãã£ã¨èª­ã¾ã‚Œã‚‹ã¨æ€ã†ã®ã§ã€ã‚ã‚“ã¾ã‚ŠæŠ€è¡“çš„ãªè©±é¡Œã«ã›ãšã«ãƒ•ãƒ¯ãƒƒã¨ã—ãŸè©±ã§ã‚‚ã—ã‚ˆã†ã‹ã¨æ€ã„ã¾ã™ã€‚ãã‚‚ãã‚‚ gem ã£ã¦ãªã‚“ã ã£ã‘ï¼Ÿãã‚‚ãã‚‚ gem ã£ã¦ã„ã†ã®ã¯ Ruby ã§ã§ããŸãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®äº‹ã§ã—ã¦ã€ä¾‹ãˆã°åƒ•ãŒå‡„ãä¾¿åˆ©ãªãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’æ›¸ã„ã¦ã€ãã‚Œã‚’ gem ã¨ã—ã¦å…¬é–‹ã™ã‚Œã°ã€ä¸–ç•Œä¸­ã®äººãŒåƒ•ã®ã‚¤ã‚±ã¦ã‚‹ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’ä½¿ãˆã‚‹ã‚ˆã†ã«ãªã‚‹ã€ã¨ã„ã†ã‚‚ã®ã§ã™ã€‚ã¾ã•ã« Win-Win ã—ã‹ãªã„ä»•çµ„ã¿ã€‚gem ã¯ä¸–ç•Œã‚’æ•‘ã„ã¾ã™ã€‚ä¸€æ–¹ã§ã€ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã£ã¦ã®ã¯æ–°æ©Ÿèƒ½ãŒè¿½åŠ ã•ã‚ŒãŸã‚Šã€ä¸å…·åˆãŒä¿®æ­£ã•ã‚ŒãŸã‚Šã—ã¦æ—¥ã€…ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆãŒç¹°ã‚Šè¿”ã•ã‚Œã¦ã„ã¾ã™ã€‚ã€Œã“ã®æ©Ÿèƒ½ã«ã¯ãƒãƒ¼ã‚¸ãƒ§ãƒ³ 1.3 ä»¥é™ã§ãªã„ã¨ä½¿ãˆã¾ã›ã‚“ã€ã¨ã‹ã€Œè‰²ã€…ã‚¤ã‚±ã¦ãªã„éƒ¨åˆ†ãŒå¤šã„ã‹ã‚‰ã“ã®æ©Ÿèƒ½ã¯å»ƒæ­¢ã—ã¾ã™ã€ã¨ã„ã†å¤‰æ›´ã‚‚ã‚ã‚‹ã®ã§ã€è‡ªåˆ†ã®ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã¯ä¸€ä½“ã©ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã® gem ã‚’ä½¿ã£ã¦ã„ã‚‹ã®ã‹ã€ã¨ã„ã†è©±ãŒç‰©å‡„ãé‡è¦ã ã£ãŸã‚Šã—ã¾ã™ã€‚gem ã«ã¯ã©ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’ä½¿ã£ã¦ã„ã‚‹ã®ã‹ï¼ˆä¾å­˜ã—ã¦ã„ã‚‹ã®ã‹ï¼‰ã¨ã„ã†æƒ…å ±ã‚’ç®¡ç†ã™ã‚‹æ©Ÿèƒ½ã‚‚å‚™ã‚ã£ã¦ã„ã¾ã™ã®ã§ã€ã‚ã‚‹æ—¥çªç„¶æ–°ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã§æŒ™å‹•ãŒå¤‰ã‚ã£ã¦ã‚‚ã€Œã†ã¡ã¯ä¸€å€‹å‰ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ä½¿ã£ã¦ã¾ã™ï¼ã€ã¨ã„ã†ç®¡ç†ãŒã§ãã¦ã„ã‚Œã°å‹•ã‹ãªããªã‚‹ã“ã¨ã¯ãªã„ã®ã§ã™ã€‚ã¨ã¯ã„ãˆæ–°ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã§ã„ããªã‚Šãã‚“ãªãƒˆãƒ³ãƒ‡ãƒ¢å¤‰æ›´ã•ã‚ŒãŸã‚‰å›°ã‚Šã¾ã™ã‘ã©ã‚‚ã€‚åƒ•ãŒåˆã‚ã¦ä½œã£ãŸ gemè‡ªåˆ†ãŒç”Ÿã¾ã‚Œã¦åˆã‚ã¦ä½œã£ãŸ gem ã¯ã“ã® rubocop_challenger ã¨ã„ã† gem ã§ã™ã€‚github.comä¸€èˆ¬çš„ã« gem ã¯ä»–ã®ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã¨çµ„ã¿åˆã‚ã›ã¦ä½¿ã†äº‹ãŒå¤šã„ã®ã§ã™ãŒã€ rubocop_challenger ã¯å˜ä½“ã§å‹•ä½œã™ã‚‹ã‚„ã¤ã§ã—ã¦ã€å®Ÿè¡Œã—ãŸãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªï¼ˆãƒ•ã‚©ãƒ«ãƒ€ï¼‰ã«ã‚ã‚‹ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã®ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã‚’å°‘ã—ãšã¤ç¶ºéº—ã«ï¼ˆäººé–“ã«ã¨ã£ã¦èª­ã¿ã‚„ã™ãã—ãŸã‚Šã€æ›¸ãæ–¹ã®ãƒ«ãƒ¼ãƒ«ã‚’çµ±ä¸€ã—ãŸã‚Šï¼‰ã—ã¦ãã‚Œã‚‹ã€ã¨ã„ã† gem ã§ã™ã€‚ã¨ã„ã†ã¨ç‰©å‡„ã„ç¥ gem ã§ã™ãŒã€RuboCop ã¨ã„ã†ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã‚’è§£æã—ã¦ãã‚Œã‚‹ä¾¿åˆ©ãª gem ã‚’å†…éƒ¨ã§å‘¼ã³å‡ºã—ã¦ãƒ—ãƒ«ãƒªã‚¯ï¼ˆãƒ—ãƒ«ãƒªã‚¯ãŒä½•ãªã®ã‹ã¯ã‚°ã‚°ã£ã¦ãã ã•ã„ï¼‰ä½œã£ã¦ãã‚Œã‚‹ã€ã¨ã„ã†ä»•çµ„ã¿ã«ãªã£ã¦ã„ã‚‹ã®ã§ã€ã€Œäººé–“ãŒæ¯æ—¥æ‰‹ä½œæ¥­ã§ã‚„ã‚‰ãªã„ã¨ã„ã‘ãªã‹ã£ãŸäº‹ã‚’è‡ªå‹•çš„ã«ã‚„ã‚‹ã€ã¨ã„ã†ã®ãŒ rubocop_challenger ã®æä¾›ã™ã‚‹ä¾¡å€¤ã«ãªã‚Šã¾ã™ ğŸ¤–è©³ã—ãã¯ã¡ã‚‡ã†ã©ä¸€å¹´ãã‚‰ã„å‰ã«ä¼šç¤¾ã®ãƒ–ãƒ­ã‚°ã«æ›¸ã„ãŸã®ã§ã€ã”èˆˆå‘³ã‚ã‚Šã¾ã—ãŸã‚‰æ˜¯éã€‚å¤ã„å†…å®¹ãªã®ã§ã€ç¾åœ¨ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‹ã‚‰ã¯å°‘ã—ãšã‚Œã¦ã¾ã™ã‘ã©ã€‚developer.feedforce.jpã¡ãªã¿ã«ã‚‚ã†ã™ã v2.0.0 ã‚’ãƒªãƒªãƒ¼ã‚¹ã™ã‚‹äºˆå®šã§ã™ã€‚ï¼ˆpre ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã§ã™ãŒã€ç¾æ™‚ç‚¹ã§ã‚‚ã™ã§ã«ä½¿ãˆã¾ã™ï¼‰ãƒ‹ãƒƒãƒãª gemåˆã‚ã¦ä½œã£ãŸã®ã¯ rubocop_challenger ã¨ã„ã†ã€Œäººé–“ãŒæ¯æ—¥æ‰‹ä½œæ¥­ã§ã‚„ã‚‰ãªã„ã¨ã„ã‘ãªã‹ã£ãŸäº‹ã‚’è‡ªå‹•çš„ã«ã‚„ã‚‹ã€ gem ã§ã—ãŸã€‚å®Œå…¨ã«è‡ªåˆ†ã®ä¼šç¤¾ã®ãƒ—ãƒ­ãƒ€ã‚¯ãƒˆç”¨ã«ä½œã£ãŸ gem ã§ã—ãŸãŒã€ Twitter ãªã©ã‚’ã‚¨ã‚´ã‚µã—ã¦ã‚‹ã¨ã€ã¼ã¡ã¼ã¡ä½¿ã£ã¦é ‚ã‘ã¦ã„ã‚‹ã‚ˆã†ã§ã™ã€‚åŒã˜ã‚ˆã†ãªæ‚©ã¿ã‚’æŠ±ãˆã¦ã„ã‚‹äººã¯ä¸–ã®ä¸­ã«ã¯ã„ã‚‹ã‚‚ã‚“ã§ã™ã­âœ¨ã¨ã¯ã„ãˆã€ gem ã‚’å…¬é–‹ã—ãŸã‚‰ä¸–ç•Œä¸­ã®äººãŸã¡ãŒä½¿ã£ã¦ãã‚Œã‚‹ã€ã¨ã„ã†ã“ã¨ã«ã¯ä¸­ã€…ãªã‚‰ãªã„ã§ã™ã€‚ä¸€å¿œé ‘å¼µã£ã¦è‹±èªã§èª¬æ˜ã‚’æ›¸ã„ãŸã‚Šã¯ã—ã¦ã„ã¾ã™ãŒã€å€‹äººã®ç™ºä¿¡åŠ›ã«ã¯é™ç•Œã‚‚ã‚ã‚Šã¾ã™ã—ã€ä½•ã‚ˆã‚Šãƒ‹ãƒƒãƒã§ã™ã€‚ã¨ã„ã†ã‹ã€å€‹äººãŒä½œã‚‹ gem ãªã‚“ã¦å¤§æŠµã¯ãƒ‹ãƒƒãƒãªã‚‚ã®ã«ãªã‚Šã¾ã™ã€‚ã€Œã‚ãƒ¼ã€ã“ã‚“ãª gem ã‚ã£ãŸã‚‰ã‚ã£ã¡ã‚ƒä¾¿åˆ©ã‚„ã‚“ï¼Ÿã€ã¨ã„ã† gem ã¯å¤§æŠµä¸–ç•Œã®ã©ã“ã‹ã®èª°ã‹ãŒä½œã£ã¦ã¾ã™ã€‚ãªã®ã§ã€ä»Šã¾ã§ã«ãªã„ã‚ˆã†ãªæ–°ã—ã„gem ã‚’ä½œã‚ã†ã¨æ€ã£ãŸã‚‰å¤§æŠµãƒ‹ãƒƒãƒã«ãªã‚Šã¾ã™ã€‚ã˜ã‚ƒã‚ gem ã‚’å…¬é–‹ã—ã¦ã‚‚å¤§ã—ã¦ä½¿ã£ã¦ã‚‚ã‚‰ãˆãªã„ã—ã€ã‚ã‚“ã¾ã‚Šæ„å‘³ãªã„ã˜ã‚ƒã‚“ã€ã£ã¦æ€ã†ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ãŒã€æ„å‘³ç„¡ãã¯ãªã„ã‚“ã§ã™ã‚ˆã­ğŸ‘åŠ¹èƒ½ 1. ã‚¹ã‚­ãƒ«ã‚¢ãƒƒãƒ—ã¾ãšã€ã‚ã£ã¡ã‚ƒãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’æ›¸ãå‹‰å¼·ã«ãªã‚Šã¾ã™ã€‚Ruby ã§ Web é–‹ç™ºã‚’ã—ã¦ã„ã‚‹äººã¯å¤§æŠµ Ruby on Rails ã‚’ä½¿ã£ã¦æ›¸ã„ã¦ã‚‹ã¨æ€ã„ã¾ã™ã€‚ã¡ãªã¿ã« Ruby on Rails ã‚‚ gem ã§ã™ã€‚Ruby on Rails ã¯å‡„ãã‚ˆãå‡ºæ¥ã¦ã„ã‚‹ã®ã§ã€Web é–‹ç™ºã®é›£ã—ã„éƒ¨åˆ†ã‚’ 9 å‰²ãã‚‰ã„ã®è‚©ä»£ã‚ã‚Šã—ã¦ãã‚Œã¾ã™ã€‚ã¨ã“ã‚ãŒã€è‡ªåˆ†ã§ä¸€ã‹ã‚‰ gem ã‚’ä½œã‚ã†ã¨ã™ã‚‹ã¨ã€è‡ªåˆ†ã®åŠ›ã§è§£æ±ºã—ãªã„ã¨ã„ã‘ãªã„ãƒ—ãƒ­ã‚°ãƒ©ãƒ çš„ãªèª²é¡ŒãŒã‚ã£ã¡ã‚ƒã‚ã‚Šã¾ã™ã€‚Web é–‹ç™ºã¯ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆç‰¹æœ‰ã®èª²é¡ŒãŒå¤šã„ã§ã™ãŒã€ gem ã®é–‹ç™ºã«ã¯ Web é–‹ç™ºä»¥å¤–ã®çŸ¥è­˜ã‚‚è‰²ã€…è¦æ±‚ã•ã‚ŒãŸã‚Šã—ã¾ã™ã€‚ä½•ã‚ˆã‚Šã€è‡ªåˆ†è‡ªèº«ã§ä»•æ§˜ã‚’ä¸€ã‹ã‚‰è€ƒãˆãªã„ã¨ã„ã‘ãªã„ã®ã§ã€æ™®æ®µã®é–‹ç™ºä»¥ä¸Šã«æ„æ€æ±ºå®šé‡ãŒã‚ã£ã¡ã‚ƒå¤šã„ã§ã™ã€‚è‡ªåˆ†ã¯ rubocop_challenger ä»¥å¤–ã«ã‚‚ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹ã—ã¦ã„ã‚‹ gem ãŒ 3 ã¤ã»ã©ã‚ã‚Šã¾ã™ãŒã€ã“ã‚Œã‚‰ã®é–‹ç™ºã‚’é€šã—ã¦æ—¥é ƒã® Web é–‹ç™ºã®å“è³ªã‚‚ä¸€æ®µãƒ¬ãƒ™ãƒ«ãŒä¸ŠãŒã£ãŸãªã€ã¨æ„Ÿã˜ã‚‹äº‹ãŒå¤šã„ã§ã™ã€‚ãªã®ã§ã€gem ã®é–‹ç™ºã¯è‡ªåˆ†è‡ªèº«ã®ä¿®è¡Œã®ãŸã‚ã ã¨æ€ã£ã¦ã‚„ã‚‹ã¨è‰¯ã„ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚èª°ã‹ã«ä½¿ãˆã¦ã‚‚ã‚‰ãˆãŸã‚‰ãƒ©ãƒƒã‚­ãƒ¼ã€ã¿ãŸã„ãªã€‚é€†ã«ä½¿ã£ã¦ã‚‚ã‚‰ãˆã‚‹äº‹ã‚’ãƒ¢ãƒãƒ™ãƒ¼ã‚·ãƒ§ãƒ³ã«ã™ã‚‹ã¨ã¡ã‚‡ã£ã¨è¾›ã„ã‹ã‚‚ã—ã‚Œãªã„ã§ã™ã€‚æ€ã£ãŸä»¥ä¸Šã«æµè¡Œã‚‰ãªã„ã€‚ã‚‚ã£ã¨æµè¡Œã‚Œï¼åŠ¹èƒ½ 2. ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒªã‚ªgem ã‚’å…¬é–‹ã—ã¦ã‚‹ã›ã„ã‹ã€ä¼æ¥­ã‹ã‚‰ã®ã‚¹ã‚«ã‚¦ãƒˆãŒã‚ã£ã¡ã‚ƒæ¥ã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚è‡ªåˆ†è‡ªèº«ã€ä¼šç¤¾ã®æ¡ç”¨æ´»å‹•ã«é–¢ã‚ã‚‹æ©Ÿä¼šãŒå¤šã„ã®ã§ã™ãŒã€ä¾‹ãˆã°ã‚¹ã‚«ã‚¦ãƒˆå€™è£œã‚’æ¢ã™éš›ã«å€™è£œè€…ã® GitHub ã¯å¿…ãšè¦‹ã‚‹ã‚ˆã†ã«ã—ã¦ã„ã¾ã™ã€‚ãã®çµŒé¨“ã‹ã‚‰ã§ã™ãŒè‡ªåˆ†ã§ gem æ›¸ã„ã¦å…¬é–‹ã—ã¦ã„ã‚‹ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ã¯ä¸–ã®ä¸­ã® 1 å‰²ã‚‚ã„ãªã„ã‚“ã˜ã‚ƒãªã„ã‹ãªã€ã£ã¦æ€ã£ã¦ã„ã¾ã™ã€‚è‡ªåˆ†ã‚‚ gem ã‚’ä½œã‚‹ã‚ˆã†ã«ãªã£ãŸã®ã¯ã“ã“ 1 ~ 2 å¹´ã§ã™ã—ã€å‰è·ã«ã„ãŸé ƒã ã¨æ™®æ®µã®ä»•äº‹ã®å¸°ã‚ŠãŒé…ã‹ã£ãŸã‚Šã‚‚ã—ãŸã®ã§å®¶ã«å¸°ã£ã¦ã‹ã‚‰ gem ã‚’ä½œã‚‹ã‚ˆã†ãªä½™è£•ã‚‚ã‚ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚ãªã®ã§ã€æœ¬äººã®ç†±é‡ã‚„ç’°å¢ƒãŒæ•´ã‚ãªã„ã¨ gem ã®é–‹ç™ºã¯é›£ã—ã„ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚ã—ã‹ã—ãªãŒã‚‰ã€è‡ªåˆ†ã‚‚æ¡ç”¨æ´»å‹•ã—ã¦ã„ã¦ã€ŒãŠã€‚ã“ã®äººã™ã”ã„ã‚„ã‚“ã€ã£ã¦ãªã‚‹ã®ã¯ GitHub ã‚„ Qiita ã¨ã‹ã§ä½•ã‹ã—ã‚‰ã‚¢ã‚¦ãƒˆãƒ—ãƒƒãƒˆã®ã‚ã‚‹æ–¹ãªã‚“ã§ã™ã‚ˆã­ã€‚ã‚‚ã¡ã‚ã‚“ã‚¢ã‚¦ãƒˆãƒ—ãƒƒãƒˆãŒç„¡ãã¦ã‚‚å®Ÿéš›ä¼šã£ã¦ã¿ãŸã‚‰å‡„ã‹ã£ãŸã£ã¦äººã¯æ²¢å±±ã„ã‚‹ã‚“ã§ã™ãŒã€æ¡ç”¨æ´»å‹•ã ã¨ãã®äººã®ä»•äº‹ã§ã®ã‚¢ã‚¦ãƒˆãƒ—ãƒƒãƒˆã£ã¦è¦‹ãˆãªã„ã‚‚ã‚“ã§ã™ã‹ã‚‰ã€‚ã€‚åˆ¥ã« gem ã˜ã‚ƒãªãã¦ã‚‚è‰¯ã„ã‚“ã§ã™ãŒã€è‡ªåˆ†è‡ªèº«ã®ã‚­ãƒ£ãƒªã‚¢å½¢æˆã‚’æ„è­˜ã™ã‚‹ãŸã‚ã®ã‚¢ã‚¦ãƒˆãƒ—ãƒƒãƒˆã®ä¸€ç’°ã¨ã—ã¦ã¨ã¦ã‚‚æœ‰ç”¨ã ã¨æ€ã„ã¾ã™ã€‚åŠ¹èƒ½ 3. é­”æ³•ã®ã‚¢ã‚¤ãƒ†ãƒ è‡ªåˆ†ãŒä»Šå¹´ä½œã£ãŸ gem ã« my_api_client ã¨ã„ã† gem ãŒã‚ã‚Šã¾ã—ã¦ã€API Client ã‚’ä½œã‚‹ãŸã‚ã®ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ãªã‚“ã§ã™ãŒã€ã“ã‚Œã¯ãƒ—ãƒ­ãƒ€ã‚¯ãƒˆã®ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã«ã‚‚ä½¿ã£ã¦ã„ã¾ã™ã€‚è‡ªåˆ†ãŒæºã‚ã£ã¦ã‚‹ã‚µãƒ¼ãƒ“ã‚¹ã¯ ã‚½ãƒ¼ã‚·ãƒ£ãƒ«PLUS ã¨ã„ã†ã‚‚ã®ã§ã—ã¦ã€ä¼æ¥­ã® Web ã‚µãƒ¼ãƒ“ã‚¹ã¨ã‚½ãƒ¼ã‚·ãƒ£ãƒ«ãƒ­ã‚°ã‚¤ãƒ³ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼ï¼ˆ LINE ã¨ã‹ Twitter ã¨ã‹ï¼‰ã®ãƒãƒ–ã«ãªã£ã¦ã‚‹ã‚µãƒ¼ãƒ“ã‚¹ãªã‚“ã§ã™ã­ã€‚ãã®ã›ã„ã‚‚ã‚ã£ã¦ã€å¤–éƒ¨ã® Web API ã¸ãƒªã‚¯ã‚¨ã‚¹ãƒˆã™ã‚‹ã¨ã„ã†å‡¦ç†ãŒå¤šãã€æ¯å›åŒã˜ã‚ˆã†ãªã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã‚„ãƒªãƒˆãƒ©ã‚¤ã®å‡¦ç†ã‚’ä½•åº¦ã‚‚æ›¸ã‹ãªã„ã¨ã„ã‘ãªãã¦å¤§å¤‰ã ã£ãŸè¨³ã§ã™ã€‚ã‚ã¨ã€ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ãŸéš›ã«ã€Œã‚½ãƒ¼ã‚·ãƒ£ãƒ«PLUSã€ã€Œã‚½ãƒ¼ã‚·ãƒ£ãƒ«PLUSã‚’åˆ©ç”¨ã—ã¦ã„ã‚‹ä¼æ¥­ã€ã€Œã‚½ãƒ¼ã‚·ãƒ£ãƒ«ãƒ­ã‚°ã‚¤ãƒ³ãƒ—ãƒ­ãƒã‚¤ãƒ€ã€ã®èª°ãŒåŸå› ãªã®ã‹ã‚’ç‰¹å®šã™ã‚‹ãŸã‚ã®æƒ…å ±ã‚’ãƒ­ã‚°ã«æ®‹ã™ã¨ã‹ã‚‚éƒ½åº¦å¯¾å¿œã—ãªã„ã¨ã„ã‘ãªãã¦è¶…å¤§å¤‰ã§ã—ãŸã€‚my_api_client ã¯ãã®è¾ºã®å‡¦ç†ã‚’ã™ã£ãã‚Šç°¡å˜ã«æ›¸ã‘ã‚‹ã‚ˆã†ã«ã™ã‚‹ãŸã‚ã® gem ã§ã—ã¦ã€ã™ã£ãã‚Šç°¡å˜ãªã‚‚ã‚“ã ã‹ã‚‰ã€ãƒãƒ¼ãƒ ãƒ¡ã‚¤ãƒˆãŒ my_api_client ã‚’æ´»ç”¨ã—ã¦è‡ªç™ºçš„ã«ã‚¬ãƒ³ã‚¬ãƒ³èª²é¡Œã‚’è§£æ±ºã—ã¦ãã‚Œã‚‹ã€ã¨ã„ã†æœ€é«˜ã«ãƒ›ãƒƒãƒˆãªçŠ¶æ³ã‚’ç”£ã¿å‡ºã™ã“ã¨ã«ä¸€å½¹è²·ã£ã¦ãŠã‚Šã¾ã™ã€‚ã‚„ã£ã±ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ã‚‚äººé–“ãªã®ã§ã€æ™®æ®µã®æ¥­å‹™ã§å¿™ã—ã„ä¸­ã§æ”¹å–„æ´»å‹•ã‚‚åŒæ™‚ã«ã‚„ã‚ã†ãªã‚“ã¦ãƒ¢ãƒãƒ™ãƒ¼ã‚·ãƒ§ãƒ³ã¯æ™®é€šã¯æ¹§ã„ã¦ã“ãªã„è¨³ã§ã™ã€‚ã§ã‚‚ã€ã“ã‚Œã‚’ä½¿ãˆã°ã™ã£ãã‚Šç°¡å˜ã ã‚ˆã€ã£ã¦ã„ã†é­”æ³•ã®ã‚¢ã‚¤ãƒ†ãƒ ãŒã‚ã‚Œã°ã€ã¿ã‚“ãªã®é‡ã„è…°ã‚’å°‘ã—ã ã‘è»½ãã™ã‚‹äº‹ãŒã§ãã¾ã™ã€‚my_api_client ã¯è‡ªåˆ†ã®ä¸­ã§ã‚‚å‰²ã¨ã‚ˆãã§ããŸ gem ãªã®ã§ã€æ¯å›ã“ã‚“ãªè‰¯ã„ gem ãŒä½œã‚Œã‚‹è¨³ã˜ã‚ƒãªã„ã§ã™ã‘ã©ã€ gem ã‚’ä½œã£ã¦ãƒãƒ¼ãƒ ã®ç”Ÿç”£æ€§ãŒä¸ŠãŒã‚‹ã£ã¦ã®ã¯ã‚„ã£ã±é­”æ³•ã®ã‚¢ã‚¤ãƒ†ãƒ ã ãªãã£ã¦æ€ã†ã‚“ã§ã™ã€‚gem ã¯ä¸–ç•Œã‚’æ•‘ã„ã¾ã™ï¼ï¼ˆï¼’å›ç›®ï¼‰ãªãŠã€ my_api_client ã«ã¤ã„ã¦ã¯ éŠ€åº§ Rails #10 ã§ç™»å£‡ã—ãŸã¨ãã®è³‡æ–™ãŒã‚ã‚‹ã®ã§è²¼ã£ã¦ãŠãã¾ã™ã€‚ã“ã‚Œã‚‚è‹¥å¹²å¤ã„ã®ã§ã€æœ€æ–°ã®ä»•æ§˜ã¨ã¯å°‘ã—ç•°ãªã‚‹ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚æœ€æ–°ã®ä»•æ§˜ã¯ ã“ã¡ã‚‰ ã‚’ã”è¦§ä¸‹ã•ã„ã€‚åŠ¹èƒ½ 4. ãŸã®ã—ã„æœ€å¾Œã¯ã“ã“ã«å¸°ã£ã¦ãã‚‹ã‚“ã§ã™ãŒã€è‡ªåˆ†ã® gem ã‚’ä½œã‚‹ã®ã¯ã‚„ã£ã±æ¥½ã—ã„ã®ã§ã™ã€‚ã„ããªã‚Šé ­æ‚ªã„æ–‡ç« ã«ãªã‚Šã¾ã—ãŸã€‚ã„ã¤ã‹ã‚‰é ­è‰¯ã„æ–‡ç« æ›¸ã„ã¦ã‚‹ã¨éŒ¯è¦šã—ã¦ã„ãŸï¼Ÿä»¥å‰å‹‰å¼·ä¼šã§ã€Œã“ã‚Œã¾ã§ã©ã†ã„ã†ã‚­ãƒ£ãƒªã‚¢ã‚’æ„è­˜ã—ã¦ã‚„ã£ã¦ãã¾ã—ãŸã‹ï¼Ÿã€ã£ã¦è‹¥æ‰‹ã®ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ã‹ã‚‰èã‹ã‚ŒãŸã®ã§ã™ãŒã€è‡ªåˆ†ã¿ãŸã„ãª 30 åŠã°ã®ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ã£ã¦ã€ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ã«ãªã£ãŸå½“åˆã¯ä»Šã¿ãŸã„ã«ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ãŒæŒã¦å›ƒã•ã‚Œã‚‹æ™‚ä»£ã§ã‚‚ãªã‹ã£ãŸã®ã§ã€è‡ªåˆ†ã‹ã‚‰ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ã«ãªã‚ã†ã£ã¦æ€ã£ãŸäººã¯å°‘ãªã‹ã‚‰ãšã€ŒãŸã ãƒ—ãƒ­ã‚°ãƒ©ãƒ ãŒå¥½ãã ã£ãŸã€ã£ã¦ã„ã†äººãŒå¤šã„ã‚“ã˜ã‚ƒãªã„ã§ã™ã‹ã­ï¼Ÿã‚ã‹ã‚“ãªã„ã§ã™ã‘ã©è‡ªåˆ†ã¯ãã†ã§ã—ãŸã€‚è‡ªä½œã® gem ã‚’ä½œã£ã¦ã‚‹ã¨ã€Œã‚„ã£ã±ãƒ—ãƒ­ã‚°ãƒ©ãƒ æ›¸ãã®ã£ã¦æ¥½ã—ã„ã€ã£ã¦ã®ã‚’æ€ã„å‡ºã•ã›ã¦ãã‚Œã¾ã™ã€‚è‡ªåˆ†ã¯ä»–ã«ã‚‚è¶£å‘³ã§ãƒãƒ³ãƒ‰ã‚„ã£ãŸã‚Šçµµã‚’æã„ãŸã‚Šã—ã¦ã„ã¾ã™ãŒã€ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°ãŒå­ä¾›ã®é ƒã«å¥½ãã ã£ãŸå·¥ä½œã«ä¸€ç•ªè¿‘ã„ã‚ˆã†ãªæ°—ãŒã—ã¦ã„ã¾ã™ã€‚ä¸­ã€…ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆã§æ™‚é–“ã‚’ä½œã‚‹ã®ã¯é›£ã—ã„ã‚“ã§ã™ãŒã€ã‚„ã¯ã‚Šæ¥½ã—ã•ãŒä¸€ç•ªæ ¹åº•ã®åŸå‹•åŠ›ã«ãªã£ã¦ã„ã‚‹ã®ã‹ã‚‚ã—ã‚Œãªã„ã§ã™ã­ã€‚ã¾ã¨ã¾ã‚‰ãªã„ã¾ã¨ã‚ä¼šç¤¾ã®ã‚¢ãƒ‰ãƒ™ãƒ³ãƒˆã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼å‘ã‘ã ã—ã€éã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ã«ã‚‚ä¼ã‚ã‚‹ã‚ˆã†ãªãƒ•ãƒ¯ãƒƒã¨ã—ãŸæ–‡ç« ã«ã—ã‚ˆã†ã¨æ€ã£ã¦æ›¸ã„ã¦ãŸã‚‰ã€é€”ä¸­ã‹ã‚‰ä¿ºã®ãƒã‚¨ãƒ ã‚’æ›¸ãæ®´ã£ã¦ãŸã ã‘ã«ãªã£ãŸæ°—ãŒã—ã¾ã™ãŒã€å½¹ã«ç«‹ã¤ã‹ã©ã†ã‹ã¯ 2 ã®æ¬¡ã«ã—ã¦ã€ã¨ã‚Šã‚ãˆãš gem ä½œã£ã¦ã¿ã‚‹ã¨æ¥½ã—ãã‚¹ã‚­ãƒ«ã‚¢ãƒƒãƒ—ã§ãã‚‹ã—ã€ã‚‚ã—ã‹ã—ãŸã‚‰èª°ã‹ã®é­”æ³•ã®ã‚¢ã‚¤ãƒ†ãƒ ã«ãªã£ã¦ã‚‹ã‹ã‚‚ã—ã‚Œãªã„ã‚ˆã€ã¨ã„ã†ãŠè©±ã§ã—ãŸã€‚ä¹…ã€…ã«ã‚†ã‚‹ã€œã„æ–‡ç« æ›¸ã„ã¦ã¦è‡ªåˆ†çš„ã«ã¯æ¥½ã—ã‹ã£ãŸã§ã™ ç¬‘ã•ã¦ã€æ˜æ—¥ã® Advent Calendar ã¯ï¼Ÿï¼ˆCV. åŠ è—¤ã¿ã©ã‚Šï¼‰Feedforce Advent Calendar 2019ã€æ˜æ—¥ã¯ä¸Šå²¡å›ãŒã€Œé‡çƒã«ã¤ã„ã¦oré éš”ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ³ã«ã¤ã„ã¦ã€æ›¸ã„ã¦ãã‚Œã‚‹ã¿ãŸã„ã§ã™ã€‚æœ€è¿‘ã¯ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ³ã‚‚é éš”ã§å‡ºæ¥ã‚‹ã‚“ã§ã™ã­ã€‚é‡çƒã‚‚é éš”ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ³ã‚‚æœªçµŒé¨“ã®ã¾ã¾ãŠã˜ã•ã‚“ã«ãªã£ã¦ã—ã¾ã£ãŸã®ã§è‡ªåˆ†ã«ã¯æœªçŸ¥ã®é ˜åŸŸã§ã™âš¾ï¸ğŸ’¨ä¹ã†ã”æœŸå¾…ï¼","link":"https://ryz310.hateblo.jp/entry/2019/12/15/224312","isoDate":"2019-12-15T13:43:12.000Z","dateMiliSeconds":1576417392000,"imageUrl":"https://cdn.blog.st-hatena.com/images/theme/og-image-1500.png","authorName":"ryz310"},{"title":"ã¾ã  .rubocop_todo.yml ã§æ¶ˆè€—ã—ã¦ã‚‹ã®ï¼Ÿ","content":"<p>ã©ã†ã‚‚ã€ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ã®ã‚µãƒˆã‚¦ãƒªãƒ§ã‚¦ã‚¹ã‚±ã§ã™ âœŒï¸('Ï‰')âœŒï¸</p>\n\n<p>è‹¥å¹²é‡£ã‚Šè‡­ã„ã‚¿ã‚¤ãƒˆãƒ«ã§ã™ãŒã€å…ˆæ—¥ <a href=\"https://github.com/ryz310/rubocop_challenger\">RubocopChallenger</a> ã¨ã„ã† gem ã® <code>v1.0.0</code> ã‚’ãƒªãƒªãƒ¼ã‚¹ã—ãŸã®ã§ç´¹ä»‹ã•ã›ã¦é ‚ãã¾ã™ ğŸ™</p>\n\n<p><iframe src=\"https://hatenablog-parts.com/embed?url=https%3A%2F%2Fgithub.com%2Fryz310%2Frubocop_challenger\" title=\"GitHub - ryz310/rubocop_challenger: Make a clean your rubocop_todo.yml with CI\" class=\"embed-card embed-webcard\" scrolling=\"no\" frameborder=\"0\" style=\"display: block; width: 100%; height: 155px; max-width: 500px; margin: 10px 0px;\"></iframe><cite class=\"hatena-citation\"><a href=\"https://github.com/ryz310/rubocop_challenger\">github.com</a></cite></p>\n\n<h2>çµŒç·¯</h2>\n\n<p>åƒ•ãŒæ‰€å±ã—ã¦ã„ã‚‹ <a href=\"https://socialplus.jp/\">ã‚½ãƒ¼ã‚·ãƒ£ãƒ«PLUS</a> ã¯ 2012 å¹´é ƒã‹ã‚‰é–‹ç™ºãŒå§‹ã¾ã‚Šã¾ã—ãŸã€‚Rails ã®ãƒ—ãƒ­ãƒ€ã‚¯ãƒˆã¨ã—ã¦ã¯å¤æ ªã®æ–¹ã ã¨æ€ã„ã¾ã™ã€‚</p>\n\n<p>ã‚½ãƒ¼ã‚·ãƒ£ãƒ«PLUS ã« <a href=\"https://github.com/rubocop-hq/rubocop\">RuboCop</a> ãŒå°å…¥ã•ã‚ŒãŸã®ã¯ 2017/02 é ƒ <sup id=\"fnref:1\"><a href=\"#fn:1\" rel=\"footnote\">1</a></sup> ã§ã€ãã‚Œã¾ã§ç‰¹ã« RuboCop ã‚’æ„è­˜ã—ãŸã‚³ãƒ¼ãƒ‰ã§é–‹ç™ºã‚’é€²ã‚ã¦ã“ãªã‹ã£ãŸã®ã§ã€å·¨å¤§ãª .rubocop_todo.yml ãŒå‡ºåŠ›ã•ã‚Œã€ãã‚ŒãŒæ‰‹ä»˜ã‹ãšã®ã¾ã¾ã«ãªã£ã¦ã—ã¾ã£ã¦ã„ã¾ã—ãŸã€‚ã¡ãªã¿ã«å½“åˆã¯ <strong>1669 è¡Œ 195 ç¨®é¡</strong> ã®é•åãƒ«ãƒ¼ãƒ«ãŒã‚ã‚Šã¾ã—ãŸã€‚</p>\n\n<p>ã“ã®ã¾ã¾ã§ã¯ RuboCop ã®æ©æµãŒå—ã‘ã‚‰ã‚Œãªã„ã®ã§ã€ RuboCop Challenge ã¨ç§°ã—ã¦ (ä»¥å‰ <a href=\"https://ja.wikipedia.org/wiki/%E3%82%A2%E3%82%A4%E3%82%B9%E3%83%BB%E3%83%90%E3%82%B1%E3%83%84%E3%83%BB%E3%83%81%E3%83%A3%E3%83%AC%E3%83%B3%E3%82%B8\">Ice Bucket Challenge</a> ãŒæµè¡Œã£ã¦ã„ãŸã®ã§) é€±ã‚¤ãƒã§ <code>.rubocop_todo.yml</code> ã‹ã‚‰é•åãƒ«ãƒ¼ãƒ«ã‚’ä¸€ã¤æ¶ˆã—ã¦ã€ auto-correct ã§ä¿®æ­£ã™ã‚‹ã€ã¨ã„ã†äº‹ã‚’ã‚„ã£ã¦ã„ãŸã®ã§ã™ãŒã€æ•°ãƒ¶æœˆï¼ˆæ•°é€±é–“ã ã£ãŸã‹ã‚‚ï¼‰ã§ã™ã£ã‹ã‚Šã‚„ã‚‹ã®ã‚’å¿˜ã‚Œã¦ã—ã¾ã„ã¾ã—ãŸ ğŸ˜‡</p>\n\n<p>æœ€è¿‘ã¾ãŸ RuboCop Challenge ã‚’å†é–‹ã—ã‚ˆã†ã€ã¨ã„ã†æµã‚Œã«ãªã£ãŸã®ã§ã™ãŒã€æ‰‹å‹•ã§ã‚³ãƒ„ã‚³ãƒ„ã‚„ã‚‹ã®ã‚‚ç²¾ç¥çš„ã«ã—ã‚“ã©ããªã£ã¦æ¥ãŸã®ã§ã€ãªã‚“ã¨ã‹è‡ªå‹•åŒ–ã—ãŸã„ãªã€ã¨ã„ã†æ°—æŒã¡ã«ãªã‚Šã€æ‰‹å‹•ã§ã‚„ã£ã¦ã„ãŸ Rubocop Challenge ã‚’ Ruby ã‚¹ã‚¯ãƒªãƒ—ãƒˆã§å‹•ã‹ã›ã‚‹ã‚ˆã†ã«ã—ã¾ã—ãŸã€‚\næœ€åˆã¯å˜ç´”ãª Ruby ã‚¹ã‚¯ãƒªãƒ—ãƒˆã ã£ãŸã®ã§ã™ãŒã€ã›ã£ã‹ããªã®ã§ gem åŒ–ã—ã‚ˆã†ã€ã¨ã„ã†äº‹ã«ãªã‚Šã€ä½œæˆã—ãŸã®ãŒ RubocopChallenger ã§ã™ã€‚</p>\n\n<p>ã¨ã“ã‚ã§ã€å¼Šç¤¾ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ã® <a href=\"http://blog.hatena.ne.jp/masutaka26/\" class=\"hatena-id-icon\"><img src=\"https://cdn.profile-image.st-hatena.com/users/masutaka26/profile.png\" width=\"16\" height=\"16\" alt=\"\" class=\"hatena-id-icon\">id:masutaka26</a> ãŒ circleci-bundle-update-pr ã¨ã„ã† CI ã‚’åˆ©ç”¨ã—ãŸ Bundle Update ã®è‡ªå‹•æ›´æ–° gem ã‚’ä½œæˆã—ã¦ã„ã¾ã™ã€‚</p>\n\n<p><iframe src=\"https://hatenablog-parts.com/embed?url=https%3A%2F%2Fgithub.com%2Fmasutaka%2Fcircleci-bundle-update-pr\" title=\"GitHub - masutaka/circleci-bundle-update-pr: Provide continues bundle update using CircleCI\" class=\"embed-card embed-webcard\" scrolling=\"no\" frameborder=\"0\" style=\"display: block; width: 100%; height: 155px; max-width: 500px; margin: 10px 0px;\"></iframe><cite class=\"hatena-citation\"><a href=\"https://github.com/masutaka/circleci-bundle-update-pr\">github.com</a></cite></p>\n\n<p>ã“ã‚Œã«æ„ŸéŠ˜ã‚’å—ã‘ã¦ (ï¼Ÿ) è‡ªåˆ†ã® RubocopChallenger ã‚‚ CI ã‹ã‚‰<code>$ rubocop --auto-correct</code> ã‚’å®Ÿè¡Œã—ãŸçµæœãŒ PR ã¨ã—ã¦å±Šãã‚ˆã†ãªä»•çµ„ã¿ã«ãªã£ã¦ã„ã¾ã™ã€‚</p>\n\n<h2>ä½¿ã„æ–¹</h2>\n\n<p><strong>2021-09-23 ä¿®æ­£</strong></p>\n\n<h3>1. <code>.circleci/config.yml</code> ã®ç·¨é›†</h3>\n\n<p>ä»¥ä¸‹ã«è¨­å®šä¾‹ã‚’ç´¹ä»‹ã—ã¾ã™ã€‚</p>\n\n<pre class=\"code lang-yaml\" data-lang=\"yaml\" data-unlink><span class=\"synComment\"># .circleci/config.yml</span>\n<span class=\"synIdentifier\">version</span><span class=\"synSpecial\">:</span> <span class=\"synConstant\">2</span>\n\n<span class=\"synIdentifier\">jobs</span><span class=\"synSpecial\">:</span>\n  <span class=\"synIdentifier\">rubocop_challenge</span><span class=\"synSpecial\">:</span>\n    <span class=\"synIdentifier\">docker</span><span class=\"synSpecial\">:</span>\n      <span class=\"synStatement\">- </span><span class=\"synIdentifier\">image</span><span class=\"synSpecial\">:</span> circleci/ruby:2.5-node-browsers\n    <span class=\"synIdentifier\">working_directory</span><span class=\"synSpecial\">:</span> ~/repo\n    <span class=\"synIdentifier\">steps</span><span class=\"synSpecial\">:</span>\n      <span class=\"synStatement\">- </span>checkout\n      <span class=\"synStatement\">- </span><span class=\"synIdentifier\">run</span><span class=\"synSpecial\">:</span>\n          <span class=\"synIdentifier\">name</span><span class=\"synSpecial\">:</span> Rubocop Challenge\n          <span class=\"synIdentifier\">command</span><span class=\"synSpecial\">:</span> |\n            gem install rubocop_challenger\n            bundle exec rubocop_challenger go \\\n              --email={RubocopChallenger ãŒ commit ã™ã‚‹éš›ã® user email} \\\n              --name=&quot;{RubocopChallenger ãŒ commit ã™ã‚‹éš›ã® user name}&quot;\n\n<span class=\"synIdentifier\">workflows</span><span class=\"synSpecial\">:</span>\n  <span class=\"synIdentifier\">version</span><span class=\"synSpecial\">:</span> <span class=\"synConstant\">2</span>\n\n  <span class=\"synIdentifier\">nightly</span><span class=\"synSpecial\">:</span>\n    <span class=\"synIdentifier\">triggers</span><span class=\"synSpecial\">:</span>\n      <span class=\"synStatement\">- </span><span class=\"synIdentifier\">schedule</span><span class=\"synSpecial\">:</span>\n          <span class=\"synIdentifier\">cron</span><span class=\"synSpecial\">:</span> <span class=\"synConstant\">&quot;30 23 * * 1,2,3&quot;</span><span class=\"synComment\"> # ã“ã®è¨­å®šã®å ´åˆã€ç«æ°´æœ¨ ã®æ¯æœ 8:30 ã« RubocopChallnger ã® PR ãŒå±Šãã¾ã™</span>\n          <span class=\"synIdentifier\">filters</span><span class=\"synSpecial\">:</span>\n            <span class=\"synIdentifier\">branches</span><span class=\"synSpecial\">:</span>\n              <span class=\"synIdentifier\">only</span><span class=\"synSpecial\">:</span>\n                <span class=\"synStatement\">- </span>master\n    <span class=\"synIdentifier\">jobs</span><span class=\"synSpecial\">:</span>\n      <span class=\"synStatement\">- </span>rubocop_challenge\n</pre>\n\n\n<p>ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã®éš›ã€ <strong>Gemfile ã« <code>gem 'rubocop_challenger'</code> ã‚’è¿½è¨˜ã—ãªã„ã‚ˆã†ã«ã”æ³¨æ„ä¸‹ã•ã„ã€‚</strong>\nä»–ã® gem ã¨ã®äº’æ›æ€§å•é¡Œã«ã‚ˆã‚Šã€ rubocop_challenger å®Ÿè¡Œä¸­ã«ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã™ã‚‹ã‚±ãƒ¼ã‚¹ãŒã‚ã‚‹ã“ã¨ã‚’ç¢ºèªã—ã¦ãŠã‚Šã¾ã™ã€‚</p>\n\n<h3>2. GitHub personal access token ã®ä½œæˆ</h3>\n\n<p>RubocopChallenger ãŒ PR ã‚’ä½œæˆã™ã‚‹ãŸã‚ã« GitHub personal access token ãŒå¿…è¦ã«ãªã‚Šã¾ã™ã€‚\n<a href=\"https://github.com/settings/tokens\">Settings</a> ã‹ã‚‰ <a href=\"https://github.com/settings/tokens/new\">Generate new token</a> ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦ access token ã‚’ä½œæˆã—ã¾ã™ã€‚\n<strong>Select Scopes</strong> ã§ã¯ <code>repo</code> ã«ãƒã‚§ãƒƒã‚¯ âœ… ã‚’å…¥ã‚Œã¦ä¸‹ã•ã„ã€‚</p>\n\n<p><img src=\"https://github.com/ryz310/rubocop_challenger/raw/master/images/generate_token.png\" alt=\"Generate new token\" /></p>\n\n<h3>3. CircleCI ã§ç’°å¢ƒå¤‰æ•°ã®è¨­å®š</h3>\n\n<p>ä»Šå›ã¯ <a href=\"https://circleci.com/\">CircleCI</a> ã§ã®åˆ©ç”¨ä¾‹ã‚’ç´¹ä»‹ã—ã¾ã™ ğŸ™</p>\n\n<p><a href=\"https://circleci.com/dashboard\">ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ç”»é¢</a> ã«ç§»å‹•ã—ã€ RubocopChallenger ã‚’é©ç”¨ã—ãŸã„ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã® <strong>Project Settings</strong> -> <strong>Environment Variables</strong> ã¸ã¨ç§»å‹•ã—ã¾ã™ã€‚\n<strong>Add Variable</strong> ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦ <code>GITHUB_ACCESS_TOKEN</code> ã¨ã„ã† Key ã§å…ˆç¨‹ä½œæˆã—ãŸ GitHub personal access token ã‚’è¨­å®šã—ã¾ã™ã€‚</p>\n\n<p><img src=\"https://github.com/ryz310/rubocop_challenger/raw/master/images/circleci_environment_variables.png\" alt=\"Environment Variables\" /></p>\n\n<h3>5. ä½œæˆã•ã‚ŒãŸ PR ã®ç¢ºèª</h3>\n\n<p>ã“ã“ã¾ã§ã®æ‰‹é †ã‚’çµ‚ãˆã‚‹ã¨ã€ CircleCI ã«æŒ‡å®šã—ãŸã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ã§ PR ãŒã•ã‚Œã‚‹ã‚ˆã†ã«ãªã‚‹ã¨æ€ã„ã¾ã™ã€‚\nå¾Œã¯ auto-correct ã®å†…å®¹ã‚’ç¢ºèªã—ã¦ã€ merge ã™ã‚‹ã ã‘ã§ã™ã€‚</p>\n\n<p>ä¸­ã«ã¯é©ç”¨ã—ãŸããªã„ãƒ«ãƒ¼ãƒ«ã‚‚å‡ºã¦ãã‚‹ã¨æ€ã„ã¾ã™ãŒã€ãã®å ´åˆã¯ <code>.rubocop.yml</code> ã«ãƒ«ãƒ¼ãƒ«ã‚’å†å®šç¾©ã—ã¦ auto-correct ã•ã‚Œãªã„ã‚ˆã†ã«ã—ã¾ã™ã€‚</p>\n\n<h2>ã©ã‚“ãª PR ãŒä½œæˆã•ã‚Œã‚‹ã®ã‹ï¼Ÿ</h2>\n\n<p>ã¡ã‚‡ã£ã¨ RubocopChallenger ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ãŒå¤ã„é ƒã®ç‰©ã§ã™ãŒã€ <a href=\"https://github.com/ryz310/rubocop_challenger/pull/97\">ä»¥ä¸‹ã®ã‚ˆã†ãª PR</a> ãŒè‡ªå‹•çš„ã«ä½œæˆã•ã‚Œã¾ã™ã€‚</p>\n\n<p><a href=\"https://github.com/ryz310/rubocop_challenger/pull/97\"><img src=\"https://github.com/ryz310/rubocop_challenger/raw/master/images/rubocop_challenge.png\" alt=\"RubocopChallnge\" /></a></p>\n\n<p>ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®è¨­å®šã§ã¯ã€ <code>.rubocop_todo.yml</code> ã®ä¸­ã‹ã‚‰ <strong>Cop supports --auto-correct</strong> ã‹ã¤ <strong>Offense count ãŒæœ€å¤§</strong> ã®ãƒ«ãƒ¼ãƒ«ã‚’æ¶ˆã—ã¦ã€ auto-correct ã—ãŸçµæœãŒ PR ã¨ã—ã¦ä½œæˆã•ã‚Œã¾ã™ã€‚</p>\n\n<p>ã¾ãŸã€ auto-correct ã®å¾Œã§ <code>$ rubocop --auto-gen-config</code> ã‚’å®Ÿè¡Œã—ã¦ <code>.rubocop_todo.yml</code> ã‚’å†ä½œæˆã—ã¦ã„ã¾ã™ã€‚ RuboCop ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ãŒå¤‰ã‚ã£ãŸæ™‚ã¨ã‹ã« <code>.rubocop_todo.yml</code> ã«å‡ºåŠ›ã•ã‚Œã‚‹å†…å®¹ã‚‚è‹¥å¹²å¤‰ã‚ã£ã¦ã„ãŸã‚Šã™ã‚‹ã®ã§ã™ãŒã€æ¯å›æœ€æ–°ã®çŠ¶æ…‹ã«ä½œã‚Šç›´ã—ã¦ãã‚Œã‚‹ã®ãŒã¡ã‚‡ã£ã¨ä¾¿åˆ©ã ã£ãŸã‚Šã—ã¾ã™ã€‚</p>\n\n<p>ã¡ãªã¿ã« PR ã® <strong>Description</strong> ã«è¡¨ç¤ºã•ã‚Œã¦ã„ã‚‹å†…å®¹ã¯ <a href=\"https://www.rubydoc.info/gems/rubocop/RuboCop/Cop/Layout/AlignHash\">æœ¬å®¶ RuboCop ã® RubyDoc</a> ã«è¨˜è¼‰ã•ã‚Œã¦ã„ã‚‹å†…å®¹ã¨åŒã˜ã‚‚ã®ã§ã™ã€‚ã“ã‚Œã‚’è¡¨ç¤ºã™ã‚‹ã®ã«åœ°å‘³ã«è‹¦åŠ´ã—ã¾ã—ãŸ ğŸ˜“</p>\n\n<h2>é«˜åº¦ãªè¨­å®š</h2>\n\n<p>RubocopChallnger ã«ã¯ã„ãã¤ã‹ã‚ªãƒ—ã‚·ãƒ§ãƒ³ãŒç”¨æ„ã•ã‚Œã¦ã„ã‚‹ã®ã§ã€ã”ç´¹ä»‹ã—ã¾ã™ã€‚</p>\n\n<h3><code>--mode</code></h3>\n\n<p>ä¸Šè¿°ã®é€šã‚Šã€ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ã¯ auto-correct ã®å¯¾è±¡ã¯ <strong>Cop supports --auto-correct</strong> ã‹ã¤ <strong>Offense count ãŒæœ€å¤§</strong> ã®ãƒ«ãƒ¼ãƒ«ãŒé¸æŠã•ã‚Œã¾ã™ãŒã€ <code>mode</code> ã«æ¸¡ã™å€¤ã«ã‚ˆã£ã¦å¯¾è±¡ã‚’å¤‰æ›´ã™ã‚‹ã“ã¨ãŒå‡ºæ¥ã¾ã™ã€‚</p>\n\n<ul>\n<li><code>most_occurrence</code> (ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ)\n\n<ul>\n<li><strong>Offense count ãŒæœ€å¤§</strong> ã®ãƒ«ãƒ¼ãƒ«ã‚’é¸æŠã™ã‚‹</li>\n</ul>\n</li>\n<li><code>least_occurrence</code>\n\n<ul>\n<li><strong>Offense count ãŒæœ€å°</strong> ã®ãƒ«ãƒ¼ãƒ«ã‚’é¸æŠã™ã‚‹</li>\n</ul>\n</li>\n<li><code>random</code>\n\n<ul>\n<li>å…¨ä½“ã‹ã‚‰ãƒ©ãƒ³ãƒ€ãƒ ã«é¸æŠã™ã‚‹</li>\n</ul>\n</li>\n</ul>\n\n\n<h4>ä½¿ç”¨ä¾‹</h4>\n\n<pre class=\"code lang-sh\" data-lang=\"sh\" data-unlink>$ bundle <span class=\"synStatement\">exec</span> rubocop_challenger go <span class=\"synStatement\">\\</span>\n    <span class=\"synSpecial\">--email=rubocop-challenger@example.com</span> <span class=\"synStatement\">\\</span>\n    <span class=\"synSpecial\">--name=</span><span class=\"synStatement\">&quot;</span><span class=\"synConstant\">Rubocop Challenger</span><span class=\"synStatement\">&quot;</span> <span class=\"synStatement\">\\</span>\n    <span class=\"synSpecial\">--mode=random</span> \n</pre>\n\n\n<h3><code>--labels</code></h3>\n\n<p>RubocopChallnger ãŒä½œæˆã™ã‚‹ PR ã«ä»˜ä¸ã•ã‚Œã‚‹ label ã‚’æŒ‡å®šã—ã¾ã™ã€‚ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ã¯ <strong>rubocop challenge</strong> ã¨ã„ã†ãƒ©ãƒ™ãƒ«ãŒä»˜ä¸ã•ã‚Œã¾ã™ã€‚\nã‚½ãƒ¼ã‚·ãƒ£ãƒ«PLUS ã§ã¯ <a href=\"https://waffle.io/\">waffle.io</a> ã‚’åˆ©ç”¨ã—ã¦ã„ãŸã‚Šã™ã‚‹ã®ã§ã™ãŒã€ãƒ¬ãƒ“ãƒ¥ãƒ¼å¾…ã¡çŠ¶æ…‹ã® label ã‚’ä»˜ä¸ã™ã‚‹ã‚ˆã†ã«ã™ã‚‹ã¨è¦‹è½ã¨ã—ãŒãªãã¦ä¾¿åˆ©ã§ã™ã€‚</p>\n\n<p><strong>ã‚¹ãƒšãƒ¼ã‚¹åŒºåˆ‡ã‚Š</strong>ã§è¤‡æ•°æŒ‡å®šã™ã‚‹ã“ã¨ãŒå‡ºæ¥ã¾ã™ã€‚</p>\n\n<h4>ä½¿ç”¨ä¾‹</h4>\n\n<pre class=\"code lang-sh\" data-lang=\"sh\" data-unlink>$ bundle <span class=\"synStatement\">exec</span> rubocop_challenger go <span class=\"synStatement\">\\</span>\n    <span class=\"synSpecial\">--email=rubocop-challenger@example.com</span> <span class=\"synStatement\">\\</span>\n    <span class=\"synSpecial\">--name=</span><span class=\"synStatement\">&quot;</span><span class=\"synConstant\">Rubocop Challenger</span><span class=\"synStatement\">&quot;</span> <span class=\"synStatement\">\\</span>\n    <span class=\"synSpecial\">--labels=</span><span class=\"synStatement\">&quot;</span><span class=\"synConstant\">rubocop challenge</span><span class=\"synStatement\">&quot;</span> <span class=\"synStatement\">&quot;</span><span class=\"synConstant\">in progress</span><span class=\"synStatement\">&quot;</span>\n</pre>\n\n\n<h3><code>--template</code></h3>\n\n<p>ä½œæˆã•ã‚Œã‚‹ PR ã‚’ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºã—ãŸã„å ´åˆãªã©ã‚ã‚‹ã‹ã¨æ€ã„ã¾ã™ã€‚\nãã®å ´åˆã¯ template ã« erb ãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ‘ã‚¹ã‚’æŒ‡å®šã™ã‚‹ã“ã¨ãŒå¯èƒ½ã§ã™ã€‚</p>\n\n<p>ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ã¯ä»¥ä¸‹ã®ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆãŒä½¿ç”¨ã•ã‚Œã‚‹ã®ã§ã€å¿…è¦ã«å¿œã˜ã¦ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºã—ã¦ã”åˆ©ç”¨ä¸‹ã•ã„ ğŸ™</p>\n\n<p><a href=\"https://github.com/ryz310/rubocop_challenger/blob/master/lib/templates/default.md.erb\">https://github.com/ryz310/rubocop_challenger/blob/master/lib/templates/default.md.erb</a></p>\n\n<h4>ä½¿ç”¨ä¾‹</h4>\n\n<pre class=\"code lang-sh\" data-lang=\"sh\" data-unlink>$ bundle <span class=\"synStatement\">exec</span> rubocop_challenger go <span class=\"synStatement\">\\</span>\n    <span class=\"synSpecial\">--email=rubocop-challenger@example.com</span> <span class=\"synStatement\">\\</span>\n    <span class=\"synSpecial\">--name=</span><span class=\"synStatement\">&quot;</span><span class=\"synConstant\">Rubocop Challenger</span><span class=\"synStatement\">&quot;</span> <span class=\"synStatement\">\\</span>\n    <span class=\"synSpecial\">--template=./path/to/template.md.erb</span>\n</pre>\n\n\n<h3><code>--no-regenerate-rubocop-todo</code></h3>\n\n<p>ä¸Šè¿°ã®é€šã‚Šã€ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ã¯ auto-correct ã®å¾Œã§ <code>$ rubocop --auto-gen-config</code> ã‚’å®Ÿè¡Œã—ã¦ .rubocop_todo.yml ã‚’å†ä½œæˆã—ã¦ã„ã¾ã™ã€‚ã“ã‚ŒãŒä¸è¦ãªå ´åˆã¯ no-regenerate-rubocop-todo ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’æŒ‡å®šã—ã¾ã™ã€‚</p>\n\n<h4>ä½¿ç”¨ä¾‹</h4>\n\n<pre class=\"code lang-sh\" data-lang=\"sh\" data-unlink>$ bundle <span class=\"synStatement\">exec</span> rubocop_challenger go <span class=\"synStatement\">\\</span>\n    <span class=\"synSpecial\">--email=rubocop-challenger@example.com</span> <span class=\"synStatement\">\\</span>\n    <span class=\"synSpecial\">--name=</span><span class=\"synStatement\">&quot;</span><span class=\"synConstant\">Rubocop Challenger</span><span class=\"synStatement\">&quot;</span> <span class=\"synStatement\">\\</span>\n    <span class=\"synSpecial\">--no-regenerate-rubocop-todo</span>\n</pre>\n\n\n<h2>æ—¢çŸ¥ã®ä¸å…·åˆ <strong>(v1.2.0 ã§è§£æ¶ˆæ¸ˆã¿)</strong></h2>\n\n<p>RuboCop ã®ãƒ«ãƒ¼ãƒ«ã®ä¸­ã«ã¯ <strong>Cop supports --auto-correct</strong> ã¨è¡¨è¨˜ã•ã‚Œã¦ã„ã‚‹ã«ã‚‚é–¢ã‚ã‚‰ãšã€éƒ¨åˆ†çš„ã«ã—ã‹ auto-correct ã—ã¦ãã‚Œãªã„ã‚‚ã®ãŒã‚ã‚Šã¾ã™ã€‚\nä¾‹ãˆã° <code>Style/Semicolon</code> ãŒ auto-correct ã§ãã‚‹ã®ã¯è¡Œæœ«ã« <code>;</code> ãŒå­˜åœ¨ã™ã‚‹å ´åˆã ã‘ã®ã‚ˆã†ã§ã™ã€‚</p>\n\n<pre class=\"code lang-ruby\" data-lang=\"ruby\" data-unlink>puts <span class=\"synSpecial\">'</span><span class=\"synConstant\">hoge</span><span class=\"synSpecial\">'</span>; <span class=\"synComment\"># =&gt; auto-correct ã•ã‚Œã‚‹</span>\nputs <span class=\"synSpecial\">'</span><span class=\"synConstant\">fuga</span><span class=\"synSpecial\">'</span>; puts <span class=\"synSpecial\">'</span><span class=\"synConstant\">piyo</span><span class=\"synSpecial\">'</span> <span class=\"synComment\"># =&gt; auto-correct ã•ã‚Œãªã„</span>\n</pre>\n\n\n<p>ã“ã®ã‚ˆã†ãªãƒ«ãƒ¼ãƒ«ãŒ auto-correct å¯¾è±¡ã«é¸ã°ã‚Œã‚‹ã¨ã€RubocopChallenger ã‚’å®Ÿè¡Œã—ãŸå¾Œã‚‚é•åãŒè§£æ±ºã•ã‚Œãšã€å¾Œç¶šã® <code>$ rubocop --auto-gen-config</code> ã§å†åº¦ <code>.rubocop_todo.yml</code> ã«å¯¾è±¡ãƒ«ãƒ¼ãƒ«ãŒå‡ºã¦ãã¦ã—ã¾ã†ã®ã§ã€ RubocopChallenger ãŒæ©Ÿèƒ½ã—ãªã„çŠ¶æ…‹ã«ãªã£ã¦ã—ã¾ã„ã¾ã™ã€‚\nç¾çŠ¶ã§ã¯ <code>Style/Semicolon</code> ã®ã‚ˆã†ãªãƒ«ãƒ¼ãƒ«ã«é­é‡ã—ãŸå ´åˆã¯ã€æ‰‹å‹•ã§ <code>.rubocop.yml</code> ã«ãƒ«ãƒ¼ãƒ«ã‚’ç§»å‹•ã•ã›ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚\n<del>ä»Šã®ã¨ã“ã‚ RubocopChallenger å´ã§ã®å¯¾ç­–ã‚’æ€ã„ä»˜ã„ã¦ã„ãªã„ã®ã§ã€ã‚‚ã—è‰¯ã„ã‚¢ã‚¤ãƒ‡ã‚¢ãŒã‚ã‚Šã¾ã—ãŸã‚‰æ•™ãˆã¦ä¸‹ã•ã„ ğŸ™</del></p>\n\n<p><strong>2019/03/26 è¿½è¨˜</strong></p>\n\n<p>RubocopChallenger v1.2.0 ã§ Ignore ãƒªã‚¹ãƒˆæ©Ÿèƒ½ãŒè¿½åŠ ã•ã‚Œã¾ã—ãŸã€‚\nRubocopChallenger ã‚’å®Ÿè¡Œã—ãŸå¾Œã‚‚é•åãŒè§£æ±ºã•ã‚Œãšã€å¾Œç¶šã® <code>$ rubocop --auto-gen-config</code> ã§å†åº¦ <code>.rubocop_todo.yml</code> ã«å¯¾è±¡ãƒ«ãƒ¼ãƒ«ãŒå‡ºã¦ãã¦ã—ã¾ã£ãŸå ´åˆã€ <code>.rubocop_challenger.yml</code> ã¨ã„ã†ãƒ•ã‚¡ã‚¤ãƒ«ãŒä½œæˆã•ã‚Œã€å¯¾è±¡ãƒ«ãƒ¼ãƒ«ãŒ Ignore ãƒªã‚¹ãƒˆã«è¿½åŠ ã•ã‚Œã¾ã™ã€‚\nIgnore ãƒªã‚¹ãƒˆã«è¿½åŠ ã•ã‚ŒãŸãƒ«ãƒ¼ãƒ«ã¯æ¬¡å›ä»¥é™ã€ RubocopChallenger ã®å¯¾è±¡ãƒ«ãƒ¼ãƒ«ã¨ã—ã¦é¸æŠã•ã‚Œãªããªã‚‹ã®ã§ã€ç‰¹ã«ä½•ã‚‚ã—ãªãã¨ã‚‚é‹ç”¨ã‚’ç¶šã‘ã‚‹ã“ã¨ãŒå¯èƒ½ã¨ãªã‚Šã¾ã™ã€‚</p>\n\n<h2>æœ€å¾Œã«</h2>\n\n<p>å½“åˆã¯ <strong>1669 è¡Œ 195 ç¨®é¡</strong> ã®é•åãƒ«ãƒ¼ãƒ«ãŒ .rubocop_todo.yml ã«å­˜åœ¨ã—ã¦ã„ã¾ã—ãŸãŒã€ RubocopChallenger ã‚’å°å…¥ã—ã¦ã‹ã‚‰ 3 ãƒ¶æœˆã§ <strong>1187 è¡Œ 132 ç¨®é¡</strong> ã¾ã§æ¸›ã‚‰ã™ã“ã¨ãŒå‡ºæ¥ã¾ã—ãŸã€‚ auto-correct å¯èƒ½ãªé•åãƒ«ãƒ¼ãƒ«ã¯ã‚ã¨ 62 ç¨®é¡æ®‹ã£ã¦ã„ã‚‹ã®ã§ã€ã‚ã¨åŠåˆ†ãã‚‰ã„ã¾ã§ã¯æ¸›ã‚‰ã™ã“ã¨ãŒã§ããã†ã§ã™ã€‚</p>\n\n<p>æœ¬è¨˜äº‹ã§ã¯è‚¥å¤§åŒ–ã—ã¦ã—ã¾ã£ãŸ .rubocop_todo.yml ã‚’è‡ªå‹•çš„ã«ä¿®æ­£ã—ã¦ã„ã RubocopChallnger ã‚’ç´¹ä»‹ã—ã€å°å…¥æ–¹æ³•ã«ã¤ã„ã¦è§£èª¬ã•ã›ã¦é ‚ãã¾ã—ãŸã€‚ .rubocop_todo.yml ãŒè‚¥å¤§åŒ–ã—ã¦å›°ã£ã¦ã„ã‚‹ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§å½¹ç«‹ã¦ã¦é ‚ã‘ã‚Œã°å¹¸ã„ã§ã™ ğŸ™</p>\n\n<p>ã¾ãŸã€åˆ©ç”¨ã—ã¦ã¿ã¦ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ãªã©ã‚ã‚Œã° <a href=\"https://github.com/ryz310/rubocop_challenger/issues\">Issue</a> ã«ã¦ã”é€£çµ¡ä¸‹ã•ã„ã€‚ GitHub ã§ã¯é ‘å¼µã£ã¦æ‹™ã„è‹±èªã‚’æ›¸ãã‚ˆã†ã«ã—ã¦ã„ã¾ã™ãŒã€æ—¥æœ¬èªã§ã‚‚å¤§ä¸ˆå¤«ã§ã™ ğŸ™† PR ã‚‚å¤§æ­“è¿ã§ã™ã€‚ã©ã†ãå®œã—ããŠé¡˜ã„è‡´ã—ã¾ã™ ğŸ™‡</p>\n<div class=\"footnotes\">\n<hr/>\n<ol>\n<li id=\"fn:1\">\n<p>ã¡ãªã¿ã«å°å…¥ã—ãŸã®ã¯è‡ªåˆ†ã§ã™<a href=\"#fnref:1\" rev=\"footnote\">&#8617;</a></p></li>\n</ol>\n</div>\n\n","contentSnippet":"ã©ã†ã‚‚ã€ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ã®ã‚µãƒˆã‚¦ãƒªãƒ§ã‚¦ã‚¹ã‚±ã§ã™ âœŒï¸('Ï‰')âœŒï¸è‹¥å¹²é‡£ã‚Šè‡­ã„ã‚¿ã‚¤ãƒˆãƒ«ã§ã™ãŒã€å…ˆæ—¥ RubocopChallenger ã¨ã„ã† gem ã® v1.0.0 ã‚’ãƒªãƒªãƒ¼ã‚¹ã—ãŸã®ã§ç´¹ä»‹ã•ã›ã¦é ‚ãã¾ã™ ğŸ™github.comçµŒç·¯åƒ•ãŒæ‰€å±ã—ã¦ã„ã‚‹ ã‚½ãƒ¼ã‚·ãƒ£ãƒ«PLUS ã¯ 2012 å¹´é ƒã‹ã‚‰é–‹ç™ºãŒå§‹ã¾ã‚Šã¾ã—ãŸã€‚Rails ã®ãƒ—ãƒ­ãƒ€ã‚¯ãƒˆã¨ã—ã¦ã¯å¤æ ªã®æ–¹ã ã¨æ€ã„ã¾ã™ã€‚ã‚½ãƒ¼ã‚·ãƒ£ãƒ«PLUS ã« RuboCop ãŒå°å…¥ã•ã‚ŒãŸã®ã¯ 2017/02 é ƒ 1 ã§ã€ãã‚Œã¾ã§ç‰¹ã« RuboCop ã‚’æ„è­˜ã—ãŸã‚³ãƒ¼ãƒ‰ã§é–‹ç™ºã‚’é€²ã‚ã¦ã“ãªã‹ã£ãŸã®ã§ã€å·¨å¤§ãª .rubocop_todo.yml ãŒå‡ºåŠ›ã•ã‚Œã€ãã‚ŒãŒæ‰‹ä»˜ã‹ãšã®ã¾ã¾ã«ãªã£ã¦ã—ã¾ã£ã¦ã„ã¾ã—ãŸã€‚ã¡ãªã¿ã«å½“åˆã¯ 1669 è¡Œ 195 ç¨®é¡ ã®é•åãƒ«ãƒ¼ãƒ«ãŒã‚ã‚Šã¾ã—ãŸã€‚ã“ã®ã¾ã¾ã§ã¯ RuboCop ã®æ©æµãŒå—ã‘ã‚‰ã‚Œãªã„ã®ã§ã€ RuboCop Challenge ã¨ç§°ã—ã¦ (ä»¥å‰ Ice Bucket Challenge ãŒæµè¡Œã£ã¦ã„ãŸã®ã§) é€±ã‚¤ãƒã§ .rubocop_todo.yml ã‹ã‚‰é•åãƒ«ãƒ¼ãƒ«ã‚’ä¸€ã¤æ¶ˆã—ã¦ã€ auto-correct ã§ä¿®æ­£ã™ã‚‹ã€ã¨ã„ã†äº‹ã‚’ã‚„ã£ã¦ã„ãŸã®ã§ã™ãŒã€æ•°ãƒ¶æœˆï¼ˆæ•°é€±é–“ã ã£ãŸã‹ã‚‚ï¼‰ã§ã™ã£ã‹ã‚Šã‚„ã‚‹ã®ã‚’å¿˜ã‚Œã¦ã—ã¾ã„ã¾ã—ãŸ ğŸ˜‡æœ€è¿‘ã¾ãŸ RuboCop Challenge ã‚’å†é–‹ã—ã‚ˆã†ã€ã¨ã„ã†æµã‚Œã«ãªã£ãŸã®ã§ã™ãŒã€æ‰‹å‹•ã§ã‚³ãƒ„ã‚³ãƒ„ã‚„ã‚‹ã®ã‚‚ç²¾ç¥çš„ã«ã—ã‚“ã©ããªã£ã¦æ¥ãŸã®ã§ã€ãªã‚“ã¨ã‹è‡ªå‹•åŒ–ã—ãŸã„ãªã€ã¨ã„ã†æ°—æŒã¡ã«ãªã‚Šã€æ‰‹å‹•ã§ã‚„ã£ã¦ã„ãŸ Rubocop Challenge ã‚’ Ruby ã‚¹ã‚¯ãƒªãƒ—ãƒˆã§å‹•ã‹ã›ã‚‹ã‚ˆã†ã«ã—ã¾ã—ãŸã€‚æœ€åˆã¯å˜ç´”ãª Ruby ã‚¹ã‚¯ãƒªãƒ—ãƒˆã ã£ãŸã®ã§ã™ãŒã€ã›ã£ã‹ããªã®ã§ gem åŒ–ã—ã‚ˆã†ã€ã¨ã„ã†äº‹ã«ãªã‚Šã€ä½œæˆã—ãŸã®ãŒ RubocopChallenger ã§ã™ã€‚ã¨ã“ã‚ã§ã€å¼Šç¤¾ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ã® id:masutaka26 ãŒ circleci-bundle-update-pr ã¨ã„ã† CI ã‚’åˆ©ç”¨ã—ãŸ Bundle Update ã®è‡ªå‹•æ›´æ–° gem ã‚’ä½œæˆã—ã¦ã„ã¾ã™ã€‚github.comã“ã‚Œã«æ„ŸéŠ˜ã‚’å—ã‘ã¦ (ï¼Ÿ) è‡ªåˆ†ã® RubocopChallenger ã‚‚ CI ã‹ã‚‰$ rubocop --auto-correct ã‚’å®Ÿè¡Œã—ãŸçµæœãŒ PR ã¨ã—ã¦å±Šãã‚ˆã†ãªä»•çµ„ã¿ã«ãªã£ã¦ã„ã¾ã™ã€‚ä½¿ã„æ–¹2021-09-23 ä¿®æ­£1. .circleci/config.yml ã®ç·¨é›†ä»¥ä¸‹ã«è¨­å®šä¾‹ã‚’ç´¹ä»‹ã—ã¾ã™ã€‚# .circleci/config.ymlversion: 2jobs:  rubocop_challenge:    docker:      - image: circleci/ruby:2.5-node-browsers    working_directory: ~/repo    steps:      - checkout      - run:          name: Rubocop Challenge          command: |            gem install rubocop_challenger            bundle exec rubocop_challenger go \\              --email={RubocopChallenger ãŒ commit ã™ã‚‹éš›ã® user email} \\              --name=\"{RubocopChallenger ãŒ commit ã™ã‚‹éš›ã® user name}\"workflows:  version: 2  nightly:    triggers:      - schedule:          cron: \"30 23 * * 1,2,3\" # ã“ã®è¨­å®šã®å ´åˆã€ç«æ°´æœ¨ ã®æ¯æœ 8:30 ã« RubocopChallnger ã® PR ãŒå±Šãã¾ã™          filters:            branches:              only:                - master    jobs:      - rubocop_challengeã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã®éš›ã€ Gemfile ã« gem 'rubocop_challenger' ã‚’è¿½è¨˜ã—ãªã„ã‚ˆã†ã«ã”æ³¨æ„ä¸‹ã•ã„ã€‚ä»–ã® gem ã¨ã®äº’æ›æ€§å•é¡Œã«ã‚ˆã‚Šã€ rubocop_challenger å®Ÿè¡Œä¸­ã«ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã™ã‚‹ã‚±ãƒ¼ã‚¹ãŒã‚ã‚‹ã“ã¨ã‚’ç¢ºèªã—ã¦ãŠã‚Šã¾ã™ã€‚2. GitHub personal access token ã®ä½œæˆRubocopChallenger ãŒ PR ã‚’ä½œæˆã™ã‚‹ãŸã‚ã« GitHub personal access token ãŒå¿…è¦ã«ãªã‚Šã¾ã™ã€‚Settings ã‹ã‚‰ Generate new token ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦ access token ã‚’ä½œæˆã—ã¾ã™ã€‚Select Scopes ã§ã¯ repo ã«ãƒã‚§ãƒƒã‚¯ âœ… ã‚’å…¥ã‚Œã¦ä¸‹ã•ã„ã€‚3. CircleCI ã§ç’°å¢ƒå¤‰æ•°ã®è¨­å®šä»Šå›ã¯ CircleCI ã§ã®åˆ©ç”¨ä¾‹ã‚’ç´¹ä»‹ã—ã¾ã™ ğŸ™ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ç”»é¢ ã«ç§»å‹•ã—ã€ RubocopChallenger ã‚’é©ç”¨ã—ãŸã„ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã® Project Settings -> Environment Variables ã¸ã¨ç§»å‹•ã—ã¾ã™ã€‚Add Variable ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦ GITHUB_ACCESS_TOKEN ã¨ã„ã† Key ã§å…ˆç¨‹ä½œæˆã—ãŸ GitHub personal access token ã‚’è¨­å®šã—ã¾ã™ã€‚5. ä½œæˆã•ã‚ŒãŸ PR ã®ç¢ºèªã“ã“ã¾ã§ã®æ‰‹é †ã‚’çµ‚ãˆã‚‹ã¨ã€ CircleCI ã«æŒ‡å®šã—ãŸã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ã§ PR ãŒã•ã‚Œã‚‹ã‚ˆã†ã«ãªã‚‹ã¨æ€ã„ã¾ã™ã€‚å¾Œã¯ auto-correct ã®å†…å®¹ã‚’ç¢ºèªã—ã¦ã€ merge ã™ã‚‹ã ã‘ã§ã™ã€‚ä¸­ã«ã¯é©ç”¨ã—ãŸããªã„ãƒ«ãƒ¼ãƒ«ã‚‚å‡ºã¦ãã‚‹ã¨æ€ã„ã¾ã™ãŒã€ãã®å ´åˆã¯ .rubocop.yml ã«ãƒ«ãƒ¼ãƒ«ã‚’å†å®šç¾©ã—ã¦ auto-correct ã•ã‚Œãªã„ã‚ˆã†ã«ã—ã¾ã™ã€‚ã©ã‚“ãª PR ãŒä½œæˆã•ã‚Œã‚‹ã®ã‹ï¼Ÿã¡ã‚‡ã£ã¨ RubocopChallenger ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ãŒå¤ã„é ƒã®ç‰©ã§ã™ãŒã€ ä»¥ä¸‹ã®ã‚ˆã†ãª PR ãŒè‡ªå‹•çš„ã«ä½œæˆã•ã‚Œã¾ã™ã€‚ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®è¨­å®šã§ã¯ã€ .rubocop_todo.yml ã®ä¸­ã‹ã‚‰ Cop supports --auto-correct ã‹ã¤ Offense count ãŒæœ€å¤§ ã®ãƒ«ãƒ¼ãƒ«ã‚’æ¶ˆã—ã¦ã€ auto-correct ã—ãŸçµæœãŒ PR ã¨ã—ã¦ä½œæˆã•ã‚Œã¾ã™ã€‚ã¾ãŸã€ auto-correct ã®å¾Œã§ $ rubocop --auto-gen-config ã‚’å®Ÿè¡Œã—ã¦ .rubocop_todo.yml ã‚’å†ä½œæˆã—ã¦ã„ã¾ã™ã€‚ RuboCop ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ãŒå¤‰ã‚ã£ãŸæ™‚ã¨ã‹ã« .rubocop_todo.yml ã«å‡ºåŠ›ã•ã‚Œã‚‹å†…å®¹ã‚‚è‹¥å¹²å¤‰ã‚ã£ã¦ã„ãŸã‚Šã™ã‚‹ã®ã§ã™ãŒã€æ¯å›æœ€æ–°ã®çŠ¶æ…‹ã«ä½œã‚Šç›´ã—ã¦ãã‚Œã‚‹ã®ãŒã¡ã‚‡ã£ã¨ä¾¿åˆ©ã ã£ãŸã‚Šã—ã¾ã™ã€‚ã¡ãªã¿ã« PR ã® Description ã«è¡¨ç¤ºã•ã‚Œã¦ã„ã‚‹å†…å®¹ã¯ æœ¬å®¶ RuboCop ã® RubyDoc ã«è¨˜è¼‰ã•ã‚Œã¦ã„ã‚‹å†…å®¹ã¨åŒã˜ã‚‚ã®ã§ã™ã€‚ã“ã‚Œã‚’è¡¨ç¤ºã™ã‚‹ã®ã«åœ°å‘³ã«è‹¦åŠ´ã—ã¾ã—ãŸ ğŸ˜“é«˜åº¦ãªè¨­å®šRubocopChallnger ã«ã¯ã„ãã¤ã‹ã‚ªãƒ—ã‚·ãƒ§ãƒ³ãŒç”¨æ„ã•ã‚Œã¦ã„ã‚‹ã®ã§ã€ã”ç´¹ä»‹ã—ã¾ã™ã€‚--modeä¸Šè¿°ã®é€šã‚Šã€ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ã¯ auto-correct ã®å¯¾è±¡ã¯ Cop supports --auto-correct ã‹ã¤ Offense count ãŒæœ€å¤§ ã®ãƒ«ãƒ¼ãƒ«ãŒé¸æŠã•ã‚Œã¾ã™ãŒã€ mode ã«æ¸¡ã™å€¤ã«ã‚ˆã£ã¦å¯¾è±¡ã‚’å¤‰æ›´ã™ã‚‹ã“ã¨ãŒå‡ºæ¥ã¾ã™ã€‚most_occurrence (ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ)Offense count ãŒæœ€å¤§ ã®ãƒ«ãƒ¼ãƒ«ã‚’é¸æŠã™ã‚‹least_occurrenceOffense count ãŒæœ€å° ã®ãƒ«ãƒ¼ãƒ«ã‚’é¸æŠã™ã‚‹randomå…¨ä½“ã‹ã‚‰ãƒ©ãƒ³ãƒ€ãƒ ã«é¸æŠã™ã‚‹ä½¿ç”¨ä¾‹$ bundle exec rubocop_challenger go \\    --email=rubocop-challenger@example.com \\    --name=\"Rubocop Challenger\" \\    --mode=random --labelsRubocopChallnger ãŒä½œæˆã™ã‚‹ PR ã«ä»˜ä¸ã•ã‚Œã‚‹ label ã‚’æŒ‡å®šã—ã¾ã™ã€‚ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ã¯ rubocop challenge ã¨ã„ã†ãƒ©ãƒ™ãƒ«ãŒä»˜ä¸ã•ã‚Œã¾ã™ã€‚ã‚½ãƒ¼ã‚·ãƒ£ãƒ«PLUS ã§ã¯ waffle.io ã‚’åˆ©ç”¨ã—ã¦ã„ãŸã‚Šã™ã‚‹ã®ã§ã™ãŒã€ãƒ¬ãƒ“ãƒ¥ãƒ¼å¾…ã¡çŠ¶æ…‹ã® label ã‚’ä»˜ä¸ã™ã‚‹ã‚ˆã†ã«ã™ã‚‹ã¨è¦‹è½ã¨ã—ãŒãªãã¦ä¾¿åˆ©ã§ã™ã€‚ã‚¹ãƒšãƒ¼ã‚¹åŒºåˆ‡ã‚Šã§è¤‡æ•°æŒ‡å®šã™ã‚‹ã“ã¨ãŒå‡ºæ¥ã¾ã™ã€‚ä½¿ç”¨ä¾‹$ bundle exec rubocop_challenger go \\    --email=rubocop-challenger@example.com \\    --name=\"Rubocop Challenger\" \\    --labels=\"rubocop challenge\" \"in progress\"--templateä½œæˆã•ã‚Œã‚‹ PR ã‚’ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºã—ãŸã„å ´åˆãªã©ã‚ã‚‹ã‹ã¨æ€ã„ã¾ã™ã€‚ãã®å ´åˆã¯ template ã« erb ãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ‘ã‚¹ã‚’æŒ‡å®šã™ã‚‹ã“ã¨ãŒå¯èƒ½ã§ã™ã€‚ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ã¯ä»¥ä¸‹ã®ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆãŒä½¿ç”¨ã•ã‚Œã‚‹ã®ã§ã€å¿…è¦ã«å¿œã˜ã¦ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºã—ã¦ã”åˆ©ç”¨ä¸‹ã•ã„ ğŸ™https://github.com/ryz310/rubocop_challenger/blob/master/lib/templates/default.md.erbä½¿ç”¨ä¾‹$ bundle exec rubocop_challenger go \\    --email=rubocop-challenger@example.com \\    --name=\"Rubocop Challenger\" \\    --template=./path/to/template.md.erb--no-regenerate-rubocop-todoä¸Šè¿°ã®é€šã‚Šã€ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ã¯ auto-correct ã®å¾Œã§ $ rubocop --auto-gen-config ã‚’å®Ÿè¡Œã—ã¦ .rubocop_todo.yml ã‚’å†ä½œæˆã—ã¦ã„ã¾ã™ã€‚ã“ã‚ŒãŒä¸è¦ãªå ´åˆã¯ no-regenerate-rubocop-todo ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’æŒ‡å®šã—ã¾ã™ã€‚ä½¿ç”¨ä¾‹$ bundle exec rubocop_challenger go \\    --email=rubocop-challenger@example.com \\    --name=\"Rubocop Challenger\" \\    --no-regenerate-rubocop-todoæ—¢çŸ¥ã®ä¸å…·åˆ (v1.2.0 ã§è§£æ¶ˆæ¸ˆã¿)RuboCop ã®ãƒ«ãƒ¼ãƒ«ã®ä¸­ã«ã¯ Cop supports --auto-correct ã¨è¡¨è¨˜ã•ã‚Œã¦ã„ã‚‹ã«ã‚‚é–¢ã‚ã‚‰ãšã€éƒ¨åˆ†çš„ã«ã—ã‹ auto-correct ã—ã¦ãã‚Œãªã„ã‚‚ã®ãŒã‚ã‚Šã¾ã™ã€‚ä¾‹ãˆã° Style/Semicolon ãŒ auto-correct ã§ãã‚‹ã®ã¯è¡Œæœ«ã« ; ãŒå­˜åœ¨ã™ã‚‹å ´åˆã ã‘ã®ã‚ˆã†ã§ã™ã€‚puts 'hoge'; # => auto-correct ã•ã‚Œã‚‹puts 'fuga'; puts 'piyo' # => auto-correct ã•ã‚Œãªã„ã“ã®ã‚ˆã†ãªãƒ«ãƒ¼ãƒ«ãŒ auto-correct å¯¾è±¡ã«é¸ã°ã‚Œã‚‹ã¨ã€RubocopChallenger ã‚’å®Ÿè¡Œã—ãŸå¾Œã‚‚é•åãŒè§£æ±ºã•ã‚Œãšã€å¾Œç¶šã® $ rubocop --auto-gen-config ã§å†åº¦ .rubocop_todo.yml ã«å¯¾è±¡ãƒ«ãƒ¼ãƒ«ãŒå‡ºã¦ãã¦ã—ã¾ã†ã®ã§ã€ RubocopChallenger ãŒæ©Ÿèƒ½ã—ãªã„çŠ¶æ…‹ã«ãªã£ã¦ã—ã¾ã„ã¾ã™ã€‚ç¾çŠ¶ã§ã¯ Style/Semicolon ã®ã‚ˆã†ãªãƒ«ãƒ¼ãƒ«ã«é­é‡ã—ãŸå ´åˆã¯ã€æ‰‹å‹•ã§ .rubocop.yml ã«ãƒ«ãƒ¼ãƒ«ã‚’ç§»å‹•ã•ã›ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚ä»Šã®ã¨ã“ã‚ RubocopChallenger å´ã§ã®å¯¾ç­–ã‚’æ€ã„ä»˜ã„ã¦ã„ãªã„ã®ã§ã€ã‚‚ã—è‰¯ã„ã‚¢ã‚¤ãƒ‡ã‚¢ãŒã‚ã‚Šã¾ã—ãŸã‚‰æ•™ãˆã¦ä¸‹ã•ã„ ğŸ™2019/03/26 è¿½è¨˜RubocopChallenger v1.2.0 ã§ Ignore ãƒªã‚¹ãƒˆæ©Ÿèƒ½ãŒè¿½åŠ ã•ã‚Œã¾ã—ãŸã€‚RubocopChallenger ã‚’å®Ÿè¡Œã—ãŸå¾Œã‚‚é•åãŒè§£æ±ºã•ã‚Œãšã€å¾Œç¶šã® $ rubocop --auto-gen-config ã§å†åº¦ .rubocop_todo.yml ã«å¯¾è±¡ãƒ«ãƒ¼ãƒ«ãŒå‡ºã¦ãã¦ã—ã¾ã£ãŸå ´åˆã€ .rubocop_challenger.yml ã¨ã„ã†ãƒ•ã‚¡ã‚¤ãƒ«ãŒä½œæˆã•ã‚Œã€å¯¾è±¡ãƒ«ãƒ¼ãƒ«ãŒ Ignore ãƒªã‚¹ãƒˆã«è¿½åŠ ã•ã‚Œã¾ã™ã€‚Ignore ãƒªã‚¹ãƒˆã«è¿½åŠ ã•ã‚ŒãŸãƒ«ãƒ¼ãƒ«ã¯æ¬¡å›ä»¥é™ã€ RubocopChallenger ã®å¯¾è±¡ãƒ«ãƒ¼ãƒ«ã¨ã—ã¦é¸æŠã•ã‚Œãªããªã‚‹ã®ã§ã€ç‰¹ã«ä½•ã‚‚ã—ãªãã¨ã‚‚é‹ç”¨ã‚’ç¶šã‘ã‚‹ã“ã¨ãŒå¯èƒ½ã¨ãªã‚Šã¾ã™ã€‚æœ€å¾Œã«å½“åˆã¯ 1669 è¡Œ 195 ç¨®é¡ ã®é•åãƒ«ãƒ¼ãƒ«ãŒ .rubocop_todo.yml ã«å­˜åœ¨ã—ã¦ã„ã¾ã—ãŸãŒã€ RubocopChallenger ã‚’å°å…¥ã—ã¦ã‹ã‚‰ 3 ãƒ¶æœˆã§ 1187 è¡Œ 132 ç¨®é¡ ã¾ã§æ¸›ã‚‰ã™ã“ã¨ãŒå‡ºæ¥ã¾ã—ãŸã€‚ auto-correct å¯èƒ½ãªé•åãƒ«ãƒ¼ãƒ«ã¯ã‚ã¨ 62 ç¨®é¡æ®‹ã£ã¦ã„ã‚‹ã®ã§ã€ã‚ã¨åŠåˆ†ãã‚‰ã„ã¾ã§ã¯æ¸›ã‚‰ã™ã“ã¨ãŒã§ããã†ã§ã™ã€‚æœ¬è¨˜äº‹ã§ã¯è‚¥å¤§åŒ–ã—ã¦ã—ã¾ã£ãŸ .rubocop_todo.yml ã‚’è‡ªå‹•çš„ã«ä¿®æ­£ã—ã¦ã„ã RubocopChallnger ã‚’ç´¹ä»‹ã—ã€å°å…¥æ–¹æ³•ã«ã¤ã„ã¦è§£èª¬ã•ã›ã¦é ‚ãã¾ã—ãŸã€‚ .rubocop_todo.yml ãŒè‚¥å¤§åŒ–ã—ã¦å›°ã£ã¦ã„ã‚‹ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§å½¹ç«‹ã¦ã¦é ‚ã‘ã‚Œã°å¹¸ã„ã§ã™ ğŸ™ã¾ãŸã€åˆ©ç”¨ã—ã¦ã¿ã¦ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ãªã©ã‚ã‚Œã° Issue ã«ã¦ã”é€£çµ¡ä¸‹ã•ã„ã€‚ GitHub ã§ã¯é ‘å¼µã£ã¦æ‹™ã„è‹±èªã‚’æ›¸ãã‚ˆã†ã«ã—ã¦ã„ã¾ã™ãŒã€æ—¥æœ¬èªã§ã‚‚å¤§ä¸ˆå¤«ã§ã™ ğŸ™† PR ã‚‚å¤§æ­“è¿ã§ã™ã€‚ã©ã†ãå®œã—ããŠé¡˜ã„è‡´ã—ã¾ã™ ğŸ™‡ã¡ãªã¿ã«å°å…¥ã—ãŸã®ã¯è‡ªåˆ†ã§ã™â†©","link":"https://developer.feedforce.jp/entry/2018/12/05/140000","isoDate":"2018-12-05T05:00:00.000Z","dateMiliSeconds":1543986000000,"imageUrl":"https://github.com/ryz310/rubocop_challenger/raw/master/images/generate_token.png","authorName":"ryz310"},{"title":"10 åˆ†ã§ã‚ã‹ã‚‹ Ruby Guild","content":"<p>ã©ã†ã‚‚ã€ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ã®ã‚µãƒˆã‚¦ãƒªãƒ§ã‚¦ã‚¹ã‚±ã§ã™ âœŒï¸('Ï‰')âœŒï¸</p>\n\n<p>RubyKaigi 2018 ã‹ã‚‰æ—© 3 é€±é–“ã€‚ã“ã®è¨˜äº‹ã‚’èª­ã‚“ã§ã„ã‚‹æ–¹ã§ã‚‚å‚åŠ ã•ã‚ŒãŸæ–¹ãŒæ²¢å±±ã„ã‚‹ã®ã§ã¯ãªã„ã‹ã¨æ€ã„ã¾ã™ã€‚\nå€‹äººçš„ãªæ„Ÿæƒ³ã§ã™ãŒã€ä»Šå¹´ã¯ä¾‹å¹´ä»¥ä¸Šã«å……å®Ÿã—ã¦ã„ãŸã‚“ã˜ã‚ƒãªã„ã‹ãªã€ã¨å¤§æº€è¶³ã§ã™âœ¨</p>\n\n<p>æ„Ÿæƒ³è¨˜äº‹ã¯ã“ã¡ã‚‰ã®è¨˜äº‹ã«è©³ã—ãã¾ã¨ã‚ã‚‰ã‚Œã¦ã„ã¾ã™ã€‚</p>\n\n<p><iframe src=\"https://hatenablog-parts.com/embed?url=https%3A%2F%2Fdeveloper.feedforce.jp%2Fentry%2F2018%2F06%2F22%2F141314\" title=\"RubyKaigi 2018 ã«è¡Œã£ã¦ããŸã®ã§ä»Šæ›´æ‰€æ„Ÿãªã©ã‚’ã¾ã¨ã‚ã¾ã—ãŸ - Feedforce Developer Blog\" class=\"embed-card embed-blogcard\" scrolling=\"no\" frameborder=\"0\" style=\"display: block; width: 100%; height: 190px; max-width: 500px; margin: 10px 0px;\"></iframe><cite class=\"hatena-citation\"><a href=\"https://developer.feedforce.jp/entry/2018/06/22/141314\">developer.feedforce.jp</a></cite></p>\n\n<p>ã•ã¦ã€ä»Šå›ã® RubyKaigi ã®ç™ºè¡¨ã§ã¯ç¬¹ç”°ã•ã‚“ã‹ã‚‰ Guild ã®é€²æ—ã«ã¤ã„ã¦ã®ç™ºè¡¨ãŒã‚ã‚Šã¾ã—ãŸã€‚</p>\n\n<p><a href=\"http://www.atdot.net/~ko1/activities/2018_rubykaigi2018.pdf\"><img src=\"https://cdn-ak.f.st-hatena.com/images/fotolife/r/ryz310/20180621/20180621190557.png\" alt=\"Guild Prototype\" /></a></p>\n\n<p>ã“ã® Guild ã®æ¦‚è¦ã«ã¤ã„ã¦ç¤¾å†…ã®ãƒ¡ãƒ³ãƒãƒ¼ã«è§£èª¬ã—ãŸã¨ã“ã‚ä¸­ã€…ã«å¥½è©•ã ã£ãŸã®ã§ã€ä»Šå›ã®è¨˜äº‹ã§ã¯ Guild ã¨ã¯ã©ã†ã„ã†ã‚‚ã®ãªã®ã‹ã‚’è¶…ã–ã£ãã‚Šã§ã™ãŒã”ç´¹ä»‹ã—ã¾ã™ã€‚</p>\n\n<ul class=\"table-of-contents\">\n    <li><a href=\"#ãã‚‚ãã‚‚è«–ãªãœ-Guild-ãŒå¿…è¦ãªã®ã‹\">ãã‚‚ãã‚‚è«–ã€‚ãªãœ Guild ãŒå¿…è¦ãªã®ã‹ï¼Ÿ</a></li>\n    <li><a href=\"#Guild-ã¨-Thread-ã®é–¢ä¿‚\">Guild ã¨ Thread ã®é–¢ä¿‚</a></li>\n    <li><a href=\"#Guild-é–“ã®ãƒ‡ãƒ¼ã‚¿ã®å—ã‘æ¸¡ã—\">Guild é–“ã®ãƒ‡ãƒ¼ã‚¿ã®å—ã‘æ¸¡ã—</a></li>\n    <li><a href=\"#ãŠã‚ã‚Šã«\">ãŠã‚ã‚Šã«</a></li>\n</ul>\n\n<h1 id=\"ãã‚‚ãã‚‚è«–ãªãœ-Guild-ãŒå¿…è¦ãªã®ã‹\">ãã‚‚ãã‚‚è«–ã€‚ãªãœ Guild ãŒå¿…è¦ãªã®ã‹ï¼Ÿ</h1>\n\n<p>ã”å­˜çŸ¥ã®æ–¹ã‚‚å¤šã„ã‹ã¨æ€ã„ã¾ã™ãŒã€ç¾åœ¨ã® Ruby ã®ã‚¹ãƒ¬ãƒƒãƒ‰å‡¦ç†ã¯ãƒãƒ«ãƒã‚³ã‚¢ã«å¯¾å¿œã—ã¦ã„ã¾ã›ã‚“ã€‚\næœ€è¿‘ã® PC ã®æ®†ã©ã«ã¯ãƒãƒ«ãƒã‚³ã‚¢ CPU ãŒæ­è¼‰ã•ã‚Œã¦ã„ã‚‹ã¨æ€ã„ã¾ã™ãŒã€ï¼‘ã¤ã® Ruby ãƒ—ãƒ­ã‚»ã‚¹ãŒåˆ©ç”¨ã§ãã‚‹ã‚³ã‚¢ã¯ï¼‘ã¤ã ã‘ã§ã™ã€‚ã¤ã¾ã‚Šã€ä¸¦åˆ—å‡¦ç†ã¨è¨€ã£ã¦ã‚‚è¤‡æ•°ã®å‡¦ç†ã‚’æ™‚é–“åˆ†å‰²ã—ã¦å®Ÿè¡Œã—ã¦ã„ã‚‹ã ã‘ã¨ã„ã†äº‹ã«ãªã‚Šã¾ã™ã€‚ Guild ã¯ Ruby ã§ãƒãƒ«ãƒã‚³ã‚¢ã‚’ä½¿ã£ãŸä¸¦åˆ—å‡¦ç†ã‚’å®Ÿç¾ã™ã‚‹ãŸã‚ã«å¿…è¦ãªæ©Ÿèƒ½ã¨ãªã‚Šã¾ã™ã€‚</p>\n\n<p>ã¡ãªã¿ã« Guild ã¨ã„ã†åç§°ã¯ã‚ãã¾ã§ã‚³ãƒ¼ãƒ‰ãƒãƒ¼ãƒ ã§ã‚ã‚‹ãŸã‚ã€ãƒªãƒªãƒ¼ã‚¹æ™‚ã«ã¯åˆ¥ã®åç§°ã«ãªã‚‹ã¨æ€ã‚ã‚Œã¾ã™ã€‚</p>\n\n<h1 id=\"Guild-ã¨-Thread-ã®é–¢ä¿‚\">Guild ã¨ Thread ã®é–¢ä¿‚</h1>\n\n<p><span itemscope itemtype=\"http://schema.org/Photograph\"><img src=\"https://cdn-ak.f.st-hatena.com/images/fotolife/r/ryz310/20180621/20180621191002.png\" alt=\"f:id:ryz310:20180621191002p:plain\" title=\"f:id:ryz310:20180621191002p:plain\" class=\"hatena-fotolife\" itemprop=\"image\"></span></p>\n\n<p>ä¸Šå›³ã®ã‚ˆã†ã« Guild ã« Thread ãŒå†…åŒ…ã•ã‚Œã‚‹é–¢ä¿‚ã«ãªã‚Šã€ãƒ—ãƒ­ã‚»ã‚¹å…¨ä½“ã§ã„ã†ã¨ <code>RubyVM â†’ Guild â†’ Thread â†’ Fiber</code> ã¨ã„ã†é–¢ä¿‚ã«ãªã‚Šã¾ã™ã€‚\nã“ã‚Œã‚’è¸ã¾ãˆã¦ã€ Guild å°å…¥ã®å‰å¾Œã‚’å›³ã«èµ·ã“ã™ã¨ä»¥ä¸‹ã®ã‚ˆã†ã«ãªã‚Šã¾ã™ï¼ˆé›‘ãªå›³ã§æç¸®ã§ã™ã€‚ã€‚ğŸ™‡ï¼‰</p>\n\n<p><span itemscope itemtype=\"http://schema.org/Photograph\"><img src=\"https://cdn-ak.f.st-hatena.com/images/fotolife/r/ryz310/20180621/20180621183710.jpg\" alt=\"f:id:ryz310:20180621183710j:plain\" title=\"f:id:ryz310:20180621183710j:plain\" class=\"hatena-fotolife\" itemprop=\"image\"></span></p>\n\n<p>åŒä¸€ Guild å†…ã® Thread ã¯å¾“æ¥ã©ãŠã‚Šã‚·ãƒ³ã‚°ãƒ«ã‚³ã‚¢ã§å‹•ä½œã—ã¾ã™ã€‚ã—ã‹ã—ã€ Guild ã‚’è¤‡æ•°å®šç¾©ã™ã‚‹ã“ã¨ã§ã€ãã‚Œãã‚Œã® Guild ã«æ‰€å±ã™ã‚‹ Thread ã¯ä¸¦åˆ—ã«å‹•ä½œã™ã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚\nGuild ãŒå®Ÿè£…ã•ã‚Œã¦ã„ãªã„ç¾åœ¨ã® Ruby ã¯ <code>RubyVM â†’ Thread â†’ Fiber</code> ã¨ã„ã†é–¢ä¿‚ã«ãªã‚Šã¾ã™ãŒã€è¨€ã„æ›ãˆã‚Œã°ã“ã‚Œã¯å˜ä¸€ã® Guild ã§ä½œã‚‰ã‚ŒãŸ Ruby ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã¨ã¿ãªã›ã‚‹ã¨æ€ã„ã¾ã™ã€‚\nã“ã®ã“ã¨ã‹ã‚‰ã€Guild ãŒå®Ÿè£…ã•ã‚Œã¦ã‚‚å¾Œæ–¹äº’æ›æ€§ã¯ä¿ãŸã‚Œã‚‹ã®ã§ã¯ãªã„ã‹äºˆæƒ³ã•ã‚Œã¾ã™ã€‚</p>\n\n<h1 id=\"Guild-é–“ã®ãƒ‡ãƒ¼ã‚¿ã®å—ã‘æ¸¡ã—\">Guild é–“ã®ãƒ‡ãƒ¼ã‚¿ã®å—ã‘æ¸¡ã—</h1>\n\n<p>Guild é–“ã§ã®ãƒ‡ãƒ¼ã‚¿å—ã‘æ¸¡ã—ã«ã¤ã„ã¦ã€ Shareable Object ã¨ Non-Shareable Object ã¨ã„ã†æ¦‚å¿µãŒå‡ºã¦ãã¾ã™ã€‚\nè©³ç´°ã¯ <a href=\"http://www.atdot.net/~ko1/activities/2018_rubykaigi2018.pdf\">ç™ºè¡¨ã‚¹ãƒ©ã‚¤ãƒ‰</a> ã‚’è¦‹ã¦ã‚‚ã‚‰ã†ã¨ã—ã¦ã€å¤§é›‘æŠŠã«ä¸¡è€…ã®é•ã„ã‚’èª¬æ˜ã™ã‚‹ã¨ä»¥ä¸‹ã®ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚</p>\n\n<ul>\n<li>Shareable Object\n\n<ul>\n<li>Guild é–“ã§ãƒ‡ãƒ¼ã‚¿å…±æœ‰ãŒå¯èƒ½ãªã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ</li>\n<li>åŸºæœ¬çš„ã«å€¤ãŒå¤‰åŒ–ã—ãªã„ Immutable ãªãƒ‡ãƒ¼ã‚¿ãŒã“ã‚Œã«è©²å½“ã™ã‚‹\n\n<ul>\n<li>Const ã‚„ Freeze ã—ãŸãƒ‡ãƒ¼ã‚¿ã®ã“ã¨</li>\n<li>ãŸã ã— Array ã‚„ Hash ã¯ Freeze ã—ã¦ã‚‚å†…å´ã®ãƒ‡ãƒ¼ã‚¿ã¾ã§ Freeze ã•ã‚Œãªã„ã®ã§ã€ Shareable ã¨ã¯ãªã‚‰ãªã„ã®ã§æ³¨æ„\n\n<ul>\n<li>ã“ã‚Œã«ã¤ã„ã¦ã¯ Deep Freeze ã‚’å®Ÿè£…ã™ã‚‹ã‹ã‚‚ã€ã¨ã®ã“ã¨ã€‚</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>ä»–ã«ã‚‚ Isolated Proc ã¨ã„ã†ã€ãƒ–ãƒ­ãƒƒã‚¯ã®å¤–å´ã®å¤‰æ•°ã¸ã®ã‚¢ã‚¯ã‚»ã‚¹ã‚’ç¦æ­¢ã—ãŸ Proc ã‚‚ã“ã‚Œã«è©²å½“ã—ã¾ã™ãŒã€è©³ç´°ã¯å‰²æ„›</li>\n</ul>\n</li>\n<li>Non-Shareable Object\n\n<ul>\n<li>Guild é–“ã§ãƒ‡ãƒ¼ã‚¿å…±æœ‰ãŒç¦æ­¢ã•ã‚Œã¦ã„ã‚‹ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ\n\n<ul>\n<li>ãƒ‡ãƒ¼ã‚¿ã®å—ã‘æ¸¡ã—ãŒã§ããªã„è¨³ã§ã¯ãªã„ï¼ˆè©³ã—ãã¯å¾Œè¿°ï¼‰</li>\n</ul>\n</li>\n<li>ä¸»ã«ä¸€èˆ¬çš„ãªå¤‰æ•°ã®ã“ã¨</li>\n<li>å˜ä¸€ã® Guild ã«ã®ã¿æ‰€å±ã™ã‚‹</li>\n</ul>\n</li>\n</ul>\n\n\n<p>Shareable Object ã¯ Immutable (å€¤ãŒå¤‰åŒ–ã—ãªã„)ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãªã®ã§ã€ä¸¦åˆ—å‡¦ç†ä¸­ã«ãƒ‡ãƒ¼ã‚¿ã‚’å…±æœ‰ã—ã¦ã‚‚å•é¡Œãªã„ã“ã¨ã¯ã‚¤ãƒ¡ãƒ¼ã‚¸ã—ã‚„ã™ã„ã‹ã¨æ€ã„ã¾ã™ã€‚\né‡è¦ãªã®ã¯ Non-Shareable Object ã®å—ã‘æ¸¡ã—ã§ã€ä»¥ä¸‹ã«ç¤ºã™ 2 ã¤ã®æ–¹æ³•ãŒã‚ã‚Šã¾ã™ã€‚</p>\n\n<ul>\n<li>COPY\n\n<ul>\n<li>ãƒ‡ãƒ¼ã‚¿ã‚’ Guild é–“ã§å…±æœ‰ã™ã‚‹ã®ã§ã¯ãªãã€åˆ¥ã® Guild ã«ã‚³ãƒ”ãƒ¼ã—ã¦æ¸¡ã™</li>\n</ul>\n</li>\n<li>MOVE\n\n<ul>\n<li>åˆ¥ã® Guild ã«ãƒ‡ãƒ¼ã‚¿ã‚’æ¸¡ã™ã¨ã€å…ƒã® Guild ã‹ã‚‰ã¯è¦‹ãˆãªããªã‚‹</li>\n</ul>\n</li>\n</ul>\n\n\n<p>COPY ã¯å‚ç…§æ¸¡ã—ã§ã¯ãªãå®Ÿä½“æ¸¡ã—ãªã®ã§ã€ï¼‘ã¤ã®ãƒ‡ãƒ¼ã‚¿ã«å¯¾ã—ã¦åŒæ™‚ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ã“ã¨ã«ã¯ãªã‚‰ãšã€ Thread-Safe ãªã‚„ã‚Šã¨ã‚Šã«ãªã‚Šã¾ã™ã€‚\nä¸€æ–¹ã® MOVE ã¯ã€ãƒ‡ãƒ¼ã‚¿ã‚’åˆ¥ã® Guild ã«æ¸¡ã™ã¨å…ƒã® Guild ã‹ã‚‰ã¯ã‚¢ã‚¯ã‚»ã‚¹ã§ããªããªã‚‹ã€ã‚«ãƒƒãƒˆã‚¢ãƒ³ãƒ‰ãƒšãƒ¼ã‚¹ãƒˆã®ã‚ˆã†ãªæŒ¯ã‚‹èˆã„ã«ãªã‚Šã¾ã™ã€‚\nã“ã¡ã‚‰ã‚‚åŒæ™‚ã‚¢ã‚¯ã‚»ã‚¹ãŒç™ºç”Ÿã—ãªã„ãŸã‚ã€ Thread-Safe ãªã‚„ã‚Šã¨ã‚Šã«ãªã‚Šã¾ã™ã€‚</p>\n\n<p>ã¡ãªã¿ã« MOVE ã‚ˆã‚Š COPY ãŒåˆ©ç”¨ã•ã‚Œã‚‹ã‚±ãƒ¼ã‚¹ãŒå¤šã„ã ã‚ã†ã¨ã®ã“ã¨ã§ã—ãŸã€‚</p>\n\n<h1 id=\"ãŠã‚ã‚Šã«\">ãŠã‚ã‚Šã«</h1>\n\n<p>RubyKaigi 2018 ã§ç™ºè¡¨ã•ã‚ŒãŸ Guild ã«ã¤ã„ã¦è¶…ã–ã£ãã‚Šã¨èª¬æ˜ã—ã¦ã¿ã¾ã—ãŸã€‚é–“é•ã£ã¦ã‚‹ã¨ã“ã‚ãŒã‚ã‚Œã°ã”æŒ‡æ‘˜é ‚ã‘ã¾ã™ã¨å¹¸ã„ã§ã™ğŸ™\nãªãŠã€é–‹ç™ºä¸­ã®ä»•æ§˜ãªã®ã§å®Ÿè£…ã¾ã§ã«ã„ãã¤ã‹ã®å¤‰æ›´ãŒã‚ã‚‹ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚</p>\n\n<p>æƒ³åƒã§ã™ãŒã€ Sidekiq ã¨ã‹ Puma ã®ã‚ˆã†ãª Thread ãƒ™ãƒ¼ã‚¹ã®ã‚µãƒ¼ãƒ“ã‚¹ã¯ Guild ãŒå°å…¥ã•ã‚ŒãŸã‚‰åŠ‡çš„ã«ãƒ‘ãƒ•ã‚©ãƒ¼ãƒ³ã‚¹ãŒè‰¯ããªã‚‹ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã­ã€‚\nã“ã‚Œã‹ã‚‰ã® Ruby ã®å¯èƒ½æ€§ã«æœŸå¾…ãŒé«˜ã¾ã‚Šã¾ã™âœ¨</p>\n","contentSnippet":"ã©ã†ã‚‚ã€ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ã®ã‚µãƒˆã‚¦ãƒªãƒ§ã‚¦ã‚¹ã‚±ã§ã™ âœŒï¸('Ï‰')âœŒï¸RubyKaigi 2018 ã‹ã‚‰æ—© 3 é€±é–“ã€‚ã“ã®è¨˜äº‹ã‚’èª­ã‚“ã§ã„ã‚‹æ–¹ã§ã‚‚å‚åŠ ã•ã‚ŒãŸæ–¹ãŒæ²¢å±±ã„ã‚‹ã®ã§ã¯ãªã„ã‹ã¨æ€ã„ã¾ã™ã€‚å€‹äººçš„ãªæ„Ÿæƒ³ã§ã™ãŒã€ä»Šå¹´ã¯ä¾‹å¹´ä»¥ä¸Šã«å……å®Ÿã—ã¦ã„ãŸã‚“ã˜ã‚ƒãªã„ã‹ãªã€ã¨å¤§æº€è¶³ã§ã™âœ¨æ„Ÿæƒ³è¨˜äº‹ã¯ã“ã¡ã‚‰ã®è¨˜äº‹ã«è©³ã—ãã¾ã¨ã‚ã‚‰ã‚Œã¦ã„ã¾ã™ã€‚developer.feedforce.jpã•ã¦ã€ä»Šå›ã® RubyKaigi ã®ç™ºè¡¨ã§ã¯ç¬¹ç”°ã•ã‚“ã‹ã‚‰ Guild ã®é€²æ—ã«ã¤ã„ã¦ã®ç™ºè¡¨ãŒã‚ã‚Šã¾ã—ãŸã€‚ã“ã® Guild ã®æ¦‚è¦ã«ã¤ã„ã¦ç¤¾å†…ã®ãƒ¡ãƒ³ãƒãƒ¼ã«è§£èª¬ã—ãŸã¨ã“ã‚ä¸­ã€…ã«å¥½è©•ã ã£ãŸã®ã§ã€ä»Šå›ã®è¨˜äº‹ã§ã¯ Guild ã¨ã¯ã©ã†ã„ã†ã‚‚ã®ãªã®ã‹ã‚’è¶…ã–ã£ãã‚Šã§ã™ãŒã”ç´¹ä»‹ã—ã¾ã™ã€‚ãã‚‚ãã‚‚è«–ã€‚ãªãœ Guild ãŒå¿…è¦ãªã®ã‹ï¼ŸGuild ã¨ Thread ã®é–¢ä¿‚Guild é–“ã®ãƒ‡ãƒ¼ã‚¿ã®å—ã‘æ¸¡ã—ãŠã‚ã‚Šã«ãã‚‚ãã‚‚è«–ã€‚ãªãœ Guild ãŒå¿…è¦ãªã®ã‹ï¼Ÿã”å­˜çŸ¥ã®æ–¹ã‚‚å¤šã„ã‹ã¨æ€ã„ã¾ã™ãŒã€ç¾åœ¨ã® Ruby ã®ã‚¹ãƒ¬ãƒƒãƒ‰å‡¦ç†ã¯ãƒãƒ«ãƒã‚³ã‚¢ã«å¯¾å¿œã—ã¦ã„ã¾ã›ã‚“ã€‚æœ€è¿‘ã® PC ã®æ®†ã©ã«ã¯ãƒãƒ«ãƒã‚³ã‚¢ CPU ãŒæ­è¼‰ã•ã‚Œã¦ã„ã‚‹ã¨æ€ã„ã¾ã™ãŒã€ï¼‘ã¤ã® Ruby ãƒ—ãƒ­ã‚»ã‚¹ãŒåˆ©ç”¨ã§ãã‚‹ã‚³ã‚¢ã¯ï¼‘ã¤ã ã‘ã§ã™ã€‚ã¤ã¾ã‚Šã€ä¸¦åˆ—å‡¦ç†ã¨è¨€ã£ã¦ã‚‚è¤‡æ•°ã®å‡¦ç†ã‚’æ™‚é–“åˆ†å‰²ã—ã¦å®Ÿè¡Œã—ã¦ã„ã‚‹ã ã‘ã¨ã„ã†äº‹ã«ãªã‚Šã¾ã™ã€‚ Guild ã¯ Ruby ã§ãƒãƒ«ãƒã‚³ã‚¢ã‚’ä½¿ã£ãŸä¸¦åˆ—å‡¦ç†ã‚’å®Ÿç¾ã™ã‚‹ãŸã‚ã«å¿…è¦ãªæ©Ÿèƒ½ã¨ãªã‚Šã¾ã™ã€‚ã¡ãªã¿ã« Guild ã¨ã„ã†åç§°ã¯ã‚ãã¾ã§ã‚³ãƒ¼ãƒ‰ãƒãƒ¼ãƒ ã§ã‚ã‚‹ãŸã‚ã€ãƒªãƒªãƒ¼ã‚¹æ™‚ã«ã¯åˆ¥ã®åç§°ã«ãªã‚‹ã¨æ€ã‚ã‚Œã¾ã™ã€‚Guild ã¨ Thread ã®é–¢ä¿‚ä¸Šå›³ã®ã‚ˆã†ã« Guild ã« Thread ãŒå†…åŒ…ã•ã‚Œã‚‹é–¢ä¿‚ã«ãªã‚Šã€ãƒ—ãƒ­ã‚»ã‚¹å…¨ä½“ã§ã„ã†ã¨ RubyVM â†’ Guild â†’ Thread â†’ Fiber ã¨ã„ã†é–¢ä¿‚ã«ãªã‚Šã¾ã™ã€‚ã“ã‚Œã‚’è¸ã¾ãˆã¦ã€ Guild å°å…¥ã®å‰å¾Œã‚’å›³ã«èµ·ã“ã™ã¨ä»¥ä¸‹ã®ã‚ˆã†ã«ãªã‚Šã¾ã™ï¼ˆé›‘ãªå›³ã§æç¸®ã§ã™ã€‚ã€‚ğŸ™‡ï¼‰åŒä¸€ Guild å†…ã® Thread ã¯å¾“æ¥ã©ãŠã‚Šã‚·ãƒ³ã‚°ãƒ«ã‚³ã‚¢ã§å‹•ä½œã—ã¾ã™ã€‚ã—ã‹ã—ã€ Guild ã‚’è¤‡æ•°å®šç¾©ã™ã‚‹ã“ã¨ã§ã€ãã‚Œãã‚Œã® Guild ã«æ‰€å±ã™ã‚‹ Thread ã¯ä¸¦åˆ—ã«å‹•ä½œã™ã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚Guild ãŒå®Ÿè£…ã•ã‚Œã¦ã„ãªã„ç¾åœ¨ã® Ruby ã¯ RubyVM â†’ Thread â†’ Fiber ã¨ã„ã†é–¢ä¿‚ã«ãªã‚Šã¾ã™ãŒã€è¨€ã„æ›ãˆã‚Œã°ã“ã‚Œã¯å˜ä¸€ã® Guild ã§ä½œã‚‰ã‚ŒãŸ Ruby ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã¨ã¿ãªã›ã‚‹ã¨æ€ã„ã¾ã™ã€‚ã“ã®ã“ã¨ã‹ã‚‰ã€Guild ãŒå®Ÿè£…ã•ã‚Œã¦ã‚‚å¾Œæ–¹äº’æ›æ€§ã¯ä¿ãŸã‚Œã‚‹ã®ã§ã¯ãªã„ã‹äºˆæƒ³ã•ã‚Œã¾ã™ã€‚Guild é–“ã®ãƒ‡ãƒ¼ã‚¿ã®å—ã‘æ¸¡ã—Guild é–“ã§ã®ãƒ‡ãƒ¼ã‚¿å—ã‘æ¸¡ã—ã«ã¤ã„ã¦ã€ Shareable Object ã¨ Non-Shareable Object ã¨ã„ã†æ¦‚å¿µãŒå‡ºã¦ãã¾ã™ã€‚è©³ç´°ã¯ ç™ºè¡¨ã‚¹ãƒ©ã‚¤ãƒ‰ ã‚’è¦‹ã¦ã‚‚ã‚‰ã†ã¨ã—ã¦ã€å¤§é›‘æŠŠã«ä¸¡è€…ã®é•ã„ã‚’èª¬æ˜ã™ã‚‹ã¨ä»¥ä¸‹ã®ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚Shareable ObjectGuild é–“ã§ãƒ‡ãƒ¼ã‚¿å…±æœ‰ãŒå¯èƒ½ãªã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆåŸºæœ¬çš„ã«å€¤ãŒå¤‰åŒ–ã—ãªã„ Immutable ãªãƒ‡ãƒ¼ã‚¿ãŒã“ã‚Œã«è©²å½“ã™ã‚‹Const ã‚„ Freeze ã—ãŸãƒ‡ãƒ¼ã‚¿ã®ã“ã¨ãŸã ã— Array ã‚„ Hash ã¯ Freeze ã—ã¦ã‚‚å†…å´ã®ãƒ‡ãƒ¼ã‚¿ã¾ã§ Freeze ã•ã‚Œãªã„ã®ã§ã€ Shareable ã¨ã¯ãªã‚‰ãªã„ã®ã§æ³¨æ„ã“ã‚Œã«ã¤ã„ã¦ã¯ Deep Freeze ã‚’å®Ÿè£…ã™ã‚‹ã‹ã‚‚ã€ã¨ã®ã“ã¨ã€‚ä»–ã«ã‚‚ Isolated Proc ã¨ã„ã†ã€ãƒ–ãƒ­ãƒƒã‚¯ã®å¤–å´ã®å¤‰æ•°ã¸ã®ã‚¢ã‚¯ã‚»ã‚¹ã‚’ç¦æ­¢ã—ãŸ Proc ã‚‚ã“ã‚Œã«è©²å½“ã—ã¾ã™ãŒã€è©³ç´°ã¯å‰²æ„›Non-Shareable ObjectGuild é–“ã§ãƒ‡ãƒ¼ã‚¿å…±æœ‰ãŒç¦æ­¢ã•ã‚Œã¦ã„ã‚‹ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãƒ‡ãƒ¼ã‚¿ã®å—ã‘æ¸¡ã—ãŒã§ããªã„è¨³ã§ã¯ãªã„ï¼ˆè©³ã—ãã¯å¾Œè¿°ï¼‰ä¸»ã«ä¸€èˆ¬çš„ãªå¤‰æ•°ã®ã“ã¨å˜ä¸€ã® Guild ã«ã®ã¿æ‰€å±ã™ã‚‹Shareable Object ã¯ Immutable (å€¤ãŒå¤‰åŒ–ã—ãªã„)ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãªã®ã§ã€ä¸¦åˆ—å‡¦ç†ä¸­ã«ãƒ‡ãƒ¼ã‚¿ã‚’å…±æœ‰ã—ã¦ã‚‚å•é¡Œãªã„ã“ã¨ã¯ã‚¤ãƒ¡ãƒ¼ã‚¸ã—ã‚„ã™ã„ã‹ã¨æ€ã„ã¾ã™ã€‚é‡è¦ãªã®ã¯ Non-Shareable Object ã®å—ã‘æ¸¡ã—ã§ã€ä»¥ä¸‹ã«ç¤ºã™ 2 ã¤ã®æ–¹æ³•ãŒã‚ã‚Šã¾ã™ã€‚COPYãƒ‡ãƒ¼ã‚¿ã‚’ Guild é–“ã§å…±æœ‰ã™ã‚‹ã®ã§ã¯ãªãã€åˆ¥ã® Guild ã«ã‚³ãƒ”ãƒ¼ã—ã¦æ¸¡ã™MOVEåˆ¥ã® Guild ã«ãƒ‡ãƒ¼ã‚¿ã‚’æ¸¡ã™ã¨ã€å…ƒã® Guild ã‹ã‚‰ã¯è¦‹ãˆãªããªã‚‹COPY ã¯å‚ç…§æ¸¡ã—ã§ã¯ãªãå®Ÿä½“æ¸¡ã—ãªã®ã§ã€ï¼‘ã¤ã®ãƒ‡ãƒ¼ã‚¿ã«å¯¾ã—ã¦åŒæ™‚ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ã“ã¨ã«ã¯ãªã‚‰ãšã€ Thread-Safe ãªã‚„ã‚Šã¨ã‚Šã«ãªã‚Šã¾ã™ã€‚ä¸€æ–¹ã® MOVE ã¯ã€ãƒ‡ãƒ¼ã‚¿ã‚’åˆ¥ã® Guild ã«æ¸¡ã™ã¨å…ƒã® Guild ã‹ã‚‰ã¯ã‚¢ã‚¯ã‚»ã‚¹ã§ããªããªã‚‹ã€ã‚«ãƒƒãƒˆã‚¢ãƒ³ãƒ‰ãƒšãƒ¼ã‚¹ãƒˆã®ã‚ˆã†ãªæŒ¯ã‚‹èˆã„ã«ãªã‚Šã¾ã™ã€‚ã“ã¡ã‚‰ã‚‚åŒæ™‚ã‚¢ã‚¯ã‚»ã‚¹ãŒç™ºç”Ÿã—ãªã„ãŸã‚ã€ Thread-Safe ãªã‚„ã‚Šã¨ã‚Šã«ãªã‚Šã¾ã™ã€‚ã¡ãªã¿ã« MOVE ã‚ˆã‚Š COPY ãŒåˆ©ç”¨ã•ã‚Œã‚‹ã‚±ãƒ¼ã‚¹ãŒå¤šã„ã ã‚ã†ã¨ã®ã“ã¨ã§ã—ãŸã€‚ãŠã‚ã‚Šã«RubyKaigi 2018 ã§ç™ºè¡¨ã•ã‚ŒãŸ Guild ã«ã¤ã„ã¦è¶…ã–ã£ãã‚Šã¨èª¬æ˜ã—ã¦ã¿ã¾ã—ãŸã€‚é–“é•ã£ã¦ã‚‹ã¨ã“ã‚ãŒã‚ã‚Œã°ã”æŒ‡æ‘˜é ‚ã‘ã¾ã™ã¨å¹¸ã„ã§ã™ğŸ™ãªãŠã€é–‹ç™ºä¸­ã®ä»•æ§˜ãªã®ã§å®Ÿè£…ã¾ã§ã«ã„ãã¤ã‹ã®å¤‰æ›´ãŒã‚ã‚‹ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚æƒ³åƒã§ã™ãŒã€ Sidekiq ã¨ã‹ Puma ã®ã‚ˆã†ãª Thread ãƒ™ãƒ¼ã‚¹ã®ã‚µãƒ¼ãƒ“ã‚¹ã¯ Guild ãŒå°å…¥ã•ã‚ŒãŸã‚‰åŠ‡çš„ã«ãƒ‘ãƒ•ã‚©ãƒ¼ãƒ³ã‚¹ãŒè‰¯ããªã‚‹ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã­ã€‚ã“ã‚Œã‹ã‚‰ã® Ruby ã®å¯èƒ½æ€§ã«æœŸå¾…ãŒé«˜ã¾ã‚Šã¾ã™âœ¨","link":"https://developer.feedforce.jp/entry/2018/06/25/100000","isoDate":"2018-06-25T01:00:00.000Z","dateMiliSeconds":1529888400000,"imageUrl":"https://cdn-ak.f.st-hatena.com/images/fotolife/r/ryz310/20180621/20180621190557.png","authorName":"ryz310"},{"title":"ç¶šãƒ»Rails 5.2 é–‹ç™ºç’°å¢ƒã‚’ Docker ã§æ§‹ç¯‰ã™ã‚‹","content":"<p>ã©ã†ã‚‚ã€ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ã®ã‚µãƒˆã‚¦ãƒªãƒ§ã‚¦ã‚¹ã‚±ã§ã™ âœŒï¸('Ï‰')âœŒï¸</p>\n\n<p>å‰å›ã®è¨˜äº‹ã§ã¯ Docker ã‚’ä½¿ã£ã¦ Rails 5.2 ã®ç’°å¢ƒæ§‹ç¯‰ã‚’ã—ã¾ã—ãŸã€‚\nç¾åœ¨ã‚‚å¼•ãç¶šã Docker ã«ã¤ã„ã¦ã®ãŠè©±ã‚’ã—ã¾ã™ã€‚</p>\n\n<p><iframe src=\"https://hatenablog-parts.com/embed?url=http%3A%2F%2Fdeveloper.feedforce.jp%2Fentry%2F2018%2F02%2F11%2F140012\" title=\"Rails 5.2 é–‹ç™ºç’°å¢ƒã‚’ Docker ã§æ§‹ç¯‰ã™ã‚‹ - Feedforce Developer Blog\" class=\"embed-card embed-blogcard\" scrolling=\"no\" frameborder=\"0\" style=\"display: block; width: 100%; height: 190px; max-width: 500px; margin: 10px 0px;\"></iframe><cite class=\"hatena-citation\"><a href=\"http://developer.feedforce.jp/entry/2018/02/11/140012\">developer.feedforce.jp</a></cite></p>\n\n<p>ãã®å¾Œã‚‚å¹¾ã¤ã‹æ‰‹ã‚’åŠ ãˆç¶šã‘ã¦ãŠã‚Šã¾ã—ã¦ã€ç¾åœ¨ã“ã®è¨˜äº‹ã‚’æ›¸ã„ã¦ã„ã‚‹æ™‚ç‚¹ã§ <code>v1.3.0</code> ã«ãªã‚Šã¾ã—ãŸ ğŸ‰\næ˜ã‚‰ã‹ã«åˆå›ã®ãƒŠãƒ³ãƒãƒªãƒ³ã‚°ã‚’é–“é•ãˆã¦ã„ãŸæ„ŸãŒã‚ã‚Šã¾ã™ãŒã€å°‘ã—ãšã¤ã‚¤ãƒ³ã‚¯ãƒªãƒ¡ãƒ³ãƒˆã•ã›ã¦ã„ãæ¥½ã—ã¿ã‚’å®Ÿæ„Ÿã§ãã¦è‰¯ã„ã§ã™ ç¬‘</p>\n\n<h2>å‰å›ã‹ã‚‰ã®å¤‰æ›´ç‚¹ã«ã¤ã„ã¦</h2>\n\n<p>ã•ã¦ã€å‰å›ã®è¨˜äº‹ã¯ <code>v1.0.0</code> æ™‚ç‚¹ã®ã‚‚ã®ã§ã—ãŸãŒã€ã“ã“ã§ <code>v1.3.0</code> ã«ãªã£ãŸç¾åœ¨ã® <code>Dockerfile</code> ã‚’è¦‹ã¦ã¿ã¾ã—ã‚‡ã†ã€‚</p>\n\n<pre class=\"code\" data-lang=\"\" data-unlink># Dockerfile\nFROM ryz310/rails-on-docker</pre>\n\n\n<p>ãªã‚“ã¨ï¼ãŸã£ãŸã®ï¼‘è¡Œã½ã£ã¡ã§ã™ï¼ï¼¼ï¼¼\\Ù©( 'Ï‰' )Ùˆ //ï¼ï¼</p>\n\n<p>ä½•è¨€ã£ã¦ã‚“ã ã‚³ã‚¤ãƒ„ã¨æ€ã‚ã‚Œãã†ã§ã™ãŒã€ã“ã‚Œã¯ã©ã†ã„ã†äº‹ã‹ã¨ã„ã†ã¨ã€å¤§éƒ¨åˆ†ã‚’ <code>base/Dockerfile</code> ã«ç§»å‹•ã—ãŸãŸã‚ã§ã™ã€‚</p>\n\n<pre class=\"code\" data-lang=\"\" data-unlink># base/Dockerfile\nFROM ruby:2.5\nMAINTAINER ryz310@gmail.com\n\nRUN apt-get update -qq &amp;&amp; apt-get install -y build-essential libpq-dev nodejs\n\nWORKDIR /myapp\nENV BUNDLE_JOBS=32\n\nONBUILD ADD Gemfile /myapp/Gemfile\nONBUILD ADD Gemfile.lock /myapp/Gemfile.lock\nONBUILD RUN bundle install\nONBUILD ADD . /myapp</pre>\n\n\n<p>ã“ã® <code>base/Dockerfile</code> ã®ã‚¤ãƒ¡ãƒ¼ã‚¸ã¯ <a href=\"https://hub.docker.com/r/ryz310/rails-on-docker/\">åƒ•ã®Docker Hub</a> ã«ç½®ã„ã¦ã‚ã‚Šã¾ã™ã€‚</p>\n\n<p><code>ONBUILD</code> ãŒä»˜ã„ãŸã‚³ãƒãƒ³ãƒ‰ã¯ã“ã®ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’ç¶™æ‰¿ã—ãŸã‚¤ãƒ¡ãƒ¼ã‚¸ã§å®Ÿè¡Œã•ã‚Œã‚‹ãŸã‚ã€å…ˆã»ã©ã® <code>Dockerfile</code> ã«ã¯ <code>FROM</code> ã—ã‹ã‚ã‚Šã¾ã›ã‚“ãŒã€ãƒ“ãƒ«ãƒ‰ã®éš›ã«ã¯ä»¥ä¸‹ã® 4 ã¤ã®ã‚³ãƒãƒ³ãƒ‰ãŒå®Ÿè¡Œã•ã‚Œã‚‹äº‹ã«ãªã‚Šã¾ã™ã€‚</p>\n\n<pre class=\"code\" data-lang=\"\" data-unlink>ADD Gemfile /myapp/Gemfile\nADD Gemfile.lock /myapp/Gemfile.lock\nRUN bundle install\nADD . /myapp</pre>\n\n\n<p>æ„Ÿè¦šã¨ã—ã¦ã¯ã€ <code>base/Dockerfile</code> ã§ Rails ã®èµ·å‹•ã«å¿…è¦ãªã‚µãƒ¼ãƒãƒ¼ç’°å¢ƒã‚’æ§‹ç¯‰ã—ã¦ã€ <code>Dockerfile</code> ã§ Rails ãã®ã‚‚ã®ã‚’æ§‹ç¯‰ã—ã¦ã„ãã‚ˆã†ãªæ„Ÿã˜ã§ã™ã€‚\nRails ã®æ§‹ç¯‰ã«ã¯ RDS ã‚¤ãƒ¡ãƒ¼ã‚¸ãªã©ã‚‚å¿…é ˆã¨ãªã£ã¦ãã¾ã™ã®ã§ã€ãã‚Œã«ã¤ã„ã¦ã¯ <code>docker-compose.yml</code> ã¨çµ„ã¿åˆã‚ã›ã¦æ§‹ç¯‰ã—ã¦ã„ãã¾ã™ã€‚</p>\n\n<pre class=\"code\" data-lang=\"\" data-unlink># docker-compose.yml\nversion: &#39;3&#39;\nservices:\n  db:\n    image: mysql:5.7\n    volumes:\n      - mysql_data:/var/lib/mysql\n    environment:\n      MYSQL_ALLOW_EMPTY_PASSWORD: &#39;yes&#39;\n    ports:\n      - &#34;3306:3306&#34;\n  web:\n    build: .\n    image: web_image\n    command: bundle exec rails s -p 3000 -b &#39;0.0.0.0&#39;\n    volumes:\n      - .:/myapp\n      - bundle:/usr/local/bundle\n    ports:\n      - &#34;3000:3000&#34;\n    depends_on:\n      - db\n    environment:\n      DB_HOST: db\n  spring:\n    image: web_image\n    command: bundle exec spring server\n    volumes:\n      - .:/myapp\n      - bundle:/usr/local/bundle\n    tty: false\n    stdin_open: false\n    environment:\n      DB_HOST: db\nvolumes:\n  mysql_data:\n  bundle:</pre>\n\n\n<p>ã“ã“ã‚‚ <code>v1.0.0</code> ã®é ƒã‹ã‚‰ã„ãã¤ã‹å¤‰æ›´ãŒã‚ã‚Šã¾ã—ã¦ã€ä¾‹ãˆã° <code>web</code> ã¨ <code>spring</code> ã§åŒã˜å†…å®¹ã«ãªã‚‹ã‚ˆã†ã« <code>v1.0.0</code> ã§ã¯ YAML ã®ã‚¨ã‚¤ãƒªã‚¢ã‚¹ã‚’ä½¿ã£ã¦ã„ãŸã®ã§ã™ãŒã€ docker image ã§å…±æœ‰ã™ã‚‹æ–¹æ³•ã«å¤‰ãˆã¾ã—ãŸã€‚ã“ã®å®šç¾©ã®è¨˜è¿°ã«ã¤ã„ã¦å°‘ã—è£œè¶³ã—ã¾ã™ã€‚</p>\n\n<p><code>web</code> ã®å®šç¾©ã§ <code>build: .</code> ã¨ <code>image: web_image</code> ã¨è¨€ã†è¨˜è¿°ãŒã‚ã‚Šã¾ã™ãŒã€ã“ã‚Œã¯ Dockerfile ã‚’ãƒ“ãƒ«ãƒ‰ã—ã¦ <code>web_image</code> ã¨ã„ã†ã‚¿ã‚°ã‚’ã¤ã‘ã‚‹ã€ã¨è¨€ã†æŒ¯ã‚‹èˆã„ã«ãªã‚Šã¾ã™ã€‚ä¸€æ–¹ã€ <code>spring</code> ã®å®šç¾©ã® <code>image: web_image</code> ã§ã¯ <code>web_image</code> ã¨ã„ã†ã‚¿ã‚°ãŒä»˜ã„ãŸã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’ä½¿ç”¨ã™ã‚‹ã€ã¨ã„ã†æŒ¯ã‚‹èˆã„ã«ãªã‚Šã¾ã™ã€‚ã“ã®è¾ºã¯ãªã‚“ã ã‹ã‚„ã‚„ã“ã—ã„ã§ã™ã­ ğŸ˜“</p>\n\n<p>ã¾ãŸã€ <code>bundle:/usr/local/bundle</code> ã‚’ volume ã«æŒ‡å®šã™ã‚‹äº‹ã§ã€<code>bundle install</code> ã®å†…å®¹ã‚’æ°¸ç¶šåŒ–ã™ã‚‹ã‚ˆã†ã«ã—ã¦ã‚ã‚Šã¾ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€<code>$ docker-compose run --rm web bundle install</code> ã¨ã„ã†ã‚³ãƒãƒ³ãƒ‰ãŒæœ‰åŠ¹ã«ãªã£ã¦ãã‚‹ã®ã§ã€Gemfile ã‚’æ›´æ–°ã—ãŸéš›ã«ä¸€ã‹ã‚‰ Build ã™ã‚‹å¿…è¦ãŒãªããªã‚Šã¾ã™ã€‚\nåŒæ§˜ã«ã€ MySQL ã‚‚ <code>mysql_data:/var/lib/mysql</code> ã‚’ volume ã«æŒ‡å®šã™ã‚‹äº‹ã§ã€ãƒ†ãƒ¼ãƒ–ãƒ«ã®å†…å®¹ã‚’æ°¸ç¶šåŒ–ã™ã‚‹ã‚ˆã†ã«ã—ã¦ã„ã¾ã™ã€‚</p>\n\n<h2>ã¾ã¨ã‚</h2>\n\n<p><code>ONBUILD</code> ã‚’ä½¿ç”¨ã™ã‚‹äº‹ã§ã€ä»–ã® Rails ã‚¢ãƒ—ãƒªã§ã‚‚åŒã˜ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’è»¢ç”¨ã§ãã‚‹ã‚ˆã†ã«ãªã£ãŸã®ãŒä¸€ç•ªã®æ”¹å–„ç‚¹ã§ã¯ãªã„ã‹ã¨æ€ã„ã¾ã™ã€‚</p>\n\n<p>ãŸã ã€Rails ã‚¢ãƒ—ãƒªå´ã®äº‹æƒ…ã§ä½•ã‹ <code>$ apt-get install</code> ã‚’åŠ ãˆãŸããªã£ãŸå ´åˆã«ã©ã†ã™ã‚‹ã®ã‹ã€ã¨ã„ã†èª²é¡Œæ„ŸãŒã‚ã‚Šã¾ã™ã€‚<code>base/Dockerfile</code> ã¯æ±ç”¨çš„ãªç’°å¢ƒæ§‹ç¯‰ã‚’æ„è­˜ã—ã¦ã„ã‚‹ã®ã§ã€ã‚ã¾ã‚Šä¸€èˆ¬çš„ã§ãªã„ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã¯è¡Œã„ãŸãã‚ã‚Šã¾ã›ã‚“ã€‚ç†æƒ³ã¨ã—ã¦ã¯ã€Œå­ã‚¤ãƒ¡ãƒ¼ã‚¸ã€ã§ <code>$ apt-get install</code> ã•ã›ã¦ã€ã€Œå­«ã‚¤ãƒ¡ãƒ¼ã‚¸ã€ã§ä»Šå›ã®ã‚ˆã†ã« Rails ã®æ§‹ç¯‰ã‚’ã™ã‚‹æ§‹æˆãŒå®Ÿç¾ã§ãã‚Œã°è‰¯ã„ã®ã§ã¯ãªã„ã‹ã¨æ€ã„ã¾ã™ãŒã€ <code>ONBUILD</code> ã‚’ã€Œå­ã‚¤ãƒ¡ãƒ¼ã‚¸ã€ã§ã‚¹ã‚­ãƒƒãƒ—ã•ã›ã‚‹ã¨ã‹å‡ºæ¥ã‚‹ã‚“ã§ã—ã‚‡ã†ã‹ï¼Ÿ</p>\n\n<p>æ¬¡å›ã¯ã“ã®è¾ºã«ã¤ã„ã¦å°‘ã—èª¿ã¹ã¦ã„ã‘ã‚Œã°ã€ã¨æ€ã£ã¦ã„ã¾ã™ã€‚</p>\n","contentSnippet":"ã©ã†ã‚‚ã€ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ã®ã‚µãƒˆã‚¦ãƒªãƒ§ã‚¦ã‚¹ã‚±ã§ã™ âœŒï¸('Ï‰')âœŒï¸å‰å›ã®è¨˜äº‹ã§ã¯ Docker ã‚’ä½¿ã£ã¦ Rails 5.2 ã®ç’°å¢ƒæ§‹ç¯‰ã‚’ã—ã¾ã—ãŸã€‚ç¾åœ¨ã‚‚å¼•ãç¶šã Docker ã«ã¤ã„ã¦ã®ãŠè©±ã‚’ã—ã¾ã™ã€‚developer.feedforce.jpãã®å¾Œã‚‚å¹¾ã¤ã‹æ‰‹ã‚’åŠ ãˆç¶šã‘ã¦ãŠã‚Šã¾ã—ã¦ã€ç¾åœ¨ã“ã®è¨˜äº‹ã‚’æ›¸ã„ã¦ã„ã‚‹æ™‚ç‚¹ã§ v1.3.0 ã«ãªã‚Šã¾ã—ãŸ ğŸ‰æ˜ã‚‰ã‹ã«åˆå›ã®ãƒŠãƒ³ãƒãƒªãƒ³ã‚°ã‚’é–“é•ãˆã¦ã„ãŸæ„ŸãŒã‚ã‚Šã¾ã™ãŒã€å°‘ã—ãšã¤ã‚¤ãƒ³ã‚¯ãƒªãƒ¡ãƒ³ãƒˆã•ã›ã¦ã„ãæ¥½ã—ã¿ã‚’å®Ÿæ„Ÿã§ãã¦è‰¯ã„ã§ã™ ç¬‘å‰å›ã‹ã‚‰ã®å¤‰æ›´ç‚¹ã«ã¤ã„ã¦ã•ã¦ã€å‰å›ã®è¨˜äº‹ã¯ v1.0.0 æ™‚ç‚¹ã®ã‚‚ã®ã§ã—ãŸãŒã€ã“ã“ã§ v1.3.0 ã«ãªã£ãŸç¾åœ¨ã® Dockerfile ã‚’è¦‹ã¦ã¿ã¾ã—ã‚‡ã†ã€‚# DockerfileFROM ryz310/rails-on-dockerãªã‚“ã¨ï¼ãŸã£ãŸã®ï¼‘è¡Œã½ã£ã¡ã§ã™ï¼ï¼¼ï¼¼\\Ù©( 'Ï‰' )Ùˆ //ï¼ï¼ä½•è¨€ã£ã¦ã‚“ã ã‚³ã‚¤ãƒ„ã¨æ€ã‚ã‚Œãã†ã§ã™ãŒã€ã“ã‚Œã¯ã©ã†ã„ã†äº‹ã‹ã¨ã„ã†ã¨ã€å¤§éƒ¨åˆ†ã‚’ base/Dockerfile ã«ç§»å‹•ã—ãŸãŸã‚ã§ã™ã€‚# base/DockerfileFROM ruby:2.5MAINTAINER ryz310@gmail.comRUN apt-get update -qq && apt-get install -y build-essential libpq-dev nodejsWORKDIR /myappENV BUNDLE_JOBS=32ONBUILD ADD Gemfile /myapp/GemfileONBUILD ADD Gemfile.lock /myapp/Gemfile.lockONBUILD RUN bundle installONBUILD ADD . /myappã“ã® base/Dockerfile ã®ã‚¤ãƒ¡ãƒ¼ã‚¸ã¯ åƒ•ã®Docker Hub ã«ç½®ã„ã¦ã‚ã‚Šã¾ã™ã€‚ONBUILD ãŒä»˜ã„ãŸã‚³ãƒãƒ³ãƒ‰ã¯ã“ã®ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’ç¶™æ‰¿ã—ãŸã‚¤ãƒ¡ãƒ¼ã‚¸ã§å®Ÿè¡Œã•ã‚Œã‚‹ãŸã‚ã€å…ˆã»ã©ã® Dockerfile ã«ã¯ FROM ã—ã‹ã‚ã‚Šã¾ã›ã‚“ãŒã€ãƒ“ãƒ«ãƒ‰ã®éš›ã«ã¯ä»¥ä¸‹ã® 4 ã¤ã®ã‚³ãƒãƒ³ãƒ‰ãŒå®Ÿè¡Œã•ã‚Œã‚‹äº‹ã«ãªã‚Šã¾ã™ã€‚ADD Gemfile /myapp/GemfileADD Gemfile.lock /myapp/Gemfile.lockRUN bundle installADD . /myappæ„Ÿè¦šã¨ã—ã¦ã¯ã€ base/Dockerfile ã§ Rails ã®èµ·å‹•ã«å¿…è¦ãªã‚µãƒ¼ãƒãƒ¼ç’°å¢ƒã‚’æ§‹ç¯‰ã—ã¦ã€ Dockerfile ã§ Rails ãã®ã‚‚ã®ã‚’æ§‹ç¯‰ã—ã¦ã„ãã‚ˆã†ãªæ„Ÿã˜ã§ã™ã€‚Rails ã®æ§‹ç¯‰ã«ã¯ RDS ã‚¤ãƒ¡ãƒ¼ã‚¸ãªã©ã‚‚å¿…é ˆã¨ãªã£ã¦ãã¾ã™ã®ã§ã€ãã‚Œã«ã¤ã„ã¦ã¯ docker-compose.yml ã¨çµ„ã¿åˆã‚ã›ã¦æ§‹ç¯‰ã—ã¦ã„ãã¾ã™ã€‚# docker-compose.ymlversion: '3'services:  db:    image: mysql:5.7    volumes:      - mysql_data:/var/lib/mysql    environment:      MYSQL_ALLOW_EMPTY_PASSWORD: 'yes'    ports:      - \"3306:3306\"  web:    build: .    image: web_image    command: bundle exec rails s -p 3000 -b '0.0.0.0'    volumes:      - .:/myapp      - bundle:/usr/local/bundle    ports:      - \"3000:3000\"    depends_on:      - db    environment:      DB_HOST: db  spring:    image: web_image    command: bundle exec spring server    volumes:      - .:/myapp      - bundle:/usr/local/bundle    tty: false    stdin_open: false    environment:      DB_HOST: dbvolumes:  mysql_data:  bundle:ã“ã“ã‚‚ v1.0.0 ã®é ƒã‹ã‚‰ã„ãã¤ã‹å¤‰æ›´ãŒã‚ã‚Šã¾ã—ã¦ã€ä¾‹ãˆã° web ã¨ spring ã§åŒã˜å†…å®¹ã«ãªã‚‹ã‚ˆã†ã« v1.0.0 ã§ã¯ YAML ã®ã‚¨ã‚¤ãƒªã‚¢ã‚¹ã‚’ä½¿ã£ã¦ã„ãŸã®ã§ã™ãŒã€ docker image ã§å…±æœ‰ã™ã‚‹æ–¹æ³•ã«å¤‰ãˆã¾ã—ãŸã€‚ã“ã®å®šç¾©ã®è¨˜è¿°ã«ã¤ã„ã¦å°‘ã—è£œè¶³ã—ã¾ã™ã€‚web ã®å®šç¾©ã§ build: . ã¨ image: web_image ã¨è¨€ã†è¨˜è¿°ãŒã‚ã‚Šã¾ã™ãŒã€ã“ã‚Œã¯ Dockerfile ã‚’ãƒ“ãƒ«ãƒ‰ã—ã¦ web_image ã¨ã„ã†ã‚¿ã‚°ã‚’ã¤ã‘ã‚‹ã€ã¨è¨€ã†æŒ¯ã‚‹èˆã„ã«ãªã‚Šã¾ã™ã€‚ä¸€æ–¹ã€ spring ã®å®šç¾©ã® image: web_image ã§ã¯ web_image ã¨ã„ã†ã‚¿ã‚°ãŒä»˜ã„ãŸã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’ä½¿ç”¨ã™ã‚‹ã€ã¨ã„ã†æŒ¯ã‚‹èˆã„ã«ãªã‚Šã¾ã™ã€‚ã“ã®è¾ºã¯ãªã‚“ã ã‹ã‚„ã‚„ã“ã—ã„ã§ã™ã­ ğŸ˜“ã¾ãŸã€ bundle:/usr/local/bundle ã‚’ volume ã«æŒ‡å®šã™ã‚‹äº‹ã§ã€bundle install ã®å†…å®¹ã‚’æ°¸ç¶šåŒ–ã™ã‚‹ã‚ˆã†ã«ã—ã¦ã‚ã‚Šã¾ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€$ docker-compose run --rm web bundle install ã¨ã„ã†ã‚³ãƒãƒ³ãƒ‰ãŒæœ‰åŠ¹ã«ãªã£ã¦ãã‚‹ã®ã§ã€Gemfile ã‚’æ›´æ–°ã—ãŸéš›ã«ä¸€ã‹ã‚‰ Build ã™ã‚‹å¿…è¦ãŒãªããªã‚Šã¾ã™ã€‚åŒæ§˜ã«ã€ MySQL ã‚‚ mysql_data:/var/lib/mysql ã‚’ volume ã«æŒ‡å®šã™ã‚‹äº‹ã§ã€ãƒ†ãƒ¼ãƒ–ãƒ«ã®å†…å®¹ã‚’æ°¸ç¶šåŒ–ã™ã‚‹ã‚ˆã†ã«ã—ã¦ã„ã¾ã™ã€‚ã¾ã¨ã‚ONBUILD ã‚’ä½¿ç”¨ã™ã‚‹äº‹ã§ã€ä»–ã® Rails ã‚¢ãƒ—ãƒªã§ã‚‚åŒã˜ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’è»¢ç”¨ã§ãã‚‹ã‚ˆã†ã«ãªã£ãŸã®ãŒä¸€ç•ªã®æ”¹å–„ç‚¹ã§ã¯ãªã„ã‹ã¨æ€ã„ã¾ã™ã€‚ãŸã ã€Rails ã‚¢ãƒ—ãƒªå´ã®äº‹æƒ…ã§ä½•ã‹ $ apt-get install ã‚’åŠ ãˆãŸããªã£ãŸå ´åˆã«ã©ã†ã™ã‚‹ã®ã‹ã€ã¨ã„ã†èª²é¡Œæ„ŸãŒã‚ã‚Šã¾ã™ã€‚base/Dockerfile ã¯æ±ç”¨çš„ãªç’°å¢ƒæ§‹ç¯‰ã‚’æ„è­˜ã—ã¦ã„ã‚‹ã®ã§ã€ã‚ã¾ã‚Šä¸€èˆ¬çš„ã§ãªã„ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã¯è¡Œã„ãŸãã‚ã‚Šã¾ã›ã‚“ã€‚ç†æƒ³ã¨ã—ã¦ã¯ã€Œå­ã‚¤ãƒ¡ãƒ¼ã‚¸ã€ã§ $ apt-get install ã•ã›ã¦ã€ã€Œå­«ã‚¤ãƒ¡ãƒ¼ã‚¸ã€ã§ä»Šå›ã®ã‚ˆã†ã« Rails ã®æ§‹ç¯‰ã‚’ã™ã‚‹æ§‹æˆãŒå®Ÿç¾ã§ãã‚Œã°è‰¯ã„ã®ã§ã¯ãªã„ã‹ã¨æ€ã„ã¾ã™ãŒã€ ONBUILD ã‚’ã€Œå­ã‚¤ãƒ¡ãƒ¼ã‚¸ã€ã§ã‚¹ã‚­ãƒƒãƒ—ã•ã›ã‚‹ã¨ã‹å‡ºæ¥ã‚‹ã‚“ã§ã—ã‚‡ã†ã‹ï¼Ÿæ¬¡å›ã¯ã“ã®è¾ºã«ã¤ã„ã¦å°‘ã—èª¿ã¹ã¦ã„ã‘ã‚Œã°ã€ã¨æ€ã£ã¦ã„ã¾ã™ã€‚","link":"https://developer.feedforce.jp/entry/2018/02/25/234556","isoDate":"2018-02-25T14:45:56.000Z","dateMiliSeconds":1519569956000,"imageUrl":"https://cdn.user.blog.st-hatena.com/default_entry_og_image/116461321/1514251518718655","authorName":"ryz310"},{"title":"Rails 5.2 é–‹ç™ºç’°å¢ƒã‚’ Docker ã§æ§‹ç¯‰ã™ã‚‹","content":"<p>ã©ã†ã‚‚ã€ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ã®ã‚µãƒˆã‚¦ãƒªãƒ§ã‚¦ã‚¹ã‚±ã§ã™ âœŒï¸('Ï‰')âœŒï¸</p>\n\n<p>åƒ•ãŒæ‰€å±ã—ã¦ã„ã‚‹ <a href=\"https://socialplus.jp/\">ã‚½ãƒ¼ã‚·ãƒ£ãƒ«PLUS</a> ãƒãƒ¼ãƒ ã§ã¯ Rails ã®é–‹ç™ºç’°å¢ƒã‚’ Docker ã§æ§‹ç¯‰ã—ã¦ã„ã¾ã™ã€‚\nè‡ªåˆ†ã‚‚æ—¥ã€…ãŠä¸–è©±ã«ãªã£ã¦ã„ã‚‹ Docker ã§ã™ãŒã€ã‚¤ãƒã‹ã‚‰ Dockerfile æ›¸ã„ãŸäº‹ãŒç„¡ã‹ã£ãŸã®ã§ã€ã‚„ã£ã¦ã¿ã¾ã—ãŸã€‚</p>\n\n<p>ã“ã¡ã‚‰ã®ãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«ã‚’å‚è€ƒã«ã—ã¦ã„ã¾ã™ã€‚</p>\n\n<p><a href=\"http://docs.docker.jp/compose/rails.html\">&#x30AF;&#x30A4;&#x30C3;&#x30AF;&#x30B9;&#x30BF;&#x30FC;&#x30C8;&#x30FB;&#x30AC;&#x30A4;&#x30C9;&#xFF1A;Docker Compose &#x3068; Rails &mdash; Docker-docs-ja 17.06.Beta &#x30C9;&#x30AD;&#x30E5;&#x30E1;&#x30F3;&#x30C8;</a></p>\n\n<h1>ã‚„ã£ã¦ã¿ãŸâœ¨</h1>\n\n<p>æ—©é€Ÿã§ã™ãŒã“ã¡ã‚‰ãŒå®Œæˆå“ã® GitHub ãƒªãƒã‚¸ãƒˆãƒªã«ãªã‚Šã¾ã™ã€‚\n<iframe src=\"https://hatenablog-parts.com/embed?url=https%3A%2F%2Fgithub.com%2Fryz310%2Frails-on-docker%2Ftree%2Fv1.0.0\" title=\"ryz310/rails-on-docker\" class=\"embed-card embed-webcard\" scrolling=\"no\" frameborder=\"0\" style=\"display: block; width: 100%; height: 155px; max-width: 500px; margin: 10px 0px;\"></iframe><cite class=\"hatena-citation\"><a href=\"https://github.com/ryz310/rails-on-docker/tree/v1.0.0\">github.com</a></cite></p>\n\n<p>ã“ã®è¨˜äº‹ã¯ <code>v1.0.0</code> æ™‚ç‚¹ã§æ›¸ã„ã¦ã„ã¾ã™ãŒã€ãƒªãƒã‚¸ãƒˆãƒªã¯ä»Šå¾Œã‚‚æ›´æ–°ã•ã‚Œã¦ã„ãå¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚</p>\n\n<h2>ç’°å¢ƒ</h2>\n\n<ul>\n<li>Debian Stretch</li>\n<li>Ruby 2.5.0</li>\n<li>Rails 5.2.0.rc1</li>\n<li>MySQL 5.7</li>\n</ul>\n\n\n<h2>ã¤ã‹ã„ã‹ãŸ</h2>\n\n<p>Rails 5.2 ã§ç’°å¢ƒæ§‹ç¯‰ã—ãŸã¨è¨€ã„ã¾ã—ãŸãŒã€ãƒªãƒã‚¸ãƒˆãƒªã«ã¯ Rails ã®ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ãŒä¸€åˆ‡å«ã¾ã‚Œã¦ã„ã¾ã›ã‚“ã€‚\nã“ã‚Œã¯ <code>rails new</code> ã‹ã‚‰ Docker ã§ã‚„ã£ã¦ã„ããŸã‚ã§ã™ã€‚\nä»¥ä¸‹ã«æ‰‹é †ã‚’ç¤ºã—ã¾ã™ã®ã§ã€èˆˆå‘³ã‚ã‚‹æ–¹ã¯ãœã²è¨˜äº‹ã‚’èª­ã¿ãªãŒã‚‰ä¸€ç·’ã«ã‚„ã£ã¦ã¿ã¦ä¸‹ã•ã„ ğŸ™</p>\n\n<h3>0. ãƒªãƒã‚¸ãƒˆãƒªã‚’ãƒ­ãƒ¼ã‚«ãƒ«ã«ã‚¯ãƒ­ãƒ¼ãƒ³ã™ã‚‹</h3>\n\n<pre class=\"code\" data-lang=\"\" data-unlink>$ git clone https://github.com/ryz310/rails-on-docker.git</pre>\n\n\n<h3>1. ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹</h3>\n\n<pre class=\"code\" data-lang=\"\" data-unlink>$ docker-compose run web rails new . --force --database=mysql --skip-bundle --skip-git</pre>\n\n\n<p><code>rails new</code> ã«ã‚ˆã£ã¦å¿…è¦ãªãƒ•ã‚¡ã‚¤ãƒ«ãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¾ã™ã€‚åŒæ™‚ã« Gemfile ã‚‚ Rails ç”¨ã«æ›´æ–°ã•ã‚Œã¾ã™ã€‚\næ®‹å¿µãªãŒã‚‰ã‚¢ãƒ—ãƒªåã¯æŒ‡å®šã§ããªã„ã®ã§ã€å¿…è¦ã«å¿œã˜ã¦å¤‰æ›´ã—ã¦ä¸‹ã•ã„ã€‚</p>\n\n<p>ãªãŠã€å¾Œè¿°ã® MySQL ãƒ‡ãƒ¼ã‚¿ã®æ°¸ç¶šåŒ–ã®ãŸã‚ MySQL ã®ãƒ‡ãƒ¼ã‚¿ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å«ã‚ãªã„ã‚ˆã†ã«ãƒªãƒã‚¸ãƒˆãƒªã®æ–¹ã§ <code>.gitignore</code> ã‚’ç”¨æ„ã—ã¦ã„ã¾ã™ã€‚\nãã®ãŸã‚ <code>--skip-git</code> ã‚’ä»˜ã‘ã¦ Rails ã« <code>.gitignore</code> ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã•ã›ãªã„ã‚ˆã†ã«ã—ã¦ã„ã¾ã™ãŒã€æ°¸ç¶šåŒ–ãŒä¸ç”¨ãªå ´åˆã¯ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’å¤–ã—ã¦ä¸‹ã•ã„ã€‚</p>\n\n<h3>2. æ›´æ–°ã•ã‚ŒãŸ <code>Gemfile</code> ã§ä»¥ä¸‹ã®ã‚³ãƒ¡ãƒ³ãƒˆã‚¢ã‚¦ãƒˆã‚’å¤–ã™</h3>\n\n<pre class=\"code\" data-lang=\"\" data-unlink># gem &#39;mini_racer&#39;, platforms: :ruby</pre>\n\n\n<p>ä»¥å‰ã§ã‚ã‚Œã° <code>therubyracer</code> ã ã£ãŸã®ã§ã™ãŒã€ã„ã¤ã®é–“ã«ã‹ <code>mini_racer</code> ã«å¤‰ã‚ã£ã¦ã„ãŸã®ã§ã™ã­ã€‚</p>\n\n<p><iframe src=\"https://hatenablog-parts.com/embed?url=https%3A%2F%2Ftechracho.bpsinc.jp%2Fhachi8833%2F2017_06_09%2F41039\" title=\"é€±åˆŠRailsã‚¦ã‚©ãƒƒãƒï¼ˆ20170609ï¼‰ã¤ã„ã«therubyracerã‹ã‚‰mini_racerã¸ã€æ³¨æ„ã—ãªã„ã¨ãƒãƒã‚‹gemã€5.1ã§ã®Vue.jsã¨Turbolinksã®å…±å­˜ã»ã‹\" class=\"embed-card embed-webcard\" scrolling=\"no\" frameborder=\"0\" style=\"display: block; width: 100%; height: 155px; max-width: 500px; margin: 10px 0px;\"></iframe><cite class=\"hatena-citation\"><a href=\"https://techracho.bpsinc.jp/hachi8833/2017_06_09/41039\">techracho.bpsinc.jp</a></cite></p>\n\n<p>TechRacho ã•ã‚“ã®é€±åˆŠRailsã‚¦ã‚©ãƒƒãƒã«ã¯ã„ã¤ã‚‚ãŠä¸–è©±ã«ãªã£ã¦ãŠã‚Šã¾ã™ ğŸ™</p>\n\n<h3>3. <code>$ docker-compose build</code> ã‚’å®Ÿè¡Œã™ã‚‹</h3>\n\n<p>Gemfile ã‚’å¤‰æ›´ã—ãŸã®ã§å†èª­ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’ä½œã‚Šç›´ã—ã¾ã™ã€‚</p>\n\n<h3>4. <code>config/database.yml</code> ã‚’ä»¥ä¸‹ã®ã‚ˆã†ã«å¤‰æ›´ã™ã‚‹</h3>\n\n<pre class=\"code\" data-lang=\"\" data-unlink>default: &amp;default\n  adapter: mysql2\n  encoding: utf8\n  pool: &lt;%= ENV.fetch(&#34;RAILS_MAX_THREADS&#34;) { 5 } %&gt;\n  username: root\n  password: xxxxxx # &lt;- ã“ã“ã‚’å¤‰æ›´\n  host: db # &lt;- ã“ã“ã‚’å¤‰æ›´</pre>\n\n\n<p>ã‚ãã¾ã§ãƒ­ãƒ¼ã‚«ãƒ«ã®é–‹ç™ºç’°å¢ƒæ§‹ç¯‰ãªã®ã§ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’éš ã—ãŸã‚Šã¨ã‹ã¯ã—ã¾ã›ã‚“ã€‚æœ¬ç•ªé‹ç”¨ã¨ã‹ã§ã‚„ã£ã¡ã‚ƒãƒ€ãƒ¡ã§ã™ã‚ˆï¼\nMySQL ã® Root ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã¯ <code>docker-compose.yml</code> ã§æŒ‡å®šã—ã¦ã„ã¾ã™ã€‚å¿…è¦ã«å¿œã˜ã¦æ›¸ãæ›ãˆã¦ä¸‹ã•ã„ã€‚</p>\n\n<pre class=\"code\" data-lang=\"\" data-unlink>  db:\n    image: mysql:5.7\n    volumes:\n      - .mysql_data:/var/lib/mysql\n    environment:\n      MYSQL_ROOT_PASSWORD: xxxxxx # &lt;- ã“ã“ï¼</pre>\n\n\n<h3>5. <code>$ docker-compose up</code> ã‚’å®Ÿè¡Œã™ã‚‹</h3>\n\n<p>ã‚³ãƒ³ãƒ†ãƒŠã‚’èµ·å‹•ã•ã›ã¾ã™ã€‚</p>\n\n<h3>6. <code>$ docker-compose exec spring spring rake db:create</code> ã‚’å®Ÿè¡Œã™ã‚‹</h3>\n\n<p>ã‚³ãƒ³ãƒ†ãƒŠã¯èµ·å‹•ã—ã¦ã„ã¾ã™ãŒã€Rails ã§ä½¿ç”¨ã™ã‚‹ DB ãƒ†ãƒ¼ãƒ–ãƒ«ã¯ã¾ã ä½œæˆã•ã‚Œã¦ã„ãªã„ã®ã§ä½œæˆã—ã¾ã™ã€‚\nä½•æ°—ã« <code>spring</code> ã‚’ä½¿ã£ã¦ã„ã‚‹ç‚¹ã«æ³¨ç›®ã§ã™ã€‚</p>\n\n<h3>7. <a href=\"http://localhost:3000/\">http://localhost:3000/</a> ã«ã‚¢ã‚¯ã‚»ã‚¹ã—ã¦ Rails ãŒå‹•ã„ã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèª</h3>\n\n<p>ã“ã“ã¾ã§ã®æ“ä½œã§ Rails ãŒæ­£ã—ãå‹•ä½œã—ã¦ã„ã‚‹ã¯ãšã§ã™ã€‚</p>\n\n<p><span itemscope itemtype=\"http://schema.org/Photograph\"><img src=\"https://cdn-ak.f.st-hatena.com/images/fotolife/r/ryz310/20180211/20180211110115.png\" alt=\"f:id:ryz310:20180211110115p:plain\" title=\"f:id:ryz310:20180211110115p:plain\" class=\"hatena-fotolife\" itemprop=\"image\"></span><figcaption>Yay! Youâ€™re on Rails!</figcaption></figure></p>\n\n<h1>ãƒã‚¤ãƒ³ãƒˆ</h1>\n\n<h2><code>bundle install</code> ãŒæ¯å›èµ°ã‚‰ãªã„ã‚ˆã†ã«å·¥å¤«ã—ã¦ã„ã‚‹</h2>\n\n<p>Dockerfile ã§ WORKDIR ã« <code>/tmp</code> ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’æŒ‡å®šã—ã¦ã„ã‚‹ã¨ã“ã‚ãŒãƒã‚¤ãƒ³ãƒˆã§ã™ã€‚\nã“ã‚Œã‚’ã›ãšã« <code>WORKDIR /myapp</code> ã‹ã‚‰ã® <code>ADD . /myapp</code> ã‚’ã‚„ã£ã¦ã—ã¾ã†ã¨ã€ Rails ã®ã‚³ãƒ¼ãƒ‰ã«å¤‰æ›´ãŒã‚ã‚‹åº¦ã« <code>bundle install</code> ãŒæœ€åˆã‹ã‚‰å®Ÿè¡Œã•ã‚Œã¦ã—ã¾ã„ã¾ã™ã€‚\nGemfile ã¨ Gemfile.lock ã‚’ <code>/tmp</code> ã«æ ¼ç´ã™ã‚‹ã“ã¨ã§ã€ã“ã‚Œã‚‰ã®ãƒ•ã‚¡ã‚¤ãƒ«ã«å¤‰æ›´ãŒãªã„é™ã‚Š <code>bundle install</code> ãŒå®Ÿè¡Œã•ã‚Œãªã„ã‚ˆã†ã«ãªã£ã¦ã„ã¾ã™ã€‚</p>\n\n<pre class=\"code\" data-lang=\"\" data-unlink>WORKDIR /tmp\nADD Gemfile Gemfile\nADD Gemfile.lock Gemfile.lock\nRUN bundle install\nWORKDIR /myapp\nADD . /myapp</pre>\n\n\n<p>å‚è€ƒ: <a href=\"https://easyramble.com/rails-development-on-docker.html#crayon-5a7fa9761d5ba051809395\">Docker&#x3067;Rails + MySQL&#x306E;&#x958B;&#x767A;&#x74B0;&#x5883;&#x3092;&#x69CB;&#x7BC9; | EasyRamble</a></p>\n\n<h2><code>spring</code> ã«å¯¾å¿œ</h2>\n\n<p>Rails ã§é–‹ç™ºã™ã‚‹ä¸Šã§æ¬ ã‹ã›ãªã„ <code>spring</code> ã‚‚åˆ©ç”¨ã§ãã‚‹ã‚ˆã†ã«ã—ã¦ã‚ã‚Šã¾ã™ã€‚\nå‰è¿°ã® <code>rake db:create</code> ã®æ™‚ã«ã‚‚å‡ºã¦ãã¾ã—ãŸãŒã€<code>$ docker-compose exec spring spring rails console</code> ã®ã‚ˆã†ã«ã—ã¦ä½¿ã„ã¾ã™ã€‚\n<code>spring</code> ãŒ 2 å›å‡ºã¦ãã‚‹ã¨ã“ã‚ãŒãƒã‚¤ãƒ³ãƒˆã§ã™ã€‚ä¸€ã¤ç›®ã¯ã‚³ãƒ³ãƒ†ãƒŠã®ã‚µãƒ¼ãƒ“ã‚¹åã§ã™ã€‚</p>\n\n<p>æ¯å›æ›¸ãã®ã¯ã ã‚‹ã„ã®ã§åƒ•ã¯ alias ã«ã—ã¦ã„ã¾ã™ã€‚fish shell ç”¨ãªã®ã§è‰¯ã„ã‚ˆã†ã«èª­ã¿æ›¿ãˆã¦ä¸‹ã•ã„ ğŸ™</p>\n\n<pre class=\"code\" data-lang=\"\" data-unlink># ~/.config/fish/config.fish\n\n# docker-compose aliases\nfunction fig\n  docker-compose $argv\nend\n\nfunction figspring\n  docker-compose exec spring spring $argv\nend</pre>\n\n\n\n\n<pre class=\"code\" data-lang=\"\" data-unlink># USAGE\n$ figspring rails c</pre>\n\n\n<p>å‚è€ƒ: <a href=\"https://qiita.com/kawasin73/items/2253523be18e5afd994f\">&#x9AD8;&#x901F;&#x306B;&#x958B;&#x767A;&#x3067;&#x304D;&#x308B; Docker + Rails&#x958B;&#x767A;&#x74B0;&#x5883;&#x306E;&#x30C6;&#x30F3;&#x30D7;&#x30EC;&#x30FC;&#x30C8;&#x3092;&#x4F5C;&#x3063;&#x305F; - Qiita</a></p>\n\n<h2>MySQL ãƒ‡ãƒ¼ã‚¿ã®æ°¸ç¶šåŒ–</h2>\n\n<p>ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’ä½œã‚Šç›´ã—ãŸæ™‚ã« MySQL ã®ãƒ‡ãƒ¼ã‚¿ãŒå¤±ã‚ã‚Œã¦ã—ã¾ã†ã®ã¯è¾›ã„ã‚‚ã®ãŒã‚ã‚Šã¾ã™ã€‚\næ¯å›ãƒ†ã‚¹ãƒˆç”¨ã®ãƒ‡ãƒ¼ã‚¿ã‚’ä¸€ã‹ã‚‰ä½œã‚Šç›´ã—ãŸããªã„ã®ã§ã€ <code>docker-compose.yml</code> ã§ä»¥ä¸‹ã®ã‚ˆã†ã«æŒ‡å®šã—ã¦MySQL ã®ãƒ‡ãƒ¼ã‚¿ã‚’æ°¸ç¶šåŒ–ã•ã›ã¦ã„ã¾ã™ã€‚</p>\n\n<pre class=\"code\" data-lang=\"\" data-unlink>  db:\n    image: mysql:5.7\n    volumes:\n      - .mysql_data:/var/lib/mysql # &lt;- ã“ã‚Œï¼\n    environment:\n      MYSQL_ROOT_PASSWORD: xxxxxx</pre>\n\n\n<p><code>.mysql_data</code> ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªä»¥ä¸‹ã« MySQL ã®ãƒ‡ãƒ¼ã‚¿ãŒæ ¼ç´ã•ã‚Œã¦ã„ã¾ã™ã€‚ãƒªãƒã‚¸ãƒˆãƒªã® <code>.gitignore</code> ã§ç„¡è¦–ã•ã›ã¦ã„ã¾ã™ã€‚\nè©¦ã—ã¦ã„ã¾ã›ã‚“ãŒã€å‚è€ƒã«ã•ã›ã¦é ‚ã„ãŸè¨˜äº‹ã«ã‚ˆã‚‹ã¨ Docker for Mac ä»¥å¤–ã®ç’°å¢ƒã§ã¯å•é¡ŒãŒç™ºç”Ÿã™ã‚‹ã‚ˆã†ã§ã™ã®ã§ã”æ³¨æ„ä¸‹ã•ã„ã€‚\nå¯¾å¿œæ–¹æ³•ã‚‚è¨˜äº‹å†…ã§ç´¹ä»‹ã•ã‚Œã¦ã„ã¾ã™ ğŸ™</p>\n\n<p>å‚è€ƒ: <a href=\"https://blog.leko.jp/post/how-to-mount-data-volume-to-local-with-docker-compose/\">docker compose&#x3067;MySQL&#x306E;&#x30C7;&#x30FC;&#x30BF;&#x9818;&#x57DF;&#x3092;&#x30ED;&#x30FC;&#x30AB;&#x30EB;&#x306B;&#x30DE;&#x30A6;&#x30F3;&#x30C8;&#x3059;&#x308B; | WEB EGG</a></p>\n\n<h1>ã¾ã¨ã‚</h1>\n\n<p>é€±æœ«ã«ä½•ã‹ã‚¢ãƒ—ãƒªã§ã‚‚æ›¸ã“ã†ã‹ã¨æ€ã£ãŸæ™‚ã«ã€ã¤ã„ã§ã« Docker ã§ç’°å¢ƒæ§‹ç¯‰ã‚‚ã‚„ã£ã¡ã‚ƒã†ã‹ã€ã¨æ€ã„ç«‹ã£ã¦æ›¸ãã¾ã—ãŸã€‚\nãã†ã“ã†ã—ã¦ã‚‹ã†ã¡ã«é€±æœ«ã®åŠåˆ†ãã‚‰ã„ãŒéãå»ã£ã¦ã„ã¾ã™ãŒã€ãã£ã¨ä»Šå¾Œã¯æ—ã‚‹ã¯ãšã€‚ã€‚ ğŸ˜‡\nä½•åº¦ã‚‚ç¢ºèªã—ã¦ã„ã¾ã™ãŒã€ã‚‚ã—é–“é•ã£ã¦ã„ã‚‹ç‚¹ã€ä¸ä¾¿ãªç‚¹ãªã©ã‚ã‚Šã¾ã—ãŸã‚‰ãã£ã¨æ•™ãˆã¦é ‚ã‘ã¾ã™ã¨å¹¸ã„ã§ã™ ğŸ™\nFork ã‚‚å¤§æ­“è¿ã§ã™ã—ã€èª°ã‹ã«ä½¿ã£ã¦ã‚‚ã‚‰ãˆã‚‹ã¨å¬‰ã—ã„ã§ã™ ğŸ˜</p>\n","contentSnippet":"ã©ã†ã‚‚ã€ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ã®ã‚µãƒˆã‚¦ãƒªãƒ§ã‚¦ã‚¹ã‚±ã§ã™ âœŒï¸('Ï‰')âœŒï¸åƒ•ãŒæ‰€å±ã—ã¦ã„ã‚‹ ã‚½ãƒ¼ã‚·ãƒ£ãƒ«PLUS ãƒãƒ¼ãƒ ã§ã¯ Rails ã®é–‹ç™ºç’°å¢ƒã‚’ Docker ã§æ§‹ç¯‰ã—ã¦ã„ã¾ã™ã€‚è‡ªåˆ†ã‚‚æ—¥ã€…ãŠä¸–è©±ã«ãªã£ã¦ã„ã‚‹ Docker ã§ã™ãŒã€ã‚¤ãƒã‹ã‚‰ Dockerfile æ›¸ã„ãŸäº‹ãŒç„¡ã‹ã£ãŸã®ã§ã€ã‚„ã£ã¦ã¿ã¾ã—ãŸã€‚ã“ã¡ã‚‰ã®ãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«ã‚’å‚è€ƒã«ã—ã¦ã„ã¾ã™ã€‚ã‚¯ã‚¤ãƒƒã‚¯ã‚¹ã‚¿ãƒ¼ãƒˆãƒ»ã‚¬ã‚¤ãƒ‰ï¼šDocker Compose ã¨ Rails â€” Docker-docs-ja 17.06.Beta ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚„ã£ã¦ã¿ãŸâœ¨æ—©é€Ÿã§ã™ãŒã“ã¡ã‚‰ãŒå®Œæˆå“ã® GitHub ãƒªãƒã‚¸ãƒˆãƒªã«ãªã‚Šã¾ã™ã€‚github.comã“ã®è¨˜äº‹ã¯ v1.0.0 æ™‚ç‚¹ã§æ›¸ã„ã¦ã„ã¾ã™ãŒã€ãƒªãƒã‚¸ãƒˆãƒªã¯ä»Šå¾Œã‚‚æ›´æ–°ã•ã‚Œã¦ã„ãå¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚ç’°å¢ƒDebian StretchRuby 2.5.0Rails 5.2.0.rc1MySQL 5.7ã¤ã‹ã„ã‹ãŸRails 5.2 ã§ç’°å¢ƒæ§‹ç¯‰ã—ãŸã¨è¨€ã„ã¾ã—ãŸãŒã€ãƒªãƒã‚¸ãƒˆãƒªã«ã¯ Rails ã®ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ãŒä¸€åˆ‡å«ã¾ã‚Œã¦ã„ã¾ã›ã‚“ã€‚ã“ã‚Œã¯ rails new ã‹ã‚‰ Docker ã§ã‚„ã£ã¦ã„ããŸã‚ã§ã™ã€‚ä»¥ä¸‹ã«æ‰‹é †ã‚’ç¤ºã—ã¾ã™ã®ã§ã€èˆˆå‘³ã‚ã‚‹æ–¹ã¯ãœã²è¨˜äº‹ã‚’èª­ã¿ãªãŒã‚‰ä¸€ç·’ã«ã‚„ã£ã¦ã¿ã¦ä¸‹ã•ã„ ğŸ™0. ãƒªãƒã‚¸ãƒˆãƒªã‚’ãƒ­ãƒ¼ã‚«ãƒ«ã«ã‚¯ãƒ­ãƒ¼ãƒ³ã™ã‚‹$ git clone https://github.com/ryz310/rails-on-docker.git1. ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹$ docker-compose run web rails new . --force --database=mysql --skip-bundle --skip-gitrails new ã«ã‚ˆã£ã¦å¿…è¦ãªãƒ•ã‚¡ã‚¤ãƒ«ãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¾ã™ã€‚åŒæ™‚ã« Gemfile ã‚‚ Rails ç”¨ã«æ›´æ–°ã•ã‚Œã¾ã™ã€‚æ®‹å¿µãªãŒã‚‰ã‚¢ãƒ—ãƒªåã¯æŒ‡å®šã§ããªã„ã®ã§ã€å¿…è¦ã«å¿œã˜ã¦å¤‰æ›´ã—ã¦ä¸‹ã•ã„ã€‚ãªãŠã€å¾Œè¿°ã® MySQL ãƒ‡ãƒ¼ã‚¿ã®æ°¸ç¶šåŒ–ã®ãŸã‚ MySQL ã®ãƒ‡ãƒ¼ã‚¿ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å«ã‚ãªã„ã‚ˆã†ã«ãƒªãƒã‚¸ãƒˆãƒªã®æ–¹ã§ .gitignore ã‚’ç”¨æ„ã—ã¦ã„ã¾ã™ã€‚ãã®ãŸã‚ --skip-git ã‚’ä»˜ã‘ã¦ Rails ã« .gitignore ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã•ã›ãªã„ã‚ˆã†ã«ã—ã¦ã„ã¾ã™ãŒã€æ°¸ç¶šåŒ–ãŒä¸ç”¨ãªå ´åˆã¯ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’å¤–ã—ã¦ä¸‹ã•ã„ã€‚2. æ›´æ–°ã•ã‚ŒãŸ Gemfile ã§ä»¥ä¸‹ã®ã‚³ãƒ¡ãƒ³ãƒˆã‚¢ã‚¦ãƒˆã‚’å¤–ã™# gem 'mini_racer', platforms: :rubyä»¥å‰ã§ã‚ã‚Œã° therubyracer ã ã£ãŸã®ã§ã™ãŒã€ã„ã¤ã®é–“ã«ã‹ mini_racer ã«å¤‰ã‚ã£ã¦ã„ãŸã®ã§ã™ã­ã€‚techracho.bpsinc.jpTechRacho ã•ã‚“ã®é€±åˆŠRailsã‚¦ã‚©ãƒƒãƒã«ã¯ã„ã¤ã‚‚ãŠä¸–è©±ã«ãªã£ã¦ãŠã‚Šã¾ã™ ğŸ™3. $ docker-compose build ã‚’å®Ÿè¡Œã™ã‚‹Gemfile ã‚’å¤‰æ›´ã—ãŸã®ã§å†èª­ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’ä½œã‚Šç›´ã—ã¾ã™ã€‚4. config/database.yml ã‚’ä»¥ä¸‹ã®ã‚ˆã†ã«å¤‰æ›´ã™ã‚‹default: &default  adapter: mysql2  encoding: utf8  pool: <%= ENV.fetch(\"RAILS_MAX_THREADS\") { 5 } %>  username: root  password: xxxxxx # <- ã“ã“ã‚’å¤‰æ›´  host: db # <- ã“ã“ã‚’å¤‰æ›´ã‚ãã¾ã§ãƒ­ãƒ¼ã‚«ãƒ«ã®é–‹ç™ºç’°å¢ƒæ§‹ç¯‰ãªã®ã§ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’éš ã—ãŸã‚Šã¨ã‹ã¯ã—ã¾ã›ã‚“ã€‚æœ¬ç•ªé‹ç”¨ã¨ã‹ã§ã‚„ã£ã¡ã‚ƒãƒ€ãƒ¡ã§ã™ã‚ˆï¼MySQL ã® Root ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã¯ docker-compose.yml ã§æŒ‡å®šã—ã¦ã„ã¾ã™ã€‚å¿…è¦ã«å¿œã˜ã¦æ›¸ãæ›ãˆã¦ä¸‹ã•ã„ã€‚  db:    image: mysql:5.7    volumes:      - .mysql_data:/var/lib/mysql    environment:      MYSQL_ROOT_PASSWORD: xxxxxx # <- ã“ã“ï¼5. $ docker-compose up ã‚’å®Ÿè¡Œã™ã‚‹ã‚³ãƒ³ãƒ†ãƒŠã‚’èµ·å‹•ã•ã›ã¾ã™ã€‚6. $ docker-compose exec spring spring rake db:create ã‚’å®Ÿè¡Œã™ã‚‹ã‚³ãƒ³ãƒ†ãƒŠã¯èµ·å‹•ã—ã¦ã„ã¾ã™ãŒã€Rails ã§ä½¿ç”¨ã™ã‚‹ DB ãƒ†ãƒ¼ãƒ–ãƒ«ã¯ã¾ã ä½œæˆã•ã‚Œã¦ã„ãªã„ã®ã§ä½œæˆã—ã¾ã™ã€‚ä½•æ°—ã« spring ã‚’ä½¿ã£ã¦ã„ã‚‹ç‚¹ã«æ³¨ç›®ã§ã™ã€‚7. http://localhost:3000/ ã«ã‚¢ã‚¯ã‚»ã‚¹ã—ã¦ Rails ãŒå‹•ã„ã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèªã“ã“ã¾ã§ã®æ“ä½œã§ Rails ãŒæ­£ã—ãå‹•ä½œã—ã¦ã„ã‚‹ã¯ãšã§ã™ã€‚Yay! Youâ€™re on Rails!ãƒã‚¤ãƒ³ãƒˆbundle install ãŒæ¯å›èµ°ã‚‰ãªã„ã‚ˆã†ã«å·¥å¤«ã—ã¦ã„ã‚‹Dockerfile ã§ WORKDIR ã« /tmp ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’æŒ‡å®šã—ã¦ã„ã‚‹ã¨ã“ã‚ãŒãƒã‚¤ãƒ³ãƒˆã§ã™ã€‚ã“ã‚Œã‚’ã›ãšã« WORKDIR /myapp ã‹ã‚‰ã® ADD . /myapp ã‚’ã‚„ã£ã¦ã—ã¾ã†ã¨ã€ Rails ã®ã‚³ãƒ¼ãƒ‰ã«å¤‰æ›´ãŒã‚ã‚‹åº¦ã« bundle install ãŒæœ€åˆã‹ã‚‰å®Ÿè¡Œã•ã‚Œã¦ã—ã¾ã„ã¾ã™ã€‚Gemfile ã¨ Gemfile.lock ã‚’ /tmp ã«æ ¼ç´ã™ã‚‹ã“ã¨ã§ã€ã“ã‚Œã‚‰ã®ãƒ•ã‚¡ã‚¤ãƒ«ã«å¤‰æ›´ãŒãªã„é™ã‚Š bundle install ãŒå®Ÿè¡Œã•ã‚Œãªã„ã‚ˆã†ã«ãªã£ã¦ã„ã¾ã™ã€‚WORKDIR /tmpADD Gemfile GemfileADD Gemfile.lock Gemfile.lockRUN bundle installWORKDIR /myappADD . /myappå‚è€ƒ: Dockerã§Rails + MySQLã®é–‹ç™ºç’°å¢ƒã‚’æ§‹ç¯‰ | EasyRamblespring ã«å¯¾å¿œRails ã§é–‹ç™ºã™ã‚‹ä¸Šã§æ¬ ã‹ã›ãªã„ spring ã‚‚åˆ©ç”¨ã§ãã‚‹ã‚ˆã†ã«ã—ã¦ã‚ã‚Šã¾ã™ã€‚å‰è¿°ã® rake db:create ã®æ™‚ã«ã‚‚å‡ºã¦ãã¾ã—ãŸãŒã€$ docker-compose exec spring spring rails console ã®ã‚ˆã†ã«ã—ã¦ä½¿ã„ã¾ã™ã€‚spring ãŒ 2 å›å‡ºã¦ãã‚‹ã¨ã“ã‚ãŒãƒã‚¤ãƒ³ãƒˆã§ã™ã€‚ä¸€ã¤ç›®ã¯ã‚³ãƒ³ãƒ†ãƒŠã®ã‚µãƒ¼ãƒ“ã‚¹åã§ã™ã€‚æ¯å›æ›¸ãã®ã¯ã ã‚‹ã„ã®ã§åƒ•ã¯ alias ã«ã—ã¦ã„ã¾ã™ã€‚fish shell ç”¨ãªã®ã§è‰¯ã„ã‚ˆã†ã«èª­ã¿æ›¿ãˆã¦ä¸‹ã•ã„ ğŸ™# ~/.config/fish/config.fish# docker-compose aliasesfunction fig  docker-compose $argvendfunction figspring  docker-compose exec spring spring $argvend# USAGE$ figspring rails cå‚è€ƒ: é«˜é€Ÿã«é–‹ç™ºã§ãã‚‹ Docker + Railsé–‹ç™ºç’°å¢ƒã®ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’ä½œã£ãŸ - QiitaMySQL ãƒ‡ãƒ¼ã‚¿ã®æ°¸ç¶šåŒ–ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’ä½œã‚Šç›´ã—ãŸæ™‚ã« MySQL ã®ãƒ‡ãƒ¼ã‚¿ãŒå¤±ã‚ã‚Œã¦ã—ã¾ã†ã®ã¯è¾›ã„ã‚‚ã®ãŒã‚ã‚Šã¾ã™ã€‚æ¯å›ãƒ†ã‚¹ãƒˆç”¨ã®ãƒ‡ãƒ¼ã‚¿ã‚’ä¸€ã‹ã‚‰ä½œã‚Šç›´ã—ãŸããªã„ã®ã§ã€ docker-compose.yml ã§ä»¥ä¸‹ã®ã‚ˆã†ã«æŒ‡å®šã—ã¦MySQL ã®ãƒ‡ãƒ¼ã‚¿ã‚’æ°¸ç¶šåŒ–ã•ã›ã¦ã„ã¾ã™ã€‚  db:    image: mysql:5.7    volumes:      - .mysql_data:/var/lib/mysql # <- ã“ã‚Œï¼    environment:      MYSQL_ROOT_PASSWORD: xxxxxx.mysql_data ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªä»¥ä¸‹ã« MySQL ã®ãƒ‡ãƒ¼ã‚¿ãŒæ ¼ç´ã•ã‚Œã¦ã„ã¾ã™ã€‚ãƒªãƒã‚¸ãƒˆãƒªã® .gitignore ã§ç„¡è¦–ã•ã›ã¦ã„ã¾ã™ã€‚è©¦ã—ã¦ã„ã¾ã›ã‚“ãŒã€å‚è€ƒã«ã•ã›ã¦é ‚ã„ãŸè¨˜äº‹ã«ã‚ˆã‚‹ã¨ Docker for Mac ä»¥å¤–ã®ç’°å¢ƒã§ã¯å•é¡ŒãŒç™ºç”Ÿã™ã‚‹ã‚ˆã†ã§ã™ã®ã§ã”æ³¨æ„ä¸‹ã•ã„ã€‚å¯¾å¿œæ–¹æ³•ã‚‚è¨˜äº‹å†…ã§ç´¹ä»‹ã•ã‚Œã¦ã„ã¾ã™ ğŸ™å‚è€ƒ: docker composeã§MySQLã®ãƒ‡ãƒ¼ã‚¿é ˜åŸŸã‚’ãƒ­ãƒ¼ã‚«ãƒ«ã«ãƒã‚¦ãƒ³ãƒˆã™ã‚‹ | WEB EGGã¾ã¨ã‚é€±æœ«ã«ä½•ã‹ã‚¢ãƒ—ãƒªã§ã‚‚æ›¸ã“ã†ã‹ã¨æ€ã£ãŸæ™‚ã«ã€ã¤ã„ã§ã« Docker ã§ç’°å¢ƒæ§‹ç¯‰ã‚‚ã‚„ã£ã¡ã‚ƒã†ã‹ã€ã¨æ€ã„ç«‹ã£ã¦æ›¸ãã¾ã—ãŸã€‚ãã†ã“ã†ã—ã¦ã‚‹ã†ã¡ã«é€±æœ«ã®åŠåˆ†ãã‚‰ã„ãŒéãå»ã£ã¦ã„ã¾ã™ãŒã€ãã£ã¨ä»Šå¾Œã¯æ—ã‚‹ã¯ãšã€‚ã€‚ ğŸ˜‡ä½•åº¦ã‚‚ç¢ºèªã—ã¦ã„ã¾ã™ãŒã€ã‚‚ã—é–“é•ã£ã¦ã„ã‚‹ç‚¹ã€ä¸ä¾¿ãªç‚¹ãªã©ã‚ã‚Šã¾ã—ãŸã‚‰ãã£ã¨æ•™ãˆã¦é ‚ã‘ã¾ã™ã¨å¹¸ã„ã§ã™ ğŸ™Fork ã‚‚å¤§æ­“è¿ã§ã™ã—ã€èª°ã‹ã«ä½¿ã£ã¦ã‚‚ã‚‰ãˆã‚‹ã¨å¬‰ã—ã„ã§ã™ ğŸ˜","link":"https://developer.feedforce.jp/entry/2018/02/11/140012","isoDate":"2018-02-11T05:00:12.000Z","dateMiliSeconds":1518325212000,"imageUrl":"https://cdn-ak.f.st-hatena.com/images/fotolife/r/ryz310/20180211/20180211110115.png","authorName":"ryz310"},{"title":"mackerel ã®ã‚«ã‚¹ã‚¿ãƒ ãƒ¡ãƒˆãƒªãƒƒã‚¯ã‚’ echo ã§ãƒ¯ãƒ³ãƒ©ã‚¤ãƒŠãƒ¼ã—ãŸã£ãŸ","content":"<p>ã©ã†ã‚‚ã€ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ã®ã‚µãƒˆã‚¦ãƒªãƒ§ã‚¦ã‚¹ã‚±ã§ã™ âœŒï¸('Ï‰')âœŒï¸</p>\n\n<p>çªç„¶ã§ã™ãŒãƒ¯ãƒ†ã‚¯ã‚·ã€ Rails ã‚¢ãƒ—ãƒªã¯ãã“ãã“æ›¸ã‘ã‚‹æ–¹ãªã‚“ã§ã™ãŒã€ã‚¤ãƒ³ãƒ•ãƒ©ã¯ã‹ã‚‰ãã—ã ã£ãŸã‚Šã—ã¾ã™ã€‚ <a href=\"https://dic.pixiv.net/a/%E3%82%AD%E3%83%A2%E3%83%BC%E3%82%A4%E3%82%AC%E3%83%BC%E3%83%AB%E3%82%BA\">ãƒ•ãƒ«ã‚¹ã‚¿ãƒƒã‚¯ã˜ã‚ƒãªã„ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ãŒè¨±ã•ã‚Œã‚‹ã®ã¯å°å­¦ç”Ÿã¾ã§ã ã‚ˆã­ãƒ¼</a>ã€ã¨ã„ã†ã¡ã‚‡ã£ã¨æ‡ã‹ã—ã¿ã®ã‚ã‚‹ç…½ã‚ŠãŒç¤¾å†…ã®ã‹ã‚‰ã‚‚èã“ãˆã¦ããã†ãªã®ã§ã€æœ€è¿‘ã‚¤ãƒ³ãƒ•ãƒ©ã‚’å°‘ã—ãšã¤è§¦ã‚‹ã‚ˆã†ã«ã—ã¦ã„ã¾ã™ã€‚è§¦ã£ã¦ã¿ã‚‹ã¨ã‚¤ãƒ³ãƒ•ãƒ©ã‚‚è‰²ã€…æ¥½ã—ã„ã§ã™ã­ âœŒï¸('Ï‰')âœŒï¸</p>\n\n<p>ã¨ã¯ã„ãˆã€ã‚¤ãƒ³ãƒ•ãƒ©ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ãƒ¬ãƒ™ãƒ« 1 ã®è‡ªåˆ†ãŒã‚ã‚Œã“ã‚Œã‚„ã£ã¦ã‚‚éšœå®³ã«ç¹‹ãŒã‚‹ã ã‘ãªã®ã§ã€ã¾ãšã¯ãŠæ‰‹è»½ãªé›‘ç”¨ã‚¿ã‚¹ã‚¯ã‹ã‚‰å§‹ã‚ã‚‹ã“ã¨ã«ã—ã¾ã—ãŸã€‚</p>\n\n<p>ã•ã¦ã€å°‘ã—è©±ã¯å¤‰ã‚ã£ã¦ã€æœ€è¿‘ã€å¼Šç¤¾ã‚µãƒ¼ãƒ“ã‚¹ã§ Sidekiq ãƒ—ãƒ­ã‚»ã‚¹ã®ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‡ã‚£ã‚¹ã‚¯ãƒªãƒ—ã‚¿ãŒæ€¥é¨°ã—ã¦ã‚µãƒ¼ãƒãƒ¼ãŒãƒ€ã‚¦ãƒ³ã™ã‚‹ã€ã¨ã„ã†éšœå®³ãŒä½•åº¦ã‹ç™ºç”Ÿã—ã¾ã—ãŸã€‚\nç¾è±¡ã¨ã—ã¦ã¯ Sidekiq ãƒ—ãƒ­ã‚»ã‚¹ã®ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‡ã‚£ã‚¹ã‚¯ãƒªãƒ—ã‚¿ãŒä¸Šé™å€¤ (åˆæœŸå€¤ã¯ <code>1024</code> ) ã«é”ã™ã‚‹ã¨ã€ã‚µãƒ¼ãƒãƒ¼ã® CPU ä½¿ç”¨ç‡ãŒ 100 % ä»˜è¿‘ã¾ã§é”ã—ã¦ã—ã¾ã†ã€ã¨ã„ã†ã‚‚ã®ã ã£ãŸã®ã§ã€ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‡ã‚£ã‚¹ã‚¯ãƒªãƒ—ã‚¿ã®ä¸Šé™ã‚’ <code>65536</code> ã¾ã§ä¸Šã’ã‚‹ã€ã¨ã„ã†ãƒ¯ãƒ¼ã‚¯ã‚¢ãƒ©ã‚¦ãƒ³ãƒ‰ãªå¯¾å¿œã§å‡Œã„ã§ã„ã¾ã—ãŸã€‚</p>\n\n<p>ç¾åœ¨ã¯è§£æ±ºæ¸ˆã¿ï¼ˆã“ã®åŸå› ã«ã¤ã„ã¦ã¯ã€åˆ¥é€”è¨˜äº‹ã«ã—ã¾ã™ï¼‰ã§ã™ãŒã€å½“æ™‚ã¯ãªãœãƒ•ã‚¡ã‚¤ãƒ«ãƒ‡ã‚£ã‚¹ã‚¯ãƒªãƒ—ã‚¿ã®æ•°ãŒä¸Šæ˜‡ã—ç¶šã‘ã¦ã—ã¾ã†ã®ã‹åŸå› ãŒå…¨ãã‚ã‹ã‚‰ãšã€ãƒãƒ¼ãƒ ã®ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ã¯å®‰çœ ã§ããªã„æ—¥ã€…ãŒç¶šã„ã¦ã„ã¾ã—ãŸã€‚ã¨ã‚Šã‚ãˆãš Sidekiq ã®ãƒ—ãƒ­ã‚»ã‚¹ã‚’ãƒªã‚¹ã‚¿ãƒ¼ãƒˆã™ã‚Œã°ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‡ã‚£ã‚¹ã‚¯ãƒªãƒ—ã‚¿ã®æ•°ã¯ä¸€æ—¦ãƒªã‚»ãƒƒãƒˆã•ã‚Œã‚‹ã®ã§ã€ç›£è¦–ã—ã¦ã‚„ã°ããªã£ãŸã‚‰ã‚¢ãƒ©ãƒ¼ãƒˆã‚’é£›ã°ã—ã¦å†èµ·å‹•ã•ã›ã‚‹ã€ã¨ã„ã†æ–¹æ³•ã§ä¸€æ—¦ã¯å‡Œã¾ã™ã€‚ã¾ãŸã€ç¶™ç¶šã—ã¦ç›£è¦–ã™ã‚‹ã“ã¨ã§ã€åŸå› ã®è§£æ˜ã«ã‚‚ç¹‹ãŒã‚‹ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚</p>\n\n<p>å¼Šç¤¾ã®ã‚µãƒ¼ãƒ“ã‚¹ã§ã¯ç›£è¦–ã« <a href=\"https://mackerel.io/\">mackerel</a> ã‚’åˆ©ç”¨ã—ã¦ã„ã‚‹ã®ã§ã€ã‚«ã‚¹ã‚¿ãƒ ãƒ¡ãƒˆãƒªãƒƒã‚¯ã‚’ä½¿ã£ã¦ãŠæ‰‹è»½ã«ç›£è¦–ã•ã›ã‚ˆã†ã€ã¨ã„ã†ã“ã¨ã«ãªã‚Šã¾ã—ãŸã€‚\nmackerel ã®ã‚«ã‚¹ã‚¿ãƒ ãƒ¡ãƒˆãƒªãƒƒã‚¯ã®æŠ•ç¨¿æ–¹æ³•ã¯ <a href=\"https://mackerel.io/ja/docs/entry/advanced/custom-metrics\">ã“ã¡ã‚‰ã®è¨˜äº‹</a> ã«ã¾ã¨ã¾ã£ã¦ã„ã¾ã™ã€‚\nè¦ç‚¹ã ã‘æŠœç²‹ã—ã¾ã™ã¨ã€ <a href=\"https://mackerel.io/ja/docs/entry/spec/agent#config-file\">mackerel-agent ã®è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«</a> ã« <strong>ä»¥ä¸‹ã®æ›¸å¼ã§æ¨™æº–å‡ºåŠ›ã‚’å®Ÿè¡Œã™ã‚‹ã‚³ãƒãƒ³ãƒ‰ã‚’è¨˜è¿°</strong> ã™ã‚Œã° OK ã§ã™ã€‚</p>\n\n<blockquote><p>è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã§æŒ‡å®šã™ã‚‹ã‚³ãƒãƒ³ãƒ‰ã¯ã€æ¨™æº–å‡ºåŠ›ã®å„è¡Œã«ä»¥ä¸‹ã®ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã®å‡ºåŠ›ã‚’ã™ã‚‹ã“ã¨ãŒæœŸå¾…ã•ã‚Œã¾ã™ï¼ˆ<code>\\t</code> ã¯ã‚¿ãƒ–æ–‡å­—ã§ã™ï¼‰:</p></blockquote>\n\n<pre class=\"code\" data-lang=\"\" data-unlink>{metric name}\\t{metric value}\\t{epoch seconds}</pre>\n\n\n<p>ãã—ã¦ä»¥ä¸‹ãŒãƒ•ã‚¡ã‚¤ãƒ«ãƒ‡ã‚£ã‚¹ã‚¯ãƒªãƒ—ã‚¿ã‚’ç›£è¦–ã™ã‚‹ãŸã‚ã®è¨­å®šã§ã™ï¼ˆå®Œæˆå“ãŒãƒ¬ãƒ³ã‚¸ã‹ã‚‰å‡ºã¦ãã‚‹ãƒ‘ãƒ†ã‚£ãƒ¼ãƒ³ï¼‰</p>\n\n<pre class=\"code\" data-lang=\"\" data-unlink>[plugin.metrics.file_descriptor_count]\ncommand = &#39;&#39;&#39;\n  echo -e &#34;file_descriptor.sidekiq\\\\t$(sudo ls /proc/$(pgrep -f -u {user_name} sidekiq | head -1)/fd/ | wc -l)\\\\t$(date -u +%s)&#34;\n&#39;&#39;&#39;</pre>\n\n\n<p>æ¨™æº–å‡ºåŠ›ã•ã‚Œã‚Œã° OK ãªã®ã§ã€ <code>echo</code> ã§ä»»æ„ã®æ–‡å­—åˆ—ã‚’å‡ºåŠ›ã™ã‚‹ã‚ˆã†ãªæ–¹æ³•ã§ã‚‚å®Ÿç¾å¯èƒ½ã§ã™ã€‚å†…éƒ¨ã§ <code>pgrep -f -u {user_name} sidekiq</code> ã¨æ›¸ã„ã¦ã€ãƒ—ãƒ­ã‚»ã‚¹ ID ã‚’å–å¾—ã—ã¦ã„ã¾ã™ãŒã€ <code>-u</code> ã§ãƒ—ãƒ­ã‚»ã‚¹ã‚’å®Ÿè¡Œã—ã¦ã„ã‚‹ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’æŒ‡å®šã—ãªã„ã¨ã€ <code>pgrep</code> ã®ãƒ—ãƒ­ã‚»ã‚¹ ID ã‚’å–å¾—ã—ã¦ã—ã¾ã†ã‚±ãƒ¼ã‚¹ãŒã‚ã‚‹ã®ã§æ³¨æ„ãŒå¿…è¦ã§ã™ã€‚(mackerel-agent ã¯ <code>root</code> ã§å®Ÿè¡Œã•ã‚Œã‚‹)\nåŒã˜è¦é ˜ã§ã€ä»–ã«ã‚‚ä»¥ä¸‹ã®ã‚ˆã†ã«æ›¸ã‘ã° <code>puma</code> ã®ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‡ã‚£ã‚¹ã‚¯ãƒªãƒ—ã‚¿ã‚‚å–ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚</p>\n\n<pre class=\"code\" data-lang=\"\" data-unlink>[plugin.metrics.file_descriptor_count]\ncommand = &#39;&#39;&#39;\n  echo -e &#34;file_descriptor.puma\\\\t$(sudo ls /proc/$(pgrep -f -u {user_name} puma.sock | head -1)/fd/ | wc -l)\\\\t$(date -u +%s)&#34;\n  echo -e &#34;file_descriptor.puma_cluster_worker\\\\t$(sudo ls /proc/$(pgrep -f -u {user_name} &#39;puma: cluster worker&#39; | head -1)/fd/ | wc -l)\\\\t$(date -u +%s)&#34;\n&#39;&#39;&#39;</pre>\n\n\n<p>ã¡ãªã¿ã«ã“ã®è¨˜äº‹ã‚’æ›¸ãã¨ãã«ã€ã‚‚ã—ã‚„ã¨æ€ã£ã¦èª¿ã¹ã¦ã¿ãŸã‚‰ã€ <code>mackerel-agent-plugins</code> ã®ä¸­ã« <a href=\"https://github.com/mackerelio/mackerel-agent-plugins/tree/master/mackerel-plugin-proc-fd\">ä»»æ„ã®ãƒ—ãƒ­ã‚»ã‚¹ã®ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‡ã‚£ã‚¹ã‚¯ãƒªãƒ—ã‚¿ã‚’ç›£è¦–ã™ã‚‹å¥´</a> ãŒã‚ã‚Šã¾ã—ãŸ ğŸ˜“\nè©¦ã—ã¦ã„ã¾ã›ã‚“ãŒã€ã“ã£ã¡ã‚’ä½¿ã£ãŸæ–¹ãŒè‰¯ã„ã¨æ€ã„ã¾ã™ ğŸ˜‡</p>\n\n<p>ãã‚“ãªæ„Ÿã˜ã§ç›£è¦–ã§ããŸã‚°ãƒ©ãƒ•ãŒä»¥ä¸‹ã«ãªã‚Šã¾ã™ã€‚</p>\n\n<p><span itemscope itemtype=\"http://schema.org/Photograph\"><img src=\"https://cdn-ak.f.st-hatena.com/images/fotolife/r/ryz310/20171231/20171231142049.png\" alt=\"f:id:ryz310:20171231142049p:plain\" title=\"f:id:ryz310:20171231142049p:plain\" class=\"hatena-fotolife\" itemprop=\"image\"></span></p>\n\n<p>ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‡ã‚£ã‚¹ã‚¯ãƒªãƒ—ã‚¿æ•°ãŒãƒ•ã‚¡ã‚¤ãƒŠãƒ«ãƒ•ã‚¡ãƒ³ã‚¿ã‚¸ãƒ¼ã® HP ã¿ãŸã„ã«ãªã£ã¦ã¾ã™ã­ã€‚ã€‚ã€‚\nã¨ã‚Šã‚ãˆãš <code>10,000</code> ã‚’è¶…ãˆãŸã‚‰ã‚¢ãƒ©ãƒ¼ãƒˆã‚’é£›ã°ã™ã‚ˆã†ã«è¨­å®šã—ã¾ã—ãŸãŒã€ãƒ‡ãƒ—ãƒ­ã‚¤ã™ã‚‹åº¦ã«ãƒªã‚»ãƒƒãƒˆã•ã‚Œã‚‹ã®ã§ã€çµå±€ã‚¢ãƒ©ãƒ¼ãƒˆãŒé£›ã¶ã“ã¨ã‚‚éšœå®³ãŒç™ºç”Ÿã™ã‚‹ã“ã¨ã‚‚ãªãã€å•é¡Œã¯è§£æ±ºã—ã¾ã—ãŸã€‚</p>\n\n<p>æœ¬ç¨¿ã§ã¯ <code>echo</code> ã‚’ä½¿ã£ãŸãƒ¯ãƒ³ãƒ©ã‚¤ãƒŠãƒ¼ã§ã‚«ã‚¹ã‚¿ãƒ ãƒ¡ãƒˆãƒªãƒƒã‚¯ã‚’æŠ•ç¨¿ã™ã‚‹æ–¹æ³•ã‚’ç´¹ä»‹ã—ã¾ã—ãŸã€‚\n<code>mackerel-agent-plugins</code> ã«è¼‰ã£ã¦ã„ãªã„ã‘ã©ãƒ¯ãƒ¼ã‚¯ã‚¢ãƒ©ã‚¦ãƒ³ãƒ‰ã§ã¨ã‚Šã‚ãˆãšç›£è¦–ã•ã›ãŸã„ã€ã¨ã„ã†æ™‚ã¯ä¾¿åˆ©ã ã¨æ€ã†ã®ã§ã€ã©ã“ã‹ã§ã”æ´»ç”¨ãã ã•ã„ ğŸ™</p>\n","contentSnippet":"ã©ã†ã‚‚ã€ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ã®ã‚µãƒˆã‚¦ãƒªãƒ§ã‚¦ã‚¹ã‚±ã§ã™ âœŒï¸('Ï‰')âœŒï¸çªç„¶ã§ã™ãŒãƒ¯ãƒ†ã‚¯ã‚·ã€ Rails ã‚¢ãƒ—ãƒªã¯ãã“ãã“æ›¸ã‘ã‚‹æ–¹ãªã‚“ã§ã™ãŒã€ã‚¤ãƒ³ãƒ•ãƒ©ã¯ã‹ã‚‰ãã—ã ã£ãŸã‚Šã—ã¾ã™ã€‚ ãƒ•ãƒ«ã‚¹ã‚¿ãƒƒã‚¯ã˜ã‚ƒãªã„ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ãŒè¨±ã•ã‚Œã‚‹ã®ã¯å°å­¦ç”Ÿã¾ã§ã ã‚ˆã­ãƒ¼ã€ã¨ã„ã†ã¡ã‚‡ã£ã¨æ‡ã‹ã—ã¿ã®ã‚ã‚‹ç…½ã‚ŠãŒç¤¾å†…ã®ã‹ã‚‰ã‚‚èã“ãˆã¦ããã†ãªã®ã§ã€æœ€è¿‘ã‚¤ãƒ³ãƒ•ãƒ©ã‚’å°‘ã—ãšã¤è§¦ã‚‹ã‚ˆã†ã«ã—ã¦ã„ã¾ã™ã€‚è§¦ã£ã¦ã¿ã‚‹ã¨ã‚¤ãƒ³ãƒ•ãƒ©ã‚‚è‰²ã€…æ¥½ã—ã„ã§ã™ã­ âœŒï¸('Ï‰')âœŒï¸ã¨ã¯ã„ãˆã€ã‚¤ãƒ³ãƒ•ãƒ©ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ãƒ¬ãƒ™ãƒ« 1 ã®è‡ªåˆ†ãŒã‚ã‚Œã“ã‚Œã‚„ã£ã¦ã‚‚éšœå®³ã«ç¹‹ãŒã‚‹ã ã‘ãªã®ã§ã€ã¾ãšã¯ãŠæ‰‹è»½ãªé›‘ç”¨ã‚¿ã‚¹ã‚¯ã‹ã‚‰å§‹ã‚ã‚‹ã“ã¨ã«ã—ã¾ã—ãŸã€‚ã•ã¦ã€å°‘ã—è©±ã¯å¤‰ã‚ã£ã¦ã€æœ€è¿‘ã€å¼Šç¤¾ã‚µãƒ¼ãƒ“ã‚¹ã§ Sidekiq ãƒ—ãƒ­ã‚»ã‚¹ã®ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‡ã‚£ã‚¹ã‚¯ãƒªãƒ—ã‚¿ãŒæ€¥é¨°ã—ã¦ã‚µãƒ¼ãƒãƒ¼ãŒãƒ€ã‚¦ãƒ³ã™ã‚‹ã€ã¨ã„ã†éšœå®³ãŒä½•åº¦ã‹ç™ºç”Ÿã—ã¾ã—ãŸã€‚ç¾è±¡ã¨ã—ã¦ã¯ Sidekiq ãƒ—ãƒ­ã‚»ã‚¹ã®ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‡ã‚£ã‚¹ã‚¯ãƒªãƒ—ã‚¿ãŒä¸Šé™å€¤ (åˆæœŸå€¤ã¯ 1024 ) ã«é”ã™ã‚‹ã¨ã€ã‚µãƒ¼ãƒãƒ¼ã® CPU ä½¿ç”¨ç‡ãŒ 100 % ä»˜è¿‘ã¾ã§é”ã—ã¦ã—ã¾ã†ã€ã¨ã„ã†ã‚‚ã®ã ã£ãŸã®ã§ã€ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‡ã‚£ã‚¹ã‚¯ãƒªãƒ—ã‚¿ã®ä¸Šé™ã‚’ 65536 ã¾ã§ä¸Šã’ã‚‹ã€ã¨ã„ã†ãƒ¯ãƒ¼ã‚¯ã‚¢ãƒ©ã‚¦ãƒ³ãƒ‰ãªå¯¾å¿œã§å‡Œã„ã§ã„ã¾ã—ãŸã€‚ç¾åœ¨ã¯è§£æ±ºæ¸ˆã¿ï¼ˆã“ã®åŸå› ã«ã¤ã„ã¦ã¯ã€åˆ¥é€”è¨˜äº‹ã«ã—ã¾ã™ï¼‰ã§ã™ãŒã€å½“æ™‚ã¯ãªãœãƒ•ã‚¡ã‚¤ãƒ«ãƒ‡ã‚£ã‚¹ã‚¯ãƒªãƒ—ã‚¿ã®æ•°ãŒä¸Šæ˜‡ã—ç¶šã‘ã¦ã—ã¾ã†ã®ã‹åŸå› ãŒå…¨ãã‚ã‹ã‚‰ãšã€ãƒãƒ¼ãƒ ã®ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ã¯å®‰çœ ã§ããªã„æ—¥ã€…ãŒç¶šã„ã¦ã„ã¾ã—ãŸã€‚ã¨ã‚Šã‚ãˆãš Sidekiq ã®ãƒ—ãƒ­ã‚»ã‚¹ã‚’ãƒªã‚¹ã‚¿ãƒ¼ãƒˆã™ã‚Œã°ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‡ã‚£ã‚¹ã‚¯ãƒªãƒ—ã‚¿ã®æ•°ã¯ä¸€æ—¦ãƒªã‚»ãƒƒãƒˆã•ã‚Œã‚‹ã®ã§ã€ç›£è¦–ã—ã¦ã‚„ã°ããªã£ãŸã‚‰ã‚¢ãƒ©ãƒ¼ãƒˆã‚’é£›ã°ã—ã¦å†èµ·å‹•ã•ã›ã‚‹ã€ã¨ã„ã†æ–¹æ³•ã§ä¸€æ—¦ã¯å‡Œã¾ã™ã€‚ã¾ãŸã€ç¶™ç¶šã—ã¦ç›£è¦–ã™ã‚‹ã“ã¨ã§ã€åŸå› ã®è§£æ˜ã«ã‚‚ç¹‹ãŒã‚‹ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚å¼Šç¤¾ã®ã‚µãƒ¼ãƒ“ã‚¹ã§ã¯ç›£è¦–ã« mackerel ã‚’åˆ©ç”¨ã—ã¦ã„ã‚‹ã®ã§ã€ã‚«ã‚¹ã‚¿ãƒ ãƒ¡ãƒˆãƒªãƒƒã‚¯ã‚’ä½¿ã£ã¦ãŠæ‰‹è»½ã«ç›£è¦–ã•ã›ã‚ˆã†ã€ã¨ã„ã†ã“ã¨ã«ãªã‚Šã¾ã—ãŸã€‚mackerel ã®ã‚«ã‚¹ã‚¿ãƒ ãƒ¡ãƒˆãƒªãƒƒã‚¯ã®æŠ•ç¨¿æ–¹æ³•ã¯ ã“ã¡ã‚‰ã®è¨˜äº‹ ã«ã¾ã¨ã¾ã£ã¦ã„ã¾ã™ã€‚è¦ç‚¹ã ã‘æŠœç²‹ã—ã¾ã™ã¨ã€ mackerel-agent ã®è¨­å®šãƒ•ã‚¡ã‚¤ãƒ« ã« ä»¥ä¸‹ã®æ›¸å¼ã§æ¨™æº–å‡ºåŠ›ã‚’å®Ÿè¡Œã™ã‚‹ã‚³ãƒãƒ³ãƒ‰ã‚’è¨˜è¿° ã™ã‚Œã° OK ã§ã™ã€‚è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã§æŒ‡å®šã™ã‚‹ã‚³ãƒãƒ³ãƒ‰ã¯ã€æ¨™æº–å‡ºåŠ›ã®å„è¡Œã«ä»¥ä¸‹ã®ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã®å‡ºåŠ›ã‚’ã™ã‚‹ã“ã¨ãŒæœŸå¾…ã•ã‚Œã¾ã™ï¼ˆ\\t ã¯ã‚¿ãƒ–æ–‡å­—ã§ã™ï¼‰:{metric name}\\t{metric value}\\t{epoch seconds}ãã—ã¦ä»¥ä¸‹ãŒãƒ•ã‚¡ã‚¤ãƒ«ãƒ‡ã‚£ã‚¹ã‚¯ãƒªãƒ—ã‚¿ã‚’ç›£è¦–ã™ã‚‹ãŸã‚ã®è¨­å®šã§ã™ï¼ˆå®Œæˆå“ãŒãƒ¬ãƒ³ã‚¸ã‹ã‚‰å‡ºã¦ãã‚‹ãƒ‘ãƒ†ã‚£ãƒ¼ãƒ³ï¼‰[plugin.metrics.file_descriptor_count]command = '''  echo -e \"file_descriptor.sidekiq\\\\t$(sudo ls /proc/$(pgrep -f -u {user_name} sidekiq | head -1)/fd/ | wc -l)\\\\t$(date -u +%s)\"'''æ¨™æº–å‡ºåŠ›ã•ã‚Œã‚Œã° OK ãªã®ã§ã€ echo ã§ä»»æ„ã®æ–‡å­—åˆ—ã‚’å‡ºåŠ›ã™ã‚‹ã‚ˆã†ãªæ–¹æ³•ã§ã‚‚å®Ÿç¾å¯èƒ½ã§ã™ã€‚å†…éƒ¨ã§ pgrep -f -u {user_name} sidekiq ã¨æ›¸ã„ã¦ã€ãƒ—ãƒ­ã‚»ã‚¹ ID ã‚’å–å¾—ã—ã¦ã„ã¾ã™ãŒã€ -u ã§ãƒ—ãƒ­ã‚»ã‚¹ã‚’å®Ÿè¡Œã—ã¦ã„ã‚‹ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’æŒ‡å®šã—ãªã„ã¨ã€ pgrep ã®ãƒ—ãƒ­ã‚»ã‚¹ ID ã‚’å–å¾—ã—ã¦ã—ã¾ã†ã‚±ãƒ¼ã‚¹ãŒã‚ã‚‹ã®ã§æ³¨æ„ãŒå¿…è¦ã§ã™ã€‚(mackerel-agent ã¯ root ã§å®Ÿè¡Œã•ã‚Œã‚‹)åŒã˜è¦é ˜ã§ã€ä»–ã«ã‚‚ä»¥ä¸‹ã®ã‚ˆã†ã«æ›¸ã‘ã° puma ã®ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‡ã‚£ã‚¹ã‚¯ãƒªãƒ—ã‚¿ã‚‚å–ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚[plugin.metrics.file_descriptor_count]command = '''  echo -e \"file_descriptor.puma\\\\t$(sudo ls /proc/$(pgrep -f -u {user_name} puma.sock | head -1)/fd/ | wc -l)\\\\t$(date -u +%s)\"  echo -e \"file_descriptor.puma_cluster_worker\\\\t$(sudo ls /proc/$(pgrep -f -u {user_name} 'puma: cluster worker' | head -1)/fd/ | wc -l)\\\\t$(date -u +%s)\"'''ã¡ãªã¿ã«ã“ã®è¨˜äº‹ã‚’æ›¸ãã¨ãã«ã€ã‚‚ã—ã‚„ã¨æ€ã£ã¦èª¿ã¹ã¦ã¿ãŸã‚‰ã€ mackerel-agent-plugins ã®ä¸­ã« ä»»æ„ã®ãƒ—ãƒ­ã‚»ã‚¹ã®ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‡ã‚£ã‚¹ã‚¯ãƒªãƒ—ã‚¿ã‚’ç›£è¦–ã™ã‚‹å¥´ ãŒã‚ã‚Šã¾ã—ãŸ ğŸ˜“è©¦ã—ã¦ã„ã¾ã›ã‚“ãŒã€ã“ã£ã¡ã‚’ä½¿ã£ãŸæ–¹ãŒè‰¯ã„ã¨æ€ã„ã¾ã™ ğŸ˜‡ãã‚“ãªæ„Ÿã˜ã§ç›£è¦–ã§ããŸã‚°ãƒ©ãƒ•ãŒä»¥ä¸‹ã«ãªã‚Šã¾ã™ã€‚ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‡ã‚£ã‚¹ã‚¯ãƒªãƒ—ã‚¿æ•°ãŒãƒ•ã‚¡ã‚¤ãƒŠãƒ«ãƒ•ã‚¡ãƒ³ã‚¿ã‚¸ãƒ¼ã® HP ã¿ãŸã„ã«ãªã£ã¦ã¾ã™ã­ã€‚ã€‚ã€‚ã¨ã‚Šã‚ãˆãš 10,000 ã‚’è¶…ãˆãŸã‚‰ã‚¢ãƒ©ãƒ¼ãƒˆã‚’é£›ã°ã™ã‚ˆã†ã«è¨­å®šã—ã¾ã—ãŸãŒã€ãƒ‡ãƒ—ãƒ­ã‚¤ã™ã‚‹åº¦ã«ãƒªã‚»ãƒƒãƒˆã•ã‚Œã‚‹ã®ã§ã€çµå±€ã‚¢ãƒ©ãƒ¼ãƒˆãŒé£›ã¶ã“ã¨ã‚‚éšœå®³ãŒç™ºç”Ÿã™ã‚‹ã“ã¨ã‚‚ãªãã€å•é¡Œã¯è§£æ±ºã—ã¾ã—ãŸã€‚æœ¬ç¨¿ã§ã¯ echo ã‚’ä½¿ã£ãŸãƒ¯ãƒ³ãƒ©ã‚¤ãƒŠãƒ¼ã§ã‚«ã‚¹ã‚¿ãƒ ãƒ¡ãƒˆãƒªãƒƒã‚¯ã‚’æŠ•ç¨¿ã™ã‚‹æ–¹æ³•ã‚’ç´¹ä»‹ã—ã¾ã—ãŸã€‚mackerel-agent-plugins ã«è¼‰ã£ã¦ã„ãªã„ã‘ã©ãƒ¯ãƒ¼ã‚¯ã‚¢ãƒ©ã‚¦ãƒ³ãƒ‰ã§ã¨ã‚Šã‚ãˆãšç›£è¦–ã•ã›ãŸã„ã€ã¨ã„ã†æ™‚ã¯ä¾¿åˆ©ã ã¨æ€ã†ã®ã§ã€ã©ã“ã‹ã§ã”æ´»ç”¨ãã ã•ã„ ğŸ™","link":"https://developer.feedforce.jp/entry/2017/12/31/143611","isoDate":"2017-12-31T05:36:11.000Z","dateMiliSeconds":1514698571000,"imageUrl":"https://cdn-ak.f.st-hatena.com/images/fotolife/r/ryz310/20171231/20171231142049.png","authorName":"ryz310"},{"title":"Dynamoid ã®ä½¿ã„æ–¹ã€global_secondary_index ç·¨ã€‘","content":"<p>ã©ã†ã‚‚ã€ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ã®ã‚µãƒˆã‚¦ãƒªãƒ§ã‚¦ã‚¹ã‚±ã§ã™ âœŒï¸('Ï‰')âœŒï¸</p>\n\n<p><a href=\"http://developer.feedforce.jp/entry/2017/11/04/235323\">å‰å›</a>ã«å¼•ãç¶šãã€ Dynamoid ç¬¬3å¼¾ã§ã™ âœŒï¸('Ï‰')âœŒï¸</p>\n\n<p>Rails ã§ DynamoDB ã‚’åˆ©ç”¨ã™ã‚‹éš›ã® ORM ã¨ã—ã¦ <code>dynamoid</code> ãŒã‚ã‚Šã¾ã™ã€‚\nä»Šå›ã¯ <code>dynamoid</code> ã‹ã‚‰ Global Secondary Index (GSI) ã‚’åˆ©ç”¨ã™ã‚‹æ–¹æ³•ã«ã¤ã„ã¦ç´¹ä»‹ã—ã¾ã™ã€‚</p>\n\n<ul class=\"table-of-contents\">\n    <li><a href=\"#Global-Secondary-Index-GSI-ã£ã¦ãªã‚“ã\">Global Secondary Index (GSI) ã£ã¦ãªã‚“ã</a><ul>\n            <li><a href=\"#ä»Šå›ã‚‚åç§°ã®æ•´ç†ã‚’ã—ã¦ãŠãã¾ã™\">ä»Šå›ã‚‚åç§°ã®æ•´ç†ã‚’ã—ã¦ãŠãã¾ã™</a></li>\n            <li><a href=\"#GSI-ã¯æ¤œç´¢ã®ãŸã‚ã®ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹\">GSI ã¯æ¤œç´¢ã®ãŸã‚ã®ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹</a></li>\n            <li><a href=\"#Local-Secondary-Index-LSI-ã‚‚ã‚ã‚‹ã‚„ã§\">Local Secondary Index (LSI) ã‚‚ã‚ã‚‹ã‚„ã§</a></li>\n            <li><a href=\"#ã©ã†ã„ã†ç”¨é€”ã§ä¾¿åˆ©ãªã®ã‹\">ã©ã†ã„ã†ç”¨é€”ã§ä¾¿åˆ©ãªã®ã‹</a></li>\n        </ul>\n    </li>\n    <li><a href=\"#Dynamoid-ã§ã®åˆ©ç”¨æ–¹æ³•\">Dynamoid ã§ã®åˆ©ç”¨æ–¹æ³•</a><ul>\n            <li><a href=\"#ãƒ†ãƒ¼ãƒ–ãƒ«å®šç¾©\">ãƒ†ãƒ¼ãƒ–ãƒ«å®šç¾©</a><ul>\n                    <li><a href=\"#where-ã‚’ä½¿ãˆã°-GSI-ã‚’ä½¿ã£ã¦è‡ªå‹•çš„ã«ã‚¯ã‚¨ãƒªã§æ¤œç´¢ã—ã¦ãã‚Œã‚‹\">#where ã‚’ä½¿ãˆã° GSI ã‚’ä½¿ã£ã¦è‡ªå‹•çš„ã«ã‚¯ã‚¨ãƒªã§æ¤œç´¢ã—ã¦ãã‚Œã‚‹</a></li>\n                    <li><a href=\"#æ˜‡é †é™é †ã‚’å…¥ã‚Œæ›¿ãˆãŸã„å ´åˆ\">æ˜‡é †ãƒ»é™é †ã‚’å…¥ã‚Œæ›¿ãˆãŸã„å ´åˆ</a></li>\n                </ul>\n            </li>\n        </ul>\n    </li>\n    <li><a href=\"#ã¾ã¨ã‚\">ã¾ã¨ã‚</a></li>\n</ul>\n\n<p><code>dynamoid</code> ã®å°å…¥æ–¹æ³•ã«ã¤ã„ã¦ã¯ä»¥å‰æ›¸ã„ãŸã“ã¡ã‚‰ã®è¨˜äº‹ã‚’å‚è€ƒã«ã—ã¦ã¿ã¦ä¸‹ã•ã„ã€‚</p>\n\n<p><iframe src=\"https://hatenablog-parts.com/embed?url=http%3A%2F%2Ftech.feedforce.jp%2Fdynamodb-setup-on-rails.html\" title=\"DynamoDB ã‚’ Rails ã§ä½¿ãˆã‚‹ã‚ˆã†ã«ã™ã‚‹ãŸã‚ã®ã‚ã‚Œã“ã‚Œ | feedforce Engineers&#39; blog\" class=\"embed-card embed-webcard\" scrolling=\"no\" frameborder=\"0\" style=\"display: block; width: 100%; height: 155px; max-width: 500px; margin: 10px 0px;\"></iframe><cite class=\"hatena-citation\"><a href=\"http://tech.feedforce.jp/dynamodb-setup-on-rails.html\">tech.feedforce.jp</a></cite></p>\n\n<h1 id=\"Global-Secondary-Index-GSI-ã£ã¦ãªã‚“ã\">Global Secondary Index (GSI) ã£ã¦ãªã‚“ã</h1>\n\n<h2 id=\"ä»Šå›ã‚‚åç§°ã®æ•´ç†ã‚’ã—ã¦ãŠãã¾ã™\">ä»Šå›ã‚‚åç§°ã®æ•´ç†ã‚’ã—ã¦ãŠãã¾ã™</h2>\n\n<p>æ–‡ä¸­ã« Hash Key ã‚„ã‚‰ Range Key ã¨ã„ã†åç§°ãŒå‡ºã¦ãã¾ã™ãŒã€ç¾åœ¨ã¯åç§°ãŒç•°ãªã‚Šã¾ã™ã€‚\nã—ã‹ã—ã€ <code>dyanmoid</code> ã§ã¯ç›¸å¤‰ã‚ã‚‰ãšæ—§åç§°ã®ã¾ã¾ (<code>hash_key</code>, <code>range_key</code>) ã§ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’æŒ‡å®šã™ã‚‹ã®ã§ã€ä»Šå›ã‚‚æœ€åˆã«å¯¾å¿œè¡¨ã‚’è¨˜è¼‰ã—ã¦ãŠãã¾ã™ã€‚</p>\n\n<table>\n<thead>\n<tr>\n<th style=\"text-align:center;\"> æ—§åç§° </th>\n<th style=\"text-align:center;\"> ç¾åç§° </th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center;\"> Hash Key </td>\n<td style=\"text-align:center;\"> Partition Key </td>\n</tr>\n<tr>\n<td style=\"text-align:center;\"> Range Key </td>\n<td style=\"text-align:center;\"> Sort Key </td>\n</tr>\n</tbody>\n</table>\n\n\n<h2 id=\"GSI-ã¯æ¤œç´¢ã®ãŸã‚ã®ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹\">GSI ã¯æ¤œç´¢ã®ãŸã‚ã®ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹</h2>\n\n<p>DynamoDB ã«ã¯ãƒ—ãƒ©ã‚¤ãƒãƒªã‚­ãƒ¼ã®æŒ‡å®šæ–¹æ³•ã¨ã—ã¦ã€å˜ä¸€ã® Partition Key ã‚’ä½¿ç”¨ã™ã‚‹æ–¹æ³•ã¨ã€Partition Key ã¨ Sort Key ã‚’çµ„ã¿åˆã‚ã›ã¦ä½¿ç”¨ã™ã‚‹æ–¹æ³•ãŒã‚ã‚Šã¾ã™ã€‚\nã“ã‚Œã«ã¤ã„ã¦ã¯å‰å›ã®ã€range ç·¨ã€‘ã®è¨˜äº‹ã§ã‚‚è§¦ã‚Œã¾ã—ãŸã€‚</p>\n\n<p><iframe src=\"https://hatenablog-parts.com/embed?url=http%3A%2F%2Fdeveloper.feedforce.jp%2Fentry%2F2017%2F11%2F04%2F235323\" title=\"Dynamoid ã®ä½¿ã„æ–¹ã€range ç·¨ã€‘ - Feedforce Developer Blog\" class=\"embed-card embed-blogcard\" scrolling=\"no\" frameborder=\"0\" style=\"display: block; width: 100%; height: 190px; max-width: 500px; margin: 10px 0px;\"></iframe><cite class=\"hatena-citation\"><a href=\"http://developer.feedforce.jp/entry/2017/11/04/235323\">developer.feedforce.jp</a></cite></p>\n\n<p>ãƒ—ãƒ©ã‚¤ãƒãƒªã‚­ãƒ¼ã«æŒ‡å®šã•ã‚ŒãŸã‚«ãƒ©ãƒ ã«å¯¾ã—ã¦ã§ã‚ã‚Œã°ã€ãƒ¬ã‚³ãƒ¼ãƒ‰ã®æŠ½å‡ºã‚„ç¯„å›²æ¤œç´¢ãªã©ãŒå®Ÿè¡Œå¯èƒ½ã¨ãªã‚‹è¨³ã§ã™ãŒã€ãƒ—ãƒ©ã‚¤ãƒãƒªã‚­ãƒ¼ã«æŒ‡å®šã•ã‚Œã¦ã„ãªã„ã‚«ãƒ©ãƒ ã«å¯¾ã—ã¦ã¯æ¤œç´¢ãŒå®Ÿè¡Œã§ããšã€ãƒ†ãƒ¼ãƒ–ãƒ«ã®ãƒ•ãƒ«ã‚¹ã‚­ãƒ£ãƒ³ã‚’å®Ÿè¡Œã™ã‚‹ã“ã¨ã«ãªã£ã¦ã—ã¾ã„éåŠ¹ç‡ã§ã™ã€‚ãã“ã§ã€åˆ¥ã®ã‚«ãƒ©ãƒ ã«å¯¾ã—ã¦ã‚‚æ¤œç´¢ã‚’è¡Œã„ãŸã„å ´åˆã¯ GSI ã‚’è¨­å®šã—ã¦ã€ãƒ•ãƒ«ã‚¹ã‚­ãƒ£ãƒ³ã™ã‚‹ã“ã¨ãªãåŠ¹ç‡çš„ã«ãƒ‡ãƒ¼ã‚¿ã‚’æŠ½å‡ºã§ãã‚‹ã‚ˆã†ã«ã—ã¾ã™ã€‚</p>\n\n<iframe src=\"//www.slideshare.net/slideshow/embed_code/key/gHjtA6AS8rk0sB?startSlide=47\" width=\"595\" height=\"485\" style=\"border: 1px solid #CCC; border-width: 1px; margin-bottom: 5px; max-width: 100%;\" scrolling=\"no\" marginwidth=\"0\" marginheight=\"0\" frameborder=\"0\"> </iframe>\n\n\n<p>GSI ã‚‚ãƒ—ãƒ©ã‚¤ãƒãƒªã‚­ãƒ¼ã®æŒ‡å®šã¨åŒæ§˜ã«ã€å˜ä¸€ã® Partition Key ã®ã¿ã§æŒ‡å®šã™ã‚‹ã“ã¨ã‚‚ã€ Partition Key ã¨  Sort Key ã®çµ„ã¿åˆã‚ã›ã§æŒ‡å®šã™ã‚‹ã“ã¨ã‚‚å¯èƒ½ã§ã™ã€‚\nãŸã ã—ã€ <strong>ãƒ—ãƒ©ã‚¤ãƒãƒªã‚­ãƒ¼ã«ã¯ãƒ¦ãƒ‹ãƒ¼ã‚¯åˆ¶ç´„ãŒè¨­å®šã•ã‚Œã¾ã™ãŒã€ GSI ã«ã¯ãƒ¦ãƒ‹ãƒ¼ã‚¯åˆ¶ç´„ãŒå­˜åœ¨ã—ãªã„</strong> ã®ã§ã€ãã®ç‚¹ã«ã¯æ³¨æ„ãŒå¿…è¦ã§ã™ã€‚</p>\n\n<h2 id=\"Local-Secondary-Index-LSI-ã‚‚ã‚ã‚‹ã‚„ã§\">Local Secondary Index (LSI) ã‚‚ã‚ã‚‹ã‚„ã§</h2>\n\n<p>LSI ã® Partition Key ã¯ãƒ—ãƒ©ã‚¤ãƒãƒªã‚­ãƒ¼ã¨å…±é€šã§ã™ã€‚Sort Key ã®éƒ¨åˆ†ã ã‘åˆ¥ã«è¨­å®šã—ãŸã„å ´åˆã«ä½¿ç”¨ã—ã¾ã™ã€‚ãã®ç‚¹ã‚’é™¤ã‘ã° GSI ã¨ã‚ˆãä¼¼ã¦ã„ã¾ã™ãŒã€ã“ã¡ã‚‰ã¯ãƒ†ãƒ¼ãƒ–ãƒ«ã®ä½œæˆæ™‚ã«ã—ã‹å®šç¾©ã™ã‚‹ã“ã¨ãŒã§ããªã„ã‚ˆã†ã§ã™ã€‚</p>\n\n<iframe src=\"//www.slideshare.net/slideshow/embed_code/key/gHjtA6AS8rk0sB?startSlide=46\" width=\"595\" height=\"485\" style=\"border: 1px solid #CCC; border-width: 1px; margin-bottom: 5px; max-width: 100%;\" scrolling=\"no\" marginwidth=\"0\" marginheight=\"0\" frameborder=\"0\"> </iframe>\n\n\n<p>ãªãŠã€LSI ã‚‚<code>dynamoid</code> ã‹ã‚‰æŒ‡å®šã™ã‚‹ã“ã¨ã¯å¯èƒ½ (<code>local_secondary_index</code> ã‚’ä½¿ç”¨ã™ã‚‹) ã§ã™ãŒã€æœ¬ç¨¿ã§ã¯è§¦ã‚Œã¾ã›ã‚“ã€‚</p>\n\n<h2 id=\"ã©ã†ã„ã†ç”¨é€”ã§ä¾¿åˆ©ãªã®ã‹\">ã©ã†ã„ã†ç”¨é€”ã§ä¾¿åˆ©ãªã®ã‹</h2>\n\n<p>ã‚ã¾ã‚Šè¤‡é›‘ãªãƒ†ãƒ¼ãƒ–ãƒ«è¨­è¨ˆãŒæ¨å¥¨ã•ã‚Œãªã„ DynamoDB ã§ã™ãŒã€ç°¡å˜ãªãƒ†ãƒ¼ãƒ–ãƒ«é–“ã®é–¢é€£ä»˜ã‘ã‚’è¡Œã„ãŸã„ã‚·ãƒ¼ãƒ³ãŒå‡ºã¦ãã¾ã™ã€‚è¦ªãƒ†ãƒ¼ãƒ–ãƒ«ã® ID ã‚’çµåˆã‚­ãƒ¼ã¨ã—ã¦å­ãƒ†ãƒ¼ãƒ–ãƒ«ã«è¨­å®šã—ãŸã„å ´åˆãªã©ã« GSI ã¯ä¾¿åˆ©ã§ã™ã€‚\nä»¥ä¸‹ã« User Table ã¨ User Comment Table ã®ä¾‹ã‚’ç¤ºã—ã¾ã™ã€‚User Comment Table ã«ã¯è¦ªãƒ†ãƒ¼ãƒ–ãƒ«ã§ã‚ã‚‹ User Table ã® ID ãŒ GSI ã® Partition Key ã¨ã—ã¦è¨­å®šã—ã¦ã‚ã‚Šã¾ã™ã€‚ã¾ãŸã€ã‚³ãƒ¡ãƒ³ãƒˆã®æŠ•ç¨¿æ—¥æ™‚ (Posted at) ã‚’ GSI ã® Sort Key ã¨ã—ã¦è¨­å®šã—ã¦ã„ã¾ã™ã€‚ã“ã‚Œã§ User æ¯ã«æŠ•ç¨¿æ—¥æ™‚é †ã«ã‚½ãƒ¼ãƒˆã—ãŸã‚³ãƒ¡ãƒ³ãƒˆã‚’å–å¾—ã™ã‚‹ã“ã¨ãŒã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚</p>\n\n<p><strong>User Table</strong></p>\n\n<table>\n<thead>\n<tr>\n<th style=\"text-align:center;\"> ID </th>\n<th> name </th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center;\"> 1 </td>\n<td> John </td>\n</tr>\n<tr>\n<td style=\"text-align:center;\"> 2 </td>\n<td> Marry </td>\n</tr>\n<tr>\n<td style=\"text-align:center;\"> 3 </td>\n<td> Taro </td>\n</tr>\n</tbody>\n</table>\n\n\n<p><strong>User Comment Table</strong></p>\n\n<table>\n<thead>\n<tr>\n<th style=\"text-align:center;\"> ID (Primary Partition Key) </th>\n<th style=\"text-align:center;\"> User ID (GSI Partition Key) </th>\n<th> Posted at (GSI Sort Key) </th>\n<th style=\"text-align:center;\"> Comment </th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center;\"> 1 </td>\n<td style=\"text-align:center;\"> 1 </td>\n<td> 1509529916 </td>\n<td style=\"text-align:center;\"> Hello </td>\n</tr>\n<tr>\n<td style=\"text-align:center;\"> 2 </td>\n<td style=\"text-align:center;\"> 1 </td>\n<td> 1509530052 </td>\n<td style=\"text-align:center;\"> I am John </td>\n</tr>\n<tr>\n<td style=\"text-align:center;\"> 3 </td>\n<td style=\"text-align:center;\"> 1 </td>\n<td> 1509530085 </td>\n<td style=\"text-align:center;\"> How do you do? </td>\n</tr>\n<tr>\n<td style=\"text-align:center;\"> 4 </td>\n<td style=\"text-align:center;\"> 2 </td>\n<td> 1509523925 </td>\n<td style=\"text-align:center;\"> Thanks a lot! </td>\n</tr>\n<tr>\n<td style=\"text-align:center;\"> 5 </td>\n<td style=\"text-align:center;\"> 3 </td>\n<td> 1509527628 </td>\n<td style=\"text-align:center;\"> ã“ã‚“ã«ã¡ã¯ </td>\n</tr>\n<tr>\n<td style=\"text-align:center;\"> 6 </td>\n<td style=\"text-align:center;\"> 3 </td>\n<td> 1509527101 </td>\n<td style=\"text-align:center;\"> ã©ã†ã‚‚ </td>\n</tr>\n</tbody>\n</table>\n\n\n<p>ã¡ãªã¿ã«ã€ãƒ—ãƒ©ã‚¤ãƒãƒªã‚­ãƒ¼ã¨ GSI ã‚’é€†ã«è¨­å®šã—ã¦ã‚‚ã»ã¼æˆç«‹ã™ã‚‹ã®ã§ã™ãŒã€å‰è¿°ã—ãŸã‚ˆã†ã« GSI ã«ã¯ãƒ¦ãƒ‹ãƒ¼ã‚¯åˆ¶ç´„ãŒå­˜åœ¨ã—ãªã„ã®ã§ã€User Comment Table ã§ã¯ ID ã‚’ãƒ—ãƒ©ã‚¤ãƒãƒªã‚­ãƒ¼ã¨ã—ã¦ã€é‡è¤‡ãŒç”Ÿã˜ãªã„ã‚ˆã†ã«è¨­å®šã—ã¦ã‚ã‚Šã¾ã™ã€‚</p>\n\n<h1 id=\"Dynamoid-ã§ã®åˆ©ç”¨æ–¹æ³•\">Dynamoid ã§ã®åˆ©ç”¨æ–¹æ³•</h1>\n\n<h2 id=\"ãƒ†ãƒ¼ãƒ–ãƒ«å®šç¾©\">ãƒ†ãƒ¼ãƒ–ãƒ«å®šç¾©</h2>\n\n<p>ã“ã“ã‹ã‚‰ã¯å‰è¿°ã® User Table ã¨ User Comment Table ã‚’ <code>dynamoid</code> ã‹ã‚‰åˆ©ç”¨ã™ã‚‹ä¾‹ã‚’ç¤ºã—ã¦ã„ãã¾ã™ã€‚</p>\n\n<pre class=\"code\" data-lang=\"\" data-unlink>class User\n  include Dynamoid::Document\n\n  table name: :users, key: :id\n\n  field :name, :string\n\n  # ç¾åœ¨ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«ç´ä»˜ãã‚³ãƒ¡ãƒ³ãƒˆã‚’ä½œæˆã™ã‚‹\n  def create_comment!(attributes = {})\n    attributes[:user_id] = id\n    UserComment.new(attributes).tap(&amp;:save!)\n  end\n\n  # ç¾åœ¨ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ã‚³ãƒ¡ãƒ³ãƒˆä¸€è¦§ã‚’å–å¾—ã™ã‚‹\n  def comments\n    UserComment.where(user_id: id)\n  end\n\n  # ç¾åœ¨ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®æœ€çµ‚ã‚³ãƒ¡ãƒ³ãƒˆã‚’å–å¾—ã™ã‚‹\n  def latest_comment\n    comments.scan_index_forward(false).scan_limit(1).all.first\n  end\nend</pre>\n\n\n\n\n<pre class=\"code\" data-lang=\"\" data-unlink>class UserComment\n  include Dynamoid::Document\n\n  table name: :user_comments, key: :id\n\n  field :user_id, :string\n  field :posted_at, :datetime\n\n  global_secondary_index hash_key: :user_id, \n                         range_key: :posted_at, \n                         projected_attributes: :all\nend</pre>\n\n\n<p>â€» ã¡ãªã¿ã« <code>dynamoid</code> ã«ã¯ <code>has_many</code> ã‚’åˆ©ç”¨ã—ã¦é–¢é€£ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’å®Ÿç¾ã™ã‚‹æ–¹æ³•ãŒã‚ã‚‹ã®ã§ã™ãŒã€çµåˆã‚­ãƒ¼ã‚’è¦ªãƒ†ãƒ¼ãƒ–ãƒ«ã«æŒã¤è¨­è¨ˆã«ãªã‚‹ã®ãŒã‚ã¾ã‚Šå¥½ã¾ã—ããªã‹ã£ãŸã®ã§ã€è‡ªå‰ã§å®Ÿè£…ã—ã¦ã„ã¾ã™ã€‚</p>\n\n<p>ã„ãã¤ã‹æ³¨æ„ã™ã‚‹ç‚¹ãŒã‚ã£ã¦ã€ <code>global_secondary_index</code> ã§ä½¿ç”¨ã™ã‚‹ <code>hash_key</code> ã¨ <code>range_key</code> ã¯ <code>field</code> ã§å®šç¾©ã•ã‚Œã¦ã„ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚\nã¾ãŸã€ <code>projected_attributes: :all</code> ã¨ã„ã†ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’ã¤ã‘ãªã„ã¨å¾Œè¿°ã® <code>#where</code> ã§ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚’åˆ©ç”¨ã—ãŸæ¤œç´¢ãŒè¡Œã‚ã‚Œã¾ã›ã‚“ã€‚ä¸€æ—¦ã“ã‚ŒãŒç„¡ã„çŠ¶æ…‹ã§ãƒªãƒªãƒ¼ã‚¹ã¨ã—ã¦ã—ã¾ã†ã¨ã€å°„å½±ã•ã‚Œã‚‹å±æ€§ãŒé™å®šã•ã‚ŒãŸ GSI ãŒä½œæˆã•ã‚Œã¦ã—ã¾ã„ã€å®Ÿè¡Œæ™‚ã«ã‚¨ãƒ©ãƒ¼ã«ãªã‚Šã¾ã™ã€‚ãã®å ´åˆã¯ AWS ãƒãƒã‚¸ãƒ¡ãƒ³ãƒˆã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã‹ã‚‰ç›´æ¥ GSI ã‚’ä½œã‚Šç›´ã™ç¾½ç›®ã«ãªã‚Šã¾ã™ã®ã§ã”æ³¨æ„ãã ã•ã„ ğŸ™</p>\n\n<pre class=\"code\" data-lang=\"\" data-unlink>One or more parameter values were invalid: Select type ALL_ATTRIBUTES is not supported for global secondary index</pre>\n\n\n<h3 id=\"where-ã‚’ä½¿ãˆã°-GSI-ã‚’ä½¿ã£ã¦è‡ªå‹•çš„ã«ã‚¯ã‚¨ãƒªã§æ¤œç´¢ã—ã¦ãã‚Œã‚‹\"><code>#where</code> ã‚’ä½¿ãˆã° GSI ã‚’ä½¿ã£ã¦è‡ªå‹•çš„ã«ã‚¯ã‚¨ãƒªã§æ¤œç´¢ã—ã¦ãã‚Œã‚‹</h3>\n\n<p><code>#comments</code> ã¨ã„ã†ãƒ¡ã‚½ãƒƒãƒ‰ã®ä¸­ã§ <code>#where</code> ã‚’ä½¿ç”¨ã—ãŸæ¤œç´¢ãŒç™»å ´ã—ã¾ã™ãŒã€ GSI ãŒè¨­å®šã•ã‚Œã¦ã„ã‚Œã°ç‰¹åˆ¥ãªè¨˜è¿°ãŒãªãã¨ã‚‚è‡ªå‹•çš„ã«ã‚¯ã‚¨ãƒªæ¤œç´¢ãŒè¡Œã‚ã‚Œã¾ã™ã€‚</p>\n\n<pre class=\"code\" data-lang=\"\" data-unlink>UserComment.where(user_id: id)\n# =&gt; [#&lt;UserComment:0x00007f44c86183e8&gt;, ...]</pre>\n\n\n<p>å‰è¿°ã®é€šã‚Š <code>projected_attributes: :all</code> ãŒæŒ‡å®šã•ã‚Œã¦ã„ãªã„ã¨ãƒ•ãƒ«ã‚¹ã‚­ãƒ£ãƒ³ã•ã‚Œã¦ã—ã¾ã†ã®ã§ã”æ³¨æ„ãã ã•ã„ã€‚</p>\n\n<h3 id=\"æ˜‡é †é™é †ã‚’å…¥ã‚Œæ›¿ãˆãŸã„å ´åˆ\">æ˜‡é †ãƒ»é™é †ã‚’å…¥ã‚Œæ›¿ãˆãŸã„å ´åˆ</h3>\n\n<p><code>#latest_comment</code> ã¨ã„ã†ãƒ¡ã‚½ãƒƒãƒ‰å†…ã§ä½¿ç”¨ã—ã¦ã„ã¾ã™ãŒã€ <code>#scan_index_forward(false)</code> ã¨æŒ‡å®šã™ã‚‹ã¨é™é †ã§ã‚½ãƒ¼ãƒˆã•ã‚ŒãŸçŠ¶æ…‹ã§çµæœãŒè¿”ã£ã¦ãã¾ã™ã€‚æœªæŒ‡å®šã®å ´åˆã¯æ˜‡é †ã§ã‚½ãƒ¼ãƒˆã•ã‚Œã¾ã™ã€‚\nã¾ãŸã€ <code>#scan_limit(n)</code> ã¨æŒ‡å®šã™ã‚‹ã“ã¨ã§ã€å…ˆé ­ã‹ã‚‰ <code>n</code> ä»¶ã®çµæœã«é™å®šã—ã¦å–å¾—ãŒå¯èƒ½ã§ã™ã€‚<code>#latest_comment</code> ã§ã¯ã“ã‚Œã‚‰ã‚’çµ„ã¿åˆã‚ã›ã¦æœ€çµ‚ã®ã‚³ãƒ¡ãƒ³ãƒˆã‚’å–å¾—ã—ã¦ã„ã¾ã™ã€‚</p>\n\n<h1 id=\"ã¾ã¨ã‚\">ã¾ã¨ã‚</h1>\n\n<p>æœ¬ç¨¿ã§ã¯ GSI ã¨ LSI ã¨ãƒ—ãƒ©ã‚¤ãƒãƒªã‚­ãƒ¼ã®é•ã„ã€å…·ä½“çš„ãªåˆ©ç”¨ç”¨é€”ã‚’ç´¹ä»‹ã—ã¾ã—ãŸã€‚<a href=\"http://developer.feedforce.jp/entry/2017/11/04/235323\">å‰å›ã®è¨˜äº‹</a>ã§ã‚‚è§¦ã‚Œã¾ã—ãŸãŒã€ <code>dynamoid</code> ã¯åˆå›å®Ÿè¡Œæ™‚ã«ãƒ†ãƒ¼ãƒ–ãƒ«ã‚„ GSI ãŒå­˜åœ¨ã—ã¦ã„ãªã„ã¨ä½œæˆã™ã‚‹ã€ã¨ã„ã†æŒ™å‹•ã«ãªã‚‹ãŸã‚ã€å¾Œã§è¨­è¨ˆã‚’å¤‰ãˆãŸããªã£ãŸå ´åˆã« GSI ã‚„æœ€æ‚ªãƒ†ãƒ¼ãƒ–ãƒ«ã‚’ä½œã‚Šç›´ã™ç¾½ç›®ã«ãªã‚Šã¾ã™ã€‚ç‰¹ã«åˆã‚ã¦åˆ©ç”¨ã™ã‚‹å ´åˆã¯è¨­è¨ˆã®å‹˜æ‰€ã‚’æ´ã‚€ã®ãŒé›£ã—ã„ã®ã§ã€ãƒªãƒªãƒ¼ã‚¹å‰ã«å…¥å¿µã«è¨­è¨ˆã‚’è¦‹ç›´ã™ã“ã¨ã‚’ãŠå‹§ã‚ã—ã¾ã™ã€‚ãã®ç‚¹ã§ã¯ RDS ä»¥ä¸Šã«æ…é‡ãªè¨­è¨ˆãŒæ±‚ã‚ã‚‰ã‚Œã‚‹ã‚ˆã†ã«æ„Ÿã˜ã¦ã„ã¾ã™ã€‚\nè‰²ã€…ã¨æ°—ã‚’ä»˜ã‘ãªã‘ã‚Œã°ãªã‚‰ãªã„ç‚¹ã‚‚å¤šã„ã§ã™ãŒã€ä¸¦åˆ—å‹•ä½œæ€§ã¯éå¸¸ã«é«˜ã„ã®ã§ã€åˆ©ç”¨ã—ãŸããªã‚‹ã‚·ãƒ¼ãƒ³ãŒå¿…ãšå‡ºã¦ãã‚‹ã¨æ€ã„ã¾ã™ã€‚ãã®éš›ã«æœ¬ç¨¿ãŒå°‘ã—ã§ã‚‚ãŠå½¹ã«ç«‹ã¦ã°å¹¸ã„ã§ã™ ğŸ™</p>\n","contentSnippet":"ã©ã†ã‚‚ã€ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ã®ã‚µãƒˆã‚¦ãƒªãƒ§ã‚¦ã‚¹ã‚±ã§ã™ âœŒï¸('Ï‰')âœŒï¸å‰å›ã«å¼•ãç¶šãã€ Dynamoid ç¬¬3å¼¾ã§ã™ âœŒï¸('Ï‰')âœŒï¸Rails ã§ DynamoDB ã‚’åˆ©ç”¨ã™ã‚‹éš›ã® ORM ã¨ã—ã¦ dynamoid ãŒã‚ã‚Šã¾ã™ã€‚ä»Šå›ã¯ dynamoid ã‹ã‚‰ Global Secondary Index (GSI) ã‚’åˆ©ç”¨ã™ã‚‹æ–¹æ³•ã«ã¤ã„ã¦ç´¹ä»‹ã—ã¾ã™ã€‚Global Secondary Index (GSI) ã£ã¦ãªã‚“ãä»Šå›ã‚‚åç§°ã®æ•´ç†ã‚’ã—ã¦ãŠãã¾ã™GSI ã¯æ¤œç´¢ã®ãŸã‚ã®ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹Local Secondary Index (LSI) ã‚‚ã‚ã‚‹ã‚„ã§ã©ã†ã„ã†ç”¨é€”ã§ä¾¿åˆ©ãªã®ã‹Dynamoid ã§ã®åˆ©ç”¨æ–¹æ³•ãƒ†ãƒ¼ãƒ–ãƒ«å®šç¾©#where ã‚’ä½¿ãˆã° GSI ã‚’ä½¿ã£ã¦è‡ªå‹•çš„ã«ã‚¯ã‚¨ãƒªã§æ¤œç´¢ã—ã¦ãã‚Œã‚‹æ˜‡é †ãƒ»é™é †ã‚’å…¥ã‚Œæ›¿ãˆãŸã„å ´åˆã¾ã¨ã‚dynamoid ã®å°å…¥æ–¹æ³•ã«ã¤ã„ã¦ã¯ä»¥å‰æ›¸ã„ãŸã“ã¡ã‚‰ã®è¨˜äº‹ã‚’å‚è€ƒã«ã—ã¦ã¿ã¦ä¸‹ã•ã„ã€‚tech.feedforce.jpGlobal Secondary Index (GSI) ã£ã¦ãªã‚“ãä»Šå›ã‚‚åç§°ã®æ•´ç†ã‚’ã—ã¦ãŠãã¾ã™æ–‡ä¸­ã« Hash Key ã‚„ã‚‰ Range Key ã¨ã„ã†åç§°ãŒå‡ºã¦ãã¾ã™ãŒã€ç¾åœ¨ã¯åç§°ãŒç•°ãªã‚Šã¾ã™ã€‚ã—ã‹ã—ã€ dyanmoid ã§ã¯ç›¸å¤‰ã‚ã‚‰ãšæ—§åç§°ã®ã¾ã¾ (hash_key, range_key) ã§ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’æŒ‡å®šã™ã‚‹ã®ã§ã€ä»Šå›ã‚‚æœ€åˆã«å¯¾å¿œè¡¨ã‚’è¨˜è¼‰ã—ã¦ãŠãã¾ã™ã€‚ æ—§åç§°  ç¾åç§°  Hash Key  Partition Key  Range Key  Sort Key GSI ã¯æ¤œç´¢ã®ãŸã‚ã®ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹DynamoDB ã«ã¯ãƒ—ãƒ©ã‚¤ãƒãƒªã‚­ãƒ¼ã®æŒ‡å®šæ–¹æ³•ã¨ã—ã¦ã€å˜ä¸€ã® Partition Key ã‚’ä½¿ç”¨ã™ã‚‹æ–¹æ³•ã¨ã€Partition Key ã¨ Sort Key ã‚’çµ„ã¿åˆã‚ã›ã¦ä½¿ç”¨ã™ã‚‹æ–¹æ³•ãŒã‚ã‚Šã¾ã™ã€‚ã“ã‚Œã«ã¤ã„ã¦ã¯å‰å›ã®ã€range ç·¨ã€‘ã®è¨˜äº‹ã§ã‚‚è§¦ã‚Œã¾ã—ãŸã€‚developer.feedforce.jpãƒ—ãƒ©ã‚¤ãƒãƒªã‚­ãƒ¼ã«æŒ‡å®šã•ã‚ŒãŸã‚«ãƒ©ãƒ ã«å¯¾ã—ã¦ã§ã‚ã‚Œã°ã€ãƒ¬ã‚³ãƒ¼ãƒ‰ã®æŠ½å‡ºã‚„ç¯„å›²æ¤œç´¢ãªã©ãŒå®Ÿè¡Œå¯èƒ½ã¨ãªã‚‹è¨³ã§ã™ãŒã€ãƒ—ãƒ©ã‚¤ãƒãƒªã‚­ãƒ¼ã«æŒ‡å®šã•ã‚Œã¦ã„ãªã„ã‚«ãƒ©ãƒ ã«å¯¾ã—ã¦ã¯æ¤œç´¢ãŒå®Ÿè¡Œã§ããšã€ãƒ†ãƒ¼ãƒ–ãƒ«ã®ãƒ•ãƒ«ã‚¹ã‚­ãƒ£ãƒ³ã‚’å®Ÿè¡Œã™ã‚‹ã“ã¨ã«ãªã£ã¦ã—ã¾ã„éåŠ¹ç‡ã§ã™ã€‚ãã“ã§ã€åˆ¥ã®ã‚«ãƒ©ãƒ ã«å¯¾ã—ã¦ã‚‚æ¤œç´¢ã‚’è¡Œã„ãŸã„å ´åˆã¯ GSI ã‚’è¨­å®šã—ã¦ã€ãƒ•ãƒ«ã‚¹ã‚­ãƒ£ãƒ³ã™ã‚‹ã“ã¨ãªãåŠ¹ç‡çš„ã«ãƒ‡ãƒ¼ã‚¿ã‚’æŠ½å‡ºã§ãã‚‹ã‚ˆã†ã«ã—ã¾ã™ã€‚ GSI ã‚‚ãƒ—ãƒ©ã‚¤ãƒãƒªã‚­ãƒ¼ã®æŒ‡å®šã¨åŒæ§˜ã«ã€å˜ä¸€ã® Partition Key ã®ã¿ã§æŒ‡å®šã™ã‚‹ã“ã¨ã‚‚ã€ Partition Key ã¨  Sort Key ã®çµ„ã¿åˆã‚ã›ã§æŒ‡å®šã™ã‚‹ã“ã¨ã‚‚å¯èƒ½ã§ã™ã€‚ãŸã ã—ã€ ãƒ—ãƒ©ã‚¤ãƒãƒªã‚­ãƒ¼ã«ã¯ãƒ¦ãƒ‹ãƒ¼ã‚¯åˆ¶ç´„ãŒè¨­å®šã•ã‚Œã¾ã™ãŒã€ GSI ã«ã¯ãƒ¦ãƒ‹ãƒ¼ã‚¯åˆ¶ç´„ãŒå­˜åœ¨ã—ãªã„ ã®ã§ã€ãã®ç‚¹ã«ã¯æ³¨æ„ãŒå¿…è¦ã§ã™ã€‚Local Secondary Index (LSI) ã‚‚ã‚ã‚‹ã‚„ã§LSI ã® Partition Key ã¯ãƒ—ãƒ©ã‚¤ãƒãƒªã‚­ãƒ¼ã¨å…±é€šã§ã™ã€‚Sort Key ã®éƒ¨åˆ†ã ã‘åˆ¥ã«è¨­å®šã—ãŸã„å ´åˆã«ä½¿ç”¨ã—ã¾ã™ã€‚ãã®ç‚¹ã‚’é™¤ã‘ã° GSI ã¨ã‚ˆãä¼¼ã¦ã„ã¾ã™ãŒã€ã“ã¡ã‚‰ã¯ãƒ†ãƒ¼ãƒ–ãƒ«ã®ä½œæˆæ™‚ã«ã—ã‹å®šç¾©ã™ã‚‹ã“ã¨ãŒã§ããªã„ã‚ˆã†ã§ã™ã€‚ ãªãŠã€LSI ã‚‚dynamoid ã‹ã‚‰æŒ‡å®šã™ã‚‹ã“ã¨ã¯å¯èƒ½ (local_secondary_index ã‚’ä½¿ç”¨ã™ã‚‹) ã§ã™ãŒã€æœ¬ç¨¿ã§ã¯è§¦ã‚Œã¾ã›ã‚“ã€‚ã©ã†ã„ã†ç”¨é€”ã§ä¾¿åˆ©ãªã®ã‹ã‚ã¾ã‚Šè¤‡é›‘ãªãƒ†ãƒ¼ãƒ–ãƒ«è¨­è¨ˆãŒæ¨å¥¨ã•ã‚Œãªã„ DynamoDB ã§ã™ãŒã€ç°¡å˜ãªãƒ†ãƒ¼ãƒ–ãƒ«é–“ã®é–¢é€£ä»˜ã‘ã‚’è¡Œã„ãŸã„ã‚·ãƒ¼ãƒ³ãŒå‡ºã¦ãã¾ã™ã€‚è¦ªãƒ†ãƒ¼ãƒ–ãƒ«ã® ID ã‚’çµåˆã‚­ãƒ¼ã¨ã—ã¦å­ãƒ†ãƒ¼ãƒ–ãƒ«ã«è¨­å®šã—ãŸã„å ´åˆãªã©ã« GSI ã¯ä¾¿åˆ©ã§ã™ã€‚ä»¥ä¸‹ã« User Table ã¨ User Comment Table ã®ä¾‹ã‚’ç¤ºã—ã¾ã™ã€‚User Comment Table ã«ã¯è¦ªãƒ†ãƒ¼ãƒ–ãƒ«ã§ã‚ã‚‹ User Table ã® ID ãŒ GSI ã® Partition Key ã¨ã—ã¦è¨­å®šã—ã¦ã‚ã‚Šã¾ã™ã€‚ã¾ãŸã€ã‚³ãƒ¡ãƒ³ãƒˆã®æŠ•ç¨¿æ—¥æ™‚ (Posted at) ã‚’ GSI ã® Sort Key ã¨ã—ã¦è¨­å®šã—ã¦ã„ã¾ã™ã€‚ã“ã‚Œã§ User æ¯ã«æŠ•ç¨¿æ—¥æ™‚é †ã«ã‚½ãƒ¼ãƒˆã—ãŸã‚³ãƒ¡ãƒ³ãƒˆã‚’å–å¾—ã™ã‚‹ã“ã¨ãŒã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚User Table ID  name  1  John  2  Marry  3  Taro User Comment Table ID (Primary Partition Key)  User ID (GSI Partition Key)  Posted at (GSI Sort Key)  Comment  1  1  1509529916  Hello  2  1  1509530052  I am John  3  1  1509530085  How do you do?  4  2  1509523925  Thanks a lot!  5  3  1509527628  ã“ã‚“ã«ã¡ã¯  6  3  1509527101  ã©ã†ã‚‚ ã¡ãªã¿ã«ã€ãƒ—ãƒ©ã‚¤ãƒãƒªã‚­ãƒ¼ã¨ GSI ã‚’é€†ã«è¨­å®šã—ã¦ã‚‚ã»ã¼æˆç«‹ã™ã‚‹ã®ã§ã™ãŒã€å‰è¿°ã—ãŸã‚ˆã†ã« GSI ã«ã¯ãƒ¦ãƒ‹ãƒ¼ã‚¯åˆ¶ç´„ãŒå­˜åœ¨ã—ãªã„ã®ã§ã€User Comment Table ã§ã¯ ID ã‚’ãƒ—ãƒ©ã‚¤ãƒãƒªã‚­ãƒ¼ã¨ã—ã¦ã€é‡è¤‡ãŒç”Ÿã˜ãªã„ã‚ˆã†ã«è¨­å®šã—ã¦ã‚ã‚Šã¾ã™ã€‚Dynamoid ã§ã®åˆ©ç”¨æ–¹æ³•ãƒ†ãƒ¼ãƒ–ãƒ«å®šç¾©ã“ã“ã‹ã‚‰ã¯å‰è¿°ã® User Table ã¨ User Comment Table ã‚’ dynamoid ã‹ã‚‰åˆ©ç”¨ã™ã‚‹ä¾‹ã‚’ç¤ºã—ã¦ã„ãã¾ã™ã€‚class User  include Dynamoid::Document  table name: :users, key: :id  field :name, :string  # ç¾åœ¨ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«ç´ä»˜ãã‚³ãƒ¡ãƒ³ãƒˆã‚’ä½œæˆã™ã‚‹  def create_comment!(attributes = {})    attributes[:user_id] = id    UserComment.new(attributes).tap(&:save!)  end  # ç¾åœ¨ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ã‚³ãƒ¡ãƒ³ãƒˆä¸€è¦§ã‚’å–å¾—ã™ã‚‹  def comments    UserComment.where(user_id: id)  end  # ç¾åœ¨ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®æœ€çµ‚ã‚³ãƒ¡ãƒ³ãƒˆã‚’å–å¾—ã™ã‚‹  def latest_comment    comments.scan_index_forward(false).scan_limit(1).all.first  endendclass UserComment  include Dynamoid::Document  table name: :user_comments, key: :id  field :user_id, :string  field :posted_at, :datetime  global_secondary_index hash_key: :user_id,                          range_key: :posted_at,                          projected_attributes: :allendâ€» ã¡ãªã¿ã« dynamoid ã«ã¯ has_many ã‚’åˆ©ç”¨ã—ã¦é–¢é€£ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’å®Ÿç¾ã™ã‚‹æ–¹æ³•ãŒã‚ã‚‹ã®ã§ã™ãŒã€çµåˆã‚­ãƒ¼ã‚’è¦ªãƒ†ãƒ¼ãƒ–ãƒ«ã«æŒã¤è¨­è¨ˆã«ãªã‚‹ã®ãŒã‚ã¾ã‚Šå¥½ã¾ã—ããªã‹ã£ãŸã®ã§ã€è‡ªå‰ã§å®Ÿè£…ã—ã¦ã„ã¾ã™ã€‚ã„ãã¤ã‹æ³¨æ„ã™ã‚‹ç‚¹ãŒã‚ã£ã¦ã€ global_secondary_index ã§ä½¿ç”¨ã™ã‚‹ hash_key ã¨ range_key ã¯ field ã§å®šç¾©ã•ã‚Œã¦ã„ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚ã¾ãŸã€ projected_attributes: :all ã¨ã„ã†ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’ã¤ã‘ãªã„ã¨å¾Œè¿°ã® #where ã§ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚’åˆ©ç”¨ã—ãŸæ¤œç´¢ãŒè¡Œã‚ã‚Œã¾ã›ã‚“ã€‚ä¸€æ—¦ã“ã‚ŒãŒç„¡ã„çŠ¶æ…‹ã§ãƒªãƒªãƒ¼ã‚¹ã¨ã—ã¦ã—ã¾ã†ã¨ã€å°„å½±ã•ã‚Œã‚‹å±æ€§ãŒé™å®šã•ã‚ŒãŸ GSI ãŒä½œæˆã•ã‚Œã¦ã—ã¾ã„ã€å®Ÿè¡Œæ™‚ã«ã‚¨ãƒ©ãƒ¼ã«ãªã‚Šã¾ã™ã€‚ãã®å ´åˆã¯ AWS ãƒãƒã‚¸ãƒ¡ãƒ³ãƒˆã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã‹ã‚‰ç›´æ¥ GSI ã‚’ä½œã‚Šç›´ã™ç¾½ç›®ã«ãªã‚Šã¾ã™ã®ã§ã”æ³¨æ„ãã ã•ã„ ğŸ™One or more parameter values were invalid: Select type ALL_ATTRIBUTES is not supported for global secondary index#where ã‚’ä½¿ãˆã° GSI ã‚’ä½¿ã£ã¦è‡ªå‹•çš„ã«ã‚¯ã‚¨ãƒªã§æ¤œç´¢ã—ã¦ãã‚Œã‚‹#comments ã¨ã„ã†ãƒ¡ã‚½ãƒƒãƒ‰ã®ä¸­ã§ #where ã‚’ä½¿ç”¨ã—ãŸæ¤œç´¢ãŒç™»å ´ã—ã¾ã™ãŒã€ GSI ãŒè¨­å®šã•ã‚Œã¦ã„ã‚Œã°ç‰¹åˆ¥ãªè¨˜è¿°ãŒãªãã¨ã‚‚è‡ªå‹•çš„ã«ã‚¯ã‚¨ãƒªæ¤œç´¢ãŒè¡Œã‚ã‚Œã¾ã™ã€‚UserComment.where(user_id: id)# => [#<UserComment:0x00007f44c86183e8>, ...]å‰è¿°ã®é€šã‚Š projected_attributes: :all ãŒæŒ‡å®šã•ã‚Œã¦ã„ãªã„ã¨ãƒ•ãƒ«ã‚¹ã‚­ãƒ£ãƒ³ã•ã‚Œã¦ã—ã¾ã†ã®ã§ã”æ³¨æ„ãã ã•ã„ã€‚æ˜‡é †ãƒ»é™é †ã‚’å…¥ã‚Œæ›¿ãˆãŸã„å ´åˆ#latest_comment ã¨ã„ã†ãƒ¡ã‚½ãƒƒãƒ‰å†…ã§ä½¿ç”¨ã—ã¦ã„ã¾ã™ãŒã€ #scan_index_forward(false) ã¨æŒ‡å®šã™ã‚‹ã¨é™é †ã§ã‚½ãƒ¼ãƒˆã•ã‚ŒãŸçŠ¶æ…‹ã§çµæœãŒè¿”ã£ã¦ãã¾ã™ã€‚æœªæŒ‡å®šã®å ´åˆã¯æ˜‡é †ã§ã‚½ãƒ¼ãƒˆã•ã‚Œã¾ã™ã€‚ã¾ãŸã€ #scan_limit(n) ã¨æŒ‡å®šã™ã‚‹ã“ã¨ã§ã€å…ˆé ­ã‹ã‚‰ n ä»¶ã®çµæœã«é™å®šã—ã¦å–å¾—ãŒå¯èƒ½ã§ã™ã€‚#latest_comment ã§ã¯ã“ã‚Œã‚‰ã‚’çµ„ã¿åˆã‚ã›ã¦æœ€çµ‚ã®ã‚³ãƒ¡ãƒ³ãƒˆã‚’å–å¾—ã—ã¦ã„ã¾ã™ã€‚ã¾ã¨ã‚æœ¬ç¨¿ã§ã¯ GSI ã¨ LSI ã¨ãƒ—ãƒ©ã‚¤ãƒãƒªã‚­ãƒ¼ã®é•ã„ã€å…·ä½“çš„ãªåˆ©ç”¨ç”¨é€”ã‚’ç´¹ä»‹ã—ã¾ã—ãŸã€‚å‰å›ã®è¨˜äº‹ã§ã‚‚è§¦ã‚Œã¾ã—ãŸãŒã€ dynamoid ã¯åˆå›å®Ÿè¡Œæ™‚ã«ãƒ†ãƒ¼ãƒ–ãƒ«ã‚„ GSI ãŒå­˜åœ¨ã—ã¦ã„ãªã„ã¨ä½œæˆã™ã‚‹ã€ã¨ã„ã†æŒ™å‹•ã«ãªã‚‹ãŸã‚ã€å¾Œã§è¨­è¨ˆã‚’å¤‰ãˆãŸããªã£ãŸå ´åˆã« GSI ã‚„æœ€æ‚ªãƒ†ãƒ¼ãƒ–ãƒ«ã‚’ä½œã‚Šç›´ã™ç¾½ç›®ã«ãªã‚Šã¾ã™ã€‚ç‰¹ã«åˆã‚ã¦åˆ©ç”¨ã™ã‚‹å ´åˆã¯è¨­è¨ˆã®å‹˜æ‰€ã‚’æ´ã‚€ã®ãŒé›£ã—ã„ã®ã§ã€ãƒªãƒªãƒ¼ã‚¹å‰ã«å…¥å¿µã«è¨­è¨ˆã‚’è¦‹ç›´ã™ã“ã¨ã‚’ãŠå‹§ã‚ã—ã¾ã™ã€‚ãã®ç‚¹ã§ã¯ RDS ä»¥ä¸Šã«æ…é‡ãªè¨­è¨ˆãŒæ±‚ã‚ã‚‰ã‚Œã‚‹ã‚ˆã†ã«æ„Ÿã˜ã¦ã„ã¾ã™ã€‚è‰²ã€…ã¨æ°—ã‚’ä»˜ã‘ãªã‘ã‚Œã°ãªã‚‰ãªã„ç‚¹ã‚‚å¤šã„ã§ã™ãŒã€ä¸¦åˆ—å‹•ä½œæ€§ã¯éå¸¸ã«é«˜ã„ã®ã§ã€åˆ©ç”¨ã—ãŸããªã‚‹ã‚·ãƒ¼ãƒ³ãŒå¿…ãšå‡ºã¦ãã‚‹ã¨æ€ã„ã¾ã™ã€‚ãã®éš›ã«æœ¬ç¨¿ãŒå°‘ã—ã§ã‚‚ãŠå½¹ã«ç«‹ã¦ã°å¹¸ã„ã§ã™ ğŸ™","link":"https://developer.feedforce.jp/entry/2017/11/26/195509","isoDate":"2017-11-26T10:55:09.000Z","dateMiliSeconds":1511693709000,"imageUrl":"https://cdn.user.blog.st-hatena.com/default_entry_og_image/116461321/1514251518718655","authorName":"ryz310"},{"title":"Serverlessconf Tokyo 2017 ã«å‚åŠ ã—ã¦ãã¾ã—ãŸ","content":"<p>ã©ã†ã‚‚ã€ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ã®ã‚µãƒˆã‚¦ãƒªãƒ§ã‚¦ã‚¹ã‚±ã§ã™ âœŒï¸('Ï‰')âœŒï¸</p>\n\n<p>å…ˆæ—¥ã®ãŠã¨ã†ãµå…ˆç”Ÿã®è¨˜äº‹ã«ã‚‚ã‚ã£ãŸã‚ˆã†ã«ã€<a href=\"http://tokyo.serverlessconf.io/\">Serverlessconf Tokyo 2017</a> ã¨ã„ã†ã‚¤ãƒ™ãƒ³ãƒˆãŒéƒ½å†…ã§é–‹å‚¬ã•ã‚Œã¦ãŠã‚Šã¾ã—ãŸã€‚</p>\n\n<p><iframe src=\"https://hatenablog-parts.com/embed?url=http%3A%2F%2Fdeveloper.feedforce.jp%2Fentry%2F2017%2F11%2F02%2F221452\" title=\"Serverlessconf Tokyo 2017 ã§ IBM Cloud Functions ã®ã‚¢ãƒ„ã„è©±ã‚’èã„ã¦ããŸ - Feedforce Developer Blog\" class=\"embed-card embed-blogcard\" scrolling=\"no\" frameborder=\"0\" style=\"display: block; width: 100%; height: 190px; max-width: 500px; margin: 10px 0px;\"></iframe><cite class=\"hatena-citation\"><a href=\"http://developer.feedforce.jp/entry/2017/11/02/221452\">developer.feedforce.jp</a></cite></p>\n\n<p>11/3(é‡‘) ã®ãƒ¡ã‚¤ãƒ³ã‚«ãƒ³ãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹ã«ã¯å¼Šç¤¾ã‹ã‚‰ã‚‚5åã»ã©å‚åŠ ã—ã¦ãŠã‚Šã€ã¿ã‚“ãªå¤§å­¦ç”Ÿã®é ƒã®100å€ãã‚‰ã„æ„è­˜é«˜ãå‹‰å¼·ã—ã¦å‚ã‚Šã¾ã—ãŸ âœŒï¸('Ï‰')âœŒï¸\nãŠæ˜¼ã”é£¯ã«å¼å½“å‡ºãŸã®ãŒå¬‰ã—ã‹ã£ãŸã§ã™ âœŒï¸('Ï‰')âœŒï¸\nã‚ã¨ã€é¦´æŸ“ã¿ã‚ã‚‹ãƒ¡ãƒ³ãƒ„ã§ã‚«ãƒ³ãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹è¡Œãã¨ã€çµ‚ã‚ã£ã¦ã‹ã‚‰é£²ã¿ã«è¡Œã‘ã‚‹ã®ã‚‚è‰¯ã„ã§ã™ã­ âœŒï¸('Ï‰')âœŒï¸</p>\n\n<p>ã•ã¦ã€ä»Šå›ã®è¨˜äº‹ã§ã¯å½“æ—¥ã®ç™ºè¡¨å†…å®¹ã«ã¤ã„ã¦ã„ãã¤ã‹ãƒ€ã‚¤ã‚¸ã‚§ã‚¹ãƒˆã¨æ„Ÿæƒ³ã‚’æ›¸ã„ã¦ã„ããŸã„ã¨æ€ã„ã¾ã™ã€‚</p>\n\n<p>ã‚¹ãƒ©ã‚¤ãƒ‰ã¯ã“ã¡ã‚‰ã®ã‚µã‚¤ãƒˆã§ã¾ã¨ã‚ã‚‰ã‚Œã¦ã„ã‚‹ã‚ˆã†ã§å¤§å¤‰åŠ©ã‹ã‚Šã¾ã™ ğŸ™</p>\n\n<p><iframe src=\"https://hatenablog-parts.com/embed?url=http%3A%2F%2Fwww.n-novice.com%2Fentry%2F2017%2F11%2F03%2F240000\" title=\"Serverlessconf Tokyo 2017 å…¬é–‹è³‡æ–™ - ã«ã‚ã‹ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢å¥½ããªã“ã¨ã‚’æ›¸ãå‚™å¿˜éŒ²\" class=\"embed-card embed-blogcard\" scrolling=\"no\" frameborder=\"0\" style=\"display: block; width: 100%; height: 190px; max-width: 500px; margin: 10px 0px;\"></iframe><cite class=\"hatena-citation\"><a href=\"http://www.n-novice.com/entry/2017/11/03/240000\">www.n-novice.com</a></cite></p>\n\n<h1>ã‚µãƒ¼ãƒãƒ¬ã‚¹ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã«ã‚ˆã‚‹æ™‚ç³»åˆ—ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®æ§‹ç¯‰ã¨ç›£è¦–</h1>\n\n<script async class=\"speakerdeck-embed\" data-id=\"c1e5e041140945188ca5b0de4ee32f34\" data-ratio=\"1.77777777777778\" src=\"//speakerdeck.com/assets/embed.js\"></script>\n\n\n<ul>\n<li>Mackerel ã¨ã„ã†ç›£è¦–ã‚µãƒ¼ãƒ“ã‚¹ã‚’ã©ã®ã‚ˆã†ã«ç›£è¦–ãƒ»ç®¡ç†ã—ã¦ã„ã‚‹ã®ã‹ã€ã¨ã„ã†ãŠè©±</li>\n<li>æ™‚ç³»åˆ—ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®æ§‹æˆ\n\n<ul>\n<li>Kinesis Streams ã¸ä¿å­˜</li>\n<li>Lambda ã§ Redis ã¸ä¿å­˜</li>\n<li>Redis ã«ä¸€å®šä»¶æ•°æºœã¾ã£ãŸã‚‰ DynamoDB ã¸ä¿å­˜\n\n<ul>\n<li>ä¸€åº¦ Redis ã‚’æŒŸã‚“ã§ã„ã‚‹ã®ã¯æ›¸ãè¾¼ã¿ã‚³ã‚¹ãƒˆã‚’æŠ‘ãˆã‚‹ãŸã‚</li>\n</ul>\n</li>\n<li>DyanmoDB ã® TTL ã‚’è¶…ãˆã‚‹ãƒ‡ãƒ¼ã‚¿ã¯ S3 ã¸ä¿å­˜</li>\n</ul>\n</li>\n<li>ãƒ‡ãƒ¼ã‚¿ã®å‚ç…§æ€§ã«åˆã‚ã›ã¦æ›¸ãè¾¼ã¿å…ˆã‚’å¤‰æ›´ã—ã¦ã„ã‚‹ã®ã¯ãƒŠãƒ«ãƒ›ãƒ‰</li>\n<li>ç›£è¦–ã«ã¤ã„ã¦ã¾ã¨ã‚\n\n<ul>\n<li>ãƒ¡ãƒˆãƒªãƒƒã‚¯ã‚’å¯è¦–åŒ–ã—ã¦çœºã‚ã‚ˆã†</li>\n<li>ç›£è¦–ã®åŸºç¤ã¯å¹³å¸¸çŠ¶æ…‹ã‚’çŸ¥ã‚‹ã“ã¨</li>\n<li>ç³»å…¨ä½“ã®å¯ç”¨æ€§ã‚’ç›£è¦–ã—ã‚ˆã†</li>\n</ul>\n</li>\n</ul>\n\n\n<p>Serverless ã‚’ä½¿ã£ãŸå…·ä½“çš„ãªè¨­è¨ˆä¾‹ã¨ã—ã¦ã€ã¨ã¦ã‚‚å‚è€ƒã«ãªã‚Šã¾ã™ã€‚\næ™‚ç³»åˆ—ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®å®Ÿè£…ã¨ã—ã¦ã€è¤‡æ•°ã®ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã‚’ä¸Šæ‰‹ãçµ„ã¿åˆã‚ã›ã¦è¨­è¨ˆã•ã‚Œã¦ã„ã‚‹ã®ã¯è‰²ã€…ãªã‚·ãƒ¼ãƒ³ã§å¿œç”¨ã§ãã‚‹è¨­è¨ˆä¾‹ã§ã¯ãªã„ã§ã—ã‚‡ã†ã‹ã€‚</p>\n\n<h1>Java ãƒãƒ¼ãƒ ãŒé¸æŠã—ãŸTypeScript ã«ã‚ˆã‚‹ AWS Lambda é–‹ç™º</h1>\n\n<p><a href=\"http://riotz.works/slides/?2017-serverless-conf\">Slides | Riotz Works</a></p>\n\n<ul>\n<li>å›ºå®š IP ã‚’å®Ÿç¾ã™ã‚‹ã«ã¯ VPC lambda ãŒå¿…è¦\n\n<ul>\n<li>VPC ã® lambda ã¯ã™ã”ãé…ã„</li>\n<li>å›ºå®š IP ã«å¯¾ã™ã‚‹éœ€è¦ã¯ç¾åœ¨ã‚‚ä¸€å®šæ•°ã‚ã‚‹ã‚ˆã†ãªã®ã§ã€‚ã€‚ã€‚ï¼ˆæ—¥æœ¬ã§ã¯ç‰¹ã«ï¼‰</li>\n</ul>\n</li>\n<li>ãƒã‚¤ã‚¯ãƒ­åŒ–ãŒéå‰°ã§è¤‡é›‘ã«ãªã£ãŸ\n\n<ul>\n<li>ã©ã®ç¨‹åº¦ã®ç²’åº¦ã§ã‚µãƒ¼ãƒ“ã‚¹ã‚’åˆ‡ã‚Šåˆ†ã‘ã¦ã„ãã‹ã€ã¨ã„ã†ã®ã¯ç›¸å¤‰ã‚ã‚‰ãšã‚»ãƒ³ã‚¹ãŒå•ã‚ã‚Œã‚‹ãªã€ã¨ã„ã†å°è±¡</li>\n</ul>\n</li>\n<li>è¨€èªæ¯ã«å®Ÿè¡Œé€Ÿåº¦ãŒãšã„ã¶ã‚“é•ã†\n\n<ul>\n<li>ä¸€åº¦ Java ã§å®Ÿè£…ã—ã¦ã€ã‚¹ãƒ”ãƒ¼ãƒ‰ãŒå‡ºãšã« TypeScript ã§å®Ÿè£…ã—ç›´ã—ãŸ\n\n<ul>\n<li>Java ã¯åˆå›å®Ÿè¡Œæ™‚ã¯ã‚ªãƒ¼ãƒãƒ¼ãƒ˜ãƒƒãƒ‰ãŒå¤§ãã„</li>\n<li>ãƒãƒƒãƒå‡¦ç†ã®ã‚ˆã†ã«è¨ˆç®—é‡ãŒå¤šã„å‡¦ç†ã§ã‚ã‚Œã° Java ã®æ–¹ãŒé€Ÿã„ã‚ˆã†ã§ã™</li>\n<li>AWS Lambdaã®å‡¦ç†æ€§èƒ½ã‚’è¨€èªæ¯ã«æ¸¬ã£ã¦ã¿ãŸ\n\n<ul>\n<li><a href=\"http://acro-engineer.hatenablog.com/entry/2016/08/02/120000\">http://acro-engineer.hatenablog.com/entry/2016/08/02/120000</a></li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n\n\n<h1>Serverlessã®ä¸–ç•Œã«ç‰¹åˆ¥ãªã“ã¨ãªã‚“ã¦ä½•ã‚‚ãªã‹ã£ãŸ</h1>\n\n<p><iframe src=\"https://hatenablog-parts.com/embed?url=https%3A%2F%2Fslideship.com%2Fusers%2F%40marcy-terui%2Fpresentations%2F2017%2F11%2F5vUYExsSUrPbyjyjKA7J99%2F\" title=\"The mind of Serverless as a Software - Serverlessã®ä¸–ç•Œã«ç‰¹åˆ¥ãªã“ã¨ãªã‚“ã¦ä½•ã‚‚ãªã‹ã£ãŸ -\" class=\"embed-card embed-webcard\" scrolling=\"no\" frameborder=\"0\" style=\"display: block; width: 100%; height: 155px; max-width: 500px; margin: 10px 0px;\"></iframe><cite class=\"hatena-citation\"><a href=\"https://slideship.com/users/@marcy-terui/presentations/2017/11/5vUYExsSUrPbyjyjKA7J99/\">slideship.com</a></cite></p>\n\n<ul>\n<li>Serverless ã§ã‚ˆãã‚ã‚‹èª²é¡Œã¨è§£æ±º\n\n<ul>\n<li>Functionã®é©åˆ‡ãªåˆ†å‰²ãƒ»çµ±åˆ</li>\n<li>Functionã‚„ã‚µãƒ¼ãƒ“ã‚¹é–“ã®ãƒ‡ãƒ¼ã‚¿ã®å—ã‘æ¸¡ã—</li>\n<li>å¤–éƒ¨ã‚µãƒ¼ãƒ“ã‚¹ã®å‘¼ã³å‡ºã—ã¨ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°</li>\n<li>ãƒ†ã‚¹ãƒˆ</li>\n</ul>\n</li>\n<li>ã‚¹ãƒ©ã‚¤ãƒ‰ã«è‰²ã€…ãª Tips ãŒè©³ã—ãæ›¸ã‹ã‚Œã¦ã„ã‚‹ã®ã§ä¸€èª­ã™ã‚‹ã¨å‰\n\n<ul>\n<li>ãŸã ã€ç´¹ä»‹ã•ã‚Œã¦ã„ã‚‹æ–¹æ³•ã ã¨ Lambda Function ã®ç²’åº¦ãŒã‹ãªã‚Šç´°ã‹ããªã‚‹ã®ã§ã€ãã®è¾ºã®ç®¡ç†ã¯å¤§ä¸ˆå¤«ãªã®ã‹æ°—ã«ãªã‚Šã¾ã—ãŸ</li>\n<li>ãƒã‚¤ã‚¯ãƒ­åŒ–ã—ã™ãå•é¡Œã¨ã‹ã¯å¤§ä¸ˆå¤«ã§ã—ã‚‡ã†ã‹ï¼Ÿ</li>\n</ul>\n</li>\n<li>ã©ã†ã„ã†ã‚µãƒ¼ãƒ“ã‚¹ãŒ Serverless ã«å‘ã„ã¦ã„ã‚‹ã®ã‹ã€ã¨ã„ã†è©±ã‚‚å‡ºã¦ãã‚‹ã®ã§å‚è€ƒã«ãªã‚Šã¾ã™\n\n<ul>\n<li>å€‹äººçš„ã«ã¯ç‰¹æ€§ã‚’æŠ¼ã•ãˆãŸä¸Šã§ã€å¾“æ¥ã® Rails ã®ã‚ˆã†ãªã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã¨ Serverless ã‚’ãƒã‚¤ãƒ–ãƒªãƒƒãƒ‰ã«çµ„ã¿åˆã‚ã›ã¦ä½¿ã†ã®ãŒè‰¯ã„ã¨è€ƒãˆã¦ã„ã¾ã™</li>\n</ul>\n</li>\n</ul>\n\n\n<h1>Serverlessã¨ã‹è¨€ã†å‰ã«çŸ¥ã£ã¦ã»ã—ã„DBã®ã“ã¨</h1>\n\n<p><iframe src=\"https://hatenablog-parts.com/embed?url=https%3A%2F%2Fslideship.com%2Fusers%2F%40marcy-terui%2Fpresentations%2F2017%2F11%2FNV8cP63mxs1tLw4qkct7Xd%2F\" title=\"Serverlessã¨ã‹è¨€ã†å‰ã«çŸ¥ã£ã¦ã»ã—ã„DBã®ã“ã¨\" class=\"embed-card embed-webcard\" scrolling=\"no\" frameborder=\"0\" style=\"display: block; width: 100%; height: 155px; max-width: 500px; margin: 10px 0px;\"></iframe><cite class=\"hatena-citation\"><a href=\"https://slideship.com/users/@marcy-terui/presentations/2017/11/NV8cP63mxs1tLw4qkct7Xd/\">slideship.com</a></cite></p>\n\n<ul>\n<li>ä¸€å€‹å‰ã®ã¨åŒã˜ç™»å£‡è€…ã®æ–¹\n\n<ul>\n<li>ã“ã¡ã‚‰ã¯ DB ã«ã¤ã„ã¦ã® tips</li>\n<li>ã„ã„æ„Ÿã˜ã«ç…½ã‚‰ã‚Œã¦ã„ãŸã®ã§ã€æ¥é€±å¼Šç¤¾ã§é–‹å‚¬ã•ã‚Œã‚‹ <a href=\"http://developer.feedforce.jp/entry/2017/11/02/190000\">LTå¤§ä¼š</a> ã§ã‚‚ã“ã‚“ãªæ„Ÿã˜ã®ãƒãƒªã‚’æœŸå¾…ã—ã¦ã„ã¾ã™ âœŒï¸('Ï‰')âœŒï¸\n\n<ul>\n<li><a href=\"http://developer.feedforce.jp/entry/2017/11/02/190000\">&#x793E;&#x5185;LT&#x5927;&#x4F1A;&#x6E96;&#x5099;&#x4E2D; - Feedforce Developer Blog</a></li>\n</ul>\n</li>\n</ul>\n</li>\n<li>éåŒæœŸã§ä¸¦åˆ—æ•°ã‚’åˆ¶é™ã™ã‚Œã° RDS ã‚’ Lambda ã‹ã‚‰åˆ©ç”¨ã—ã¦ã‚‚å•é¡Œãªã„\n\n<ul>\n<li>åŒæ™‚æ¥ç¶šæ•°ãŒçˆ†ç™ºã—ãªã„ã‚ˆã†ã«èª¿æ•´ã—ã¦ä½¿ãˆã° OK\n\n<ul>\n<li>Lambda ã‹ã‚‰ RDS ã‚’ä½¿ã£ã¦ã¯ã„ã‘ãªã„ã€ã¨ã„ã†ã®ãŒã‚»ã‚ªãƒªãƒ¼ã ã£ãŸã®ã§ã€ä½¿ãˆã‚‹ã¨è¨€ã„åˆ‡ã‚‹äººãŒã„ãŸã®ã¯ã‚¤ãƒ³ãƒ‘ã‚¯ãƒˆã‚ã£ãŸ</li>\n<li>ã¾ã‚ç¢ºã‹ã«ã€‚ä¾‹ãˆã° AWS Aurora ã® db.r3.large ã ã¨ æœ€å¤§æ¥ç¶šæ•°ãŒ 1,000 ã‚ã‚‹\n\n<ul>\n<li><a href=\"http://docs.aws.amazon.com/ja_jp/AmazonRDS/latest/UserGuide/Aurora.Managing.html#Aurora.Managing.MaxConnections\">http://docs.aws.amazon.com/ja_jp/AmazonRDS/latest/UserGuide/Aurora.Managing.html#Aurora.Managing.MaxConnections</a></li>\n</ul>\n</li>\n<li>åŒæ™‚ã« 1,000 ã‚’è¶…ãˆã‚‹ Lambda ãŒå®Ÿè¡Œã•ã‚Œãªã‘ã‚Œã°ç†å±ˆã®ä¸Šã§ã¯å¤§ä¸ˆå¤«ãªã¯ãš</li>\n<li>ç”¨æ³•ç”¨é‡ã‚’å®ˆã£ã¦æ­£ã—ããŠä½¿ã„ãã ã•ã„ã€ã¨ã„ã†ã‚„ã¤ã‹ã€‚ã€‚</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>DynamoDB ã§ãƒ•ãƒ«ã‚¹ã‚­ãƒ£ãƒ³ã—ãŸã‚‰è² ã‘\n\n<ul>\n<li>ã“ã®è¾ºã¯æœ€è¿‘è‡ªåˆ†ã§ã‚‚å‹‰å¼·ã—ã¦ã„ãŸã®ã§å†ç¢ºèªã—ãªãŒã‚‰èã„ã¦ã„ã¾ã—ãŸï¼ˆå®£ä¼ï¼‰</li>\n</ul>\n</li>\n</ul>\n\n\n<p><iframe src=\"https://hatenablog-parts.com/embed?url=http%3A%2F%2Fdeveloper.feedforce.jp%2Fentry%2F2017%2F11%2F04%2F235323\" title=\"Dynamoid ã®ä½¿ã„æ–¹ã€range ç·¨ã€‘ - Feedforce Developer Blog\" class=\"embed-card embed-blogcard\" scrolling=\"no\" frameborder=\"0\" style=\"display: block; width: 100%; height: 190px; max-width: 500px; margin: 10px 0px;\"></iframe><cite class=\"hatena-citation\"><a href=\"http://developer.feedforce.jp/entry/2017/11/04/235323\">developer.feedforce.jp</a></cite></p>\n\n<h1>çœŸã®ã‚µãƒ¼ãƒãƒ¬ã‚¹ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒˆã¨ã‚µãƒ¼ãƒãƒ¬ã‚¹æ™‚ä»£ã®ã‚²ãƒ¼ãƒ é–‹ç™ºãƒ»é‹ç”¨</h1>\n\n<script async class=\"speakerdeck-embed\" data-id=\"100ed8972466451a8fab9450e51bb0c6\" data-ratio=\"1.77777777777778\" src=\"//speakerdeck.com/assets/embed.js\"></script>\n\n\n<p>ä»–ã®ç™ºè¡¨ã¨è¢«ã£ã¦ã—ã¾ã£ãŸã®ã§ã€å½“æ—¥ã®è¬›æ¼”ã¯è¦‹ã‚‰ã‚Œãªã‹ã£ãŸã®ã§ã™ãŒã€ãƒ–ãƒ­ã‚°ã®æ–¹ã‚’è¦‹ãŸã‚‰ã¨ã¦ã‚‚èˆˆå‘³æ·±ã„å†…å®¹ã ã£ãŸã®ã§ã”ç´¹ä»‹ã—ã¦ãŠãã¾ã™ğŸ™</p>\n\n<p><iframe src=\"https://hatenablog-parts.com/embed?url=http%3A%2F%2Fgs2.hatenablog.com%2Fentry%2F2017%2F11%2F04%2F013215\" title=\"Serverlessconf Tokyo 2017 ã«ç™»å£‡ã—ã¾ã—ãŸã€‚ãã®ã»ã‹é›‘æ„Ÿ - GS2 Blog\" class=\"embed-card embed-blogcard\" scrolling=\"no\" frameborder=\"0\" style=\"display: block; width: 100%; height: 190px; max-width: 500px; margin: 10px 0px;\"></iframe><cite class=\"hatena-citation\"><a href=\"http://gs2.hatenablog.com/entry/2017/11/04/013215\">gs2.hatenablog.com</a></cite></p>\n\n<blockquote><p>å®Ÿã¯ã€ç§ã‚‚SaaSã¯ã‚µãƒ¼ãƒãƒ¬ã‚¹ãªã®ã‹ï¼Ÿã¨ã„ã†äº‹ã«å¯¾ã—ã¦ã¯ã€ã¡ã‚‡ã£ã¨æ€ã†ã¨ã“ã‚ãŒã‚ã‚Šã¾ã™ã€‚\nç§ã¯ãƒ•ãƒ«ãƒãƒãƒ¼ã‚¸ãƒ‰ã‚µãƒ¼ãƒ“ã‚¹ã¯ã‚µãƒ¼ãƒãƒ¬ã‚¹ã ã¨æ€ã„ã¾ã™ãŒã€ãƒãƒãƒ¼ã‚¸ãƒ‰ã‚µãƒ¼ãƒ“ã‚¹ã¯ã‚µãƒ¼ãƒãƒ¬ã‚¹ã§ã¯ãªã„ã€‚ã¨æ€ã£ã¦ã„ã‚‹ãŸã‚ã§ã™ã€‚\nã¾ãŸã€åˆ¥ã®è¨€ã„æ–¹ã‚’ã™ã‚‹ã¨ã€ã‚¹ã‚±ãƒ¼ãƒ«ã«é™ç•ŒãŒã‚ã‚‹ãƒ¢ãƒã¯ã‚µãƒ¼ãƒãƒ¬ã‚¹ã§ã¯ãªã„ã€‚ã¨æ€ã£ã¦ã„ã¾ã™ã€‚\nã¤ã¾ã‚Šã€ä½¿ç”¨æ–¹æ³•ã•ãˆé–“é•ãˆãªã‘ã‚Œã°ã€Šå‹æ‰‹ã«ã€‹ã€Šç„¡é™ã«ã€‹ã‚¹ã‚±ãƒ¼ãƒ«ã™ã‚‹ãƒ•ãƒ«ãƒãƒãƒ¼ã‚¸ãƒ‰ã‚µãƒ¼ãƒ“ã‚¹ã“ããŒã‚µãƒ¼ãƒãƒ¬ã‚¹ã€‚ã¨è¨€ãˆã‚‹ã®ã§ã¯ãªã„ã‹ã€‚ã¨æ€ã£ã¦ã„ã¾ã™ã€‚</p></blockquote>\n\n<p>SaaS ã®é‹ç”¨ãƒ»é–‹ç™ºã—ã¦ã‚‹äººã ã¨çµæ§‹é‡è¦ãªãƒ†ãƒ¼ãƒãªã®ã§ã¯ãªã„ã‹ã€ã¨æ€ã„ã¾ã™ã€‚\nSaaS ãªã‚“ã ã‹ã‚‰ãƒªã‚¯ã‚¨ã‚¹ãƒˆã©ã‚“ã ã‘é€ã£ã¦ã‚‚å‘ã“ã†å´ã§è‰¯ãã«è¨ˆã‚‰ã£ã¦ãã‚Œã‚‹ã‚„ã‚ã€‚ãã†æ€ã£ã¦ãŸæ™‚æœŸãŒä¿ºã«ã‚‚ã‚ã‚Šã¾ã—ãŸ ğŸ˜‡\nã¨ã¯è¨€ãˆã€SaaS åˆ©ç”¨è€…ã‹ã‚‰ãã†è¦‹ãˆã‚‹ã‚ˆã†ãªã‚µãƒ¼ãƒ“ã‚¹ã«ã—ãŸã„ã€ã¨ã„ã†æ€ã„ã¯ã‚ã‚Šã¾ã™ã€‚SaaS åˆ©ç”¨è€…ã¨ã—ã¦ã‚‚ SaaS ã®è£å´ã®ã“ã¨ã¯ä¸€åˆ‡è€ƒãˆãšã«åˆ©ç”¨ã—ãŸã„ã¨æ€ã†ã®ã§ã€‚ã€‚\nå¼Šç¤¾ã® <a href=\"https://socialplus.jp/\">ã‚½ãƒ¼ã‚·ãƒ£ãƒ« PLUS</a> ã‚‚ SaaS ã§ã™ãŒã€åˆ©ç”¨ã—ã¦é ‚ã„ã¦ã„ã‚‹ã‚µã‚¤ãƒˆãŒã‚¤ãƒ™ãƒ³ãƒˆãªã©ã§ã‚¢ã‚¯ã‚»ã‚¹ãŒæ€¥é¨°ã™ã‚‹ã‚±ãƒ¼ã‚¹ãŒã‚ã‚Šã¾ã™ã®ã§ã€é–‹ç™ºãƒ»é‹ç”¨ã§ã¯ãã†ã„ã†ç‚¹ã«æ°—ã‚’é£ã£ã¦ã„ã¾ã™ã€‚</p>\n\n<ul>\n<li>ã‚³ãƒ¼ãƒ«ãƒ‰ã‚¹ã‚¿ãƒ¼ãƒˆå¯¾ç­–\n\n<ul>\n<li>ã‚³ãƒ¼ãƒ«ãƒ‰ã‚¹ã‚¿ãƒ¼ãƒˆã¨ã¯\n\n<ul>\n<li>Lambda ã¯åˆå›å‘¼ã³å‡ºã—æ™‚ã‚„ã—ã°ã‚‰ãå‘¼ã°ã‚Œãªã‹ã£ãŸå¾Œã«å‘¼ã°ã‚ŒãŸã¨ãã¯ response time ãŒé•·ããªã‚‹</li>\n</ul>\n</li>\n<li>1 ã¤ã® Lambda Function ã«å…¨ãƒ­ã‚¸ãƒƒã‚¯ã‚’å…¥ã‚Œã‚‹\n\n<ul>\n<li>API Gateway ã®ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆæ¯ã«ã©ã®ãƒ­ã‚¸ãƒƒã‚¯ã‚’å®Ÿè¡Œã™ã‚‹ã‹ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã§æ¸¡ã—ã¦ã„ã‚‹</li>\n<li>ã‚³ãƒ¼ãƒ«æ¯”ç‡ã®ä½ã„ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã§ã‚‚ã‚³ãƒ¼ãƒ«ãƒ‰ã‚¹ã‚¿ãƒ¼ãƒˆã‚’å›é¿ã§ãã‚‹</li>\n</ul>\n</li>\n<li>ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã§å‹•ä½œãŒå¤‰ã‚ã‚‹\n\n<ul>\n<li>Rails ã® Routing ã®ã‚ˆã†ãªã‚‚ã®ã¨ä½è—¤ã¯è§£é‡ˆã—ã¾ã—ãŸ</li>\n</ul>\n</li>\n<li>ä¸€å®šé–“éš”ã§ Lambda ã‚’èµ·ã“ã™ã‚ˆã†ã« Invoke ã•ã›ã‚‹æ–¹æ³•ã‚‚ã‚ã‚‹ãŒã€å€‹äººçš„ã«ã¯ Routing ã‚„ã‚‰ã›ã‚‹æ–¹å¼ã®æ–¹ãŒè‰¯ã„ã®ã§ã¯ãªã„ã‹ã€ã¨ã„ã†æ°—ãŒã™ã‚‹\n\n<ul>\n<li>Lambda Function ãŒå¤§é‡ã«ä½œã‚‰ã‚Œã¦ã—ã¾ã†ï¼ˆãƒã‚¤ã‚¯ãƒ­åŒ–ã—ã™ãå•é¡Œï¼‰ã¨ç®¡ç†ãŒé›£ã—ããªã‚‹ã®ã§ã¯ãªã„ã‹ã€ã¨ã„ã†æ€ã„ã‚‚ã‚ã£ã¦</li>\n<li>ã“ã®æ–¹æ³•ã¯å®Ÿéš›ã«è©¦ã—ã¦ã¿ãŸã„ã§ã™</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n\n\n<h1>æ‰€æ„Ÿ</h1>\n\n<p>Serverless ã«é™ã£ãŸã“ã¨ã§ã¯ã‚ã‚Šã¾ã›ã‚“ãŒã€è¿‘å¹´ç™»å ´ã™ã‚‹æ–°æŠ€è¡“ã¯ãƒˆãƒ¬ãƒ¼ãƒ‰ã‚ªãƒ•ãªå´é¢ãŒå¼·ã„ã‚ˆã†ã«æ„Ÿã˜ã¦ã„ã¾ã™ã€‚\nä¸€æ˜”å‰ã¯ä»Šã¾ã§ã¯è§£ã®ç„¡ã‹ã£ãŸæŠ€è¡“çš„èª²é¡Œã‚’è§£æ±ºã™ã‚‹å½¢ã§æ–°ã—ã„æŠ€è¡“ãŒç™»å ´ã™ã‚‹ã€ã¨ã„ã†ã‚±ãƒ¼ã‚¹ãŒå¤šã‹ã£ãŸã®ã§ã¯ãªã„ã§ã—ã‚‡ã†ã‹ï¼Ÿ\nå¯¾ã—ã¦ä»Šã¯ã€æ—¢å­˜ã®æŠ€è¡“ã§ã‚‚ã§ããªãã¯ãªã„ã‘ã©ã€ç‰¹å®šã®ã‚±ãƒ¼ã‚¹ã§å›°ã‚‹ã‹ã‚‰ã€ãã‚Œã‚’è§£æ±ºã™ã‚‹æ–°ã—ã„æŠ€è¡“ãŒç™»å ´ã™ã‚‹ã€ã¨ã„ã†ã‚±ãƒ¼ã‚¹ãŒå¤šã„ã‚ˆã†ãªã€‚\nãã—ã¦ã€ãã®ç‰¹å®šã®ã‚±ãƒ¼ã‚¹ã‚’è§£æ±ºã™ã‚‹ãŸã‚ã«ã€ä¸€éƒ¨ã®ã“ã¨ã¯è¨±å®¹ã—ãªã‘ã‚Œã°ãªã‚‰ãªã„ã€ã¨ã„ã†å°è±¡ã§ã™ã€‚\nï¼ˆã¾ã‚å˜ç´”ã«åƒ•ã‚‚æ­³ã‚’ã¨ã£ã¦ã€ä¿å®ˆçš„ãªè€ƒãˆæ–¹ãŒå¼·ããªã£ã¦ããŸã ã‘ãªã®ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚ã€‚ï¼‰</p>\n\n<p>ä»Šå›ã®ã‚«ãƒ³ãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹ã¯å®Ÿéš›ã®é–‹ç™ºè€…ã‹ã‚‰ã©ã†ã„ã†ãƒˆãƒ¬ãƒ¼ãƒ‰ã‚ªãƒ•ãŒã‚ã‚‹ã‹ã€ã¨ã„ã†è©±ãŒå‡ºã¦ããŸã“ã¨ã§ã€è‡ªåˆ†ã®ä¸­ã§æ”¹ã‚ã¦ Serverless ã¨å‘ãåˆã†è¦šæ‚Ÿã¨ã„ã†ã‹ã€ãƒ¢ãƒãƒ™ãƒ¼ã‚·ãƒ§ãƒ³ãŒå‡ºã¦ããŸã‚ˆã†ã«æ€ã„ã¾ã™ã€‚</p>\n\n<p>ã¨ã¯ã„ãˆã€å€‹äººçš„ã«ã¯ã€å¾“æ¥ã® Rails ã‚¢ãƒ—ãƒªã¨ Serverless ã‚’ãƒã‚¤ãƒ–ãƒªãƒƒãƒ‰ã«ä½¿ã£ãŸè¨­è¨ˆã«å–ã‚Šçµ„ã‚“ã§ã„ãã®ãŒç¾æ™‚ç‚¹ã§ã®æœ€é©è§£ã§ã¯ãªã„ã‹ã¨æ„Ÿã˜ã¦ã„ã¾ã™ã€‚\nã‚‚ã¡ã‚ã‚“ã€è¨­è¨ˆã‚’è€ƒãˆãŸä¸Šã§ Full-Serverless ãŒæœ€é©ã¨ãªã‚Œã°ã€ãã†ã„ã†ã‚¢ãƒ—ãƒªã‚’ä½œã£ã¦è¡Œãã¤ã‚‚ã‚Šã§ã™ãŒã€ãã‚Œãªã‚Šã«è¤‡é›‘ãªãƒ­ã‚¸ãƒƒã‚¯ã‚’è€ƒãˆã‚‹ã«ã¯ã¾ã  Full-Serverless ã¯æ—©ã„ã®ã§ã¯ãªã„ã‹ãªã€ã¨æ€ã„ã¾ã™ã€‚\nã‚„ã¯ã‚Šä¸¦åˆ—æ€§ã®é«˜ã•ãŒ Serverless ã®é­…åŠ›ãªã®ã§ã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®åŸºæœ¬çš„ãªéƒ¨åˆ†ã¯å¾“æ¥é€šã‚Š Rails ã§ä½œæˆã—ã¦ã€ã‚¢ã‚¯ã‚»ã‚¹æ•°ãŒæ€¥ã«ã‚¹ãƒ‘ã‚¤ã‚¯ã™ã‚‹ã‚ˆã†ãªå ´æ‰€ã‚’å±€æ‰€çš„ã« Serverless ã«ã™ã‚‹ã‚ˆã†ãªè¨­è¨ˆã‚’ã“ã‚Œã‹ã‚‰è‰²ã€…è©¦ã—ã¦ã„ã“ã†ã¨è€ƒãˆã¦ã„ã¾ã™ã€‚</p>\n\n<p>ãŸã ã€Serverless ã®ã‚³ãƒ³ã‚»ãƒ—ãƒˆã¨ã—ã¦ã¯ã€ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢é–‹ç™ºã®ç”Ÿç”£æ€§ãã®ã‚‚ã®ã‚’å‘ä¸Šã•ã›ã‚‹ã“ã¨ãŒç›®çš„ã¨ã®ã“ã¨ã ã£ãŸã®ã§ã€å°†æ¥çš„ã«ã¯ãƒã‚¤ãƒ–ãƒªãƒƒãƒ‰ã‚ˆã‚Šã‚‚ Serverless ã«æŒ¯ã‚Šåˆ‡ã£ãŸè¨­è¨ˆãŒãƒ™ã‚¹ãƒˆã«ãªã£ã¦ã„ãã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚ä»Šå¾Œã®ç™ºå±•ã«æœŸå¾…ã—ã¦ã„ã¾ã™ã€‚</p>\n","contentSnippet":"ã©ã†ã‚‚ã€ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ã®ã‚µãƒˆã‚¦ãƒªãƒ§ã‚¦ã‚¹ã‚±ã§ã™ âœŒï¸('Ï‰')âœŒï¸å…ˆæ—¥ã®ãŠã¨ã†ãµå…ˆç”Ÿã®è¨˜äº‹ã«ã‚‚ã‚ã£ãŸã‚ˆã†ã«ã€Serverlessconf Tokyo 2017 ã¨ã„ã†ã‚¤ãƒ™ãƒ³ãƒˆãŒéƒ½å†…ã§é–‹å‚¬ã•ã‚Œã¦ãŠã‚Šã¾ã—ãŸã€‚developer.feedforce.jp11/3(é‡‘) ã®ãƒ¡ã‚¤ãƒ³ã‚«ãƒ³ãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹ã«ã¯å¼Šç¤¾ã‹ã‚‰ã‚‚5åã»ã©å‚åŠ ã—ã¦ãŠã‚Šã€ã¿ã‚“ãªå¤§å­¦ç”Ÿã®é ƒã®100å€ãã‚‰ã„æ„è­˜é«˜ãå‹‰å¼·ã—ã¦å‚ã‚Šã¾ã—ãŸ âœŒï¸('Ï‰')âœŒï¸ãŠæ˜¼ã”é£¯ã«å¼å½“å‡ºãŸã®ãŒå¬‰ã—ã‹ã£ãŸã§ã™ âœŒï¸('Ï‰')âœŒï¸ã‚ã¨ã€é¦´æŸ“ã¿ã‚ã‚‹ãƒ¡ãƒ³ãƒ„ã§ã‚«ãƒ³ãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹è¡Œãã¨ã€çµ‚ã‚ã£ã¦ã‹ã‚‰é£²ã¿ã«è¡Œã‘ã‚‹ã®ã‚‚è‰¯ã„ã§ã™ã­ âœŒï¸('Ï‰')âœŒï¸ã•ã¦ã€ä»Šå›ã®è¨˜äº‹ã§ã¯å½“æ—¥ã®ç™ºè¡¨å†…å®¹ã«ã¤ã„ã¦ã„ãã¤ã‹ãƒ€ã‚¤ã‚¸ã‚§ã‚¹ãƒˆã¨æ„Ÿæƒ³ã‚’æ›¸ã„ã¦ã„ããŸã„ã¨æ€ã„ã¾ã™ã€‚ã‚¹ãƒ©ã‚¤ãƒ‰ã¯ã“ã¡ã‚‰ã®ã‚µã‚¤ãƒˆã§ã¾ã¨ã‚ã‚‰ã‚Œã¦ã„ã‚‹ã‚ˆã†ã§å¤§å¤‰åŠ©ã‹ã‚Šã¾ã™ ğŸ™www.n-novice.comã‚µãƒ¼ãƒãƒ¬ã‚¹ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã«ã‚ˆã‚‹æ™‚ç³»åˆ—ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®æ§‹ç¯‰ã¨ç›£è¦–Mackerel ã¨ã„ã†ç›£è¦–ã‚µãƒ¼ãƒ“ã‚¹ã‚’ã©ã®ã‚ˆã†ã«ç›£è¦–ãƒ»ç®¡ç†ã—ã¦ã„ã‚‹ã®ã‹ã€ã¨ã„ã†ãŠè©±æ™‚ç³»åˆ—ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®æ§‹æˆKinesis Streams ã¸ä¿å­˜Lambda ã§ Redis ã¸ä¿å­˜Redis ã«ä¸€å®šä»¶æ•°æºœã¾ã£ãŸã‚‰ DynamoDB ã¸ä¿å­˜ä¸€åº¦ Redis ã‚’æŒŸã‚“ã§ã„ã‚‹ã®ã¯æ›¸ãè¾¼ã¿ã‚³ã‚¹ãƒˆã‚’æŠ‘ãˆã‚‹ãŸã‚DyanmoDB ã® TTL ã‚’è¶…ãˆã‚‹ãƒ‡ãƒ¼ã‚¿ã¯ S3 ã¸ä¿å­˜ãƒ‡ãƒ¼ã‚¿ã®å‚ç…§æ€§ã«åˆã‚ã›ã¦æ›¸ãè¾¼ã¿å…ˆã‚’å¤‰æ›´ã—ã¦ã„ã‚‹ã®ã¯ãƒŠãƒ«ãƒ›ãƒ‰ç›£è¦–ã«ã¤ã„ã¦ã¾ã¨ã‚ãƒ¡ãƒˆãƒªãƒƒã‚¯ã‚’å¯è¦–åŒ–ã—ã¦çœºã‚ã‚ˆã†ç›£è¦–ã®åŸºç¤ã¯å¹³å¸¸çŠ¶æ…‹ã‚’çŸ¥ã‚‹ã“ã¨ç³»å…¨ä½“ã®å¯ç”¨æ€§ã‚’ç›£è¦–ã—ã‚ˆã†Serverless ã‚’ä½¿ã£ãŸå…·ä½“çš„ãªè¨­è¨ˆä¾‹ã¨ã—ã¦ã€ã¨ã¦ã‚‚å‚è€ƒã«ãªã‚Šã¾ã™ã€‚æ™‚ç³»åˆ—ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®å®Ÿè£…ã¨ã—ã¦ã€è¤‡æ•°ã®ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã‚’ä¸Šæ‰‹ãçµ„ã¿åˆã‚ã›ã¦è¨­è¨ˆã•ã‚Œã¦ã„ã‚‹ã®ã¯è‰²ã€…ãªã‚·ãƒ¼ãƒ³ã§å¿œç”¨ã§ãã‚‹è¨­è¨ˆä¾‹ã§ã¯ãªã„ã§ã—ã‚‡ã†ã‹ã€‚Java ãƒãƒ¼ãƒ ãŒé¸æŠã—ãŸTypeScript ã«ã‚ˆã‚‹ AWS Lambda é–‹ç™ºSlides | Riotz Workså›ºå®š IP ã‚’å®Ÿç¾ã™ã‚‹ã«ã¯ VPC lambda ãŒå¿…è¦VPC ã® lambda ã¯ã™ã”ãé…ã„å›ºå®š IP ã«å¯¾ã™ã‚‹éœ€è¦ã¯ç¾åœ¨ã‚‚ä¸€å®šæ•°ã‚ã‚‹ã‚ˆã†ãªã®ã§ã€‚ã€‚ã€‚ï¼ˆæ—¥æœ¬ã§ã¯ç‰¹ã«ï¼‰ãƒã‚¤ã‚¯ãƒ­åŒ–ãŒéå‰°ã§è¤‡é›‘ã«ãªã£ãŸã©ã®ç¨‹åº¦ã®ç²’åº¦ã§ã‚µãƒ¼ãƒ“ã‚¹ã‚’åˆ‡ã‚Šåˆ†ã‘ã¦ã„ãã‹ã€ã¨ã„ã†ã®ã¯ç›¸å¤‰ã‚ã‚‰ãšã‚»ãƒ³ã‚¹ãŒå•ã‚ã‚Œã‚‹ãªã€ã¨ã„ã†å°è±¡è¨€èªæ¯ã«å®Ÿè¡Œé€Ÿåº¦ãŒãšã„ã¶ã‚“é•ã†ä¸€åº¦ Java ã§å®Ÿè£…ã—ã¦ã€ã‚¹ãƒ”ãƒ¼ãƒ‰ãŒå‡ºãšã« TypeScript ã§å®Ÿè£…ã—ç›´ã—ãŸJava ã¯åˆå›å®Ÿè¡Œæ™‚ã¯ã‚ªãƒ¼ãƒãƒ¼ãƒ˜ãƒƒãƒ‰ãŒå¤§ãã„ãƒãƒƒãƒå‡¦ç†ã®ã‚ˆã†ã«è¨ˆç®—é‡ãŒå¤šã„å‡¦ç†ã§ã‚ã‚Œã° Java ã®æ–¹ãŒé€Ÿã„ã‚ˆã†ã§ã™AWS Lambdaã®å‡¦ç†æ€§èƒ½ã‚’è¨€èªæ¯ã«æ¸¬ã£ã¦ã¿ãŸhttp://acro-engineer.hatenablog.com/entry/2016/08/02/120000Serverlessã®ä¸–ç•Œã«ç‰¹åˆ¥ãªã“ã¨ãªã‚“ã¦ä½•ã‚‚ãªã‹ã£ãŸslideship.comServerless ã§ã‚ˆãã‚ã‚‹èª²é¡Œã¨è§£æ±ºFunctionã®é©åˆ‡ãªåˆ†å‰²ãƒ»çµ±åˆFunctionã‚„ã‚µãƒ¼ãƒ“ã‚¹é–“ã®ãƒ‡ãƒ¼ã‚¿ã®å—ã‘æ¸¡ã—å¤–éƒ¨ã‚µãƒ¼ãƒ“ã‚¹ã®å‘¼ã³å‡ºã—ã¨ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ãƒ†ã‚¹ãƒˆã‚¹ãƒ©ã‚¤ãƒ‰ã«è‰²ã€…ãª Tips ãŒè©³ã—ãæ›¸ã‹ã‚Œã¦ã„ã‚‹ã®ã§ä¸€èª­ã™ã‚‹ã¨å‰ãŸã ã€ç´¹ä»‹ã•ã‚Œã¦ã„ã‚‹æ–¹æ³•ã ã¨ Lambda Function ã®ç²’åº¦ãŒã‹ãªã‚Šç´°ã‹ããªã‚‹ã®ã§ã€ãã®è¾ºã®ç®¡ç†ã¯å¤§ä¸ˆå¤«ãªã®ã‹æ°—ã«ãªã‚Šã¾ã—ãŸãƒã‚¤ã‚¯ãƒ­åŒ–ã—ã™ãå•é¡Œã¨ã‹ã¯å¤§ä¸ˆå¤«ã§ã—ã‚‡ã†ã‹ï¼Ÿã©ã†ã„ã†ã‚µãƒ¼ãƒ“ã‚¹ãŒ Serverless ã«å‘ã„ã¦ã„ã‚‹ã®ã‹ã€ã¨ã„ã†è©±ã‚‚å‡ºã¦ãã‚‹ã®ã§å‚è€ƒã«ãªã‚Šã¾ã™å€‹äººçš„ã«ã¯ç‰¹æ€§ã‚’æŠ¼ã•ãˆãŸä¸Šã§ã€å¾“æ¥ã® Rails ã®ã‚ˆã†ãªã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã¨ Serverless ã‚’ãƒã‚¤ãƒ–ãƒªãƒƒãƒ‰ã«çµ„ã¿åˆã‚ã›ã¦ä½¿ã†ã®ãŒè‰¯ã„ã¨è€ƒãˆã¦ã„ã¾ã™Serverlessã¨ã‹è¨€ã†å‰ã«çŸ¥ã£ã¦ã»ã—ã„DBã®ã“ã¨slideship.comä¸€å€‹å‰ã®ã¨åŒã˜ç™»å£‡è€…ã®æ–¹ã“ã¡ã‚‰ã¯ DB ã«ã¤ã„ã¦ã® tipsã„ã„æ„Ÿã˜ã«ç…½ã‚‰ã‚Œã¦ã„ãŸã®ã§ã€æ¥é€±å¼Šç¤¾ã§é–‹å‚¬ã•ã‚Œã‚‹ LTå¤§ä¼š ã§ã‚‚ã“ã‚“ãªæ„Ÿã˜ã®ãƒãƒªã‚’æœŸå¾…ã—ã¦ã„ã¾ã™ âœŒï¸('Ï‰')âœŒï¸ç¤¾å†…LTå¤§ä¼šæº–å‚™ä¸­ - Feedforce Developer BlogéåŒæœŸã§ä¸¦åˆ—æ•°ã‚’åˆ¶é™ã™ã‚Œã° RDS ã‚’ Lambda ã‹ã‚‰åˆ©ç”¨ã—ã¦ã‚‚å•é¡Œãªã„åŒæ™‚æ¥ç¶šæ•°ãŒçˆ†ç™ºã—ãªã„ã‚ˆã†ã«èª¿æ•´ã—ã¦ä½¿ãˆã° OKLambda ã‹ã‚‰ RDS ã‚’ä½¿ã£ã¦ã¯ã„ã‘ãªã„ã€ã¨ã„ã†ã®ãŒã‚»ã‚ªãƒªãƒ¼ã ã£ãŸã®ã§ã€ä½¿ãˆã‚‹ã¨è¨€ã„åˆ‡ã‚‹äººãŒã„ãŸã®ã¯ã‚¤ãƒ³ãƒ‘ã‚¯ãƒˆã‚ã£ãŸã¾ã‚ç¢ºã‹ã«ã€‚ä¾‹ãˆã° AWS Aurora ã® db.r3.large ã ã¨ æœ€å¤§æ¥ç¶šæ•°ãŒ 1,000 ã‚ã‚‹http://docs.aws.amazon.com/ja_jp/AmazonRDS/latest/UserGuide/Aurora.Managing.html#Aurora.Managing.MaxConnectionsåŒæ™‚ã« 1,000 ã‚’è¶…ãˆã‚‹ Lambda ãŒå®Ÿè¡Œã•ã‚Œãªã‘ã‚Œã°ç†å±ˆã®ä¸Šã§ã¯å¤§ä¸ˆå¤«ãªã¯ãšç”¨æ³•ç”¨é‡ã‚’å®ˆã£ã¦æ­£ã—ããŠä½¿ã„ãã ã•ã„ã€ã¨ã„ã†ã‚„ã¤ã‹ã€‚ã€‚DynamoDB ã§ãƒ•ãƒ«ã‚¹ã‚­ãƒ£ãƒ³ã—ãŸã‚‰è² ã‘ã“ã®è¾ºã¯æœ€è¿‘è‡ªåˆ†ã§ã‚‚å‹‰å¼·ã—ã¦ã„ãŸã®ã§å†ç¢ºèªã—ãªãŒã‚‰èã„ã¦ã„ã¾ã—ãŸï¼ˆå®£ä¼ï¼‰developer.feedforce.jpçœŸã®ã‚µãƒ¼ãƒãƒ¬ã‚¹ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒˆã¨ã‚µãƒ¼ãƒãƒ¬ã‚¹æ™‚ä»£ã®ã‚²ãƒ¼ãƒ é–‹ç™ºãƒ»é‹ç”¨ä»–ã®ç™ºè¡¨ã¨è¢«ã£ã¦ã—ã¾ã£ãŸã®ã§ã€å½“æ—¥ã®è¬›æ¼”ã¯è¦‹ã‚‰ã‚Œãªã‹ã£ãŸã®ã§ã™ãŒã€ãƒ–ãƒ­ã‚°ã®æ–¹ã‚’è¦‹ãŸã‚‰ã¨ã¦ã‚‚èˆˆå‘³æ·±ã„å†…å®¹ã ã£ãŸã®ã§ã”ç´¹ä»‹ã—ã¦ãŠãã¾ã™ğŸ™gs2.hatenablog.comå®Ÿã¯ã€ç§ã‚‚SaaSã¯ã‚µãƒ¼ãƒãƒ¬ã‚¹ãªã®ã‹ï¼Ÿã¨ã„ã†äº‹ã«å¯¾ã—ã¦ã¯ã€ã¡ã‚‡ã£ã¨æ€ã†ã¨ã“ã‚ãŒã‚ã‚Šã¾ã™ã€‚ç§ã¯ãƒ•ãƒ«ãƒãƒãƒ¼ã‚¸ãƒ‰ã‚µãƒ¼ãƒ“ã‚¹ã¯ã‚µãƒ¼ãƒãƒ¬ã‚¹ã ã¨æ€ã„ã¾ã™ãŒã€ãƒãƒãƒ¼ã‚¸ãƒ‰ã‚µãƒ¼ãƒ“ã‚¹ã¯ã‚µãƒ¼ãƒãƒ¬ã‚¹ã§ã¯ãªã„ã€‚ã¨æ€ã£ã¦ã„ã‚‹ãŸã‚ã§ã™ã€‚ã¾ãŸã€åˆ¥ã®è¨€ã„æ–¹ã‚’ã™ã‚‹ã¨ã€ã‚¹ã‚±ãƒ¼ãƒ«ã«é™ç•ŒãŒã‚ã‚‹ãƒ¢ãƒã¯ã‚µãƒ¼ãƒãƒ¬ã‚¹ã§ã¯ãªã„ã€‚ã¨æ€ã£ã¦ã„ã¾ã™ã€‚ã¤ã¾ã‚Šã€ä½¿ç”¨æ–¹æ³•ã•ãˆé–“é•ãˆãªã‘ã‚Œã°ã€Šå‹æ‰‹ã«ã€‹ã€Šç„¡é™ã«ã€‹ã‚¹ã‚±ãƒ¼ãƒ«ã™ã‚‹ãƒ•ãƒ«ãƒãƒãƒ¼ã‚¸ãƒ‰ã‚µãƒ¼ãƒ“ã‚¹ã“ããŒã‚µãƒ¼ãƒãƒ¬ã‚¹ã€‚ã¨è¨€ãˆã‚‹ã®ã§ã¯ãªã„ã‹ã€‚ã¨æ€ã£ã¦ã„ã¾ã™ã€‚SaaS ã®é‹ç”¨ãƒ»é–‹ç™ºã—ã¦ã‚‹äººã ã¨çµæ§‹é‡è¦ãªãƒ†ãƒ¼ãƒãªã®ã§ã¯ãªã„ã‹ã€ã¨æ€ã„ã¾ã™ã€‚SaaS ãªã‚“ã ã‹ã‚‰ãƒªã‚¯ã‚¨ã‚¹ãƒˆã©ã‚“ã ã‘é€ã£ã¦ã‚‚å‘ã“ã†å´ã§è‰¯ãã«è¨ˆã‚‰ã£ã¦ãã‚Œã‚‹ã‚„ã‚ã€‚ãã†æ€ã£ã¦ãŸæ™‚æœŸãŒä¿ºã«ã‚‚ã‚ã‚Šã¾ã—ãŸ ğŸ˜‡ã¨ã¯è¨€ãˆã€SaaS åˆ©ç”¨è€…ã‹ã‚‰ãã†è¦‹ãˆã‚‹ã‚ˆã†ãªã‚µãƒ¼ãƒ“ã‚¹ã«ã—ãŸã„ã€ã¨ã„ã†æ€ã„ã¯ã‚ã‚Šã¾ã™ã€‚SaaS åˆ©ç”¨è€…ã¨ã—ã¦ã‚‚ SaaS ã®è£å´ã®ã“ã¨ã¯ä¸€åˆ‡è€ƒãˆãšã«åˆ©ç”¨ã—ãŸã„ã¨æ€ã†ã®ã§ã€‚ã€‚å¼Šç¤¾ã® ã‚½ãƒ¼ã‚·ãƒ£ãƒ« PLUS ã‚‚ SaaS ã§ã™ãŒã€åˆ©ç”¨ã—ã¦é ‚ã„ã¦ã„ã‚‹ã‚µã‚¤ãƒˆãŒã‚¤ãƒ™ãƒ³ãƒˆãªã©ã§ã‚¢ã‚¯ã‚»ã‚¹ãŒæ€¥é¨°ã™ã‚‹ã‚±ãƒ¼ã‚¹ãŒã‚ã‚Šã¾ã™ã®ã§ã€é–‹ç™ºãƒ»é‹ç”¨ã§ã¯ãã†ã„ã†ç‚¹ã«æ°—ã‚’é£ã£ã¦ã„ã¾ã™ã€‚ã‚³ãƒ¼ãƒ«ãƒ‰ã‚¹ã‚¿ãƒ¼ãƒˆå¯¾ç­–ã‚³ãƒ¼ãƒ«ãƒ‰ã‚¹ã‚¿ãƒ¼ãƒˆã¨ã¯Lambda ã¯åˆå›å‘¼ã³å‡ºã—æ™‚ã‚„ã—ã°ã‚‰ãå‘¼ã°ã‚Œãªã‹ã£ãŸå¾Œã«å‘¼ã°ã‚ŒãŸã¨ãã¯ response time ãŒé•·ããªã‚‹1 ã¤ã® Lambda Function ã«å…¨ãƒ­ã‚¸ãƒƒã‚¯ã‚’å…¥ã‚Œã‚‹API Gateway ã®ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆæ¯ã«ã©ã®ãƒ­ã‚¸ãƒƒã‚¯ã‚’å®Ÿè¡Œã™ã‚‹ã‹ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã§æ¸¡ã—ã¦ã„ã‚‹ã‚³ãƒ¼ãƒ«æ¯”ç‡ã®ä½ã„ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã§ã‚‚ã‚³ãƒ¼ãƒ«ãƒ‰ã‚¹ã‚¿ãƒ¼ãƒˆã‚’å›é¿ã§ãã‚‹ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã§å‹•ä½œãŒå¤‰ã‚ã‚‹Rails ã® Routing ã®ã‚ˆã†ãªã‚‚ã®ã¨ä½è—¤ã¯è§£é‡ˆã—ã¾ã—ãŸä¸€å®šé–“éš”ã§ Lambda ã‚’èµ·ã“ã™ã‚ˆã†ã« Invoke ã•ã›ã‚‹æ–¹æ³•ã‚‚ã‚ã‚‹ãŒã€å€‹äººçš„ã«ã¯ Routing ã‚„ã‚‰ã›ã‚‹æ–¹å¼ã®æ–¹ãŒè‰¯ã„ã®ã§ã¯ãªã„ã‹ã€ã¨ã„ã†æ°—ãŒã™ã‚‹Lambda Function ãŒå¤§é‡ã«ä½œã‚‰ã‚Œã¦ã—ã¾ã†ï¼ˆãƒã‚¤ã‚¯ãƒ­åŒ–ã—ã™ãå•é¡Œï¼‰ã¨ç®¡ç†ãŒé›£ã—ããªã‚‹ã®ã§ã¯ãªã„ã‹ã€ã¨ã„ã†æ€ã„ã‚‚ã‚ã£ã¦ã“ã®æ–¹æ³•ã¯å®Ÿéš›ã«è©¦ã—ã¦ã¿ãŸã„ã§ã™æ‰€æ„ŸServerless ã«é™ã£ãŸã“ã¨ã§ã¯ã‚ã‚Šã¾ã›ã‚“ãŒã€è¿‘å¹´ç™»å ´ã™ã‚‹æ–°æŠ€è¡“ã¯ãƒˆãƒ¬ãƒ¼ãƒ‰ã‚ªãƒ•ãªå´é¢ãŒå¼·ã„ã‚ˆã†ã«æ„Ÿã˜ã¦ã„ã¾ã™ã€‚ä¸€æ˜”å‰ã¯ä»Šã¾ã§ã¯è§£ã®ç„¡ã‹ã£ãŸæŠ€è¡“çš„èª²é¡Œã‚’è§£æ±ºã™ã‚‹å½¢ã§æ–°ã—ã„æŠ€è¡“ãŒç™»å ´ã™ã‚‹ã€ã¨ã„ã†ã‚±ãƒ¼ã‚¹ãŒå¤šã‹ã£ãŸã®ã§ã¯ãªã„ã§ã—ã‚‡ã†ã‹ï¼Ÿå¯¾ã—ã¦ä»Šã¯ã€æ—¢å­˜ã®æŠ€è¡“ã§ã‚‚ã§ããªãã¯ãªã„ã‘ã©ã€ç‰¹å®šã®ã‚±ãƒ¼ã‚¹ã§å›°ã‚‹ã‹ã‚‰ã€ãã‚Œã‚’è§£æ±ºã™ã‚‹æ–°ã—ã„æŠ€è¡“ãŒç™»å ´ã™ã‚‹ã€ã¨ã„ã†ã‚±ãƒ¼ã‚¹ãŒå¤šã„ã‚ˆã†ãªã€‚ãã—ã¦ã€ãã®ç‰¹å®šã®ã‚±ãƒ¼ã‚¹ã‚’è§£æ±ºã™ã‚‹ãŸã‚ã«ã€ä¸€éƒ¨ã®ã“ã¨ã¯è¨±å®¹ã—ãªã‘ã‚Œã°ãªã‚‰ãªã„ã€ã¨ã„ã†å°è±¡ã§ã™ã€‚ï¼ˆã¾ã‚å˜ç´”ã«åƒ•ã‚‚æ­³ã‚’ã¨ã£ã¦ã€ä¿å®ˆçš„ãªè€ƒãˆæ–¹ãŒå¼·ããªã£ã¦ããŸã ã‘ãªã®ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚ã€‚ï¼‰ä»Šå›ã®ã‚«ãƒ³ãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹ã¯å®Ÿéš›ã®é–‹ç™ºè€…ã‹ã‚‰ã©ã†ã„ã†ãƒˆãƒ¬ãƒ¼ãƒ‰ã‚ªãƒ•ãŒã‚ã‚‹ã‹ã€ã¨ã„ã†è©±ãŒå‡ºã¦ããŸã“ã¨ã§ã€è‡ªåˆ†ã®ä¸­ã§æ”¹ã‚ã¦ Serverless ã¨å‘ãåˆã†è¦šæ‚Ÿã¨ã„ã†ã‹ã€ãƒ¢ãƒãƒ™ãƒ¼ã‚·ãƒ§ãƒ³ãŒå‡ºã¦ããŸã‚ˆã†ã«æ€ã„ã¾ã™ã€‚ã¨ã¯ã„ãˆã€å€‹äººçš„ã«ã¯ã€å¾“æ¥ã® Rails ã‚¢ãƒ—ãƒªã¨ Serverless ã‚’ãƒã‚¤ãƒ–ãƒªãƒƒãƒ‰ã«ä½¿ã£ãŸè¨­è¨ˆã«å–ã‚Šçµ„ã‚“ã§ã„ãã®ãŒç¾æ™‚ç‚¹ã§ã®æœ€é©è§£ã§ã¯ãªã„ã‹ã¨æ„Ÿã˜ã¦ã„ã¾ã™ã€‚ã‚‚ã¡ã‚ã‚“ã€è¨­è¨ˆã‚’è€ƒãˆãŸä¸Šã§ Full-Serverless ãŒæœ€é©ã¨ãªã‚Œã°ã€ãã†ã„ã†ã‚¢ãƒ—ãƒªã‚’ä½œã£ã¦è¡Œãã¤ã‚‚ã‚Šã§ã™ãŒã€ãã‚Œãªã‚Šã«è¤‡é›‘ãªãƒ­ã‚¸ãƒƒã‚¯ã‚’è€ƒãˆã‚‹ã«ã¯ã¾ã  Full-Serverless ã¯æ—©ã„ã®ã§ã¯ãªã„ã‹ãªã€ã¨æ€ã„ã¾ã™ã€‚ã‚„ã¯ã‚Šä¸¦åˆ—æ€§ã®é«˜ã•ãŒ Serverless ã®é­…åŠ›ãªã®ã§ã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®åŸºæœ¬çš„ãªéƒ¨åˆ†ã¯å¾“æ¥é€šã‚Š Rails ã§ä½œæˆã—ã¦ã€ã‚¢ã‚¯ã‚»ã‚¹æ•°ãŒæ€¥ã«ã‚¹ãƒ‘ã‚¤ã‚¯ã™ã‚‹ã‚ˆã†ãªå ´æ‰€ã‚’å±€æ‰€çš„ã« Serverless ã«ã™ã‚‹ã‚ˆã†ãªè¨­è¨ˆã‚’ã“ã‚Œã‹ã‚‰è‰²ã€…è©¦ã—ã¦ã„ã“ã†ã¨è€ƒãˆã¦ã„ã¾ã™ã€‚ãŸã ã€Serverless ã®ã‚³ãƒ³ã‚»ãƒ—ãƒˆã¨ã—ã¦ã¯ã€ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢é–‹ç™ºã®ç”Ÿç”£æ€§ãã®ã‚‚ã®ã‚’å‘ä¸Šã•ã›ã‚‹ã“ã¨ãŒç›®çš„ã¨ã®ã“ã¨ã ã£ãŸã®ã§ã€å°†æ¥çš„ã«ã¯ãƒã‚¤ãƒ–ãƒªãƒƒãƒ‰ã‚ˆã‚Šã‚‚ Serverless ã«æŒ¯ã‚Šåˆ‡ã£ãŸè¨­è¨ˆãŒãƒ™ã‚¹ãƒˆã«ãªã£ã¦ã„ãã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚ä»Šå¾Œã®ç™ºå±•ã«æœŸå¾…ã—ã¦ã„ã¾ã™ã€‚","link":"https://developer.feedforce.jp/entry/2017/11/05/111553","isoDate":"2017-11-05T02:15:53.000Z","dateMiliSeconds":1509848153000,"imageUrl":"https://cdn-ak.f.st-hatena.com/images/fotolife/t/tmd45/20171103/20171103011524.jpg","authorName":"ryz310"},{"title":"Dynamoid ã®ä½¿ã„æ–¹ã€range ç·¨ã€‘","content":"<p>ã©ã†ã‚‚ã€ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ã®ã‚µãƒˆã‚¦ãƒªãƒ§ã‚¦ã‚¹ã‚±ã§ã™ âœŒï¸('Ï‰')âœŒï¸</p>\n\n<p>æœ€è¿‘ã“ã†ã—ã¦ <a href=\"http://developer.feedforce.jp/entry/2017/10/12/100000\">å¼Šç¤¾ã® tech ãƒ–ãƒ­ã‚°ãŒç§»è»¢ã—ãŸ</a> è¨³ã§ã™ãŒã€è‡ªç¤¾ã§ç®¡ç†ã—ã¦ã‚‹ãƒ–ãƒ­ã‚°ã ã¨æŠ•ç¨¿ãƒ•ãƒ­ãƒ¼ãŒã‚ã‚“ã©ãã•ã„ã¨åƒ•ãŒãƒœãƒ¤ã„ãŸã®ãŒç§»è»¢ç†ç”±ã®ä¸€ç«¯ã ã£ãŸã‚Šã—ã¾ã™ ğŸ˜\nã§ã‚‚ç§»è»¢ä½œæ¥­ã—ãŸã®ã¯åƒ•ã˜ã‚ƒãªãã¦ã€çƒã ã‘æŠ•ã’ã¦ã©ã£ã‹è¡Œãã¾ã—ãŸ ğŸ˜\nç§»è»¢ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™ ğŸ™‡</p>\n\n<p>ç§»è»¢ã—ã¦ä¸€ç™ºç›®ã®æŠ•ç¨¿ãªã®ã§å¼µã‚Šåˆ‡ã£ã¦å‚ã‚Šã¾ã™ ğŸ’ª</p>\n\n<p>ã•ã¦ã€Rails ã§ DynamoDB ã‚’åˆ©ç”¨ã™ã‚‹éš›ã® ORM ã¨ã—ã¦ <code>dynamoid</code> ãŒã‚ã‚Šã¾ã™ã€‚\nä»Šå›ã¯ <code>dynamoid</code> ã‹ã‚‰ Hash-Range Table (Partition Key ã¨ Sort Key ã®è¤‡åˆ) ã‚’åˆ©ç”¨ã™ã‚‹æ–¹æ³•ã«ã¤ã„ã¦ç´¹ä»‹ã—ã¾ã™ã€‚</p>\n\n<p><code>dynamoid</code> ã®å°å…¥æ–¹æ³•ã«ã¤ã„ã¦ã¯ä»¥å‰æ›¸ã„ãŸã“ã¡ã‚‰ã®è¨˜äº‹ã‚’å‚è€ƒã«ã—ã¦ã¿ã¦ä¸‹ã•ã„ã€‚</p>\n\n<p><iframe src=\"https://hatenablog-parts.com/embed?url=http%3A%2F%2Ftech.feedforce.jp%2Fdynamodb-setup-on-rails.html\" title=\"DynamoDB ã‚’ Rails ã§ä½¿ãˆã‚‹ã‚ˆã†ã«ã™ã‚‹ãŸã‚ã®ã‚ã‚Œã“ã‚Œ | feedforce Engineers&#39; blog\" class=\"embed-card embed-webcard\" scrolling=\"no\" frameborder=\"0\" style=\"display: block; width: 100%; height: 155px; max-width: 500px; margin: 10px 0px;\"></iframe><cite class=\"hatena-citation\"><a href=\"http://tech.feedforce.jp/dynamodb-setup-on-rails.html\">tech.feedforce.jp</a></cite></p>\n\n<h1>Hash-Range Table ã£ã¦ãªã‚“ã</h1>\n\n<h2>ãã®å‰ã«åç§°ã®æ•´ç†ã‚’ã—ã¦ãŠãã¾ã™</h2>\n\n<p>ã‚¿ã‚¤ãƒˆãƒ«ã« ã€range ç·¨ã€‘ã¨æ›¸ã„ã¦ã„ã‚‹ã®ã§ã™ãŒã€ã“ã‚Œã¯ Sort Key ã®äº‹ã‚’æŒ‡ã—ã¾ã™ã€‚\nã©ã†ã‚„ã‚‰ DynamoDB ã¯åˆæœŸã®é ƒã¨ç¾åœ¨ã§ä¸€éƒ¨ã®åç§°ãŒå¤‰åŒ–ã—ãŸã‚ˆã†ã§ã™ã€‚\nã—ã‹ã—ã€ <code>Dyanmoid</code> ã§ã¯ç›¸å¤‰ã‚ã‚‰ãšæ—§åç§°ã®ã¾ã¾ (<code>hash_key</code>, <code>range_key</code>) ã§ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’æŒ‡å®šã™ã‚‹ã®ã§ã€å¯¾å¿œè¡¨ã‚’è¨˜è¼‰ã—ã¦ãŠãã¾ã™ã€‚</p>\n\n<table>\n<thead>\n<tr>\n<th style=\"text-align:center;\"> æ—§åç§° </th>\n<th style=\"text-align:center;\"> ç¾åç§° </th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center;\"> Hash Key </td>\n<td style=\"text-align:center;\"> Partition Key </td>\n</tr>\n<tr>\n<td style=\"text-align:center;\"> Range Key </td>\n<td style=\"text-align:center;\"> Sort Key </td>\n</tr>\n</tbody>\n</table>\n\n\n<h2>DyanmoDB ã«ã¯ 2 ç¨®é¡ã®ãƒ—ãƒ©ã‚¤ãƒãƒªã‚­ãƒ¼ãŒã‚ã‚‹</h2>\n\n<p>ã“ã¡ã‚‰ã®ã‚¹ãƒ©ã‚¤ãƒ‰ãŒåˆ†ã‹ã‚Šã‚„ã™ã„ã®ã§ã™ãŒã€ DynamoDB ã®ãƒ†ãƒ¼ãƒ–ãƒ«å®šç¾©ã¨ã—ã¦ Hash Table ã¨ Hash-Range Table ã¨ã„ã†ã‚‚ã®ãŒã‚ã‚Šã¾ã™ã€‚</p>\n\n<iframe src=\"//www.slideshare.net/slideshow/embed_code/key/gHjtA6AS8rk0sB?startSlide=24\" width=\"595\" height=\"485\" style=\"border: 1px solid #CCC; border-width: 1px; margin-bottom: 5px; max-width: 100%;\" scrolling=\"no\" marginwidth=\"0\" marginheight=\"0\" frameborder=\"0\"> </iframe>\n\n\n\n\n<iframe src=\"//www.slideshare.net/slideshow/embed_code/key/gHjtA6AS8rk0sB?startSlide=26\" width=\"595\" height=\"485\" style=\"border: 1px solid #CCC; border-width: 1px; margin-bottom: 5px; max-width: 100%;\" scrolling=\"no\" marginwidth=\"0\" marginheight=\"0\" frameborder=\"0\"> </iframe>\n\n\n<ul>\n<li>Hash Table\n\n<ul>\n<li>Hash Key (Partition Key) ã¨ã„ã†ä¸€ã¤ã®ã‚«ãƒ©ãƒ ã®å€¤ã§ãƒ—ãƒ©ã‚¤ãƒãƒªã‚­ãƒ¼ã‚’è¡¨ç¾ã™ã‚‹ãƒ†ãƒ¼ãƒ–ãƒ«</li>\n<li>ã“ã®æ§‹æˆã ã¨ Hash Key ã¯ <strong>é‡è¤‡ã•ã›ã‚‹ã“ã¨ãŒã§ããªã„</strong></li>\n</ul>\n</li>\n<li>Hash-Range Table\n\n<ul>\n<li>Hash Key ã¨ Range Key (Partition Key,  Sort Key) ã®äºŒã¤ã®å€¤ã§ãƒ—ãƒ©ã‚¤ãƒãƒªã‚­ãƒ¼ã‚’è¡¨ç¾ã™ã‚‹</li>\n<li>Range Key ãŒç•°ãªã£ã¦ã„ã‚Œã°ã€åŒä¸€ã® Hash Key ã‚’æŒã¤ãƒ¬ã‚³ãƒ¼ãƒ‰ãŒè¤‡æ•°å­˜åœ¨ã—ã¦ã‚‚è‰¯ã„</li>\n<li>ã‚¹ã‚­ãƒ£ãƒ³ã‚ˆã‚Šé«˜é€Ÿãªã‚¯ã‚¨ãƒª <sup id=\"fnref:1\"><a href=\"#fn:1\" rel=\"footnote\">1</a></sup> ã§è¤‡æ•°ã®ãƒ¬ã‚³ãƒ¼ãƒ‰ã‚’å–å¾—ã™ã‚‹ã“ã¨ãŒå¯èƒ½\n\n<ul>\n<li>ã‚¹ã‚­ãƒ£ãƒ³ã ã¨ç‰©å‡„ãã‚³ã‚¹ãƒˆãŒé«˜ã„ã®ã§ã€åŸºæœ¬çš„ã«ã‚¯ã‚¨ãƒªã ã‘ã§ãƒ‡ãƒ¼ã‚¿å–å¾—ã§ãã‚‹ã‚ˆã†ã«è¨­è¨ˆã™ã¹ã</li>\n</ul>\n</li>\n<li>Range Key ã§ã®æ˜‡é †ãƒ»é™é †ã§ã®ã‚½ãƒ¼ãƒˆãŒå¯èƒ½</li>\n<li>Range Key ã«å¯¾ã—ã¦ã® <a href=\"http://docs.aws.amazon.com/ja_jp/amazondynamodb/latest/developerguide/Query.html#Query.KeyConditionExpressions\">ç¯„å›²æ¤œç´¢</a> ã‚‚å¯èƒ½</li>\n</ul>\n</li>\n</ul>\n\n\n<h1><code>dynamoid</code> ã§ã®åˆ©ç”¨æ–¹æ³•</h1>\n\n<h2>ãƒ†ãƒ¼ãƒ–ãƒ«å®šç¾©</h2>\n\n<pre class=\"code\" data-lang=\"\" data-unlink>class User\n  include Dynamoid::Document\n\n  table name: :users, key: :hash_key\n  range :range_key, :string # &lt;= ã“ã‚Œ\nend</pre>\n\n\n<p><code>range :(ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰å), :(ãƒ‡ãƒ¼ã‚¿å‹)</code> ã§ Range Key ã®å®šç¾©ãŒå¯èƒ½ã§ã™ã€‚\nã¡ã‚‡ã£ã¨è©¦ã›ã¦ã„ãªã„ã®ã§ã™ãŒã€AWS ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã‹ã‚‰ã ã¨ãƒ†ãƒ¼ãƒ–ãƒ«ä½œæˆæ™‚ã«ã—ã‹ Range Key (ã‚½ãƒ¼ãƒˆã‚­ãƒ¼) ã‚’å®šç¾©ã§ããªã„ã®ã§ã€æ—¢ã«å­˜åœ¨ã—ã¦ã„ã‚‹ãƒ†ãƒ¼ãƒ–ãƒ«ã«é€”ä¸­ã§ <code>range</code> ã®å®šç¾©ã‚’åŠ ãˆã¦ã‚‚å‹•ä½œã—ãªã„ã¨æ€ã„ã¾ã™ã€‚</p>\n\n<h2>ä½¿ã„æ–¹</h2>\n\n<p>Dynamoid ã«ã‚‚ ActiveRecord ã¨åŒã˜ã‚ˆã†ã« <code>#where</code> ã¨ã„ã†ãƒ¡ã‚½ãƒƒãƒ‰ãŒå®Ÿè£…ã•ã‚Œã¦ã„ã¾ã™ã€‚\nãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã§ã¯å†…éƒ¨ã§ã©ã®ã‚ˆã†ãªå‹•ãã‚’ã™ã‚‹ã®ã‹ãŒè¦‹å½“ãŸã‚‰ãªã‹ã£ãŸã®ã§ã€å®Ÿè£…ã‹ã‚‰ç¢ºèªã—ãŸã®ã§ã™ãŒã€æ¤œç´¢æ¡ä»¶ã« Hash Key ã‚„ Range Key ãŒå«ã¾ã‚Œã¦ã„ã‚‹ã‹ã©ã†ã‹ã‚’åˆ¤æ–­ã—ã¦ã€ã‚¯ã‚¨ãƒªãŒä½¿ãˆã‚‹å ´åˆã¯ã‚¯ã‚¨ãƒªã§æ¤œç´¢ã—ã¦ãã‚Œã‚‹ã‚ˆã†ã§ã™ã€‚</p>\n\n<pre class=\"code\" data-lang=\"\" data-unlink>User.where(hash_key: &#39;hash_key&#39;) # ã‚¯ã‚¨ãƒªã§æ¤œç´¢ã•ã‚Œã‚‹\nUser.where(hash_key: &#39;hash_key&#39;, range_key: &#39;range_key&#39;) # ã‚¯ã‚¨ãƒªã§æ¤œç´¢ã•ã‚Œã‚‹\nUser.where(name: &#39;name&#39;) # Hash Key ãŒç„¡ã„ã®ã§ã‚¹ã‚­ãƒ£ãƒ³ãŒå®Ÿè¡Œã•ã‚Œã‚‹</pre>\n\n\n<p>ãŸã ã—ã€å¼•æ•°ã®æŒ‡å®šæ–¹æ³•ã‚„å®šç¾©ã®ä»•æ–¹ãŒå°‘ã—ã§ã‚‚é–“é•ã£ã¦ã„ã‚‹ã¨ <code>#where</code> ã§ã‚¹ã‚­ãƒ£ãƒ³ãŒå®Ÿè¡Œã•ã‚Œã¦ã—ã¾ã£ã¦ã„ã‚‹ã‚±ãƒ¼ã‚¹ãŒã‚ã‚Šã¾ã™ã€‚æœ¬å½“ã«ã‚¯ã‚¨ãƒªæ¤œç´¢ã•ã‚Œã¦ã„ã‚‹ã‹ã€å¿µã®ãŸã‚ Rails ã®ãƒ­ã‚°å‡ºåŠ›ã‚’ç¢ºèªã—ã€ã‚¹ã‚­ãƒ£ãƒ³ãŒå®Ÿè¡Œã•ã‚Œã¦ã„ãªã„ã‹ã©ã†ã‹ç¢ºèªã™ã‚‹ã‚ˆã†ã«ã—ã¦ä¸‹ã•ã„ âš ï¸</p>\n\n<p><code>#where</code> ã®ä½¿ã„æ–¹ã¯ ActiveRecord ã¨ã»ã¼åŒã˜ã§ã™ã€‚</p>\n\n<pre class=\"code\" data-lang=\"\" data-unlink>User.where(hash_key: &#39;hash_key&#39;).all # =&gt; [#&lt;User:0x000000076ed848&gt;, #&lt;User:0x0000000779abb0&gt;, ...]\nUser.where(hash_key: &#39;hash_key&#39;).each do |user|\n  user # =&gt; #&lt;User:0x000000076ed848&gt;\nend\nUser.where(hash_key: &#39;hash_key&#39;).first # =&gt; #&lt;User:0x000000048cb050&gt;\nUser.where(hash_key: &#39;hash_key&#39;).last # =&gt; #&lt;User:0x000000048cb050&gt;</pre>\n\n\n<p>ãã—ã¦ã€ <code>range_key</code> ã«å¯¾ã—ã¦ <code>gt</code>, <code>lt</code>, <code>gte</code>, <code>lte</code>, <code>begins_with</code>, <code>between</code> ã®æ¼”ç®—å­ãŒä½¿ç”¨ã§ãã¾ã™ã€‚</p>\n\n<pre class=\"code\" data-lang=\"\" data-unlink>User.where(hash_key: &#39;hash_key&#39;, &#39;range_key.gt&#39;: 123)\nUser.where(hash_key: &#39;hash_key&#39;, &#39;range_key.lt&#39;: 123)\nUser.where(hash_key: &#39;hash_key&#39;, &#39;range_key.gte&#39;: 123)\nUser.where(hash_key: &#39;hash_key&#39;, &#39;range_key.lte&#39;: 123)\nUser.where(hash_key: &#39;hash_key&#39;, &#39;range_key.begins_with&#39;: &#39;range_&#39;)\nUser.where(hash_key: &#39;hash_key&#39;, &#39;range_key.between&#39;: [100, 200])</pre>\n\n\n<h2>ãƒãƒã‚Šãƒã‚¤ãƒ³ãƒˆ</h2>\n\n<p>ã“ã“ã‹ã‚‰ã¯ Range Key ã‚’ <code>dyanmoid</code> ã‚’ä½¿ã£ã¦ã„ã¦ãƒãƒã£ãŸç‚¹ã‚’ã„ãã¤ã‹ç´¹ä»‹ã—ãŸã„ã¨æ€ã„ã¾ã™ã€‚</p>\n\n<h3><code>range</code> ã‚’å®šç¾©ã—ã¦ã„ã‚‹ã¨ <code>#find_by_id</code> ã®å‹•ä½œãŒå¤‰ã‚ã‚‹</h3>\n\n<pre class=\"code\" data-lang=\"\" data-unlink># Hash Table ã¨ã—ã¦åˆ©ç”¨\nclass User\n  include Dynamoid::Document\n\n  table name: :users, key: :hash_key\nend\n\n# OK!\nUser.find_by_id(&#39;hash_key&#39;)\n# =&gt; #&lt;User:0x000000048cb050&gt;</pre>\n\n\n\n\n<pre class=\"code\" data-lang=\"\" data-unlink># Hash-Range Table ã¨ã—ã¦åˆ©ç”¨\nclass User\n  include Dynamoid::Document\n\n  table name: :users, key: :hash_key\n  range :range_key, :string\nend\n\n# Error!\nUser.find_by_id(&#39;hash_key&#39;)\n# =&gt; Aws::DynamoDB::Errors::ValidationException: The provided key element does not match the schema</pre>\n\n\n<p>ã‚“ã‚“ï¼Ÿï¼Ÿã£ã¦ãªã£ãŸã®ã§ã™ãŒã€ã“ã†ã„ã†äº‹ã‚‰ã—ã„ã§ã™ã€‚</p>\n\n<ul>\n<li><code>#find_by_id</code> ã¯å†…éƒ¨çš„ã«ã¯ <code>Aws::DynamoDB::Client#get_item</code> ã‚’å‘¼ã³å‡ºã—ã¦ã„ã‚‹</li>\n<li><code>#get_item</code> ã¯çµæœãŒä¸€æ„ã«å®šã¾ã‚‹æ¤œç´¢æ¡ä»¶ã‚’æŒ‡å®šã—ãªã„ã¨ã‚¨ãƒ©ãƒ¼ã«ãªã‚‹\n\n<ul>\n<li>ã¤ã¾ã‚Š <code>range_key (primary sort key)</code> ã‚’å®šç¾©ã—ã¦ã„ã‚‹å ´åˆã¯å¼•æ•°ä¸€ã¤ã ã¨ã‚¨ãƒ©ãƒ¼</li>\n<li>å¼•æ•°ã« <code>range_key</code> ã‚’æŒ‡å®šã™ã‚Œã° OK</li>\n</ul>\n</li>\n</ul>\n\n\n<pre class=\"code\" data-lang=\"\" data-unlink>Line::User.find_by_id(&#39;hash_key&#39;, range_key: &#39;range_key&#39;)\n# =&gt; #&lt;User:0x000000048cb050&gt;\n# OK!</pre>\n\n\n<h3><code>has_many</code> ã¯ Hash-Range Table ã«å¯¾å¿œã—ã¦ã„ãªã„</h3>\n\n<p><code>dynamoid</code> ã§ã¯ ActiveRecord ã®ã‚ˆã†ãª <code>has_many</code> <code>has_one</code> <code>belongs_to</code> ãŒå®šç¾©ã•ã‚Œã¦ã„ã‚‹ã®ã§ã™ãŒã€ Hash-Range Table ã ã¨ä¸Šæ‰‹ãå‹•ä½œã—ã¾ã›ã‚“ã€‚\nå†…éƒ¨ã®å®Ÿè£…ã‚’è¦‹ã¦ã¿ã¾ã—ãŸãŒã€ Hash Table ã®çŠ¶æ…‹ã§åˆ©ç”¨ã™ã‚‹ã“ã¨ãŒå‰æã¨ãªã£ã¦ã„ã‚‹ã‚ˆã†ã§ã—ãŸã€‚</p>\n\n<p>Hash Table ã§ã‚ã‚Œã°ã“ã‚“ãªæ„Ÿã˜ã§åˆ©ç”¨ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚</p>\n\n<pre class=\"code\" data-lang=\"\" data-unlink>class User\n  include Dynamoid::Document\n\n  table name: :users, key: :hash_key\n  has_many :talks, class: Talk\nend\n\nclass Talk\n  include Dynamoid::Document\n\n  table name: :talks, key: :hash_key\n  belongs_to :user, class: User\nend\n\nuser = User.create(name: &#39;Taro&#39;)\nuser.talks.create(content: &#39;Hello world&#39;)</pre>\n\n\n<h1>ã¾ã¨ã‚</h1>\n\n<p>Hash Table ã¨ Hash-Range Table ã®é•ã„ã‹ã‚‰ã€ Dynamoid ã«ãŠã‘ã‚‹å®Ÿè£…æ–¹æ³•ã«ã¤ã„ã¦ã‚’ç´¹ä»‹ã—ã¾ã—ãŸã€‚\nDynamoid ã‚’åˆ©ç”¨ã—ãŸå ´åˆã¯ migration ã‚’æ˜ç¤ºçš„ã«å®Ÿè¡Œã™ã‚‹è¨³ã§ã¯ãªã„ãŸã‚ã€Rails ã®ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã¨ DyanmoDB ã®ãƒ†ãƒ¼ãƒ–ãƒ«ã®å®Ÿæ…‹ãŒå¿…ãšã—ã‚‚ä¸€è‡´ã—ã¦ã„ãªã„ã‚±ãƒ¼ã‚¹ãŒã‚ã‚‹ç‚¹ãŒãƒãƒã‚Šã©ã“ã‚ã®ã‚ˆã†ãªæ°—ãŒã—ã¾ã™ã€‚\næœ¬ç¨¿ã§ç´¹ä»‹ã—ãŸ Hash-Range Table ãŒ DynamoDB ã¨ Dynamoid ä¸¡æ–¹ã§æ­£ã—ãè¨­å®šã•ã‚Œã¦ã„ã‚‹ã‹ã‚’ãƒªãƒªãƒ¼ã‚¹å‰ã«å…¥å¿µã«ãƒã‚§ãƒƒã‚¯ã—ãŸæ–¹ãŒè‰¯ã„ã§ã—ã‚‡ã†ã€‚</p>\n<div class=\"footnotes\">\n<hr/>\n<ol>\n<li id=\"fn:1\">\n<p><a href=\"http://docs.aws.amazon.com/ja_jp/amazondynamodb/latest/developerguide/QueryAndScanGuidelines.html\">ã‚¯ã‚¨ãƒªã¨ã‚¹ã‚­ãƒ£ãƒ³ã®ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¯ã‚¹</a><a href=\"#fnref:1\" rev=\"footnote\">&#8617;</a></p></li>\n</ol>\n</div>\n\n","contentSnippet":"ã©ã†ã‚‚ã€ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ã®ã‚µãƒˆã‚¦ãƒªãƒ§ã‚¦ã‚¹ã‚±ã§ã™ âœŒï¸('Ï‰')âœŒï¸æœ€è¿‘ã“ã†ã—ã¦ å¼Šç¤¾ã® tech ãƒ–ãƒ­ã‚°ãŒç§»è»¢ã—ãŸ è¨³ã§ã™ãŒã€è‡ªç¤¾ã§ç®¡ç†ã—ã¦ã‚‹ãƒ–ãƒ­ã‚°ã ã¨æŠ•ç¨¿ãƒ•ãƒ­ãƒ¼ãŒã‚ã‚“ã©ãã•ã„ã¨åƒ•ãŒãƒœãƒ¤ã„ãŸã®ãŒç§»è»¢ç†ç”±ã®ä¸€ç«¯ã ã£ãŸã‚Šã—ã¾ã™ ğŸ˜ã§ã‚‚ç§»è»¢ä½œæ¥­ã—ãŸã®ã¯åƒ•ã˜ã‚ƒãªãã¦ã€çƒã ã‘æŠ•ã’ã¦ã©ã£ã‹è¡Œãã¾ã—ãŸ ğŸ˜ç§»è»¢ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™ ğŸ™‡ç§»è»¢ã—ã¦ä¸€ç™ºç›®ã®æŠ•ç¨¿ãªã®ã§å¼µã‚Šåˆ‡ã£ã¦å‚ã‚Šã¾ã™ ğŸ’ªã•ã¦ã€Rails ã§ DynamoDB ã‚’åˆ©ç”¨ã™ã‚‹éš›ã® ORM ã¨ã—ã¦ dynamoid ãŒã‚ã‚Šã¾ã™ã€‚ä»Šå›ã¯ dynamoid ã‹ã‚‰ Hash-Range Table (Partition Key ã¨ Sort Key ã®è¤‡åˆ) ã‚’åˆ©ç”¨ã™ã‚‹æ–¹æ³•ã«ã¤ã„ã¦ç´¹ä»‹ã—ã¾ã™ã€‚dynamoid ã®å°å…¥æ–¹æ³•ã«ã¤ã„ã¦ã¯ä»¥å‰æ›¸ã„ãŸã“ã¡ã‚‰ã®è¨˜äº‹ã‚’å‚è€ƒã«ã—ã¦ã¿ã¦ä¸‹ã•ã„ã€‚tech.feedforce.jpHash-Range Table ã£ã¦ãªã‚“ããã®å‰ã«åç§°ã®æ•´ç†ã‚’ã—ã¦ãŠãã¾ã™ã‚¿ã‚¤ãƒˆãƒ«ã« ã€range ç·¨ã€‘ã¨æ›¸ã„ã¦ã„ã‚‹ã®ã§ã™ãŒã€ã“ã‚Œã¯ Sort Key ã®äº‹ã‚’æŒ‡ã—ã¾ã™ã€‚ã©ã†ã‚„ã‚‰ DynamoDB ã¯åˆæœŸã®é ƒã¨ç¾åœ¨ã§ä¸€éƒ¨ã®åç§°ãŒå¤‰åŒ–ã—ãŸã‚ˆã†ã§ã™ã€‚ã—ã‹ã—ã€ Dyanmoid ã§ã¯ç›¸å¤‰ã‚ã‚‰ãšæ—§åç§°ã®ã¾ã¾ (hash_key, range_key) ã§ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’æŒ‡å®šã™ã‚‹ã®ã§ã€å¯¾å¿œè¡¨ã‚’è¨˜è¼‰ã—ã¦ãŠãã¾ã™ã€‚ æ—§åç§°  ç¾åç§°  Hash Key  Partition Key  Range Key  Sort Key DyanmoDB ã«ã¯ 2 ç¨®é¡ã®ãƒ—ãƒ©ã‚¤ãƒãƒªã‚­ãƒ¼ãŒã‚ã‚‹ã“ã¡ã‚‰ã®ã‚¹ãƒ©ã‚¤ãƒ‰ãŒåˆ†ã‹ã‚Šã‚„ã™ã„ã®ã§ã™ãŒã€ DynamoDB ã®ãƒ†ãƒ¼ãƒ–ãƒ«å®šç¾©ã¨ã—ã¦ Hash Table ã¨ Hash-Range Table ã¨ã„ã†ã‚‚ã®ãŒã‚ã‚Šã¾ã™ã€‚  Hash TableHash Key (Partition Key) ã¨ã„ã†ä¸€ã¤ã®ã‚«ãƒ©ãƒ ã®å€¤ã§ãƒ—ãƒ©ã‚¤ãƒãƒªã‚­ãƒ¼ã‚’è¡¨ç¾ã™ã‚‹ãƒ†ãƒ¼ãƒ–ãƒ«ã“ã®æ§‹æˆã ã¨ Hash Key ã¯ é‡è¤‡ã•ã›ã‚‹ã“ã¨ãŒã§ããªã„Hash-Range TableHash Key ã¨ Range Key (Partition Key,  Sort Key) ã®äºŒã¤ã®å€¤ã§ãƒ—ãƒ©ã‚¤ãƒãƒªã‚­ãƒ¼ã‚’è¡¨ç¾ã™ã‚‹Range Key ãŒç•°ãªã£ã¦ã„ã‚Œã°ã€åŒä¸€ã® Hash Key ã‚’æŒã¤ãƒ¬ã‚³ãƒ¼ãƒ‰ãŒè¤‡æ•°å­˜åœ¨ã—ã¦ã‚‚è‰¯ã„ã‚¹ã‚­ãƒ£ãƒ³ã‚ˆã‚Šé«˜é€Ÿãªã‚¯ã‚¨ãƒª 1 ã§è¤‡æ•°ã®ãƒ¬ã‚³ãƒ¼ãƒ‰ã‚’å–å¾—ã™ã‚‹ã“ã¨ãŒå¯èƒ½ã‚¹ã‚­ãƒ£ãƒ³ã ã¨ç‰©å‡„ãã‚³ã‚¹ãƒˆãŒé«˜ã„ã®ã§ã€åŸºæœ¬çš„ã«ã‚¯ã‚¨ãƒªã ã‘ã§ãƒ‡ãƒ¼ã‚¿å–å¾—ã§ãã‚‹ã‚ˆã†ã«è¨­è¨ˆã™ã¹ãRange Key ã§ã®æ˜‡é †ãƒ»é™é †ã§ã®ã‚½ãƒ¼ãƒˆãŒå¯èƒ½Range Key ã«å¯¾ã—ã¦ã® ç¯„å›²æ¤œç´¢ ã‚‚å¯èƒ½dynamoid ã§ã®åˆ©ç”¨æ–¹æ³•ãƒ†ãƒ¼ãƒ–ãƒ«å®šç¾©class User  include Dynamoid::Document  table name: :users, key: :hash_key  range :range_key, :string # <= ã“ã‚Œendrange :(ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰å), :(ãƒ‡ãƒ¼ã‚¿å‹) ã§ Range Key ã®å®šç¾©ãŒå¯èƒ½ã§ã™ã€‚ã¡ã‚‡ã£ã¨è©¦ã›ã¦ã„ãªã„ã®ã§ã™ãŒã€AWS ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã‹ã‚‰ã ã¨ãƒ†ãƒ¼ãƒ–ãƒ«ä½œæˆæ™‚ã«ã—ã‹ Range Key (ã‚½ãƒ¼ãƒˆã‚­ãƒ¼) ã‚’å®šç¾©ã§ããªã„ã®ã§ã€æ—¢ã«å­˜åœ¨ã—ã¦ã„ã‚‹ãƒ†ãƒ¼ãƒ–ãƒ«ã«é€”ä¸­ã§ range ã®å®šç¾©ã‚’åŠ ãˆã¦ã‚‚å‹•ä½œã—ãªã„ã¨æ€ã„ã¾ã™ã€‚ä½¿ã„æ–¹Dynamoid ã«ã‚‚ ActiveRecord ã¨åŒã˜ã‚ˆã†ã« #where ã¨ã„ã†ãƒ¡ã‚½ãƒƒãƒ‰ãŒå®Ÿè£…ã•ã‚Œã¦ã„ã¾ã™ã€‚ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã§ã¯å†…éƒ¨ã§ã©ã®ã‚ˆã†ãªå‹•ãã‚’ã™ã‚‹ã®ã‹ãŒè¦‹å½“ãŸã‚‰ãªã‹ã£ãŸã®ã§ã€å®Ÿè£…ã‹ã‚‰ç¢ºèªã—ãŸã®ã§ã™ãŒã€æ¤œç´¢æ¡ä»¶ã« Hash Key ã‚„ Range Key ãŒå«ã¾ã‚Œã¦ã„ã‚‹ã‹ã©ã†ã‹ã‚’åˆ¤æ–­ã—ã¦ã€ã‚¯ã‚¨ãƒªãŒä½¿ãˆã‚‹å ´åˆã¯ã‚¯ã‚¨ãƒªã§æ¤œç´¢ã—ã¦ãã‚Œã‚‹ã‚ˆã†ã§ã™ã€‚User.where(hash_key: 'hash_key') # ã‚¯ã‚¨ãƒªã§æ¤œç´¢ã•ã‚Œã‚‹User.where(hash_key: 'hash_key', range_key: 'range_key') # ã‚¯ã‚¨ãƒªã§æ¤œç´¢ã•ã‚Œã‚‹User.where(name: 'name') # Hash Key ãŒç„¡ã„ã®ã§ã‚¹ã‚­ãƒ£ãƒ³ãŒå®Ÿè¡Œã•ã‚Œã‚‹ãŸã ã—ã€å¼•æ•°ã®æŒ‡å®šæ–¹æ³•ã‚„å®šç¾©ã®ä»•æ–¹ãŒå°‘ã—ã§ã‚‚é–“é•ã£ã¦ã„ã‚‹ã¨ #where ã§ã‚¹ã‚­ãƒ£ãƒ³ãŒå®Ÿè¡Œã•ã‚Œã¦ã—ã¾ã£ã¦ã„ã‚‹ã‚±ãƒ¼ã‚¹ãŒã‚ã‚Šã¾ã™ã€‚æœ¬å½“ã«ã‚¯ã‚¨ãƒªæ¤œç´¢ã•ã‚Œã¦ã„ã‚‹ã‹ã€å¿µã®ãŸã‚ Rails ã®ãƒ­ã‚°å‡ºåŠ›ã‚’ç¢ºèªã—ã€ã‚¹ã‚­ãƒ£ãƒ³ãŒå®Ÿè¡Œã•ã‚Œã¦ã„ãªã„ã‹ã©ã†ã‹ç¢ºèªã™ã‚‹ã‚ˆã†ã«ã—ã¦ä¸‹ã•ã„ âš ï¸#where ã®ä½¿ã„æ–¹ã¯ ActiveRecord ã¨ã»ã¼åŒã˜ã§ã™ã€‚User.where(hash_key: 'hash_key').all # => [#<User:0x000000076ed848>, #<User:0x0000000779abb0>, ...]User.where(hash_key: 'hash_key').each do |user|  user # => #<User:0x000000076ed848>endUser.where(hash_key: 'hash_key').first # => #<User:0x000000048cb050>User.where(hash_key: 'hash_key').last # => #<User:0x000000048cb050>ãã—ã¦ã€ range_key ã«å¯¾ã—ã¦ gt, lt, gte, lte, begins_with, between ã®æ¼”ç®—å­ãŒä½¿ç”¨ã§ãã¾ã™ã€‚User.where(hash_key: 'hash_key', 'range_key.gt': 123)User.where(hash_key: 'hash_key', 'range_key.lt': 123)User.where(hash_key: 'hash_key', 'range_key.gte': 123)User.where(hash_key: 'hash_key', 'range_key.lte': 123)User.where(hash_key: 'hash_key', 'range_key.begins_with': 'range_')User.where(hash_key: 'hash_key', 'range_key.between': [100, 200])ãƒãƒã‚Šãƒã‚¤ãƒ³ãƒˆã“ã“ã‹ã‚‰ã¯ Range Key ã‚’ dyanmoid ã‚’ä½¿ã£ã¦ã„ã¦ãƒãƒã£ãŸç‚¹ã‚’ã„ãã¤ã‹ç´¹ä»‹ã—ãŸã„ã¨æ€ã„ã¾ã™ã€‚range ã‚’å®šç¾©ã—ã¦ã„ã‚‹ã¨ #find_by_id ã®å‹•ä½œãŒå¤‰ã‚ã‚‹# Hash Table ã¨ã—ã¦åˆ©ç”¨class User  include Dynamoid::Document  table name: :users, key: :hash_keyend# OK!User.find_by_id('hash_key')# => #<User:0x000000048cb050># Hash-Range Table ã¨ã—ã¦åˆ©ç”¨class User  include Dynamoid::Document  table name: :users, key: :hash_key  range :range_key, :stringend# Error!User.find_by_id('hash_key')# => Aws::DynamoDB::Errors::ValidationException: The provided key element does not match the schemaã‚“ã‚“ï¼Ÿï¼Ÿã£ã¦ãªã£ãŸã®ã§ã™ãŒã€ã“ã†ã„ã†äº‹ã‚‰ã—ã„ã§ã™ã€‚#find_by_id ã¯å†…éƒ¨çš„ã«ã¯ Aws::DynamoDB::Client#get_item ã‚’å‘¼ã³å‡ºã—ã¦ã„ã‚‹#get_item ã¯çµæœãŒä¸€æ„ã«å®šã¾ã‚‹æ¤œç´¢æ¡ä»¶ã‚’æŒ‡å®šã—ãªã„ã¨ã‚¨ãƒ©ãƒ¼ã«ãªã‚‹ã¤ã¾ã‚Š range_key (primary sort key) ã‚’å®šç¾©ã—ã¦ã„ã‚‹å ´åˆã¯å¼•æ•°ä¸€ã¤ã ã¨ã‚¨ãƒ©ãƒ¼å¼•æ•°ã« range_key ã‚’æŒ‡å®šã™ã‚Œã° OKLine::User.find_by_id('hash_key', range_key: 'range_key')# => #<User:0x000000048cb050># OK!has_many ã¯ Hash-Range Table ã«å¯¾å¿œã—ã¦ã„ãªã„dynamoid ã§ã¯ ActiveRecord ã®ã‚ˆã†ãª has_many has_one belongs_to ãŒå®šç¾©ã•ã‚Œã¦ã„ã‚‹ã®ã§ã™ãŒã€ Hash-Range Table ã ã¨ä¸Šæ‰‹ãå‹•ä½œã—ã¾ã›ã‚“ã€‚å†…éƒ¨ã®å®Ÿè£…ã‚’è¦‹ã¦ã¿ã¾ã—ãŸãŒã€ Hash Table ã®çŠ¶æ…‹ã§åˆ©ç”¨ã™ã‚‹ã“ã¨ãŒå‰æã¨ãªã£ã¦ã„ã‚‹ã‚ˆã†ã§ã—ãŸã€‚Hash Table ã§ã‚ã‚Œã°ã“ã‚“ãªæ„Ÿã˜ã§åˆ©ç”¨ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚class User  include Dynamoid::Document  table name: :users, key: :hash_key  has_many :talks, class: Talkendclass Talk  include Dynamoid::Document  table name: :talks, key: :hash_key  belongs_to :user, class: Userenduser = User.create(name: 'Taro')user.talks.create(content: 'Hello world')ã¾ã¨ã‚Hash Table ã¨ Hash-Range Table ã®é•ã„ã‹ã‚‰ã€ Dynamoid ã«ãŠã‘ã‚‹å®Ÿè£…æ–¹æ³•ã«ã¤ã„ã¦ã‚’ç´¹ä»‹ã—ã¾ã—ãŸã€‚Dynamoid ã‚’åˆ©ç”¨ã—ãŸå ´åˆã¯ migration ã‚’æ˜ç¤ºçš„ã«å®Ÿè¡Œã™ã‚‹è¨³ã§ã¯ãªã„ãŸã‚ã€Rails ã®ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã¨ DyanmoDB ã®ãƒ†ãƒ¼ãƒ–ãƒ«ã®å®Ÿæ…‹ãŒå¿…ãšã—ã‚‚ä¸€è‡´ã—ã¦ã„ãªã„ã‚±ãƒ¼ã‚¹ãŒã‚ã‚‹ç‚¹ãŒãƒãƒã‚Šã©ã“ã‚ã®ã‚ˆã†ãªæ°—ãŒã—ã¾ã™ã€‚æœ¬ç¨¿ã§ç´¹ä»‹ã—ãŸ Hash-Range Table ãŒ DynamoDB ã¨ Dynamoid ä¸¡æ–¹ã§æ­£ã—ãè¨­å®šã•ã‚Œã¦ã„ã‚‹ã‹ã‚’ãƒªãƒªãƒ¼ã‚¹å‰ã«å…¥å¿µã«ãƒã‚§ãƒƒã‚¯ã—ãŸæ–¹ãŒè‰¯ã„ã§ã—ã‚‡ã†ã€‚ã‚¯ã‚¨ãƒªã¨ã‚¹ã‚­ãƒ£ãƒ³ã®ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¯ã‚¹â†©","link":"https://developer.feedforce.jp/entry/2017/11/04/235323","isoDate":"2017-11-04T14:53:23.000Z","dateMiliSeconds":1509807203000,"imageUrl":"https://cdn.user.blog.st-hatena.com/default_entry_og_image/116461321/1514251518718655","authorName":"ryz310"}]},"__N_SSG":true}