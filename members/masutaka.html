<!DOCTYPE html><html><head><meta name="viewport" content="width=device-width"/><meta charSet="utf-8"/><link rel="icon shortcut" type="image/png" href="https://engineers.feedforce.jp/logo.png"/><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700&amp;display=swap"/><title>masutaka | Feedforce Engineers&#x27; Blogs</title><meta property="og:title" content="masutaka"/><meta property="og:url" content="https://engineers.feedforce.jp/members/masutaka"/><meta name="twitter:card" content="summary_large_image"/><meta property="og:site" content="Feedforce Engineers&#x27; Blogs"/><meta property="og:image" content="https://engineers.feedforce.jp/og.png"/><link rel="canonical" href="https://engineers.feedforce.jp/members/masutaka"/><link rel="alternate" type="application/rss+xml" title="Feedforce Engineers&#x27; Blogs" href="https://engineers.feedforce.jp/rss.xml"/><link rel="alternate" type="application/atom+xml" title="Feedforce Engineers&#x27; Blogs" href="https://engineers.feedforce.jp/atom.xml"/><link rel="preload" href="/_next/static/css/d7faf1fdf25fe7d3262e.css" as="style"/><link rel="stylesheet" href="/_next/static/css/d7faf1fdf25fe7d3262e.css" data-n-g=""/><noscript data-n-css="true"></noscript><link rel="preload" href="/_next/static/chunks/main-8a83f0fd99327c4684a8.js" as="script"/><link rel="preload" href="/_next/static/chunks/webpack-e067438c4cf4ef2ef178.js" as="script"/><link rel="preload" href="/_next/static/chunks/framework.1daf1ec1ecf144ee9147.js" as="script"/><link rel="preload" href="/_next/static/chunks/commons.9e003f150a446b53bdd9.js" as="script"/><link rel="preload" href="/_next/static/chunks/pages/_app-99db904e083fc7f74e35.js" as="script"/><link rel="preload" href="/_next/static/chunks/588505f8033a39c9ef82bc46b1145ac9fd1db500.827e01289b5e6a2fdb97.js" as="script"/><link rel="preload" href="/_next/static/chunks/pages/members/%5Bname%5D-42a7756adc6c0800b4dc.js" as="script"/></head><body><div id="__next"><header class="site-header"><div class="content-wrapper"><div class="site-header__inner"><a class="site-header__logo-link" href="/"><img src="https://engineers.feedforce.jp/logo.svg" alt="Feedforce Engineers&#x27; Blogs" class="site-header__logo-img"/></a><div class="site-header__links"><a href="https://feedforcegroup.jp" class="site-header__link">Company</a><a href="https://github.com/feedforce" class="site-header__link">GitHub</a><a href="https://engineers.recruit.feedforce.jp" class="site-header__link">Recruit</a></div></div></div></header><section class="member"><div class="content-wrapper"><header class="member-header"><div class="member-header__avatar"><img src="https://www.gravatar.com/avatar/d6c5403c0b6ef2f9fd51910ea38323a3?size=256" alt="masutaka" width="100" height="100" class="member-header__avatar-img"/></div><h1 class="member-header__name">masutaka</h1><p class="member-header__bio">カレー大好き！</p><div class="member-header__links"><a href="https://twitter.com/masutaka" class="member-header__link"><img src="https://engineers.feedforce.jp/icons/twitter.svg" alt="Twitterのユーザー@masutaka" width="22" height="22"/></a><a href="https://github.com/masutaka" class="member-header__link"><img src="https://engineers.feedforce.jp/icons/github.svg" alt="GitHubのユーザー@masutaka" width="22" height="22"/></a><a href="https://masutaka.net" class="member-header__link"><img src="https://engineers.feedforce.jp/icons/link.svg" alt="ウェブサイトのリンク" width="22" height="22"/></a></div></header><div class="member-posts-container"><div class="post-list"><article class="post-link"><a class="post-link__author" href="/members/masutaka"><img src="https://www.gravatar.com/avatar/d6c5403c0b6ef2f9fd51910ea38323a3?size=256" class="post-link__author-img" width="35" height="35"/><div class="post-link__author-name"><div class="post-link__author-name">masutaka</div><time dateTime="2022-10-01T04:49:29.000Z" class="post-link__date">11 days ago</time></div></a><a href="https://masutaka.net/2022-10-01-1/" class="post-link__main-link"><h2 class="post-link__title">このブログを『CloudFront+Heroku』から『Cloud Run』に移して知った Google のドメイン豆知識</h2><div class="post-link__site"><img src="https://www.google.com/s2/favicons?domain=masutaka.net" width="14" height="14" class="post-link__site-favicon"/>masutaka.net</div></a></article><article class="post-link"><a class="post-link__author" href="/members/masutaka"><img src="https://www.gravatar.com/avatar/d6c5403c0b6ef2f9fd51910ea38323a3?size=256" class="post-link__author-img" width="35" height="35"/><div class="post-link__author-name"><div class="post-link__author-name">masutaka</div><time dateTime="2022-09-30T09:00:00.000Z" class="post-link__date">12 days ago</time></div></a><a href="https://developer.feedforce.jp/entry/2022/09/30/180000" class="post-link__main-link"><h2 class="post-link__title">自分のブログを CloudFront + Heroku から Cloud Run に移行した話をした</h2><div class="post-link__site"><img src="https://www.google.com/s2/favicons?domain=developer.feedforce.jp" width="14" height="14" class="post-link__site-favicon"/>developer.feedforce.jp</div></a></article><article class="post-link"><a class="post-link__author" href="/members/masutaka"><img src="https://www.gravatar.com/avatar/d6c5403c0b6ef2f9fd51910ea38323a3?size=256" class="post-link__author-img" width="35" height="35"/><div class="post-link__author-name"><div class="post-link__author-name">masutaka</div><time dateTime="2022-09-16T04:00:00.000Z" class="post-link__date">a month ago</time></div></a><a href="https://developer.feedforce.jp/entry/2022/09/16/130000" class="post-link__main-link"><h2 class="post-link__title">OSS 版 Spectacles を使って、LookML の data tests や validation などを GitHub Actions で継続的に実行させてみた</h2><div class="post-link__site"><img src="https://www.google.com/s2/favicons?domain=developer.feedforce.jp" width="14" height="14" class="post-link__site-favicon"/>developer.feedforce.jp</div></a></article><article class="post-link"><a class="post-link__author" href="/members/masutaka"><img src="https://www.gravatar.com/avatar/d6c5403c0b6ef2f9fd51910ea38323a3?size=256" class="post-link__author-img" width="35" height="35"/><div class="post-link__author-name"><div class="post-link__author-name">masutaka</div><time dateTime="2022-07-21T12:00:00.000Z" class="post-link__date">3 months ago</time></div></a><a href="https://developer.feedforce.jp/entry/2022/07/21/210000" class="post-link__main-link"><h2 class="post-link__title">Looker User Meetup Online #8 で『BigQuery経由で使うGoogleスプレッドシートのスキーマ管理』の話をした</h2><div class="post-link__site"><img src="https://www.google.com/s2/favicons?domain=developer.feedforce.jp" width="14" height="14" class="post-link__site-favicon"/>developer.feedforce.jp</div></a></article><article class="post-link"><a class="post-link__author" href="/members/masutaka"><img src="https://www.gravatar.com/avatar/d6c5403c0b6ef2f9fd51910ea38323a3?size=256" class="post-link__author-img" width="35" height="35"/><div class="post-link__author-name"><div class="post-link__author-name">masutaka</div><time dateTime="2022-06-21T04:00:00.000Z" class="post-link__date">4 months ago</time></div></a><a href="https://developer.feedforce.jp/entry/2022/06/21/130000" class="post-link__main-link"><h2 class="post-link__title">LAMS を導入して、LookML の再利用性を高められた</h2><div class="post-link__site"><img src="https://www.google.com/s2/favicons?domain=developer.feedforce.jp" width="14" height="14" class="post-link__site-favicon"/>developer.feedforce.jp</div></a></article><article class="post-link"><a class="post-link__author" href="/members/masutaka"><img src="https://www.gravatar.com/avatar/d6c5403c0b6ef2f9fd51910ea38323a3?size=256" class="post-link__author-img" width="35" height="35"/><div class="post-link__author-name"><div class="post-link__author-name">masutaka</div><time dateTime="2022-06-17T02:00:00.000Z" class="post-link__date">4 months ago</time></div></a><a href="https://developer.feedforce.jp/entry/2022/06/17/110000" class="post-link__main-link"><h2 class="post-link__title">Looker で困った時の解決手段まとめ</h2><div class="post-link__site"><img src="https://www.google.com/s2/favicons?domain=developer.feedforce.jp" width="14" height="14" class="post-link__site-favicon"/>developer.feedforce.jp</div></a></article><article class="post-link"><a class="post-link__author" href="/members/masutaka"><img src="https://www.gravatar.com/avatar/d6c5403c0b6ef2f9fd51910ea38323a3?size=256" class="post-link__author-img" width="35" height="35"/><div class="post-link__author-name"><div class="post-link__author-name">masutaka</div><time dateTime="2022-05-30T02:00:00.000Z" class="post-link__date">4 months ago</time></div></a><a href="https://developer.feedforce.jp/entry/2022/05/30/110000" class="post-link__main-link"><h2 class="post-link__title">LookML Validation を 20 秒から 11 秒に高速化出来た</h2><div class="post-link__site"><img src="https://www.google.com/s2/favicons?domain=developer.feedforce.jp" width="14" height="14" class="post-link__site-favicon"/>developer.feedforce.jp</div></a></article><article class="post-link"><a class="post-link__author" href="/members/masutaka"><img src="https://www.gravatar.com/avatar/d6c5403c0b6ef2f9fd51910ea38323a3?size=256" class="post-link__author-img" width="35" height="35"/><div class="post-link__author-name"><div class="post-link__author-name">masutaka</div><time dateTime="2022-04-09T00:00:00.000Z" class="post-link__date">6 months ago</time></div></a><a href="https://masutaka.net/2022-04-09-1/" class="post-link__main-link"><h2 class="post-link__title">『本を聴く毎日を送っています』という LT をした</h2><div class="post-link__site"><img src="https://www.google.com/s2/favicons?domain=masutaka.net" width="14" height="14" class="post-link__site-favicon"/>masutaka.net</div></a></article><article class="post-link"><a class="post-link__author" href="/members/masutaka"><img src="https://www.gravatar.com/avatar/d6c5403c0b6ef2f9fd51910ea38323a3?size=256" class="post-link__author-img" width="35" height="35"/><div class="post-link__author-name"><div class="post-link__author-name">masutaka</div><time dateTime="2022-02-04T09:00:00.000Z" class="post-link__date">8 months ago</time></div></a><a href="https://developer.feedforce.jp/entry/2022/02/04/180000" class="post-link__main-link"><h2 class="post-link__title">『ボッチLookML開発者兼データ整備人を連れてきたよ！』という発表をした</h2><div class="post-link__site"><img src="https://www.google.com/s2/favicons?domain=developer.feedforce.jp" width="14" height="14" class="post-link__site-favicon"/>developer.feedforce.jp</div></a></article><article class="post-link"><a class="post-link__author" href="/members/masutaka"><img src="https://www.gravatar.com/avatar/d6c5403c0b6ef2f9fd51910ea38323a3?size=256" class="post-link__author-img" width="35" height="35"/><div class="post-link__author-name"><div class="post-link__author-name">masutaka</div><time dateTime="2021-12-13T02:00:00.000Z" class="post-link__date">10 months ago</time></div></a><a href="https://developer.feedforce.jp/entry/2021/12/13/110000" class="post-link__main-link"><h2 class="post-link__title">LookML 開発で使っているディレクトリ構造を紹介する</h2><div class="post-link__site"><img src="https://www.google.com/s2/favicons?domain=developer.feedforce.jp" width="14" height="14" class="post-link__site-favicon"/>developer.feedforce.jp</div></a></article><article class="post-link"><a class="post-link__author" href="/members/masutaka"><img src="https://www.gravatar.com/avatar/d6c5403c0b6ef2f9fd51910ea38323a3?size=256" class="post-link__author-img" width="35" height="35"/><div class="post-link__author-name"><div class="post-link__author-name">masutaka</div><time dateTime="2021-08-30T06:00:00.000Z" class="post-link__date">a year ago</time></div></a><a href="https://developer.feedforce.jp/entry/2021/08/30/150000" class="post-link__main-link"><h2 class="post-link__title">Looker で Join 先の view の primary_key をいい感じにテストする方法をようやく見つけた</h2><div class="post-link__site"><img src="https://www.google.com/s2/favicons?domain=developer.feedforce.jp" width="14" height="14" class="post-link__site-favicon"/>developer.feedforce.jp</div></a></article><article class="post-link"><a class="post-link__author" href="/members/masutaka"><img src="https://www.gravatar.com/avatar/d6c5403c0b6ef2f9fd51910ea38323a3?size=256" class="post-link__author-img" width="35" height="35"/><div class="post-link__author-name"><div class="post-link__author-name">masutaka</div><time dateTime="2021-08-16T06:00:00.000Z" class="post-link__date">a year ago</time></div></a><a href="https://developer.feedforce.jp/entry/2021/08/16/150000" class="post-link__main-link"><h2 class="post-link__title">私が１年かけて辿り着いた Looker の情報収集方法を紹介する</h2><div class="post-link__site"><img src="https://www.google.com/s2/favicons?domain=developer.feedforce.jp" width="14" height="14" class="post-link__site-favicon"/>developer.feedforce.jp</div></a></article><article class="post-link"><a class="post-link__author" href="/members/masutaka"><img src="https://www.gravatar.com/avatar/d6c5403c0b6ef2f9fd51910ea38323a3?size=256" class="post-link__author-img" width="35" height="35"/><div class="post-link__author-name"><div class="post-link__author-name">masutaka</div><time dateTime="2021-06-11T09:00:00.000Z" class="post-link__date">a year ago</time></div></a><a href="https://developer.feedforce.jp/entry/2021/06/11/180000" class="post-link__main-link"><h2 class="post-link__title">『ここがつらいよ普段使いのLinux』という発表をした</h2><div class="post-link__site"><img src="https://www.google.com/s2/favicons?domain=developer.feedforce.jp" width="14" height="14" class="post-link__site-favicon"/>developer.feedforce.jp</div></a></article><article class="post-link"><a class="post-link__author" href="/members/masutaka"><img src="https://www.gravatar.com/avatar/d6c5403c0b6ef2f9fd51910ea38323a3?size=256" class="post-link__author-img" width="35" height="35"/><div class="post-link__author-name"><div class="post-link__author-name">masutaka</div><time dateTime="2021-02-15T02:00:00.000Z" class="post-link__date">2 years ago</time></div></a><a href="https://developer.feedforce.jp/entry/2021/02/15/110000" class="post-link__main-link"><h2 class="post-link__title">全ての esa 新着記事を読みきれないので、最近はこの方法を使ってる</h2><div class="post-link__site"><img src="https://www.google.com/s2/favicons?domain=developer.feedforce.jp" width="14" height="14" class="post-link__site-favicon"/>developer.feedforce.jp</div></a></article><article class="post-link"><a class="post-link__author" href="/members/masutaka"><img src="https://www.gravatar.com/avatar/d6c5403c0b6ef2f9fd51910ea38323a3?size=256" class="post-link__author-img" width="35" height="35"/><div class="post-link__author-name"><div class="post-link__author-name">masutaka</div><time dateTime="2021-02-03T02:00:00.000Z" class="post-link__date">2 years ago</time></div></a><a href="https://developer.feedforce.jp/entry/2021/02/03/110000" class="post-link__main-link"><h2 class="post-link__title">変化に耐え得る esa のカテゴリ設計を徹底的に考えてみた</h2><div class="post-link__site"><img src="https://www.google.com/s2/favicons?domain=developer.feedforce.jp" width="14" height="14" class="post-link__site-favicon"/>developer.feedforce.jp</div></a></article><article class="post-link"><a class="post-link__author" href="/members/masutaka"><img src="https://www.gravatar.com/avatar/d6c5403c0b6ef2f9fd51910ea38323a3?size=256" class="post-link__author-img" width="35" height="35"/><div class="post-link__author-name"><div class="post-link__author-name">masutaka</div><time dateTime="2020-12-03T00:00:00.000Z" class="post-link__date">2 years ago</time></div></a><a href="https://masutaka.net/2020-12-03-1/" class="post-link__main-link"><h2 class="post-link__title">優先度より優先順位のほうが偉い</h2><div class="post-link__site"><img src="https://www.google.com/s2/favicons?domain=masutaka.net" width="14" height="14" class="post-link__site-favicon"/>masutaka.net</div></a></article><article class="post-link"><a class="post-link__author" href="/members/masutaka"><img src="https://www.gravatar.com/avatar/d6c5403c0b6ef2f9fd51910ea38323a3?size=256" class="post-link__author-img" width="35" height="35"/><div class="post-link__author-name"><div class="post-link__author-name">masutaka</div><time dateTime="2020-10-23T10:00:00.000Z" class="post-link__date">2 years ago</time></div></a><a href="https://developer.feedforce.jp/entry/2020/10/23/190000" class="post-link__main-link"><h2 class="post-link__title">『4月から取り組んできたLookerの導入から実装までのお話（Redashとも比較）』という発表をした</h2><div class="post-link__site"><img src="https://www.google.com/s2/favicons?domain=developer.feedforce.jp" width="14" height="14" class="post-link__site-favicon"/>developer.feedforce.jp</div></a></article><article class="post-link"><a class="post-link__author" href="/members/masutaka"><img src="https://www.gravatar.com/avatar/d6c5403c0b6ef2f9fd51910ea38323a3?size=256" class="post-link__author-img" width="35" height="35"/><div class="post-link__author-name"><div class="post-link__author-name">masutaka</div><time dateTime="2020-06-29T05:00:00.000Z" class="post-link__date">2 years ago</time></div></a><a href="https://developer.feedforce.jp/entry/2020/06/29/140000" class="post-link__main-link"><h2 class="post-link__title">個人的に実践している、Slack に振り回されない方法</h2><div class="post-link__site"><img src="https://www.google.com/s2/favicons?domain=developer.feedforce.jp" width="14" height="14" class="post-link__site-favicon"/>developer.feedforce.jp</div></a></article><article class="post-link"><a class="post-link__author" href="/members/masutaka"><img src="https://www.gravatar.com/avatar/d6c5403c0b6ef2f9fd51910ea38323a3?size=256" class="post-link__author-img" width="35" height="35"/><div class="post-link__author-name"><div class="post-link__author-name">masutaka</div><time dateTime="2020-03-02T05:00:00.000Z" class="post-link__date">3 years ago</time></div></a><a href="https://developer.feedforce.jp/entry/2020/03/02/140000" class="post-link__main-link"><h2 class="post-link__title">『HerokuでSidekiqを監視する方法を確立した』という発表をした</h2><div class="post-link__site"><img src="https://www.google.com/s2/favicons?domain=developer.feedforce.jp" width="14" height="14" class="post-link__site-favicon"/>developer.feedforce.jp</div></a></article><article class="post-link"><a class="post-link__author" href="/members/masutaka"><img src="https://www.gravatar.com/avatar/d6c5403c0b6ef2f9fd51910ea38323a3?size=256" class="post-link__author-img" width="35" height="35"/><div class="post-link__author-name"><div class="post-link__author-name">masutaka</div><time dateTime="2020-02-13T06:00:00.000Z" class="post-link__date">3 years ago</time></div></a><a href="https://developer.feedforce.jp/entry/2020/02/13/150000" class="post-link__main-link"><h2 class="post-link__title">Heroku Ruby Language Metrics のメトリクス収集の仕組みを調べた</h2><div class="post-link__site"><img src="https://www.google.com/s2/favicons?domain=developer.feedforce.jp" width="14" height="14" class="post-link__site-favicon"/>developer.feedforce.jp</div></a></article><article class="post-link"><a class="post-link__author" href="/members/masutaka"><img src="https://www.gravatar.com/avatar/d6c5403c0b6ef2f9fd51910ea38323a3?size=256" class="post-link__author-img" width="35" height="35"/><div class="post-link__author-name"><div class="post-link__author-name">masutaka</div><time dateTime="2019-12-14T06:30:00.000Z" class="post-link__date">3 years ago</time></div></a><a href="https://developer.feedforce.jp/entry/2019/12/14/153000" class="post-link__main-link"><h2 class="post-link__title">Heroku Meetup #27 で『デプロイで止まらないバッチ処理を求めて』という話をしてきた #herokujp</h2><div class="post-link__site"><img src="https://www.google.com/s2/favicons?domain=developer.feedforce.jp" width="14" height="14" class="post-link__site-favicon"/>developer.feedforce.jp</div></a></article><article class="post-link"><a class="post-link__author" href="/members/masutaka"><img src="https://www.gravatar.com/avatar/d6c5403c0b6ef2f9fd51910ea38323a3?size=256" class="post-link__author-img" width="35" height="35"/><div class="post-link__author-name"><div class="post-link__author-name">masutaka</div><time dateTime="2019-12-05T01:19:31.000Z" class="post-link__date">3 years ago</time></div></a><a href="https://developer.feedforce.jp/entry/2019/12/05/101931" class="post-link__main-link"><h2 class="post-link__title">月末に起動したいバッチを sidekiq-cron で指定し、healthchecks.io で監視する</h2><div class="post-link__site"><img src="https://www.google.com/s2/favicons?domain=developer.feedforce.jp" width="14" height="14" class="post-link__site-favicon"/>developer.feedforce.jp</div></a></article><article class="post-link"><a class="post-link__author" href="/members/masutaka"><img src="https://www.gravatar.com/avatar/d6c5403c0b6ef2f9fd51910ea38323a3?size=256" class="post-link__author-img" width="35" height="35"/><div class="post-link__author-name"><div class="post-link__author-name">masutaka</div><time dateTime="2019-07-29T05:00:00.000Z" class="post-link__date">3 years ago</time></div></a><a href="https://developer.feedforce.jp/entry/2019/07/29/140000" class="post-link__main-link"><h2 class="post-link__title">Heroku Meetup #25 &quot;Heroku Ghost&quot; で 2 回話してきた #herokujp</h2><div class="post-link__site"><img src="https://www.google.com/s2/favicons?domain=developer.feedforce.jp" width="14" height="14" class="post-link__site-favicon"/>developer.feedforce.jp</div></a></article><article class="post-link"><a class="post-link__author" href="/members/masutaka"><img src="https://www.gravatar.com/avatar/d6c5403c0b6ef2f9fd51910ea38323a3?size=256" class="post-link__author-img" width="35" height="35"/><div class="post-link__author-name"><div class="post-link__author-name">masutaka</div><time dateTime="2019-07-01T05:00:00.000Z" class="post-link__date">3 years ago</time></div></a><a href="https://developer.feedforce.jp/entry/2019/07/01/140000" class="post-link__main-link"><h2 class="post-link__title">esa をネタに Emacs Lisp と Elm を無理やり繋げた発表をした</h2><div class="post-link__site"><img src="https://www.google.com/s2/favicons?domain=developer.feedforce.jp" width="14" height="14" class="post-link__site-favicon"/>developer.feedforce.jp</div></a></article><article class="post-link"><a class="post-link__author" href="/members/masutaka"><img src="https://www.gravatar.com/avatar/d6c5403c0b6ef2f9fd51910ea38323a3?size=256" class="post-link__author-img" width="35" height="35"/><div class="post-link__author-name"><div class="post-link__author-name">masutaka</div><time dateTime="2019-04-26T06:45:40.000Z" class="post-link__date">3 years ago</time></div></a><a href="https://developer.feedforce.jp/entry/2019/04/26/154540" class="post-link__main-link"><h2 class="post-link__title">Heroku で Chrome を使ったクローラの IP アドレスを固定する</h2><div class="post-link__site"><img src="https://www.google.com/s2/favicons?domain=developer.feedforce.jp" width="14" height="14" class="post-link__site-favicon"/>developer.feedforce.jp</div></a></article><article class="post-link"><a class="post-link__author" href="/members/masutaka"><img src="https://www.gravatar.com/avatar/d6c5403c0b6ef2f9fd51910ea38323a3?size=256" class="post-link__author-img" width="35" height="35"/><div class="post-link__author-name"><div class="post-link__author-name">masutaka</div><time dateTime="2018-12-12T03:00:00.000Z" class="post-link__date">4 years ago</time></div></a><a href="https://developer.feedforce.jp/entry/2018/12/12/120000" class="post-link__main-link"><h2 class="post-link__title">Heroku の Preboot 機能を深掘りした</h2><div class="post-link__site"><img src="https://www.google.com/s2/favicons?domain=developer.feedforce.jp" width="14" height="14" class="post-link__site-favicon"/>developer.feedforce.jp</div></a></article><article class="post-link"><a class="post-link__author" href="/members/masutaka"><img src="https://www.gravatar.com/avatar/d6c5403c0b6ef2f9fd51910ea38323a3?size=256" class="post-link__author-img" width="35" height="35"/><div class="post-link__author-name"><div class="post-link__author-name">masutaka</div><time dateTime="2018-12-07T00:00:00.000Z" class="post-link__date">4 years ago</time></div></a><a href="https://masutaka.net/2018-12-07-1/" class="post-link__main-link"><h2 class="post-link__title">ジム通いと食生活改善を５ヶ月続けたので中間報告をする</h2><div class="post-link__site"><img src="https://www.google.com/s2/favicons?domain=masutaka.net" width="14" height="14" class="post-link__site-favicon"/>masutaka.net</div></a></article><article class="post-link"><a class="post-link__author" href="/members/masutaka"><img src="https://www.gravatar.com/avatar/d6c5403c0b6ef2f9fd51910ea38323a3?size=256" class="post-link__author-img" width="35" height="35"/><div class="post-link__author-name"><div class="post-link__author-name">masutaka</div><time dateTime="2018-11-14T05:00:00.000Z" class="post-link__date">4 years ago</time></div></a><a href="https://developer.feedforce.jp/entry/2018/11/14/140000" class="post-link__main-link"><h2 class="post-link__title">『Heroku と EC Booster と私』と『Heroku ちょこっと Deep Dive』という発表をした</h2><div class="post-link__site"><img src="https://www.google.com/s2/favicons?domain=developer.feedforce.jp" width="14" height="14" class="post-link__site-favicon"/>developer.feedforce.jp</div></a></article><article class="post-link"><a class="post-link__author" href="/members/masutaka"><img src="https://www.gravatar.com/avatar/d6c5403c0b6ef2f9fd51910ea38323a3?size=256" class="post-link__author-img" width="35" height="35"/><div class="post-link__author-name"><div class="post-link__author-name">masutaka</div><time dateTime="2018-10-09T05:00:00.000Z" class="post-link__date">4 years ago</time></div></a><a href="https://developer.feedforce.jp/entry/2018/10/09/140000" class="post-link__main-link"><h2 class="post-link__title">terraform-provider-healthchecksio に足りない機能を実装したらコラボレータになれた</h2><div class="post-link__site"><img src="https://www.google.com/s2/favicons?domain=developer.feedforce.jp" width="14" height="14" class="post-link__site-favicon"/>developer.feedforce.jp</div></a></article><article class="post-link"><a class="post-link__author" href="/members/masutaka"><img src="https://www.gravatar.com/avatar/d6c5403c0b6ef2f9fd51910ea38323a3?size=256" class="post-link__author-img" width="35" height="35"/><div class="post-link__author-name"><div class="post-link__author-name">masutaka</div><time dateTime="2018-06-15T04:00:00.000Z" class="post-link__date">4 years ago</time></div></a><a href="https://developer.feedforce.jp/entry/2018/06/15/130000" class="post-link__main-link"><h2 class="post-link__title">先期の MVP に選ばれた</h2><div class="post-link__site"><img src="https://www.google.com/s2/favicons?domain=developer.feedforce.jp" width="14" height="14" class="post-link__site-favicon"/>developer.feedforce.jp</div></a></article><article class="post-link"><a class="post-link__author" href="/members/masutaka"><img src="https://www.gravatar.com/avatar/d6c5403c0b6ef2f9fd51910ea38323a3?size=256" class="post-link__author-img" width="35" height="35"/><div class="post-link__author-name"><div class="post-link__author-name">masutaka</div><time dateTime="2018-05-21T06:00:00.000Z" class="post-link__date">4 years ago</time></div></a><a href="https://developer.feedforce.jp/entry/2018/05/21/150000" class="post-link__main-link"><h2 class="post-link__title">『開発基盤チームとして課題を探したらマネジメントをしていた』という発表をした</h2><div class="post-link__site"><img src="https://www.google.com/s2/favicons?domain=developer.feedforce.jp" width="14" height="14" class="post-link__site-favicon"/>developer.feedforce.jp</div></a></article><article class="post-link"><a class="post-link__author" href="/members/masutaka"><img src="https://www.gravatar.com/avatar/d6c5403c0b6ef2f9fd51910ea38323a3?size=256" class="post-link__author-img" width="35" height="35"/><div class="post-link__author-name"><div class="post-link__author-name">masutaka</div><time dateTime="2017-12-19T00:00:00.000Z" class="post-link__date">5 years ago</time></div></a><a href="https://masutaka.net/2017-12-19-1/" class="post-link__main-link"><h2 class="post-link__title">これまで試したダイエット７つを紹介する（※全部失敗）</h2><div class="post-link__site"><img src="https://www.google.com/s2/favicons?domain=masutaka.net" width="14" height="14" class="post-link__site-favicon"/>masutaka.net</div></a></article></div><div class="post-list-load"><button class="post-list-load__button">LOAD MORE</button></div></div></div></section><footer class="site-footer"><div class="content-wrapper"><p>© <!-- -->Feedforce Group Inc.</p></div></footer></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"member":{"name":"masutaka","role":"LookML Developer","bio":"カレー大好き！","avatarSrc":"https://www.gravatar.com/avatar/d6c5403c0b6ef2f9fd51910ea38323a3?size=256","sources":["https://developer.feedforce.jp/rss/author/masutaka26","https://masutaka.net/tags/feedforce/index.xml"],"twitterUsername":"masutaka","githubUsername":"masutaka","websiteUrl":"https://masutaka.net"},"postItems":[{"title":"このブログを『CloudFront+Heroku』から『Cloud Run』に移して知った Google のドメイン豆知識","content":"昨日社内勉強会でこんな発表をしました。いつもどおり右上の History を更新しました。\nスライド: 39 にもありますが、GCP の Cloud Run への移行の他に、ドメインも Amazon Route 53 から Google Domains に移行しました。これで上から下まで全部 Google になりました。\n少し気になって Cloud Run のカスタムドメインとして設定した masutaka.net を辿ったら面白いことを知ったので、この記事にメモとして残します。\nmasutaka.net を辿る旅 dig コマンドを使うと、masutaka.net が Google Domains のネームサーバーを使っていることを確認できます。\n$ dig -t NS masutaka.net (snip) ;; ANSWER SECTION: masutaka.net. 21399 IN NS ns-cloud-b4.googledomains.com. masutaka.net. 21399 IN NS ns-cloud-b1.googledomains.com. masutaka.net. 21399 IN NS ns-cloud-b2.googledomains.com. masutaka.net. 21399 IN NS ns-cloud-b3.googledomains.com. (snip) 普通に dig するとこうです。\n$ dig masutaka.net (snip) ;; ANSWER SECTION: masutaka.","contentSnippet":"昨日社内勉強会でこんな発表をしました。いつもどおり右上の History を更新しました。スライド: 39 にもありますが、GCP の Cloud Run への移行の他に、ドメインも Amazon Route 53 から Google Domains に移行しました。これで上から下まで全部 Google になりました。少し気になって Cloud Run のカスタムドメインとして設定した masutaka.net を辿ったら面白いことを知ったので、この記事にメモとして残します。masutaka.net を辿る旅 dig コマンドを使うと、masutaka.net が Google Domains のネームサーバーを使っていることを確認できます。$ dig -t NS masutaka.net (snip) ;; ANSWER SECTION: masutaka.net. 21399 IN NS ns-cloud-b4.googledomains.com. masutaka.net. 21399 IN NS ns-cloud-b1.googledomains.com. masutaka.net. 21399 IN NS ns-cloud-b2.googledomains.com. masutaka.net. 21399 IN NS ns-cloud-b3.googledomains.com. (snip) 普通に dig するとこうです。$ dig masutaka.net (snip) ;; ANSWER SECTION: masutaka.","link":"https://masutaka.net/2022-10-01-1/","isoDate":"2022-10-01T04:49:29.000Z","dateMiliSeconds":1664599769000,"authorName":"masutaka"},{"title":"自分のブログを CloudFront + Heroku から Cloud Run に移行した話をした","content":"\u003cp\u003eこんにちは \u003ca href=\"http://blog.hatena.ne.jp/masutaka26/\" class=\"hatena-id-icon\"\u003e\u003cimg src=\"https://cdn.profile-image.st-hatena.com/users/masutaka26/profile.png\" width=\"16\" height=\"16\" alt=\"\" class=\"hatena-id-icon\"\u003eid:masutaka26\u003c/a\u003e です。\u003c/p\u003e\n\n\u003cp\u003e本日、週次の社内勉強会 \u003ca href=\"https://developer.feedforce.jp/archive/category/FFTT\"\u003eFFTT\u003c/a\u003e で『引っ越ししたら家賃が3分の1になったかも』というタイトルで、実際は Amazon CloudFront + Heroku で動いていた\u003ca href=\"https://masutaka.net/\"\u003e自分のブログ\u003c/a\u003eを GCP の \u003ca href=\"https://cloud.google.com/run\"\u003eCloud Run\u003c/a\u003e に移行した話をしました。\u003c/p\u003e\n\n\u003ciframe src=\"https://docs.google.com/presentation/d/e/2PACX-1vTucSlV9z4czouHd-hIOiDBwaeh1a7CMbEm2mmx5kGDTijuRKJF4ID3blnnKz1nhG6rvMfMBLyTSFMM/embed?start=false\u0026loop=false\u0026delayms=3000\" frameborder=\"0\" width=\"960\" height=\"410\" allowfullscreen=\"true\" mozallowfullscreen=\"true\" webkitallowfullscreen=\"true\"\u003e\u003c/iframe\u003e\n\n\n\u003cp\u003eモチベーションはスライドにつらつら書きつつも、実際はこの FFTT の発表当番だったからではあります。結果的に満足行く結果にはなったので、これからコード管理などもう少し作り込んでいきます。\u003cs\u003e今後ネタに困ったらまた引っ越せばよいし。\u003c/s\u003e\u003c/p\u003e\n\n\u003cp\u003eCloud Run もそうですが、\u003ca href=\"https://domains.google/intl/ja_jp/\"\u003eGoogle Domains\u003c/a\u003e や \u003ca href=\"https://cloud.google.com/monitoring\"\u003eCloud Monitoring\u003c/a\u003e の外形監視（稼働時間チェック）など、便利でライトに使える GCP を知ることが出来たことも収穫でした。\u003c/p\u003e\n\n\u003cp\u003eそれでは良い週末を！(^^)/\u003c/p\u003e\n","contentSnippet":"こんにちは id:masutaka26 です。本日、週次の社内勉強会 FFTT で『引っ越ししたら家賃が3分の1になったかも』というタイトルで、実際は Amazon CloudFront + Heroku で動いていた自分のブログを GCP の Cloud Run に移行した話をしました。モチベーションはスライドにつらつら書きつつも、実際はこの FFTT の発表当番だったからではあります。結果的に満足行く結果にはなったので、これからコード管理などもう少し作り込んでいきます。今後ネタに困ったらまた引っ越せばよいし。Cloud Run もそうですが、Google Domains や Cloud Monitoring の外形監視（稼働時間チェック）など、便利でライトに使える GCP を知ることが出来たことも収穫でした。それでは良い週末を！(^^)/","link":"https://developer.feedforce.jp/entry/2022/09/30/180000","isoDate":"2022-09-30T09:00:00.000Z","dateMiliSeconds":1664528400000,"imageUrl":"https://cdn-ak.f.st-hatena.com/images/fotolife/m/masutaka26/20220930/20220930173417.png","authorName":"masutaka"},{"title":"OSS 版 Spectacles を使って、LookML の data tests や validation などを GitHub Actions で継続的に実行させてみた","content":"\u003cp\u003eこんにちは。\u003ca href=\"https://twitter.com/masutaka/status/1550357627779284992\"\u003e自称 Looker エバンジェリスト\u003c/a\u003eの \u003ca href=\"http://blog.hatena.ne.jp/masutaka26/\" class=\"hatena-id-icon\"\u003e\u003cimg src=\"https://cdn.profile-image.st-hatena.com/users/masutaka26/profile.png\" width=\"16\" height=\"16\" alt=\"\" class=\"hatena-id-icon\"\u003eid:masutaka26\u003c/a\u003e です。\u003c/p\u003e\n\n\u003cp\u003e今日は Spectacles というツールを導入して、Looker インスタンスの健全性を高められた話を紹介します。\u003c/p\u003e\n\n\u003cul class=\"table-of-contents\"\u003e\n    \u003cli\u003e\u003ca href=\"#Spectacles-とは\"\u003eSpectacles とは\u003c/a\u003e\u003cul\u003e\n            \u003cli\u003e\u003ca href=\"#4-種類のテスト\"\u003e4 種類のテスト\u003c/a\u003e\u003c/li\u003e\n            \u003cli\u003e\u003ca href=\"#基本的な振る舞い\"\u003e基本的な振る舞い\u003c/a\u003e\u003c/li\u003e\n        \u003c/ul\u003e\n    \u003c/li\u003e\n    \u003cli\u003e\u003ca href=\"#どのテストを採用しどのような課題を解決したのか\"\u003eどのテストを採用し、どのような課題を解決したのか\u003c/a\u003e\u003cul\u003e\n            \u003cli\u003e\u003ca href=\"#SQL-validation\"\u003eSQL validation\u003c/a\u003e\u003c/li\u003e\n            \u003cli\u003e\u003ca href=\"#Assert-validation\"\u003eAssert validation\u003c/a\u003e\u003c/li\u003e\n            \u003cli\u003e\u003ca href=\"#Content-validation\"\u003eContent validation\u003c/a\u003e\u003c/li\u003e\n            \u003cli\u003e\u003ca href=\"#LookML-validation\"\u003eLookML validation\u003c/a\u003e\u003c/li\u003e\n        \u003c/ul\u003e\n    \u003c/li\u003e\n    \u003cli\u003e\u003ca href=\"#どのような-GitHub-Actions-にしたのか\"\u003eどのような GitHub Actions にしたのか\u003c/a\u003e\u003cul\u003e\n            \u003cli\u003e\u003ca href=\"#CI-workflow\"\u003eCI workflow\u003c/a\u003e\u003c/li\u003e\n            \u003cli\u003e\u003ca href=\"#Schedule-workflow\"\u003eSchedule workflow\u003c/a\u003e\u003c/li\u003e\n        \u003c/ul\u003e\n    \u003c/li\u003e\n    \u003cli\u003e\u003ca href=\"#落ち穂拾い\"\u003e落ち穂拾い\u003c/a\u003e\u003cul\u003e\n            \u003cli\u003e\u003ca href=\"#作業ブランチのゴミが残ることがある\"\u003e作業ブランチのゴミが残ることがある\u003c/a\u003e\u003c/li\u003e\n            \u003cli\u003e\u003ca href=\"#マシンユーザーを作るか作らないか\"\u003eマシンユーザーを作るか作らないか\u003c/a\u003e\u003c/li\u003e\n        \u003c/ul\u003e\n    \u003c/li\u003e\n    \u003cli\u003e\u003ca href=\"#まとめ\"\u003eまとめ\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch2 id=\"Spectacles-とは\"\u003eSpectacles とは\u003c/h2\u003e\n\n\u003cp\u003eSpectacles は Looker のサードパーティ CI ツールです。継続的に各種テストを実行し、Looker インスタンスを健全に保つことが出来ます。\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://www.spectacles.dev/\"\u003eクラウド版\u003c/a\u003eと OSS 版があり、それぞれ過去にクラスメソッドや、Zenn の記事で紹介されたことがあります。\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://dev.classmethod.jp/articles/spectacles-looker-validation/\"\u003eSpectaclesでLooker（LookML）のテストをやってみた | DevelopersIO\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://zenn.dev/skryo/articles/4f060327da2bf6\"\u003eLookerのCIツールであるSpectaclesを導入した話\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\n\n\u003cp\u003e今回は OSS 版を使いました。\u003c/p\u003e\n\n\u003cp\u003e\u003ciframe src=\"https://hatenablog-parts.com/embed?url=https%3A%2F%2Fgithub.com%2Fspectacles-ci%2Fspectacles\" title=\"GitHub - spectacles-ci/spectacles: A continuous integration tool for Looker and LookML.\" class=\"embed-card embed-webcard\" scrolling=\"no\" frameborder=\"0\" style=\"display: block; width: 100%; height: 155px; max-width: 500px; margin: 10px 0px;\" loading=\"lazy\"\u003e\u003c/iframe\u003e\u003ccite class=\"hatena-citation\"\u003e\u003ca href=\"https://github.com/spectacles-ci/spectacles\"\u003egithub.com\u003c/a\u003e\u003c/cite\u003e\u003c/p\u003e\n\n\u003ch3 id=\"4-種類のテスト\"\u003e4 種類のテスト\u003c/h3\u003e\n\n\u003cp\u003e2022 年 9 月時点で 4 種類のテストが実装されています。\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://docs.spectacles.dev/cli/tutorials/validators#the-sql-validator\"\u003eSQL validation\u003c/a\u003e\n\n\u003cul\u003e\n\u003cli\u003e全ての Dimension の \u003ca href=\"https://cloud.google.com/looker/docs/reference/param-field-sql\"\u003esql\u003c/a\u003e パラメーターについて、実際にクエリを実行し、その有効性を検証する\u003c/li\u003e\n\u003cli\u003edata warehouse のリソースを過剰に使わないよう工夫されている。例えば BigQuery の料金は発生しない\u003csup id=\"fnref:1\"\u003e\u003ca href=\"#fn:1\" rel=\"footnote\"\u003e1\u003c/a\u003e\u003c/sup\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://docs.spectacles.dev/cli/tutorials/validators#the-assert-validator\"\u003eAssert validation\u003c/a\u003e\n\n\u003cul\u003e\n\u003cli\u003eLookML IDE 上でも実行できる LookML data tests を実行する\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://docs.spectacles.dev/cli/tutorials/validators#the-content-validator\"\u003eContent validation\u003c/a\u003e\n\n\u003cul\u003e\n\u003cli\u003e開発メニューの Content Validator 相当の検証を行い、エラーのある Dashboard や Look を特定する\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://docs.spectacles.dev/cli/tutorials/validators/#the-lookml-validator\"\u003eLookML validation\u003c/a\u003e\n\n\u003cul\u003e\n\u003cli\u003eLookML IDE 上でも実行できる LookML validation を実行する\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\n\n\u003ch3 id=\"基本的な振る舞い\"\u003e基本的な振る舞い\u003c/h3\u003e\n\n\u003cp\u003eSpectacles は Looker API を使用し、指定した Looker インスタンス上で、LookML data tests や validation などを実行します。\u003c/p\u003e\n\n\u003cpre class=\"code\" data-lang=\"\" data-unlink\u003eSpectacles -(Looker API)-\u0026gt; Your Looker Instance\u003c/pre\u003e\n\n\n\u003cp\u003eいわゆるユニットテストでは、テスト環境でソースコードを checkout し、そこでテストを実行しますが、Spectacles はその点は全く違います。\u003c/p\u003e\n\n\u003cp\u003eつまり GitHub Actions 等の CI で動かす場合、LookML コードの checkout は不要ということです。\u003c/p\u003e\n\n\u003ch2 id=\"どのテストを採用しどのような課題を解決したのか\"\u003eどのテストを採用し、どのような課題を解決したのか\u003c/h2\u003e\n\n\u003ch3 id=\"SQL-validation\"\u003eSQL validation\u003c/h3\u003e\n\n\u003cp\u003eいきなりですが、こちらは今回採用出来ませんでした。\u003c/p\u003e\n\n\u003cp\u003e我々の環境で全ての Explore をテスト対象にすると、かなりの数のテストが失敗します。\u003ccode\u003ehidden: yes\u003c/code\u003e な Dimension がおそらく全てです。想定内です。\u003c/p\u003e\n\n\u003cpre class=\"code\" data-lang=\"\" data-unlink\u003e$ spectacles sql --project my_project_name --profile -v\u003c/pre\u003e\n\n\n\u003cp\u003eそれならばと、\u003ccode\u003e--ignore-hidden\u003c/code\u003e オプションを付けると、今度はこんなエラーが発生します。どうやら 1 つも Dimension が表示されない Explore があるようです。こちらも想定内です。\u003c/p\u003e\n\n\u003cpre class=\"code\" data-lang=\"\" data-unlink\u003eExplore object is missing dimensions, meaning this query won\u0026#39;t have fields and will error. Often this happens because you didn\u0026#39;t include dimensions when you built the project.\u003c/pre\u003e\n\n\n\u003cp\u003e\u003ccode\u003e--explore\u003c/code\u003e オプションでエラーが発生しない Explore を指定すればよいのですが、Explore が 150 個以上ある関係で、切り分けができていません。\u003c/p\u003e\n\n\u003cp\u003esql パラメーターは壊れていても、実際に Explore で当該 Dimension が使われないとエラーにならないのと、そのエラーが報告されるとも限らないので、いずれは再挑戦したいです。\u003c/p\u003e\n\n\u003ch3 id=\"Assert-validation\"\u003eAssert validation\u003c/h3\u003e\n\n\u003cp\u003e我々の Looker インスタンスでは、BigQuery の外部テーブルに Google スプレッドシートを指定したテーブルを数多く参照しています。つまり人間が編集するデータです。このようなデータはオペミスにより壊れることがあり、primary_key も芋づる式に壊れることがあります。\u003c/p\u003e\n\n\u003cp\u003eprimary_key はほぼ全てテストを書いています\u003csup id=\"fnref:2\"\u003e\u003ca href=\"#fn:2\" rel=\"footnote\"\u003e2\u003c/a\u003e\u003c/sup\u003eが、約 250 個と数が多いです。一方で LookML IDE 上での data tests は同時実行数が 1 に制限されているようで、テストに 10 分以上かかります。commit 前のテストを必須にできない状態でした。そのため、時々テストを手動実行しないと、壊れたことに気づけない課題がありました。\u003c/p\u003e\n\n\u003cp\u003e以上の課題を解決するために、定期的に LookML data tests を実行し、手動実行せずに気付けるようになりました。\u003c/p\u003e\n\n\u003ch3 id=\"Content-validation\"\u003eContent validation\u003c/h3\u003e\n\n\u003cp\u003e今までは私の注意力で Dashboard 約 140 個と Look 約 30 個のエラー数ゼロを継続できていましたが、まさに属人的でした。\u003c/p\u003e\n\n\u003cp\u003eこれも定期的に実行し、Content Validator を手動実行することなく気付けるようになりました。\u003c/p\u003e\n\n\u003ch3 id=\"LookML-validation\"\u003eLookML validation\u003c/h3\u003e\n\n\u003cp\u003e時々 LookML IDE を介さず、ローカル環境で git commit してデプロイすることがあります。そのケースで大きな変更をすることはないものの、validation が通らない LookML がデプロイされる確率はゼロではありません。\u003c/p\u003e\n\n\u003cp\u003eこちらは git push のタイミングで実行することで、健全性を高めることが出来ました。\u003c/p\u003e\n\n\u003ch2 id=\"どのような-GitHub-Actions-にしたのか\"\u003eどのような GitHub Actions にしたのか\u003c/h2\u003e\n\n\u003cp\u003egit push のタイミングで実行する CI workflow と、定期的に実行する Schedule workflow を作りました。\u003c/p\u003e\n\n\u003ch3 id=\"CI-workflow\"\u003eCI workflow\u003c/h3\u003e\n\n\u003cp\u003egit push のたびに、当該 commit のブランチに対して、LookML validation のテストをしています\u003csup id=\"fnref:3\"\u003e\u003ca href=\"#fn:3\" rel=\"footnote\"\u003e3\u003c/a\u003e\u003c/sup\u003e。\u003c/p\u003e\n\n\u003cpre class=\"code lang-yaml\" data-lang=\"yaml\" data-unlink\u003e\u003cspan class=\"synIdentifier\"\u003ename\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e:\u003c/span\u003e CI\n\n\u003cspan class=\"synIdentifier\"\u003eon\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e:\u003c/span\u003e\n  \u003cspan class=\"synIdentifier\"\u003epush\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e:\u003c/span\u003e\n    \u003cspan class=\"synIdentifier\"\u003ebranches-ignore\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e:\u003c/span\u003e\u003cspan class=\"synComment\"\u003e # ①\u003c/span\u003e\n      \u003cspan class=\"synStatement\"\u003e- \u003c/span\u003e\u003cspan class=\"synConstant\"\u003e'dev-**'\u003c/span\u003e           \u003cspan class=\"synComment\"\u003e # LookML IDE の個人用開発ブランチ\u003c/span\u003e\n      \u003cspan class=\"synStatement\"\u003e- \u003c/span\u003e\u003cspan class=\"synConstant\"\u003e'tmp_spectacles_**'\u003c/span\u003e\u003cspan class=\"synComment\"\u003e # spectacles の --commit-ref オプションが作るブランチ\u003c/span\u003e\n\n\u003cspan class=\"synIdentifier\"\u003ejobs\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e:\u003c/span\u003e\n  \u003cspan class=\"synIdentifier\"\u003evalidate_lookml\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e:\u003c/span\u003e\n    \u003cspan class=\"synIdentifier\"\u003ename\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e:\u003c/span\u003e Validate LookML files\n    \u003cspan class=\"synIdentifier\"\u003eruns-on\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e:\u003c/span\u003e ubuntu-latest\n    \u003cspan class=\"synIdentifier\"\u003etimeout-minutes\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e:\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e5\u003c/span\u003e\u003cspan class=\"synComment\"\u003e # デフォルトは 360 分。料金のスパイクを防ぐ\u003c/span\u003e\n    \u003cspan class=\"synIdentifier\"\u003econcurrency\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e:\u003c/span\u003e\u003cspan class=\"synComment\"\u003e # ② spectacles が複数同時に実行しないようにする\u003c/span\u003e\n      spectacles_should_be_run_in_series\n    \u003cspan class=\"synIdentifier\"\u003esteps\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e:\u003c/span\u003e\n    \u003cspan class=\"synStatement\"\u003e- \u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003euses\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e:\u003c/span\u003e actions/setup-python@v4\n      \u003cspan class=\"synIdentifier\"\u003ewith\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e:\u003c/span\u003e\n        \u003cspan class=\"synIdentifier\"\u003epython-version\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e:\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e'3.x'\u003c/span\u003e\n    \u003cspan class=\"synStatement\"\u003e- \u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ename\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e:\u003c/span\u003e Install Spectacles\n      \u003cspan class=\"synIdentifier\"\u003erun\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e:\u003c/span\u003e pip install spectacles\n    \u003cspan class=\"synStatement\"\u003e- \u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ename\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e:\u003c/span\u003e Run LookML Validator\n      \u003cspan class=\"synIdentifier\"\u003eenv\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e:\u003c/span\u003e\n        \u003cspan class=\"synIdentifier\"\u003eLOOKER_BASE_URL\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e:\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;https://my_instance_name.looker.com\u0026quot;\u003c/span\u003e\n        \u003cspan class=\"synIdentifier\"\u003eLOOKER_CLIENT_ID\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e:\u003c/span\u003e ${{ secrets.SPECTACLES_LOOKER_CLIENT_ID }}\u003cspan class=\"synComment\"\u003e # ③\u003c/span\u003e\n        \u003cspan class=\"synIdentifier\"\u003eLOOKER_CLIENT_SECRET\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e:\u003c/span\u003e ${{ secrets.SPECTACLES_LOOKER_CLIENT_SECRET }}\u003cspan class=\"synComment\"\u003e # ③\u003c/span\u003e\n      \u003cspan class=\"synIdentifier\"\u003erun\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e:\u003c/span\u003e spectacles lookml --project my_project_name --commit-ref \u003cspan class=\"synConstant\"\u003e\u0026quot;$GITHUB_SHA\u0026quot;\u003c/span\u003e -v\n\u003c/pre\u003e\n\n\n\u003cp\u003e①で特定のブランチを除外しています。特に今回のケースでは、\u003ccode\u003etmp_spectacles_**\u003c/code\u003e を設定しないと \u003ccode\u003evalidate_lookml\u003c/code\u003e ジョブが無限に起動し続けるため、絶対に必要です。\u003c/p\u003e\n\n\u003cp\u003e②も結構重要で、CI workflow と次に示す Schedule workflow から起動される spectacles プロセスの同時実行数を 1 に制限しています。\u003c/p\u003e\n\n\u003cp\u003eSpectacles は③と紐づく Looker ユーザーが実際に開発モードで \u003ccode\u003etmp_spectacles_**\u003c/code\u003e というブランチを作り、切り替えます。Looker では 1 人のユーザーが同時に利用できるブランチは 1 つだけです。Spectacles の複数起動は問題が発生するため、今回の制限を設定しました。\u003ca href=\"https://docs.spectacles.dev/cli/guides/how-to-deploy-spectacles/\"\u003e公式ドキュメント\u003c/a\u003eでも言及されています。\u003c/p\u003e\n\n\u003ch3 id=\"Schedule-workflow\"\u003eSchedule workflow\u003c/h3\u003e\n\n\u003cp\u003e早朝と夕方に master（デフォルト）ブランチ上で、Content validation と LookML data tests を実行しています。\u003c/p\u003e\n\n\u003cpre class=\"code lang-yaml\" data-lang=\"yaml\" data-unlink\u003e\u003cspan class=\"synIdentifier\"\u003ename\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e:\u003c/span\u003e Schedule\n\n\u003cspan class=\"synIdentifier\"\u003eon\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e:\u003c/span\u003e\n  \u003cspan class=\"synIdentifier\"\u003eschedule\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e:\u003c/span\u003e\n    \u003cspan class=\"synStatement\"\u003e- \u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecron\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e:\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;00 21 * * 0-4\u0026quot;\u003c/span\u003e\u003cspan class=\"synComment\"\u003e # 平日の  6:00 JST\u003c/span\u003e\n    \u003cspan class=\"synStatement\"\u003e- \u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecron\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e:\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;30  7 * * 1-5\u0026quot;\u003c/span\u003e\u003cspan class=\"synComment\"\u003e # 平日の 16:30 JST\u003c/span\u003e\n\n\u003cspan class=\"synIdentifier\"\u003ejobs\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e:\u003c/span\u003e\n  \u003cspan class=\"synIdentifier\"\u003eschedule\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e:\u003c/span\u003e\n    \u003cspan class=\"synIdentifier\"\u003ename\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e:\u003c/span\u003e Scheduled job\n    \u003cspan class=\"synIdentifier\"\u003eruns-on\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e:\u003c/span\u003e ubuntu-latest\n    \u003cspan class=\"synIdentifier\"\u003etimeout-minutes\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e:\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e30\u003c/span\u003e\u003cspan class=\"synComment\"\u003e # デフォルトは 360 分。料金のスパイクを防ぐ\u003c/span\u003e\n    \u003cspan class=\"synIdentifier\"\u003econcurrency\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e:\u003c/span\u003e\u003cspan class=\"synComment\"\u003e # ① spectacles が複数同時に実行しないようにする\u003c/span\u003e\n      spectacles_should_be_run_in_series\n    \u003cspan class=\"synIdentifier\"\u003eenv\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e:\u003c/span\u003e\n      \u003cspan class=\"synIdentifier\"\u003eLOOKER_BASE_URL\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e:\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;https://my_instance_name.looker.com\u0026quot;\u003c/span\u003e\n      \u003cspan class=\"synIdentifier\"\u003eLOOKER_CLIENT_ID\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e:\u003c/span\u003e ${{ secrets.SPECTACLES_LOOKER_CLIENT_ID }}\n      \u003cspan class=\"synIdentifier\"\u003eLOOKER_CLIENT_SECRET\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e:\u003c/span\u003e ${{ secrets.SPECTACLES_LOOKER_CLIENT_SECRET }}\n    \u003cspan class=\"synIdentifier\"\u003esteps\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e:\u003c/span\u003e\n    \u003cspan class=\"synStatement\"\u003e- \u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003euses\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e:\u003c/span\u003e actions/setup-python@v4\n      \u003cspan class=\"synIdentifier\"\u003ewith\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e:\u003c/span\u003e\n        \u003cspan class=\"synIdentifier\"\u003epython-version\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e:\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e'3.x'\u003c/span\u003e\n    \u003cspan class=\"synStatement\"\u003e- \u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ename\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e:\u003c/span\u003e Install Spectacles\n      \u003cspan class=\"synIdentifier\"\u003erun\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e:\u003c/span\u003e pip install spectacles\n    \u003cspan class=\"synStatement\"\u003e- \u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ename\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e:\u003c/span\u003e Run Content Validator\n      \u003cspan class=\"synIdentifier\"\u003erun\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e:\u003c/span\u003e spectacles content --project my_project_name -v\n    \u003cspan class=\"synStatement\"\u003e- \u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ename\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e:\u003c/span\u003e Run LookML data tests\n      \u003cspan class=\"synIdentifier\"\u003erun\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e:\u003c/span\u003e spectacles assert --project my_project_name -v\n\u003c/pre\u003e\n\n\n\u003cp\u003eブランチの時や、master ブランチへのマージ直後ではまだ Dashboard や Look がエラーになることがあるため、Content validation はこのタイミングにしています。\u003c/p\u003e\n\n\u003cp\u003eLookML data tests も 10 分以上かかることと、git push の粒度でやらないと不安というわけではないため、このタイミングにしています。BigQuery の料金もかかりますからね。\u003c/p\u003e\n\n\u003ch2 id=\"落ち穂拾い\"\u003e落ち穂拾い\u003c/h2\u003e\n\n\u003ch3 id=\"作業ブランチのゴミが残ることがある\"\u003e作業ブランチのゴミが残ることがある\u003c/h3\u003e\n\n\u003cp\u003eSpectacles が途中で異常終了すると、LookML IDE と GitHub に \u003ccode\u003etmp_spectacles_b016c8a4dd\u003c/code\u003e といった、Spectacles が作る作業ブランチが残ることがあります。気づいたら削除してあげましょう。\u003c/p\u003e\n\n\u003cp\u003e正常終了の場合は残りません。\u003c/p\u003e\n\n\u003ch3 id=\"マシンユーザーを作るか作らないか\"\u003eマシンユーザーを作るか作らないか\u003c/h3\u003e\n\n\u003cp\u003eLooker はユーザー課金モデルであるため、Spectacles のためにユーザーを作ることに躊躇するかもしれません。私もそうでした。おまけに Developer 相当の権限が必要なため、そこそこの料金です。\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://docs.spectacles.dev/app/guides/how-to-create-an-api-key\"\u003eCreate a Looker API Key | Spectacles Docs\u003c/a\u003e\u003c/p\u003e\n\n\u003cblockquote\u003e\u003cp\u003eWe strongly recommend creating \u003cstrong\u003ea dedicated Spectacles user in Looker\u003c/strong\u003e to ensure a human user doesn't accidentally change the Git branch or turn off development mode in the middle of a validation.\u003c/p\u003e\u003c/blockquote\u003e\n\n\u003cp\u003eですが、公式ドキュメントで強く奨励されているとおり、Spectacles 専用のユーザーを作って下さい。\u003c/p\u003e\n\n\u003cp\u003e人間のユーザーは権限が大きすぎますし、前述のとおり Spectacles は実際に開発モードでブランチを作って切り替えるため、人間の作業とコンフリクトします。\u003c/p\u003e\n\n\u003ch2 id=\"まとめ\"\u003eまとめ\u003c/h2\u003e\n\n\u003cp\u003eSpectacles というツールを導入して、Looker インスタンスの健全性を高められた話をしました。\u003c/p\u003e\n\n\u003cp\u003e導入したのは先月ですが、導入の翌日にタイミング良く Schedule workflow のテストが落ち、primary_key が壊れたことに気づけたことにはニッコリしました。\u003c/p\u003e\n\n\u003cp\u003e私のようなボッチ LookML 開発者は、いかに作業を機械に任せるかが重要だと思います。心の平穏も大事です。また、あとから CI を導入するのは結構大変なので、始めから開発計画に組み込むことをオススメします。\u003c/p\u003e\n\n\u003cp\u003eそれでは良い Looker ライフを！(^^)/\u003c/p\u003e\n\u003cdiv class=\"footnotes\"\u003e\n\u003chr/\u003e\n\u003col\u003e\n\u003cli id=\"fn:1\"\u003e\n\u003cp\u003e\u003ca href=\"https://docs.spectacles.dev/app/explanation/limiting-resource-consumption/\"\u003eLimiting Resource Consumption | Spectacles Docs\u003c/a\u003e\u003ca href=\"#fnref:1\" rev=\"footnote\"\u003e\u0026#8617;\u003c/a\u003e\u003c/p\u003e\u003c/li\u003e\n\u003cli id=\"fn:2\"\u003e\n\u003cp\u003e\u003ca href=\"https://developer.feedforce.jp/entry/2021/08/30/150000\"\u003eLooker で Join 先の view の primary_key をいい感じにテストする方法をようやく見つけた - Feedforce Developer Blog\u003c/a\u003e\u003ca href=\"#fnref:2\" rev=\"footnote\"\u003e\u0026#8617;\u003c/a\u003e\u003c/p\u003e\u003c/li\u003e\n\u003cli id=\"fn:3\"\u003e\n\u003cp\u003e実際には他のジョブや、失敗時の Slack 通知ジョブもありますが、分かりやすくするために省略しています。\u003ca href=\"#fnref:3\" rev=\"footnote\"\u003e\u0026#8617;\u003c/a\u003e\u003c/p\u003e\u003c/li\u003e\n\u003c/ol\u003e\n\u003c/div\u003e\n\n","contentSnippet":"こんにちは。自称 Looker エバンジェリストの id:masutaka26 です。今日は Spectacles というツールを導入して、Looker インスタンスの健全性を高められた話を紹介します。Spectacles とは4 種類のテスト基本的な振る舞いどのテストを採用し、どのような課題を解決したのかSQL validationAssert validationContent validationLookML validationどのような GitHub Actions にしたのかCI workflowSchedule workflow落ち穂拾い作業ブランチのゴミが残ることがあるマシンユーザーを作るか作らないかまとめSpectacles とはSpectacles は Looker のサードパーティ CI ツールです。継続的に各種テストを実行し、Looker インスタンスを健全に保つことが出来ます。クラウド版と OSS 版があり、それぞれ過去にクラスメソッドや、Zenn の記事で紹介されたことがあります。SpectaclesでLooker（LookML）のテストをやってみた | DevelopersIOLookerのCIツールであるSpectaclesを導入した話今回は OSS 版を使いました。github.com4 種類のテスト2022 年 9 月時点で 4 種類のテストが実装されています。SQL validation全ての Dimension の sql パラメーターについて、実際にクエリを実行し、その有効性を検証するdata warehouse のリソースを過剰に使わないよう工夫されている。例えば BigQuery の料金は発生しない1Assert validationLookML IDE 上でも実行できる LookML data tests を実行するContent validation開発メニューの Content Validator 相当の検証を行い、エラーのある Dashboard や Look を特定するLookML validationLookML IDE 上でも実行できる LookML validation を実行する基本的な振る舞いSpectacles は Looker API を使用し、指定した Looker インスタンス上で、LookML data tests や validation などを実行します。Spectacles -(Looker API)-\u003e Your Looker Instanceいわゆるユニットテストでは、テスト環境でソースコードを checkout し、そこでテストを実行しますが、Spectacles はその点は全く違います。つまり GitHub Actions 等の CI で動かす場合、LookML コードの checkout は不要ということです。どのテストを採用し、どのような課題を解決したのかSQL validationいきなりですが、こちらは今回採用出来ませんでした。我々の環境で全ての Explore をテスト対象にすると、かなりの数のテストが失敗します。hidden: yes な Dimension がおそらく全てです。想定内です。$ spectacles sql --project my_project_name --profile -vそれならばと、--ignore-hidden オプションを付けると、今度はこんなエラーが発生します。どうやら 1 つも Dimension が表示されない Explore があるようです。こちらも想定内です。Explore object is missing dimensions, meaning this query won't have fields and will error. Often this happens because you didn't include dimensions when you built the project.--explore オプションでエラーが発生しない Explore を指定すればよいのですが、Explore が 150 個以上ある関係で、切り分けができていません。sql パラメーターは壊れていても、実際に Explore で当該 Dimension が使われないとエラーにならないのと、そのエラーが報告されるとも限らないので、いずれは再挑戦したいです。Assert validation我々の Looker インスタンスでは、BigQuery の外部テーブルに Google スプレッドシートを指定したテーブルを数多く参照しています。つまり人間が編集するデータです。このようなデータはオペミスにより壊れることがあり、primary_key も芋づる式に壊れることがあります。primary_key はほぼ全てテストを書いています2が、約 250 個と数が多いです。一方で LookML IDE 上での data tests は同時実行数が 1 に制限されているようで、テストに 10 分以上かかります。commit 前のテストを必須にできない状態でした。そのため、時々テストを手動実行しないと、壊れたことに気づけない課題がありました。以上の課題を解決するために、定期的に LookML data tests を実行し、手動実行せずに気付けるようになりました。Content validation今までは私の注意力で Dashboard 約 140 個と Look 約 30 個のエラー数ゼロを継続できていましたが、まさに属人的でした。これも定期的に実行し、Content Validator を手動実行することなく気付けるようになりました。LookML validation時々 LookML IDE を介さず、ローカル環境で git commit してデプロイすることがあります。そのケースで大きな変更をすることはないものの、validation が通らない LookML がデプロイされる確率はゼロではありません。こちらは git push のタイミングで実行することで、健全性を高めることが出来ました。どのような GitHub Actions にしたのかgit push のタイミングで実行する CI workflow と、定期的に実行する Schedule workflow を作りました。CI workflowgit push のたびに、当該 commit のブランチに対して、LookML validation のテストをしています3。name: CIon:  push:    branches-ignore: # ①      - 'dev-**'            # LookML IDE の個人用開発ブランチ      - 'tmp_spectacles_**' # spectacles の --commit-ref オプションが作るブランチjobs:  validate_lookml:    name: Validate LookML files    runs-on: ubuntu-latest    timeout-minutes: 5 # デフォルトは 360 分。料金のスパイクを防ぐ    concurrency: # ② spectacles が複数同時に実行しないようにする      spectacles_should_be_run_in_series    steps:    - uses: actions/setup-python@v4      with:        python-version: '3.x'    - name: Install Spectacles      run: pip install spectacles    - name: Run LookML Validator      env:        LOOKER_BASE_URL: \"https://my_instance_name.looker.com\"        LOOKER_CLIENT_ID: ${{ secrets.SPECTACLES_LOOKER_CLIENT_ID }} # ③        LOOKER_CLIENT_SECRET: ${{ secrets.SPECTACLES_LOOKER_CLIENT_SECRET }} # ③      run: spectacles lookml --project my_project_name --commit-ref \"$GITHUB_SHA\" -v①で特定のブランチを除外しています。特に今回のケースでは、tmp_spectacles_** を設定しないと validate_lookml ジョブが無限に起動し続けるため、絶対に必要です。②も結構重要で、CI workflow と次に示す Schedule workflow から起動される spectacles プロセスの同時実行数を 1 に制限しています。Spectacles は③と紐づく Looker ユーザーが実際に開発モードで tmp_spectacles_** というブランチを作り、切り替えます。Looker では 1 人のユーザーが同時に利用できるブランチは 1 つだけです。Spectacles の複数起動は問題が発生するため、今回の制限を設定しました。公式ドキュメントでも言及されています。Schedule workflow早朝と夕方に master（デフォルト）ブランチ上で、Content validation と LookML data tests を実行しています。name: Scheduleon:  schedule:    - cron: \"00 21 * * 0-4\" # 平日の  6:00 JST    - cron: \"30  7 * * 1-5\" # 平日の 16:30 JSTjobs:  schedule:    name: Scheduled job    runs-on: ubuntu-latest    timeout-minutes: 30 # デフォルトは 360 分。料金のスパイクを防ぐ    concurrency: # ① spectacles が複数同時に実行しないようにする      spectacles_should_be_run_in_series    env:      LOOKER_BASE_URL: \"https://my_instance_name.looker.com\"      LOOKER_CLIENT_ID: ${{ secrets.SPECTACLES_LOOKER_CLIENT_ID }}      LOOKER_CLIENT_SECRET: ${{ secrets.SPECTACLES_LOOKER_CLIENT_SECRET }}    steps:    - uses: actions/setup-python@v4      with:        python-version: '3.x'    - name: Install Spectacles      run: pip install spectacles    - name: Run Content Validator      run: spectacles content --project my_project_name -v    - name: Run LookML data tests      run: spectacles assert --project my_project_name -vブランチの時や、master ブランチへのマージ直後ではまだ Dashboard や Look がエラーになることがあるため、Content validation はこのタイミングにしています。LookML data tests も 10 分以上かかることと、git push の粒度でやらないと不安というわけではないため、このタイミングにしています。BigQuery の料金もかかりますからね。落ち穂拾い作業ブランチのゴミが残ることがあるSpectacles が途中で異常終了すると、LookML IDE と GitHub に tmp_spectacles_b016c8a4dd といった、Spectacles が作る作業ブランチが残ることがあります。気づいたら削除してあげましょう。正常終了の場合は残りません。マシンユーザーを作るか作らないかLooker はユーザー課金モデルであるため、Spectacles のためにユーザーを作ることに躊躇するかもしれません。私もそうでした。おまけに Developer 相当の権限が必要なため、そこそこの料金です。Create a Looker API Key | Spectacles DocsWe strongly recommend creating a dedicated Spectacles user in Looker to ensure a human user doesn't accidentally change the Git branch or turn off development mode in the middle of a validation.ですが、公式ドキュメントで強く奨励されているとおり、Spectacles 専用のユーザーを作って下さい。人間のユーザーは権限が大きすぎますし、前述のとおり Spectacles は実際に開発モードでブランチを作って切り替えるため、人間の作業とコンフリクトします。まとめSpectacles というツールを導入して、Looker インスタンスの健全性を高められた話をしました。導入したのは先月ですが、導入の翌日にタイミング良く Schedule workflow のテストが落ち、primary_key が壊れたことに気づけたことにはニッコリしました。私のようなボッチ LookML 開発者は、いかに作業を機械に任せるかが重要だと思います。心の平穏も大事です。また、あとから CI を導入するのは結構大変なので、始めから開発計画に組み込むことをオススメします。それでは良い Looker ライフを！(^^)/Limiting Resource Consumption | Spectacles Docs↩Looker で Join 先の view の primary_key をいい感じにテストする方法をようやく見つけた - Feedforce Developer Blog↩実際には他のジョブや、失敗時の Slack 通知ジョブもありますが、分かりやすくするために省略しています。↩","link":"https://developer.feedforce.jp/entry/2022/09/16/130000","isoDate":"2022-09-16T04:00:00.000Z","dateMiliSeconds":1663300800000,"imageUrl":"https://cdn-ak.f.st-hatena.com/images/fotolife/m/masutaka26/20220914/20220914170914.png","authorName":"masutaka"},{"title":"Looker User Meetup Online #8 で『BigQuery経由で使うGoogleスプレッドシートのスキーマ管理』の話をした","content":"\u003cp\u003eこんばんは \u003ca href=\"http://blog.hatena.ne.jp/masutaka26/\" class=\"hatena-id-icon\"\u003e\u003cimg src=\"https://cdn.profile-image.st-hatena.com/users/masutaka26/profile.png\" width=\"16\" height=\"16\" alt=\"\" class=\"hatena-id-icon\"\u003eid:masutaka26\u003c/a\u003e です。\u003c/p\u003e\n\n\u003cp\u003e本日、\u003ca href=\"https://looker-japan-user-group.connpass.com/event/253923/\"\u003eLooker User Meetup Online #8\u003c/a\u003e で『BigQuery経由で使うGoogleスプレッドシートのスキーマ管理』の話をしてきました。Looker User Meetup は 5 回目の参加、発表は初めてです。\u003c/p\u003e\n\n\u003ciframe src=\"https://docs.google.com/presentation/d/e/2PACX-1vTlQkD3R2OS415gr51ieTs1pyy3cK0ck8By1PYJ8SZtrFDjWyLP1eD_s7Q4UDH_yvmTDNdHFpZQf0IU/embed?start=false\u0026loop=false\u0026delayms=3000\" frameborder=\"0\" width=\"960\" height=\"410\" allowfullscreen=\"true\" mozallowfullscreen=\"true\" webkitallowfullscreen=\"true\"\u003e\u003c/iframe\u003e\n\n\n\u003cp\u003eいくつかネタはあったのですが、今回のテーマは「Lookerまでのデータデリバリー、みんなどうしてる？」ということもあり、この 2 年で確立した方法を紹介することとなりました。\u003c/p\u003e\n\n\u003cp\u003ebq CLI ではなく、terraform で管理している方もいらっしゃいました。terraform の更新に追随するのはそれなりに大変だと思いますが、これならスキーマ定義と、実際のスキーマの差異検知は出来そうですね。\u003c/p\u003e\n\n\u003cp\u003e「dbt seed」を使っている方もいらっしゃるようでした。今回 2 つの発表があった dbt ですが、全く触ったことがありません。😇\u003c/p\u003e\n\n\u003cp\u003eあと、P24 で「BigQueryは一番左のシートしか参照できない」と書きましたが、誤りでした。範囲にでシート名も指定すれば出来ることを確認しました。P10 で華麗に「シート範囲」を無視してますね。💦\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://gist.github.com/masutaka/142ca20b802401d12012fe952f2ea1f3\"\u003eP18 の Gist\u003c/a\u003e との差分は以下になります。\u003c/p\u003e\n\n\u003cpre class=\"code lang-diff\" data-lang=\"diff\" data-unlink\u003e\u003cspan class=\"synType\"\u003ediff --git a/define.json b/define.json\u003c/span\u003e\n\u003cspan class=\"synPreProc\"\u003eindex 9429e16..11d391c 100644\u003c/span\u003e\n\u003cspan class=\"synType\"\u003e--- a/define.json\u003c/span\u003e\n\u003cspan class=\"synType\"\u003e+++ b/define.json\u003c/span\u003e\n\u003cspan class=\"synStatement\"\u003e@@ -1,7 +1,8 @@\u003c/span\u003e\n {\n   \u0026quot;autodetect\u0026quot;: false,\n   \u0026quot;googleSheetsOptions\u0026quot;: {\n\u003cspan class=\"synSpecial\"\u003e-    \u0026quot;skipLeadingRows\u0026quot;: 1\u003c/span\u003e\n\u003cspan class=\"synIdentifier\"\u003e+    \u0026quot;skipLeadingRows\u0026quot;: 1,\u003c/span\u003e\n\u003cspan class=\"synIdentifier\"\u003e+    \u0026quot;range\u0026quot;: \u0026quot;マスターデータ!A:E\u0026quot;\u003c/span\u003e\n   },\n   \u0026quot;ignoreUnknownValues\u0026quot;: false,\n   \u0026quot;maxBadRecords\u0026quot;: 0,\n\u003c/pre\u003e\n\n\n\u003cp\u003e一人開発の弊害ではありますが、こうやってアウトプットすることでこそ得られるフィードバックとも言えます。ある意味期待通りです。😄\u003c/p\u003e\n\n\u003cp\u003e次回以降も需要があれば発表したいと思います。\u003c/p\u003e\n","contentSnippet":"こんばんは id:masutaka26 です。本日、Looker User Meetup Online #8 で『BigQuery経由で使うGoogleスプレッドシートのスキーマ管理』の話をしてきました。Looker User Meetup は 5 回目の参加、発表は初めてです。いくつかネタはあったのですが、今回のテーマは「Lookerまでのデータデリバリー、みんなどうしてる？」ということもあり、この 2 年で確立した方法を紹介することとなりました。bq CLI ではなく、terraform で管理している方もいらっしゃいました。terraform の更新に追随するのはそれなりに大変だと思いますが、これならスキーマ定義と、実際のスキーマの差異検知は出来そうですね。「dbt seed」を使っている方もいらっしゃるようでした。今回 2 つの発表があった dbt ですが、全く触ったことがありません。😇あと、P24 で「BigQueryは一番左のシートしか参照できない」と書きましたが、誤りでした。範囲にでシート名も指定すれば出来ることを確認しました。P10 で華麗に「シート範囲」を無視してますね。💦P18 の Gist との差分は以下になります。diff --git a/define.json b/define.jsonindex 9429e16..11d391c 100644--- a/define.json+++ b/define.json@@ -1,7 +1,8 @@ {   \"autodetect\": false,   \"googleSheetsOptions\": {-    \"skipLeadingRows\": 1+    \"skipLeadingRows\": 1,+    \"range\": \"マスターデータ!A:E\"   },   \"ignoreUnknownValues\": false,   \"maxBadRecords\": 0,一人開発の弊害ではありますが、こうやってアウトプットすることでこそ得られるフィードバックとも言えます。ある意味期待通りです。😄次回以降も需要があれば発表したいと思います。","link":"https://developer.feedforce.jp/entry/2022/07/21/210000","isoDate":"2022-07-21T12:00:00.000Z","dateMiliSeconds":1658404800000,"imageUrl":"https://cdn-ak.f.st-hatena.com/images/fotolife/m/masutaka26/20201023/20201023184859.png","authorName":"masutaka"},{"title":"LAMS を導入して、LookML の再利用性を高められた","content":"\u003cp\u003eこんにちは、\u003ca href=\"http://blog.hatena.ne.jp/masutaka26/\" class=\"hatena-id-icon\"\u003e\u003cimg src=\"https://cdn.profile-image.st-hatena.com/users/masutaka26/profile.png\" width=\"16\" height=\"16\" alt=\"\" class=\"hatena-id-icon\"\u003eid:masutaka26\u003c/a\u003e です。\u003ca href=\"https://developer.feedforce.jp/entry/2022/06/17/110000\"\u003e先週\u003c/a\u003eに引き続いてのブログ更新です。\u003c/p\u003e\n\n\u003cp\u003eRuby や JavaScript などのプログラミング言語では、依存関係を管理することでコードの再利用性を高めるとともに、バグの少ないコードを書くことが出来ます。ただ、\u003ca href=\"https://docs.looker.com/ja/data-modeling/learning-lookml/what-is-lookml\"\u003eLookML\u003c/a\u003e はプログラミング言語ではないため、同じ方法が使えません。\u003c/p\u003e\n\n\u003cp\u003e今回は LAMS という LookML Linter を導入することで、LookML の再利用性を高める糸口を見つけました。LAMS を紹介しつつ、その知見を共有します。\u003c/p\u003e\n\n\u003cul class=\"table-of-contents\"\u003e\n    \u003cli\u003e\u003ca href=\"#LAMS-とは\"\u003eLAMS とは\u003c/a\u003e\u003c/li\u003e\n    \u003cli\u003e\u003ca href=\"#導入方法\"\u003e導入方法\u003c/a\u003e\u003c/li\u003e\n    \u003cli\u003e\u003ca href=\"#ルールの免除\"\u003eルールの免除\u003c/a\u003e\u003c/li\u003e\n    \u003cli\u003e\u003ca href=\"#LookML-の再利用性を高められた-F1-ルール\"\u003eLookML の再利用性を高められた F1 ルール\u003c/a\u003e\u003c/li\u003e\n    \u003cli\u003e\u003ca href=\"#注意事項\"\u003e注意事項\u003c/a\u003e\u003c/li\u003e\n    \u003cli\u003e\u003ca href=\"#まとめ\"\u003eまとめ\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch2 id=\"LAMS-とは\"\u003eLAMS とは\u003c/h2\u003e\n\n\u003cp\u003eLAMS (Look At Me Sideways) は LookML のスタイルガイドと Linter がセットになったツールです。準公式のツールなのかな？\u003c/p\u003e\n\n\u003cp\u003e\u003ciframe src=\"https://hatenablog-parts.com/embed?url=https%3A%2F%2Fgithub.com%2Flooker-open-source%2Flook-at-me-sideways\" title=\"GitHub - looker-open-source/look-at-me-sideways: A style guide and linter for Looker\u0026#39;s LookML data modeling language\" class=\"embed-card embed-webcard\" scrolling=\"no\" frameborder=\"0\" style=\"display: block; width: 100%; height: 155px; max-width: 500px; margin: 10px 0px;\"\u003e\u003c/iframe\u003e\u003ccite class=\"hatena-citation\"\u003e\u003ca href=\"https://github.com/looker-open-source/look-at-me-sideways\"\u003egithub.com\u003c/a\u003e\u003c/cite\u003e\u003c/p\u003e\n\n\u003cp\u003eLookML IDE に付属する LookML validator が文法的な誤りを検出するのに対して、LAMS はメンテナンス性の高い、もう一歩進んだ LookML を提案します。\u003c/p\u003e\n\n\u003cp\u003e2022-06-21 現在、4 グループ、32 個のルールが定義されています。\u003c/p\u003e\n\n\u003cp\u003e🔗 \u003ca href=\"https://looker-open-source.github.io/look-at-me-sideways/rules.html\"\u003eLAMS Style Guide\u003c/a\u003e\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eKey Dimensions (K1 ~ K6)\u003c/li\u003e\n\u003cli\u003eOther Fields (F1 ~ F6)\u003c/li\u003e\n\u003cli\u003eDerived Tables (T1 ~ T15)\u003c/li\u003e\n\u003cli\u003eExplores (E1 ~ E5)\u003c/li\u003e\n\u003c/ul\u003e\n\n\n\u003ch2 id=\"導入方法\"\u003e導入方法\u003c/h2\u003e\n\n\u003cp\u003eLinter を後から導入するのは辛いので、可能ならリポジトリを作るタイミングで導入するのが良いと思います。\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://github.com/looker-open-source/look-at-me-sideways#deployment-examples\"\u003eREADME の Deployment Examples\u003c/a\u003e には、ローカルマシンで実行する方法や、GitHub Actions や CircleCI などで CI する方法がまとまっています。\u003c/p\u003e\n\n\u003cp\u003e今回は GitHub Actions を採用しました。git push するたびに LAMS が実行され、結果を Pull request 上で確認出来ます。参考までにコードを貼っておきます。\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003e.github/workflows/ci.yml\u003c/strong\u003e\u003c/p\u003e\n\n\u003cpre class=\"code lang-yaml\" data-lang=\"yaml\" data-unlink\u003e\u003cspan class=\"synIdentifier\"\u003ename\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e:\u003c/span\u003e CI\n\n\u003cspan class=\"synIdentifier\"\u003eon\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e:\u003c/span\u003e push\n\n\u003cspan class=\"synIdentifier\"\u003ejobs\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e:\u003c/span\u003e\n  \u003cspan class=\"synIdentifier\"\u003elams\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e:\u003c/span\u003e\n    \u003cspan class=\"synIdentifier\"\u003ename\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e:\u003c/span\u003e LAMS LookML Linter\n    \u003cspan class=\"synIdentifier\"\u003eruns-on\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e:\u003c/span\u003e ubuntu-latest\n    \u003cspan class=\"synIdentifier\"\u003esteps\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e:\u003c/span\u003e\n    \u003cspan class=\"synStatement\"\u003e- \u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003euses\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e:\u003c/span\u003e actions/checkout@v3\n    \u003cspan class=\"synStatement\"\u003e- \u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003euses\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e:\u003c/span\u003e actions/setup-node@v3\n      \u003cspan class=\"synIdentifier\"\u003ewith\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e:\u003c/span\u003e\n        \u003cspan class=\"synIdentifier\"\u003enode-version\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e:\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e'16'\u003c/span\u003e\u003cspan class=\"synComment\"\u003e # Use LTS https://nodejs.org/en/\u003c/span\u003e\n    \u003cspan class=\"synStatement\"\u003e- \u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ename\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e:\u003c/span\u003e Install LAMS\n      \u003cspan class=\"synIdentifier\"\u003erun\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e:\u003c/span\u003e npm install -g @looker/look-at-me-sideways@2\n    \u003cspan class=\"synStatement\"\u003e- \u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ename\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e:\u003c/span\u003e Run LAMS\n      \u003cspan class=\"synIdentifier\"\u003eenv\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e:\u003c/span\u003e\n        \u003cspan class=\"synIdentifier\"\u003eLOOKER_LICENSE_KEY\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e:\u003c/span\u003e ${{ secrets.LOOKER_LICENSE_KEY }}\n      \u003cspan class=\"synIdentifier\"\u003erun\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e:\u003c/span\u003e make lams\n\u003c/pre\u003e\n\n\n\u003cp\u003e\u003cstrong\u003eMakefile\u003c/strong\u003e \u003csup id=\"fnref:1\"\u003e\u003ca href=\"#fn:1\" rel=\"footnote\"\u003e1\u003c/a\u003e\u003c/sup\u003e\u003c/p\u003e\n\n\u003cpre class=\"code makefile\" data-lang=\"makefile\" data-unlink\u003eLAMS := lams\nLOOKER_LICENSE_KEY := ${LOOKER_LICENSE_KEY}\nREPORT_USER := feedmatic_report@example.com\nSOURCE := **/{*.model,*.explore,*.view,*.layer,manifest}.lkml\n\n.PHONY: lams\nlams:\n    @$(LAMS) --reporting=yes --report-license-key=$(LOOKER_LICENSE_KEY) --report-user=$(REPORT_USER) --source=\u0026#39;$(SOURCE)\u0026#39;\u003c/pre\u003e\n\n\n\u003ch2 id=\"ルールの免除\"\u003eルールの免除\u003c/h2\u003e\n\n\u003cp\u003emanifest.lkml にこのように書くと、プロジェクト全体で任意のルールを免除することが出来ます。\u003c/p\u003e\n\n\u003cpre class=\"code\" data-lang=\"\" data-unlink\u003e# LAMS\n# rule_exemptions: {\n#  F2: \u0026#34;Any explanatory message you would like\u0026#34;\n#  F3: \u0026#34;Another explanatory message for a different rule\u0026#34;\n# }\u003c/pre\u003e\n\n\n\u003cp\u003edimension, measure, derived_table 単位でも免除することが出来ます。基本はこちらで免除し、無理そうなら manifest.lkml で免除すると良いでしょう。\u003c/p\u003e\n\n\u003cp\u003e初めから全てのルールをパスすることは少ないと思うので、必要に応じて免除すると良いでしょう。また、LAMS はあくまでスタイルガイドなので、必ずしも全てのルールに対応する必要はありません。\u003c/p\u003e\n\n\u003ch2 id=\"LookML-の再利用性を高められた-F1-ルール\"\u003eLookML の再利用性を高められた F1 ルール\u003c/h2\u003e\n\n\u003cp\u003e32 個のルールのうち、今回は個人的に一番意義というか、感心した \u003ca href=\"https://looker-open-source.github.io/look-at-me-sideways/rules.html#f1\"\u003eF1\u003c/a\u003e ルールを紹介します。\u003c/p\u003e\n\n\u003cp\u003e例えば orders.view から users.view の \u003ccode\u003ecount\u003c/code\u003e measure を参照する、以下のような LookML があったとします。\u003c/p\u003e\n\n\u003cp\u003eLookML 書き始めの頃はこのように書きがちかと思いますが、F1 ルールでは NG です。orders.view が users.view に依存してしまうことで、orders.view の再利用がし辛くなるからです。そもそもこのケースでは LookML validation もエラーになるはずです。\u003csup id=\"fnref:2\"\u003e\u003ca href=\"#fn:2\" rel=\"footnote\"\u003e2\u003c/a\u003e\u003c/sup\u003e\u003c/p\u003e\n\n\u003cpre class=\"code\" data-lang=\"\" data-unlink\u003eview: users {...}\n\nview: orders {\n  ...\n  measure: orders_per_user {\n    sql: ${count} / NULLIF(${users.count},0)\n  }\n}\n\nexplore: orders {} # Errors :(\n\nexplore: users {\n  join: orders {...}\n}\u003c/pre\u003e\n\n\n\u003cp\u003e解決方法がこちらです。まず、依存フィールドだけを抽出した users_orders.view を作ります。この view では sql_table_name や derived_table を設定しません。\u003c/p\u003e\n\n\u003cpre class=\"code\" data-lang=\"\" data-unlink\u003eview: users {...}\nview: orders {...}\n\nview: users_orders {\n  # No need for a sql_table_name or derived_table\n  measure: orders_per_user {\n    sql: ${orders.count} / NULLIF(${users.count},0)\n  }\n}\u003c/pre\u003e\n\n\n\u003cp\u003eこうすることで少なくとも orders.explore は users.view に依存しないクリーンな LookML になりました。\u003c/p\u003e\n\n\u003cpre class=\"code\" data-lang=\"\" data-unlink\u003eexplore: orders {} # Doesn\u0026#39;t break like before!\u003c/pre\u003e\n\n\n\u003cp\u003e次に users.explore で魔法を使います。users.view と users_orders.view の Join で通常指定するはずの \u003ccode\u003esql_on ... ;;\u003c/code\u003e の代わりに、空の SQL \u003ccode\u003esql: ;;\u003c/code\u003e を指定します。\u003c/p\u003e\n\n\u003cpre class=\"code\" data-lang=\"\" data-unlink\u003eexplore: users {\n  join: orders {...}\n  join: users_orders {\n    sql: ;;\n    # Use `sql` instead of `sql_on` and put some whitespace in it\n    relationship: one_to_one\n    view_label: \u0026#34;Orders\u0026#34; # For cleaner explore UI\n  }\n}\u003c/pre\u003e\n\n\n\u003cp\u003eえ？と思うかもしれませんが、これは妥当な LookML です。\u003c/p\u003e\n\n\u003cp\u003eUsers explore が生成する SQL を確認すると分かりますが、\u003ccode\u003eorders_per_user\u003c/code\u003e measure を選択しても Join 句は増えません。しかしこの measure が参照するテーブルは既存の users と orders だけなので、構文エラーになりません。\u003c/p\u003e\n\n\u003cp\u003e初見での理解は難しくなりますが、orders.view の再利用性が高まるのは大きなメリットです。\u003c/p\u003e\n\n\u003ch2 id=\"注意事項\"\u003e注意事項\u003c/h2\u003e\n\n\u003cp\u003e\u003ca href=\"https://looker-open-source.github.io/look-at-me-sideways/rules.html#k1\"\u003eK1\u003c/a\u003e と \u003ca href=\"https://looker-open-source.github.io/look-at-me-sideways/rules.html#k2\"\u003eK2\u003c/a\u003e のように、一部のルールには依存関係があり、一方を免除するためには両方免除する必要があります。\u003c/p\u003e\n\n\u003cp\u003eあと、まだ \u003ca href=\"https://docs.looker.com/reference/view-params/extension-for-view\"\u003eExtension\u003c/a\u003e と \u003ca href=\"https://docs.looker.com/ja/data-modeling/learning-lookml/refinements\"\u003eRefinements\u003c/a\u003e に対応していません。Issue \u003ca href=\"https://github.com/looker-open-source/look-at-me-sideways/issues/46\"\u003e#46\u003c/a\u003e によると、\u003ca href=\"https://github.com/fabio-looker/node-lookml-parser\"\u003eパーサー\u003c/a\u003e側は対応したそうで、あとは LAMS 本体を対応するだけだそうです。割と致命的な課題...。\u003c/p\u003e\n\n\u003ch2 id=\"まとめ\"\u003eまとめ\u003c/h2\u003e\n\n\u003cp\u003eLookML の Linter である LAMS を紹介しました。うまく使うことで、再利用性やメンテナンス性の高い LookML を書くことが出来るかもしれません。\u003c/p\u003e\n\n\u003cp\u003eそれでは良い Looker ライフを！(^^)/\u003c/p\u003e\n\u003cdiv class=\"footnotes\"\u003e\n\u003chr/\u003e\n\u003col\u003e\n\u003cli id=\"fn:1\"\u003e\n\u003cp\u003eMakefile を作ったのは、ローカルで実行しやすくするためです。\u003ca href=\"#fnref:1\" rev=\"footnote\"\u003e\u0026#8617;\u003c/a\u003e\u003c/p\u003e\u003c/li\u003e\n\u003cli id=\"fn:2\"\u003e\n\u003cp\u003e\u003ca href=\"https://help.looker.com/hc/en-us/articles/360023586293-Error-Unknown-or-Inaccessible-Field\"\u003eF1 ルールに従わずにエラーを回避する方法はあります。\u003c/a\u003e\u003ca href=\"#fnref:2\" rev=\"footnote\"\u003e\u0026#8617;\u003c/a\u003e\u003c/p\u003e\u003c/li\u003e\n\u003c/ol\u003e\n\u003c/div\u003e\n\n","contentSnippet":"こんにちは、id:masutaka26 です。先週に引き続いてのブログ更新です。Ruby や JavaScript などのプログラミング言語では、依存関係を管理することでコードの再利用性を高めるとともに、バグの少ないコードを書くことが出来ます。ただ、LookML はプログラミング言語ではないため、同じ方法が使えません。今回は LAMS という LookML Linter を導入することで、LookML の再利用性を高める糸口を見つけました。LAMS を紹介しつつ、その知見を共有します。LAMS とは導入方法ルールの免除LookML の再利用性を高められた F1 ルール注意事項まとめLAMS とはLAMS (Look At Me Sideways) は LookML のスタイルガイドと Linter がセットになったツールです。準公式のツールなのかな？github.comLookML IDE に付属する LookML validator が文法的な誤りを検出するのに対して、LAMS はメンテナンス性の高い、もう一歩進んだ LookML を提案します。2022-06-21 現在、4 グループ、32 個のルールが定義されています。🔗 LAMS Style GuideKey Dimensions (K1 ~ K6)Other Fields (F1 ~ F6)Derived Tables (T1 ~ T15)Explores (E1 ~ E5)導入方法Linter を後から導入するのは辛いので、可能ならリポジトリを作るタイミングで導入するのが良いと思います。README の Deployment Examples には、ローカルマシンで実行する方法や、GitHub Actions や CircleCI などで CI する方法がまとまっています。今回は GitHub Actions を採用しました。git push するたびに LAMS が実行され、結果を Pull request 上で確認出来ます。参考までにコードを貼っておきます。.github/workflows/ci.ymlname: CIon: pushjobs:  lams:    name: LAMS LookML Linter    runs-on: ubuntu-latest    steps:    - uses: actions/checkout@v3    - uses: actions/setup-node@v3      with:        node-version: '16' # Use LTS https://nodejs.org/en/    - name: Install LAMS      run: npm install -g @looker/look-at-me-sideways@2    - name: Run LAMS      env:        LOOKER_LICENSE_KEY: ${{ secrets.LOOKER_LICENSE_KEY }}      run: make lamsMakefile 1LAMS := lamsLOOKER_LICENSE_KEY := ${LOOKER_LICENSE_KEY}REPORT_USER := feedmatic_report@example.comSOURCE := **/{*.model,*.explore,*.view,*.layer,manifest}.lkml.PHONY: lamslams:    @$(LAMS) --reporting=yes --report-license-key=$(LOOKER_LICENSE_KEY) --report-user=$(REPORT_USER) --source='$(SOURCE)'ルールの免除manifest.lkml にこのように書くと、プロジェクト全体で任意のルールを免除することが出来ます。# LAMS# rule_exemptions: {#  F2: \"Any explanatory message you would like\"#  F3: \"Another explanatory message for a different rule\"# }dimension, measure, derived_table 単位でも免除することが出来ます。基本はこちらで免除し、無理そうなら manifest.lkml で免除すると良いでしょう。初めから全てのルールをパスすることは少ないと思うので、必要に応じて免除すると良いでしょう。また、LAMS はあくまでスタイルガイドなので、必ずしも全てのルールに対応する必要はありません。LookML の再利用性を高められた F1 ルール32 個のルールのうち、今回は個人的に一番意義というか、感心した F1 ルールを紹介します。例えば orders.view から users.view の count measure を参照する、以下のような LookML があったとします。LookML 書き始めの頃はこのように書きがちかと思いますが、F1 ルールでは NG です。orders.view が users.view に依存してしまうことで、orders.view の再利用がし辛くなるからです。そもそもこのケースでは LookML validation もエラーになるはずです。2view: users {...}view: orders {  ...  measure: orders_per_user {    sql: ${count} / NULLIF(${users.count},0)  }}explore: orders {} # Errors :(explore: users {  join: orders {...}}解決方法がこちらです。まず、依存フィールドだけを抽出した users_orders.view を作ります。この view では sql_table_name や derived_table を設定しません。view: users {...}view: orders {...}view: users_orders {  # No need for a sql_table_name or derived_table  measure: orders_per_user {    sql: ${orders.count} / NULLIF(${users.count},0)  }}こうすることで少なくとも orders.explore は users.view に依存しないクリーンな LookML になりました。explore: orders {} # Doesn't break like before!次に users.explore で魔法を使います。users.view と users_orders.view の Join で通常指定するはずの sql_on ... ;; の代わりに、空の SQL sql: ;; を指定します。explore: users {  join: orders {...}  join: users_orders {    sql: ;;    # Use `sql` instead of `sql_on` and put some whitespace in it    relationship: one_to_one    view_label: \"Orders\" # For cleaner explore UI  }}え？と思うかもしれませんが、これは妥当な LookML です。Users explore が生成する SQL を確認すると分かりますが、orders_per_user measure を選択しても Join 句は増えません。しかしこの measure が参照するテーブルは既存の users と orders だけなので、構文エラーになりません。初見での理解は難しくなりますが、orders.view の再利用性が高まるのは大きなメリットです。注意事項K1 と K2 のように、一部のルールには依存関係があり、一方を免除するためには両方免除する必要があります。あと、まだ Extension と Refinements に対応していません。Issue #46 によると、パーサー側は対応したそうで、あとは LAMS 本体を対応するだけだそうです。割と致命的な課題...。まとめLookML の Linter である LAMS を紹介しました。うまく使うことで、再利用性やメンテナンス性の高い LookML を書くことが出来るかもしれません。それでは良い Looker ライフを！(^^)/Makefile を作ったのは、ローカルで実行しやすくするためです。↩F1 ルールに従わずにエラーを回避する方法はあります。↩","link":"https://developer.feedforce.jp/entry/2022/06/21/130000","isoDate":"2022-06-21T04:00:00.000Z","dateMiliSeconds":1655784000000,"imageUrl":"https://cdn-ak.f.st-hatena.com/images/fotolife/m/masutaka26/20201023/20201023184859.png","authorName":"masutaka"},{"title":"Looker で困った時の解決手段まとめ","content":"\u003cp\u003eこんにちは、\u003ca href=\"http://blog.hatena.ne.jp/masutaka26/\" class=\"hatena-id-icon\"\u003e\u003cimg src=\"https://cdn.profile-image.st-hatena.com/users/masutaka26/profile.png\" width=\"16\" height=\"16\" alt=\"\" class=\"hatena-id-icon\"\u003eid:masutaka26\u003c/a\u003e です。\u003c/p\u003e\n\n\u003cp\u003e今回は少し前に社内に共有した記事を、このブログでも共有します。Looker は Ruby や Python 等のプログラミング言語よりはユーザーが少ないはずで、質問相手がいないと本当に困ります。この記事がその一助になれば幸いです。\u003c/p\u003e\n\n\u003cul class=\"table-of-contents\"\u003e\n    \u003cli\u003e\u003ca href=\"#ググる\"\u003eググる\u003c/a\u003e\u003c/li\u003e\n    \u003cli\u003e\u003ca href=\"#チャット\"\u003eチャット\u003c/a\u003e\u003c/li\u003e\n    \u003cli\u003e\u003ca href=\"#問い合わせフォーム\"\u003e問い合わせフォーム\u003c/a\u003e\u003c/li\u003e\n    \u003cli\u003e\u003ca href=\"#Looker-Community-en\"\u003eLooker Community (en)\u003c/a\u003e\u003c/li\u003e\n    \u003cli\u003e\u003ca href=\"#Looker-Community-ja\"\u003eLooker Community (ja)\u003c/a\u003e\u003c/li\u003e\n    \u003cli\u003e\u003ca href=\"#Slack-Looker-User-Group---Japan\"\u003eSlack Looker User Group - Japan\u003c/a\u003e\u003c/li\u003e\n    \u003cli\u003e\u003ca href=\"#番外編-製品についてのアイディアがありますか\"\u003e番外編: 製品についてのアイディアがありますか？\u003c/a\u003e\u003c/li\u003e\n    \u003cli\u003e\u003ca href=\"#まとめ\"\u003eまとめ\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch2 id=\"ググる\"\u003eググる\u003c/h2\u003e\n\n\u003cp\u003eさすがにこれは基本ですね。💦\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://docs.looker.com/ja\"\u003e公式ドキュメント\u003c/a\u003e に誘導されることもしばしばです。これが結構よく出来ています。\u003ccode\u003elooker table calculation\u003c/code\u003e などと英語でググると、解決にたどり着きやすいかもしれません。\u003c/p\u003e\n\n\u003cp\u003eマニアックなテクニックとして、ググった URL の後ろに \u003ccode\u003e\u0026amp;gl=us\u0026amp;hl=en\u0026amp;gws_rd=cr\u003c/code\u003e を付け、検索対象を英語にして、日本語のノイズを減らす方法もあります。\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://www.google.com/search?q=looker+table+calculation\u0026oq=looker+table+calculation\u0026aqs=chrome..69i57.26j0j7\u0026sourceid=chrome\u0026ie=UTF-8\"\u003ehttps://www.google.com/search?q=looker+table+calculation\u0026oq=looker+table+calculation\u0026aqs=chrome..69i57.26j0j7\u0026sourceid=chrome\u0026ie=UTF-8\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e↓\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://www.google.com/search?q=looker+table+calculation\u0026oq=looker+table+calculation\u0026aqs=chrome..69i57.26j0j7\u0026sourceid=chrome\u0026ie=UTF-8\u0026gl=us\u0026hl=en\u0026gws_rd=cr\"\u003ehttps://www.google.com/search?q=looker+table+calculation\u0026oq=looker+table+calculation\u0026aqs=chrome..69i57.26j0j7\u0026sourceid=chrome\u0026ie=UTF-8\u0026gl=us\u0026hl=en\u0026gws_rd=cr\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e私はこんなブックマークレットを使っています。ちなみに名前は \u003ccode\u003een\u003c/code\u003e です。\u003c/p\u003e\n\n\u003cpre class=\"code\" data-lang=\"\" data-unlink\u003ejavascript:location.href=location.href+\u0026#39;\u0026amp;gl=us\u0026amp;hl=en\u0026amp;gws_rd=cr\u0026#39;\u003c/pre\u003e\n\n\n\u003ch2 id=\"チャット\"\u003eチャット\u003c/h2\u003e\n\n\u003cp\u003eAdmin 権限を持ったユーザーだけが使用できます。\u003c/p\u003e\n\n\u003cp\u003e日本語可ですが、日々混んでいるので急ぎでなければ次の「問い合わせフォーム」が良いと思います。\u003c/p\u003e\n\n\u003cp\u003e\u003cspan itemscope itemtype=\"http://schema.org/Photograph\"\u003e\u003cimg src=\"https://cdn-ak.f.st-hatena.com/images/fotolife/m/masutaka26/20220616/20220616165108.png\" width=\"313\" height=\"400\" loading=\"lazy\" title=\"\" class=\"hatena-fotolife\" itemprop=\"image\"\u003e\u003c/span\u003e\u003c/p\u003e\n\n\u003ch2 id=\"問い合わせフォーム\"\u003e問い合わせフォーム\u003c/h2\u003e\n\n\u003cp\u003e\u003ca href=\"https://help.looker.com/hc/en-us/requests\"\u003ehttps://help.looker.com/hc/en-us/requests\u003c/a\u003e から \u003ccode\u003eCreate a New Request\u003c/code\u003e をクリックします。Looker ユーザーなら誰でも利用可能なのかな？日本語可です。\u003c/p\u003e\n\n\u003cp\u003eこのフォームは割と最近知ったのですが、問い合わせてみたら翌日返信が来て、速やかに解決できました。急がない時はチャットより良いと思います。サポートの方も時間に追われなくて良さそうです。\u003c/p\u003e\n\n\u003cp\u003e今までのチャット履歴もここで確認出来ます。これは知らなかった。\u003c/p\u003e\n\n\u003ch2 id=\"Looker-Community-en\"\u003eLooker Community (en)\u003c/h2\u003e\n\n\u003cp\u003e誰でも利用可能です。日本語不可。頻繁に投稿があります。\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://community.looker.com/\"\u003ehttps://community.looker.com/\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003cspan itemscope itemtype=\"http://schema.org/Photograph\"\u003e\u003cimg src=\"https://cdn-ak.f.st-hatena.com/images/fotolife/m/masutaka26/20220616/20220616173918.png\" width=\"1200\" height=\"489\" loading=\"lazy\" title=\"\" class=\"hatena-fotolife\" itemprop=\"image\"\u003e\u003c/span\u003e\u003c/p\u003e\n\n\u003ch2 id=\"Looker-Community-ja\"\u003eLooker Community (ja)\u003c/h2\u003e\n\n\u003cp\u003e誰でも利用可能な日本語コミュニティです。稀に投稿があります。\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://community.looker.com/%E3%83%98%E3%83%AB%E3%83%97%E3%81%A8%E3%82%B5%E3%83%9D%E3%83%BC%E3%83%88-101\"\u003eコミュニティフォーラム (Japanese) \u003e ヘルプとサポート\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003cspan itemscope itemtype=\"http://schema.org/Photograph\"\u003e\u003cimg src=\"https://cdn-ak.f.st-hatena.com/images/fotolife/m/masutaka26/20220616/20220616174114.png\" width=\"1200\" height=\"458\" loading=\"lazy\" title=\"\" class=\"hatena-fotolife\" itemprop=\"image\"\u003e\u003c/span\u003e\u003c/p\u003e\n\n\u003cp\u003e⚠️ \u003ca href=\"https://community.looker.com/%E3%82%B3%E3%83%9F%E3%83%A5%E3%83%8B%E3%83%86%E3%82%A3%E3%83%95%E3%82%A9%E3%83%BC%E3%83%A9%E3%83%A0-japanese-161\"\u003eコミュニティフォーラム (Japanese) のトップ\u003c/a\u003e で \u003ccode\u003eAsk question / Create topic\u003c/code\u003e ボタンをクリックすると en のほうにトピックが作られてしまいます。注意です。\u003c/p\u003e\n\n\u003cp\u003e\u003cspan itemscope itemtype=\"http://schema.org/Photograph\"\u003e\u003cimg src=\"https://cdn-ak.f.st-hatena.com/images/fotolife/m/masutaka26/20220616/20220616174411.png\" width=\"1116\" height=\"774\" loading=\"lazy\" title=\"\" class=\"hatena-fotolife\" itemprop=\"image\"\u003e\u003c/span\u003e\u003c/p\u003e\n\n\u003cp\u003eこのフォームが正解です。\u003c/p\u003e\n\n\u003cp\u003e\u003cspan itemscope itemtype=\"http://schema.org/Photograph\"\u003e\u003cimg src=\"https://cdn-ak.f.st-hatena.com/images/fotolife/m/masutaka26/20220616/20220616174446.png\" width=\"1200\" height=\"690\" loading=\"lazy\" title=\"\" class=\"hatena-fotolife\" itemprop=\"image\"\u003e\u003c/span\u003e\u003c/p\u003e\n\n\u003ch2 id=\"Slack-Looker-User-Group---Japan\"\u003eSlack Looker User Group - Japan\u003c/h2\u003e\n\n\u003cp\u003e日本語の Slack コミュニティもあります。\u003ca href=\"https://community.looker.com/%E3%83%8B%E3%83%A5%E3%83%BC%E3%82%B9%E3%81%A8%E5%91%8A%E7%9F%A5-100/looker%E3%83%A6%E3%83%BC%E3%82%B6%E3%83%BC%E4%BC%9Aslack%E3%81%AE%E3%81%94%E6%A1%88%E5%86%85-28903\"\u003e今年の初め (2022-01-14) に作られました\u003c/a\u003e。\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://join.slack.com/t/lookerusergroup-japan/shared_invite/zt-1auagto9i-cT2lV~cejC7MgxMrzvveow\"\u003eこの招待リンク\u003c/a\u003eから参加出来ます。\u003c/p\u003e\n\n\u003ch2 id=\"番外編-製品についてのアイディアがありますか\"\u003e番外編: 製品についてのアイディアがありますか？\u003c/h2\u003e\n\n\u003cp\u003e新しい機能のアイディアを POST 出来る場所です。Admin 権限を持ったユーザーだけが使用できます。日本語不可です。\u003c/p\u003e\n\n\u003cp\u003e不具合も報告されることがあり、たまに 前述の「問い合わせフォーム」に誘導されています。それで知りました。\u003c/p\u003e\n\n\u003cp\u003e\u003cspan itemscope itemtype=\"http://schema.org/Photograph\"\u003e\u003cimg src=\"https://cdn-ak.f.st-hatena.com/images/fotolife/m/masutaka26/20220616/20220616175411.png\" width=\"391\" height=\"500\" loading=\"lazy\" title=\"\" class=\"hatena-fotolife\" itemprop=\"image\"\u003e\u003c/span\u003e\u003c/p\u003e\n\n\u003ch2 id=\"まとめ\"\u003eまとめ\u003c/h2\u003e\n\n\u003cp\u003e私が知る限りの「Looker で困った時の解決手段」をまとめました。\u003c/p\u003e\n\n\u003cp\u003e以前紹介した情報収集も日々継続すれば、Looker のスキルはかなり高まる実感があります。\u003c/p\u003e\n\n\u003cp\u003e\u003ciframe src=\"https://hatenablog-parts.com/embed?url=https%3A%2F%2Fdeveloper.feedforce.jp%2Fentry%2F2021%2F08%2F16%2F150000\" title=\"私が１年かけて辿り着いた Looker の情報収集方法を紹介する - Feedforce Developer Blog\" class=\"embed-card embed-blogcard\" scrolling=\"no\" frameborder=\"0\" style=\"display: block; width: 100%; height: 190px; max-width: 500px; margin: 10px 0px;\"\u003e\u003c/iframe\u003e\u003c/p\u003e\n\n\u003cp\u003eそれでは良い Looker ライフを！(^^)/\u003c/p\u003e\n","contentSnippet":"こんにちは、id:masutaka26 です。今回は少し前に社内に共有した記事を、このブログでも共有します。Looker は Ruby や Python 等のプログラミング言語よりはユーザーが少ないはずで、質問相手がいないと本当に困ります。この記事がその一助になれば幸いです。ググるチャット問い合わせフォームLooker Community (en)Looker Community (ja)Slack Looker User Group - Japan番外編: 製品についてのアイディアがありますか？まとめググるさすがにこれは基本ですね。💦公式ドキュメント に誘導されることもしばしばです。これが結構よく出来ています。looker table calculation などと英語でググると、解決にたどり着きやすいかもしれません。マニアックなテクニックとして、ググった URL の後ろに \u0026gl=us\u0026hl=en\u0026gws_rd=cr を付け、検索対象を英語にして、日本語のノイズを減らす方法もあります。https://www.google.com/search?q=looker+table+calculation\u0026oq=looker+table+calculation\u0026aqs=chrome..69i57.26j0j7\u0026sourceid=chrome\u0026ie=UTF-8↓https://www.google.com/search?q=looker+table+calculation\u0026oq=looker+table+calculation\u0026aqs=chrome..69i57.26j0j7\u0026sourceid=chrome\u0026ie=UTF-8\u0026gl=us\u0026hl=en\u0026gws_rd=cr私はこんなブックマークレットを使っています。ちなみに名前は en です。javascript:location.href=location.href+'\u0026gl=us\u0026hl=en\u0026gws_rd=cr'チャットAdmin 権限を持ったユーザーだけが使用できます。日本語可ですが、日々混んでいるので急ぎでなければ次の「問い合わせフォーム」が良いと思います。問い合わせフォームhttps://help.looker.com/hc/en-us/requests から Create a New Request をクリックします。Looker ユーザーなら誰でも利用可能なのかな？日本語可です。このフォームは割と最近知ったのですが、問い合わせてみたら翌日返信が来て、速やかに解決できました。急がない時はチャットより良いと思います。サポートの方も時間に追われなくて良さそうです。今までのチャット履歴もここで確認出来ます。これは知らなかった。Looker Community (en)誰でも利用可能です。日本語不可。頻繁に投稿があります。https://community.looker.com/Looker Community (ja)誰でも利用可能な日本語コミュニティです。稀に投稿があります。コミュニティフォーラム (Japanese) \u003e ヘルプとサポート⚠️ コミュニティフォーラム (Japanese) のトップ で Ask question / Create topic ボタンをクリックすると en のほうにトピックが作られてしまいます。注意です。このフォームが正解です。Slack Looker User Group - Japan日本語の Slack コミュニティもあります。今年の初め (2022-01-14) に作られました。この招待リンクから参加出来ます。番外編: 製品についてのアイディアがありますか？新しい機能のアイディアを POST 出来る場所です。Admin 権限を持ったユーザーだけが使用できます。日本語不可です。不具合も報告されることがあり、たまに 前述の「問い合わせフォーム」に誘導されています。それで知りました。まとめ私が知る限りの「Looker で困った時の解決手段」をまとめました。以前紹介した情報収集も日々継続すれば、Looker のスキルはかなり高まる実感があります。それでは良い Looker ライフを！(^^)/","link":"https://developer.feedforce.jp/entry/2022/06/17/110000","isoDate":"2022-06-17T02:00:00.000Z","dateMiliSeconds":1655431200000,"imageUrl":"https://cdn-ak.f.st-hatena.com/images/fotolife/m/masutaka26/20201023/20201023184859.png","authorName":"masutaka"},{"title":"LookML Validation を 20 秒から 11 秒に高速化出来た","content":"\u003cp\u003eこんにちは、\u003ca href=\"http://blog.hatena.ne.jp/masutaka26/\" class=\"hatena-id-icon\"\u003e\u003cimg src=\"https://cdn.profile-image.st-hatena.com/users/masutaka26/profile.png\" width=\"16\" height=\"16\" alt=\"\" class=\"hatena-id-icon\"\u003eid:masutaka26\u003c/a\u003e です。\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://www.looker.com/\"\u003eLooker\u003c/a\u003e を使い始めて 3 年目に突入しました。変わらず \u003ca href=\"https://feedmatic.net/\"\u003eFeedmatic\u003c/a\u003e という広告運用コンサルティングのデータ整備をする毎日です。\u003c/p\u003e\n\n\u003cp\u003e今回はここ 1 年の懸案だった LookML Validation の堪え難い遅さを改善出来たので、共有します。\u003c/p\u003e\n\n\u003cul class=\"table-of-contents\"\u003e\n    \u003cli\u003e\u003ca href=\"#2-年間でコード量が肥大化した\"\u003e2 年間でコード量が肥大化した\u003c/a\u003e\u003c/li\u003e\n    \u003cli\u003e\u003ca href=\"#LookML-Validation-が堪え難いほど遅くなった\"\u003eLookML Validation が堪え難いほど遅くなった\u003c/a\u003e\u003c/li\u003e\n    \u003cli\u003e\u003ca href=\"#My-LookML-Validator-is-slow\"\u003eMy LookML Validator is slow!\u003c/a\u003e\u003cul\u003e\n            \u003cli\u003e\u003ca href=\"#TLDR\"\u003eTL;DR\u003c/a\u003e\u003c/li\u003e\n            \u003cli\u003e\u003ca href=\"#Quick-wins\"\u003eQuick wins\u003c/a\u003e\u003c/li\u003e\n            \u003cli\u003e\u003ca href=\"#Long-answer\"\u003eLong answer\u003c/a\u003e\u003c/li\u003e\n            \u003cli\u003e\u003ca href=\"#Bonus-note\"\u003eBonus note\u003c/a\u003e\u003c/li\u003e\n        \u003c/ul\u003e\n    \u003c/li\u003e\n    \u003cli\u003e\u003ca href=\"#include-を最適化したら半分弱の時間になった\"\u003einclude を最適化したら半分弱の時間になった\u003c/a\u003e\u003c/li\u003e\n    \u003cli\u003e\u003ca href=\"#まとめ\"\u003eまとめ\u003c/a\u003e\u003c/li\u003e\n    \u003cli\u003e\u003ca href=\"#余談\"\u003e余談\u003c/a\u003e\u003c/li\u003e\n    \u003cli\u003e\u003ca href=\"#追記-LAMS-を使って-wildcard-include-を禁止する\"\u003e追記: LAMS を使って wildcard include を禁止する\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch2 id=\"2-年間でコード量が肥大化した\"\u003e2 年間でコード量が肥大化した\u003c/h2\u003e\n\n\u003cp\u003e2 年前と比べて Feedmatic プロジェクトの \u003ccode\u003e.lkml\u003c/code\u003e ファイルがものすごく増え、440 個、23,217 行\u003csup id=\"fnref:1\"\u003e\u003ca href=\"#fn:1\" rel=\"footnote\"\u003e1\u003c/a\u003e\u003c/sup\u003eにもなりました。Explore は 62 個、\u003ca href=\"/entry/2021/08/30/150000\"\u003eテスト用\u003c/a\u003eも含めると 150 個もあります。相変わらず\u003ca href=\"/entry/2022/02/04/180000\"\u003eボッチ LookML 開発者\u003c/a\u003eではあるのですが。💦\u003c/p\u003e\n\n\u003cp\u003eさて、\u003ca href=\"/entry/2020/10/23/190000\"\u003eLooker の JumpStart\u003c/a\u003e で教えて頂いた「モデル編成のベストプラクティス」のうちの 1 つにこちらがありました。\u003c/p\u003e\n\n\u003cblockquote\u003e\u003cp\u003eユーザーが必要とする答えに簡単にアクセスできる、可能な限り少ない数の explore を使用する。\u003c/p\u003e\u003c/blockquote\u003e\n\n\u003cp\u003eしかし、広告運用の文脈だと、クライアントごとに独自実装が必要なケースが多く、このコード量になってしまいました。💦\u003c/p\u003e\n\n\u003ch2 id=\"LookML-Validation-が堪え難いほど遅くなった\"\u003eLookML Validation が堪え難いほど遅くなった\u003c/h2\u003e\n\n\u003cp\u003eそんな LookML 開発に使用する Looker IDE には LookML Validator が付属しており、git commit 前に強制する設定をしています。\u003c/p\u003e\n\n\u003cp\u003e\u003ciframe src=\"https://hatenablog-parts.com/embed?url=https%3A%2F%2Fdocs.looker.com%2Fja%2Fdata-modeling%2Fgetting-started%2Flookml-validation%23validating_your_lookml\" title=\"Editing and validating LookML\" class=\"embed-card embed-webcard\" scrolling=\"no\" frameborder=\"0\" style=\"display: block; width: 100%; height: 155px; max-width: 500px; margin: 10px 0px;\"\u003e\u003c/iframe\u003e\u003ccite class=\"hatena-citation\"\u003e\u003ca href=\"https://docs.looker.com/ja/data-modeling/getting-started/lookml-validation#validating_your_lookml\"\u003edocs.looker.com\u003c/a\u003e\u003c/cite\u003e\u003c/p\u003e\n\n\u003cp\u003e以前は一瞬で完了していましたが、最近は 20 秒以上かかります。ちょっとコメントを書き換えただけでこれだけ待たされるのは、なかなかの苦行です。\u003c/p\u003e\n\n\u003cp\u003e試作した別プロジェクト（41 ファイル、1999 行）はそんなにかからないため、単純にコード量に比例していると思いました。\u003c/p\u003e\n\n\u003cp\u003e念のため Looker のサポートに質問したところ、やはりコード量（プロジェクトのサイズ）が影響しているそう。そして Looker インスタンスの CPU やメモリ使用量に問題はないとのこと。\u003c/p\u003e\n\n\u003cp\u003eさらに、こちらの記事を紹介して頂きました。🙏\u003c/p\u003e\n\n\u003cp\u003e\u003ciframe src=\"https://hatenablog-parts.com/embed?url=https%3A%2F%2Fcommunity.looker.com%2Ftechnical-tips-tricks-1021%2Fmy-lookml-validator-is-slow-23592\" title=\"My LookML Validator is slow! | Looker Community\" class=\"embed-card embed-webcard\" scrolling=\"no\" frameborder=\"0\" style=\"display: block; width: 100%; height: 155px; max-width: 500px; margin: 10px 0px;\"\u003e\u003c/iframe\u003e\u003ccite class=\"hatena-citation\"\u003e\u003ca href=\"https://community.looker.com/technical-tips-tricks-1021/my-lookml-validator-is-slow-23592\"\u003ecommunity.looker.com\u003c/a\u003e\u003c/cite\u003e\u003c/p\u003e\n\n\u003ch2 id=\"My-LookML-Validator-is-slow\"\u003eMy LookML Validator is slow!\u003c/h2\u003e\n\n\u003cp\u003e長い記事ではないので、ざっと翻訳します。\u003c/p\u003e\n\n\u003ch3 id=\"TLDR\"\u003eTL;DR\u003c/h3\u003e\n\n\u003cp\u003eプロジェクトが大きければ大きいほど、検証には時間がかかります。\u003c/p\u003e\n\n\u003ch3 id=\"Quick-wins\"\u003eQuick wins\u003c/h3\u003e\n\n\u003col\u003e\n\u003cli\u003e戦略的に \"includes\" する\n\n\u003col\u003e\n\u003cli\u003e常に他のすべてのビューをインクルードすることは開発上簡単かもしれないが、命名規則を使って必要なファイルだけを戦略的にインクルードすることで、パフォーマンスを向上させることができる\u003c/li\u003e\n\u003c/ol\u003e\n\u003c/li\u003e\n\u003cli\u003e使用しない explore（および join、field など）をコメントアウトまたは削除する\u003c/li\u003e\n\u003cli\u003eプロジェクトを複数のプロジェクトに分割することを検討する\u003c/li\u003e\n\u003c/ol\u003e\n\n\n\u003cp\u003eLookML のベストプラクティスについては、\u003ca href=\"https://community.looker.com/lookml-5/lookml-best-practices-1636\"\u003eこちらの記事\u003c/a\u003eをご覧ください。\u003c/p\u003e\n\n\u003ch3 id=\"Long-answer\"\u003eLong answer\u003c/h3\u003e\n\n\u003cp\u003eLookML のプロジェクトサイズ（総行数）と不要な \u003ccode\u003einclude\u003c/code\u003e の両方が LookML Validator の性能に影響を及ぼします。\u003c/p\u003e\n\n\u003cp\u003eValidation は 2 段階のプロセスで行われます。\u003c/p\u003e\n\n\u003cp\u003e1) 1 回目の検証では、プロジェクト内のすべてのファイルを読み込み、どこにも参照されていないファイルも含めて、メモリに読み込み、ソースコードを 1 モデルずつ完全に翻訳して、「コンパイル」エラーを探します。\u003c/p\u003e\n\n\u003cp\u003e2) 2 回目の検証は、各モデルで開始し、そのモデルから参照されるファイルのみを解析します。そして、そのモデルに基づいてクエリーを構築し、クエリーエラーや「実行時」エラーを探します。また、これらのパスは、すべての検証で行われることも重要です。\u003c/p\u003e\n\n\u003cp\u003e結論として、1 回目の検証は LookML プロジェクトのサイズに、2 回目の検証は不要な \u003ccode\u003einclude\u003c/code\u003e 文に影響されます。したがって、LookML プロジェクトのサイズを適切に保つと同時に、より選択的かつ戦略的な \u003ccode\u003einclude\u003c/code\u003e を推奨するのが良いでしょう。\u003c/p\u003e\n\n\u003ch3 id=\"Bonus-note\"\u003eBonus note\u003c/h3\u003e\n\n\u003cp\u003eExplore ごとのフィールド数は、検証時間という点で非常に重要です。これはしばしばモデルのパースよりも時間がかかります。\u003c/p\u003e\n\n\u003ch2 id=\"include-を最適化したら半分弱の時間になった\"\u003einclude を最適化したら半分弱の時間になった\u003c/h2\u003e\n\n\u003cp\u003e今回は「戦略的に \"includes\" する」をやってみました。\u003c/p\u003e\n\n\u003cp\u003e具体的には 56 個の \u003ccode\u003e.explore.lkml\u003c/code\u003e ファイルを以下のように変更しました。ワイルドカード付きの \u003ccode\u003einclude\u003c/code\u003e を出来るだけ減らしました。\u003c/p\u003e\n\n\u003cpre class=\"code\" data-lang=\"\" data-unlink\u003e# 変更前\ninclude: \u0026#34;/views/**/*.view\u0026#34;\n\n↓\n\n# 変更後\ninclude: \u0026#34;/views/view1.view\u0026#34;\ninclude: \u0026#34;/views/view2.view\u0026#34;\ninclude: \u0026#34;/views/view3.view\u0026#34;\ninclude: \u0026#34;/views/view4.view\u0026#34;\ninclude: \u0026#34;/views/view5.view\u0026#34;\u003c/pre\u003e\n\n\n\u003cp\u003e結果がこちら。たったこれだけで、20 秒かかっていた LookML validation が 12 秒弱にまで縮まりました。期待以上です！👏😂🎉\u003c/p\u003e\n\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth style=\"text-align:right;\"\u003e \u003c/th\u003e\n\u003cth style=\"text-align:right;\"\u003e 変更前（秒） \u003c/th\u003e\n\u003cth style=\"text-align:right;\"\u003e 変更後（秒） \u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd style=\"text-align:right;\"\u003e 1 \u003c/td\u003e\n\u003ctd style=\"text-align:right;\"\u003e 20.46 \u003c/td\u003e\n\u003ctd style=\"text-align:right;\"\u003e 12.39 \u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd style=\"text-align:right;\"\u003e 2 \u003c/td\u003e\n\u003ctd style=\"text-align:right;\"\u003e 20.44 \u003c/td\u003e\n\u003ctd style=\"text-align:right;\"\u003e 11.89 \u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd style=\"text-align:right;\"\u003e 3 \u003c/td\u003e\n\u003ctd style=\"text-align:right;\"\u003e 20.05 \u003c/td\u003e\n\u003ctd style=\"text-align:right;\"\u003e 11.69 \u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd style=\"text-align:right;\"\u003e 3 \u003c/td\u003e\n\u003ctd style=\"text-align:right;\"\u003e 20.61 \u003c/td\u003e\n\u003ctd style=\"text-align:right;\"\u003e 11.65 \u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd style=\"text-align:right;\"\u003e 5 \u003c/td\u003e\n\u003ctd style=\"text-align:right;\"\u003e 20.48 \u003c/td\u003e\n\u003ctd style=\"text-align:right;\"\u003e 11.95 \u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd style=\"text-align:right;\"\u003e 平均 \u003c/td\u003e\n\u003ctd style=\"text-align:right;\"\u003e 20.41 \u003c/td\u003e\n\u003ctd style=\"text-align:right;\"\u003e 11.91 \u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\n\n\u003cp\u003eついでに、事情があって隠している Explore 10 個\u003csup id=\"fnref:2\"\u003e\u003ca href=\"#fn:2\" rel=\"footnote\"\u003e2\u003c/a\u003e\u003c/sup\u003eの削除を確認してみたら、さらに速くなり、9 秒程度まで縮まりました。なるほど。\u003c/p\u003e\n\n\u003ch2 id=\"まとめ\"\u003eまとめ\u003c/h2\u003e\n\n\u003cp\u003eここ 1 年の懸案だった LookML Validation のパフォーマンスを改善しました。\u003c/p\u003e\n\n\u003cp\u003einclude を最適化するだけで、ここまで速くなるとは驚きでした。おまけに LookML Validation のプロセスも理解することもできました。\u003c/p\u003e\n\n\u003cp\u003e💭 コンパイラ側で良しなにするのは難しいのかな、\u003ca href=\"https://github.com/looker-open-source/look-at-me-sideways\"\u003eLAMS\u003c/a\u003e で警告してくれれば良いのかな。\u003c/p\u003e\n\n\u003cp\u003e引き続き、LookML 開発を妨げる課題があれば、解決していきます。💪\u003c/p\u003e\n\n\u003ch2 id=\"余談\"\u003e余談\u003c/h2\u003e\n\n\u003cp\u003e\u003ccode\u003eValidate LookML\u003c/code\u003e をクリックすると、すぐ \u003ccode\u003eValidate LookML\u003c/code\u003e に戻ることがあるのですが、なんででしょう...？ファイル保存直後だとほぼ発生します。\u003c/p\u003e\n\n\u003cp\u003e\u003cimg src=\"https://user-images.githubusercontent.com/170014/170627597-55819ca6-7394-4900-9e33-9ed0c1ce2492.gif\" alt=\"looker\" /\u003e\u003c/p\u003e\n\n\u003cp\u003eValidation が終わる時間くらいまで待つと 2 回クリックしなくて良いみたいです。🙄\u003c/p\u003e\n\n\u003cp\u003e\u003cimg src=\"https://user-images.githubusercontent.com/170014/170627672-f1bf212b-ab73-48f3-9feb-4e8f751984b6.gif\" alt=\"looker2\" /\u003e\u003c/p\u003e\n\n\u003ch2 id=\"追記-LAMS-を使って-wildcard-include-を禁止する\"\u003e追記: LAMS を使って wildcard include を禁止する\u003c/h2\u003e\n\n\u003cp\u003eLookML の Linter として LAMS というものがあります。\u003c/p\u003e\n\n\u003cp\u003e\u003ciframe src=\"https://hatenablog-parts.com/embed?url=https%3A%2F%2Fdeveloper.feedforce.jp%2Fentry%2F2022%2F06%2F21%2F130000\" title=\"LAMS を導入して、LookML の再利用性を高められた - Feedforce Developer Blog\" class=\"embed-card embed-blogcard\" scrolling=\"no\" frameborder=\"0\" style=\"display: block; width: 100%; height: 190px; max-width: 500px; margin: 10px 0px;\"\u003e\u003c/iframe\u003e\u003ccite class=\"hatena-citation\"\u003e\u003ca href=\"https://developer.feedforce.jp/entry/2022/06/21/130000\"\u003edeveloper.feedforce.jp\u003c/a\u003e\u003c/cite\u003e\u003c/p\u003e\n\n\u003cp\u003eこのカスタムルールを定義することで、今回のようなワイルドカード付きの \u003ccode\u003einclude\u003c/code\u003e を禁止することが出来ます。\u003c/p\u003e\n\n\u003cp\u003emanifest.lkml にこのように書くだけです。\u003c/p\u003e\n\n\u003cpre class=\"code\" data-lang=\"\" data-unlink\u003e# LAMS\n# rule: NO_WINC {\n#  description: \u0026#34;Prohibit wildcard include to avoid increasing LookML verification time\u0026#34;\n#  match: \u0026#34;$.files.*.include.*\u0026#34;\n#  expr_rule: ($let file_path ($get ::project files ::path:2 $file_path))\n#             ($if ($match \u0026#34;\\\\*\u0026#34; ::match)\n#                 ($concat \u0026#34;Found wildcard include \u0026#39;\u0026#34; ::match \u0026#34;\u0026#39; in \u0026#34; ::file_path \u0026#34;\u0026#34;)\n#               true) ;;\n# }\u003c/pre\u003e\n\n\n\u003cp\u003e\u003ca href=\"https://looker-open-source.github.io/look-at-me-sideways/customizing-lams\"\u003eCustomizing LAMS\u003c/a\u003e にさらりと書いてありますが、指摘されたファイル名を出す方法が分からなかったので、Issue \u003ca href=\"https://github.com/looker-open-source/look-at-me-sideways/issues/95\"\u003e#95\u003c/a\u003e で質問したら分かりました。これは分からない。💦\u003c/p\u003e\n\u003cdiv class=\"footnotes\"\u003e\n\u003chr/\u003e\n\u003col\u003e\n\u003cli id=\"fn:1\"\u003e\n\u003cp\u003eコメントと空行を除く\u003ca href=\"#fnref:1\" rev=\"footnote\"\u003e\u0026#8617;\u003c/a\u003e\u003c/p\u003e\u003c/li\u003e\n\u003cli id=\"fn:2\"\u003e\n\u003cp\u003e\u003ccode\u003e.explore.lkml\u003c/code\u003e 10 個、\u003ccode\u003e.view.lkml\u003c/code\u003e 10 個、\u003ccode\u003e.layer.lkml\u003c/code\u003e 31 個\u003ca href=\"#fnref:2\" rev=\"footnote\"\u003e\u0026#8617;\u003c/a\u003e\u003c/p\u003e\u003c/li\u003e\n\u003c/ol\u003e\n\u003c/div\u003e\n\n","contentSnippet":"こんにちは、id:masutaka26 です。Looker を使い始めて 3 年目に突入しました。変わらず Feedmatic という広告運用コンサルティングのデータ整備をする毎日です。今回はここ 1 年の懸案だった LookML Validation の堪え難い遅さを改善出来たので、共有します。2 年間でコード量が肥大化したLookML Validation が堪え難いほど遅くなったMy LookML Validator is slow!TL;DRQuick winsLong answerBonus noteinclude を最適化したら半分弱の時間になったまとめ余談追記: LAMS を使って wildcard include を禁止する2 年間でコード量が肥大化した2 年前と比べて Feedmatic プロジェクトの .lkml ファイルがものすごく増え、440 個、23,217 行1にもなりました。Explore は 62 個、テスト用も含めると 150 個もあります。相変わらずボッチ LookML 開発者ではあるのですが。💦さて、Looker の JumpStart で教えて頂いた「モデル編成のベストプラクティス」のうちの 1 つにこちらがありました。ユーザーが必要とする答えに簡単にアクセスできる、可能な限り少ない数の explore を使用する。しかし、広告運用の文脈だと、クライアントごとに独自実装が必要なケースが多く、このコード量になってしまいました。💦LookML Validation が堪え難いほど遅くなったそんな LookML 開発に使用する Looker IDE には LookML Validator が付属しており、git commit 前に強制する設定をしています。docs.looker.com以前は一瞬で完了していましたが、最近は 20 秒以上かかります。ちょっとコメントを書き換えただけでこれだけ待たされるのは、なかなかの苦行です。試作した別プロジェクト（41 ファイル、1999 行）はそんなにかからないため、単純にコード量に比例していると思いました。念のため Looker のサポートに質問したところ、やはりコード量（プロジェクトのサイズ）が影響しているそう。そして Looker インスタンスの CPU やメモリ使用量に問題はないとのこと。さらに、こちらの記事を紹介して頂きました。🙏community.looker.comMy LookML Validator is slow!長い記事ではないので、ざっと翻訳します。TL;DRプロジェクトが大きければ大きいほど、検証には時間がかかります。Quick wins戦略的に \"includes\" する常に他のすべてのビューをインクルードすることは開発上簡単かもしれないが、命名規則を使って必要なファイルだけを戦略的にインクルードすることで、パフォーマンスを向上させることができる使用しない explore（および join、field など）をコメントアウトまたは削除するプロジェクトを複数のプロジェクトに分割することを検討するLookML のベストプラクティスについては、こちらの記事をご覧ください。Long answerLookML のプロジェクトサイズ（総行数）と不要な include の両方が LookML Validator の性能に影響を及ぼします。Validation は 2 段階のプロセスで行われます。1) 1 回目の検証では、プロジェクト内のすべてのファイルを読み込み、どこにも参照されていないファイルも含めて、メモリに読み込み、ソースコードを 1 モデルずつ完全に翻訳して、「コンパイル」エラーを探します。2) 2 回目の検証は、各モデルで開始し、そのモデルから参照されるファイルのみを解析します。そして、そのモデルに基づいてクエリーを構築し、クエリーエラーや「実行時」エラーを探します。また、これらのパスは、すべての検証で行われることも重要です。結論として、1 回目の検証は LookML プロジェクトのサイズに、2 回目の検証は不要な include 文に影響されます。したがって、LookML プロジェクトのサイズを適切に保つと同時に、より選択的かつ戦略的な include を推奨するのが良いでしょう。Bonus noteExplore ごとのフィールド数は、検証時間という点で非常に重要です。これはしばしばモデルのパースよりも時間がかかります。include を最適化したら半分弱の時間になった今回は「戦略的に \"includes\" する」をやってみました。具体的には 56 個の .explore.lkml ファイルを以下のように変更しました。ワイルドカード付きの include を出来るだけ減らしました。# 変更前include: \"/views/**/*.view\"↓# 変更後include: \"/views/view1.view\"include: \"/views/view2.view\"include: \"/views/view3.view\"include: \"/views/view4.view\"include: \"/views/view5.view\"結果がこちら。たったこれだけで、20 秒かかっていた LookML validation が 12 秒弱にまで縮まりました。期待以上です！👏😂🎉  変更前（秒）  変更後（秒）  1  20.46  12.39  2  20.44  11.89  3  20.05  11.69  3  20.61  11.65  5  20.48  11.95  平均  20.41  11.91 ついでに、事情があって隠している Explore 10 個2の削除を確認してみたら、さらに速くなり、9 秒程度まで縮まりました。なるほど。まとめここ 1 年の懸案だった LookML Validation のパフォーマンスを改善しました。include を最適化するだけで、ここまで速くなるとは驚きでした。おまけに LookML Validation のプロセスも理解することもできました。💭 コンパイラ側で良しなにするのは難しいのかな、LAMS で警告してくれれば良いのかな。引き続き、LookML 開発を妨げる課題があれば、解決していきます。💪余談Validate LookML をクリックすると、すぐ Validate LookML に戻ることがあるのですが、なんででしょう...？ファイル保存直後だとほぼ発生します。Validation が終わる時間くらいまで待つと 2 回クリックしなくて良いみたいです。🙄追記: LAMS を使って wildcard include を禁止するLookML の Linter として LAMS というものがあります。developer.feedforce.jpこのカスタムルールを定義することで、今回のようなワイルドカード付きの include を禁止することが出来ます。manifest.lkml にこのように書くだけです。# LAMS# rule: NO_WINC {#  description: \"Prohibit wildcard include to avoid increasing LookML verification time\"#  match: \"$.files.*.include.*\"#  expr_rule: ($let file_path ($get ::project files ::path:2 $file_path))#             ($if ($match \"\\\\*\" ::match)#                 ($concat \"Found wildcard include '\" ::match \"' in \" ::file_path \"\")#               true) ;;# }Customizing LAMS にさらりと書いてありますが、指摘されたファイル名を出す方法が分からなかったので、Issue #95 で質問したら分かりました。これは分からない。💦コメントと空行を除く↩.explore.lkml 10 個、.view.lkml 10 個、.layer.lkml 31 個↩","link":"https://developer.feedforce.jp/entry/2022/05/30/110000","isoDate":"2022-05-30T02:00:00.000Z","dateMiliSeconds":1653876000000,"imageUrl":"https://cdn-ak.f.st-hatena.com/images/fotolife/m/masutaka26/20201023/20201023184859.png","authorName":"masutaka"},{"title":"『本を聴く毎日を送っています』という LT をした","content":"私が所属しているフィードフォースでは、毎月 FFLT という LT 大会があります。\n最近久しぶりに参加していて、昨日は本当に久しぶりに LT をしました。久しぶりすぎて LT が 5 分であることを気にかけなかったという\u0026hellip;。いや、もちろん覚えてはいたのですが（汗）。\nお題は [2022-03-06-1] や [2022-03-30-1] でそれとなく書いていた「Kindle 本を聴く」方法です。\nすべてのケースに合うわけでも、ベストな方法でもありませんが、集中力が必要で眠くなりがちな本を読むという作業を省エネ化出来たことは、自分にとって価値あるものでした。\nまだまだ最適化が必要なので、やっていきます。","contentSnippet":"私が所属しているフィードフォースでは、毎月 FFLT という LT 大会があります。最近久しぶりに参加していて、昨日は本当に久しぶりに LT をしました。久しぶりすぎて LT が 5 分であることを気にかけなかったという…。いや、もちろん覚えてはいたのですが（汗）。お題は [2022-03-06-1] や [2022-03-30-1] でそれとなく書いていた「Kindle 本を聴く」方法です。すべてのケースに合うわけでも、ベストな方法でもありませんが、集中力が必要で眠くなりがちな本を読むという作業を省エネ化出来たことは、自分にとって価値あるものでした。まだまだ最適化が必要なので、やっていきます。","link":"https://masutaka.net/2022-04-09-1/","isoDate":"2022-04-09T00:00:00.000Z","dateMiliSeconds":1649462400000,"authorName":"masutaka"},{"title":"『ボッチLookML開発者兼データ整備人を連れてきたよ！』という発表をした","content":"\u003cp\u003eこんにちは \u003ca href=\"http://blog.hatena.ne.jp/masutaka26/\" class=\"hatena-id-icon\"\u003e\u003cimg src=\"https://cdn.profile-image.st-hatena.com/users/masutaka26/profile.png\" width=\"16\" height=\"16\" alt=\"\" class=\"hatena-id-icon\"\u003eid:masutaka26\u003c/a\u003e です。\u003c/p\u003e\n\n\u003cp\u003e本日、週次の社内勉強会 \u003ca href=\"https://developer.feedforce.jp/archive/category/FFTT\"\u003eFFTT\u003c/a\u003e で『ボッチLookML開発者兼データ整備人を連れてきたよ！』というひどいタイトルの発表をしました。\u003c/p\u003e\n\n\u003ciframe src=\"https://docs.google.com/presentation/d/e/2PACX-1vTv911SmUBM9fAk-IKQM9139Q29fU7INnUHwbFeOBxolqyybPdlcFHW2dAHBTgr3P9J_kL0Xdhbe38L/embed?start=false\u0026loop=false\u0026delayms=3000\" frameborder=\"0\" width=\"960\" height=\"410\" allowfullscreen=\"true\" mozallowfullscreen=\"true\" webkitallowfullscreen=\"true\"\u003e\u003c/iframe\u003e\n\n\n\u003cp\u003e2020 年 4 月から Looker に関わって得たことをまとめた内容であるとともに、1 年半近く前からのアップデートになります。\u003c/p\u003e\n\n\u003cp\u003e\u003ciframe src=\"https://hatenablog-parts.com/embed?url=https%3A%2F%2Fdeveloper.feedforce.jp%2Fentry%2F2020%2F10%2F23%2F190000\" title=\"『4月から取り組んできたLookerの導入から実装までのお話（Redashとも比較）』という発表をした - Feedforce Developer Blog\" class=\"embed-card embed-blogcard\" scrolling=\"no\" frameborder=\"0\" style=\"display: block; width: 100%; height: 190px; max-width: 500px; margin: 10px 0px;\"\u003e\u003c/iframe\u003e\u003ccite class=\"hatena-citation\"\u003e\u003ca href=\"https://developer.feedforce.jp/entry/2020/10/23/190000\"\u003edeveloper.feedforce.jp\u003c/a\u003e\u003c/cite\u003e\u003c/p\u003e\n\n\u003cp\u003e世に出ている Looker の情報はキラキラしているものが多く、ツラい話をそれほど目にしません。\u003cs\u003e絶対にあるはずなのに！😭\u003c/s\u003e\u003c/p\u003e\n\n\u003cp\u003eそれならば！とツラい話や解決が困難な話を散りばめさせてもらいました。課題が共有されて初めて知見が役に立つと思いますからね。\u003cem\u003e解決した課題もあるよ（小声）。\u003c/em\u003e\u003c/p\u003e\n\n\u003cp\u003eそれでは良い週末を！(^^)/\u003c/p\u003e\n","contentSnippet":"こんにちは id:masutaka26 です。本日、週次の社内勉強会 FFTT で『ボッチLookML開発者兼データ整備人を連れてきたよ！』というひどいタイトルの発表をしました。2020 年 4 月から Looker に関わって得たことをまとめた内容であるとともに、1 年半近く前からのアップデートになります。developer.feedforce.jp世に出ている Looker の情報はキラキラしているものが多く、ツラい話をそれほど目にしません。絶対にあるはずなのに！😭それならば！とツラい話や解決が困難な話を散りばめさせてもらいました。課題が共有されて初めて知見が役に立つと思いますからね。解決した課題もあるよ（小声）。それでは良い週末を！(^^)/","link":"https://developer.feedforce.jp/entry/2022/02/04/180000","isoDate":"2022-02-04T09:00:00.000Z","dateMiliSeconds":1643965200000,"imageUrl":"https://cdn-ak.f.st-hatena.com/images/fotolife/m/masutaka26/20201023/20201023184859.png","authorName":"masutaka"},{"title":"LookML 開発で使っているディレクトリ構造を紹介する","content":"\u003cp\u003eこんにちは、\u003ca href=\"http://blog.hatena.ne.jp/masutaka26/\" class=\"hatena-id-icon\"\u003e\u003cimg src=\"https://cdn.profile-image.st-hatena.com/users/masutaka26/profile.png\" width=\"16\" height=\"16\" alt=\"\" class=\"hatena-id-icon\"\u003eid:masutaka26\u003c/a\u003e です。\u003c/p\u003e\n\n\u003cp\u003eこの記事は Looker Advent Calendar 2021 の 13 日目の記事です。\u003c/p\u003e\n\n\u003cp\u003e\u003ciframe src=\"https://hatenablog-parts.com/embed?url=https%3A%2F%2Fqiita.com%2Fadvent-calendar%2F2021%2Flooker\" title=\"Calendar for Looker | Advent Calendar 2021 - Qiita\" class=\"embed-card embed-webcard\" scrolling=\"no\" frameborder=\"0\" style=\"display: block; width: 100%; height: 155px; max-width: 500px; margin: 10px 0px;\"\u003e\u003c/iframe\u003e\u003ccite class=\"hatena-citation\"\u003e\u003ca href=\"https://qiita.com/advent-calendar/2021/looker\"\u003eqiita.com\u003c/a\u003e\u003c/cite\u003e\u003c/p\u003e\n\n\u003cp\u003e昨日は Yappli 阿部さんの「\u003ca href=\"https://tech.yappli.io/entry/2021/12/12/Sexy_Tech_for_You_9\"\u003eLookerの目標値やストップワードを、Googleスプレッドシート連携でお手軽管理【Sexy Tech for You #9】\u003c/a\u003e」でした。Looker を使うとこのような LookML を書くだけで、ビジネスユーザーが SQL を書くことなく、本業に集中できるのはとても良いですよね。\u003c/p\u003e\n\n\u003cp\u003e個人的には、SQL ベースの派生テーブルの中で join するよりも、explore で join したほうが Looker らしく、メンテナンス性が良い気がしました。\u003ca href=\"https://help.looker.com/hc/en-us/articles/360023722974\"\u003esymmetric 集計\u003c/a\u003eが働くため、ファンアウトも避けられます。wikipedia テーブルに関しては、永続的な派生テーブル（PDT）を使って BigQuery のスキャンサイズを抑えるのも良さそうです。\u003c/p\u003e\n\n\u003cp\u003e、、、( ﾟдﾟ)ハッ！ついマジレスをしてしまいました。💦\u003c/p\u003e\n\n\u003cp\u003e今回は dimension が null の measure を（0 ではなく）ø にする少しマニアックな記事を書く予定でしたが、先日の \u003ca href=\"https://looker-japan-user-group.connpass.com/event/233775/\"\u003eLooker User Meetup Online #7\u003c/a\u003e で、LookML のディレクトリ構造を知りたいというチャットをお見かけしたので、今回はその話を書くことにしました。\u003c/p\u003e\n\n\u003cul class=\"table-of-contents\"\u003e\n    \u003cli\u003e\u003ca href=\"#今回のプロジェクトの規模感\"\u003e今回のプロジェクトの規模感\u003c/a\u003e\u003c/li\u003e\n    \u003cli\u003e\u003ca href=\"#デフォルトのディレクトリ構造\"\u003eデフォルトのディレクトリ構造？\u003c/a\u003e\u003c/li\u003e\n    \u003cli\u003e\u003ca href=\"#特別なファイル形式を知る\"\u003e特別なファイル形式を知る\u003c/a\u003e\u003c/li\u003e\n    \u003cli\u003e\u003ca href=\"#最近使っているディレクトリ構造\"\u003e最近使っているディレクトリ構造\u003c/a\u003e\u003cul\u003e\n            \u003cli\u003e\u003ca href=\"#bigquery\"\u003ebigquery/\u003c/a\u003e\u003c/li\u003e\n            \u003cli\u003e\u003ca href=\"#model1modellkml\"\u003emodel1.model.lkml\u003c/a\u003e\u003c/li\u003e\n            \u003cli\u003e\u003ca href=\"#explores\"\u003eexplores/\u003c/a\u003e\u003c/li\u003e\n            \u003cli\u003e\u003ca href=\"#views\"\u003eviews/\u003c/a\u003e\u003c/li\u003e\n            \u003cli\u003e\u003ca href=\"#tests\"\u003etests/\u003c/a\u003e\u003c/li\u003e\n            \u003cli\u003e\u003ca href=\"#manifestlkml\"\u003emanifest.lkml\u003c/a\u003e\u003c/li\u003e\n        \u003c/ul\u003e\n    \u003c/li\u003e\n    \u003cli\u003e\u003ca href=\"#まとめ\"\u003eまとめ\u003c/a\u003e\u003c/li\u003e\n    \u003cli\u003e\u003ca href=\"#2021-12-29-追記\"\u003e2021-12-29 追記\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch2 id=\"今回のプロジェクトの規模感\"\u003e今回のプロジェクトの規模感\u003c/h2\u003e\n\n\u003cp\u003eプロジェクトの規模感によってディレクトリ構造は変わると思うので、先に書いておきます。\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eLooker インスタンスに 1 つだけ LookML プロジェクトが存在する\u003c/li\u003e\n\u003cli\u003eBigQuery Dataset 76 個\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e.lkml\u003c/code\u003e ファイル 277 個\n\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003e.model.lkml\u003c/code\u003e ファイル 1 個\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e.explore.lkml\u003c/code\u003e ファイル 56 個\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e.view.lkml\u003c/code\u003e ファイル 139 個\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e.test.lkml\u003c/code\u003e ファイル 78 個\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eLookML 開発者 1 名\u003c/li\u003e\n\u003c/ul\u003e\n\n\n\u003ch2 id=\"デフォルトのディレクトリ構造\"\u003eデフォルトのディレクトリ構造？\u003c/h2\u003e\n\n\u003cp\u003eこの記事を書くまで誤解をしていたのですが、デフォルトのディレクトリ構造というものはなかったのですね。この記事を書くために改めて Blank Project を作ったら、ファイルもディレクトリも何もないプロジェクトが作られました。\u003c/p\u003e\n\n\u003cp\u003eモデルファイルを作るとこのようなコードが展開されるので、\u003ccode\u003e.view.lkml\u003c/code\u003e に関しては \u003ccode\u003e/views/\u003c/code\u003e 以下に作る方が多いと思います。私もそうでした。\u003c/p\u003e\n\n\u003cpre class=\"code\" data-lang=\"\" data-unlink\u003einclude: \u0026#34;/views/*.view.lkml\u0026#34;                # include all views in the views/ folder in this project\n# include: \u0026#34;/**/*.view.lkml\u0026#34;                 # include all views in this project\n# include: \u0026#34;my_dashboard.dashboard.lookml\u0026#34;   # include a lookml dashboard called my_dashboard\u003c/pre\u003e\n\n\n\u003cp\u003e例えばこのようになります。\u003c/p\u003e\n\n\u003cpre class=\"code\" data-lang=\"\" data-unlink\u003efeedmatic.model.lkml\nviews\n├── all_media.view.lkml\n└── ga.view.lkml\u003c/pre\u003e\n\n\n\u003cp\u003e開発初期は \u003ccode\u003efeedmatic.model.lkml\u003c/code\u003e に view 以外の、explore や datagroup などをズラズラと書いていました。\u003c/p\u003e\n\n\u003ch2 id=\"特別なファイル形式を知る\"\u003e特別なファイル形式を知る\u003c/h2\u003e\n\n\u003cp\u003eご存知の通り、LookML のファイル形式は \u003ccode\u003e.lkml\u003c/code\u003e です。\u003c/p\u003e\n\n\u003cp\u003eLookML 開発が続くと \u003ccode\u003e.model.lkml\u003c/code\u003e や \u003ccode\u003e.view.lkml\u003c/code\u003e などが増えていきますが、この中で唯一意味を持つのが \u003ccode\u003e.model.lkml\u003c/code\u003e です\u003csup id=\"fnref:1\"\u003e\u003ca href=\"#fn:1\" rel=\"footnote\"\u003e1\u003c/a\u003e\u003c/sup\u003e。その他のファイル形式は整理のために自由に作ることが出来ます。\u003c/p\u003e\n\n\u003cp\u003e例えば \u003ccode\u003efeedmatic.model.lkml\u003c/code\u003e を作ると、\u003ccode\u003efeedmatic\u003c/code\u003e というモデルが定義されます。\u003ccode\u003ehttps://{{your looker domain}}/projects\u003c/code\u003e で確認できます。\u003ccode\u003eall_media.view.lkml\u003c/code\u003e を作っても、何かが作られるわけではありません。\u003c/p\u003e\n\n\u003cp\u003e以上の知識を持った上で、公式ドキュメントを読むと理解が深まるかもしれません。\u003c/p\u003e\n\n\u003cp\u003e\u003ciframe src=\"https://hatenablog-parts.com/embed?url=https%3A%2F%2Fdocs.looker.com%2Fja%2Fdata-modeling%2Flearning-lookml%2Flookml-terms-and-concepts\" title=\"LookMLの用語と概念\" class=\"embed-card embed-webcard\" scrolling=\"no\" frameborder=\"0\" style=\"display: block; width: 100%; height: 155px; max-width: 500px; margin: 10px 0px;\"\u003e\u003c/iframe\u003e\u003c/p\u003e\n\n\u003ch2 id=\"最近使っているディレクトリ構造\"\u003e最近使っているディレクトリ構造\u003c/h2\u003e\n\n\u003cp\u003eこんな感じです。それぞれ解説していきます。\u003c/p\u003e\n\n\u003cpre class=\"code\" data-lang=\"\" data-unlink\u003ebigquery\n├── spreadsheet1\n│   ├── define.json\n│   └── schema.json\n└── spreadsheet2\n    ├── define.json\n    └── schema.json\nmodel1.model.lkml\nexplores\n├── corp\n│   ├── base.explore.lkml\n│   ├── name1.explore.lkml\n│   └── name2.explore.lkml\n├── explore1.explore.lkml\n└── explore2.explore.lkml\nviews\n├── corp\n│   ├── base.view.lkml\n│   ├── name1.view.lkml\n│   └── name2.view.lkml\n├── view1.view.lkml\n└── view2.view.lkml\ntests\n└── model1\n    ├── corp\n    │   ├── name1.test.lkml\n    │   └── name2.test.lkml\n    ├── explore1.test.lkml\n    └── explore2.test.lkml\nmanifest.lkml\u003c/pre\u003e\n\n\n\u003ch3 id=\"bigquery\"\u003ebigquery/\u003c/h3\u003e\n\n\u003cp\u003eいきなり LookML 関係ありません。💦\u003c/p\u003e\n\n\u003cp\u003eBigQuery はデータソースに Google スプレッドシートを指定でき、そのスキーマ定義はコード化することが出来ます。\u003c/p\u003e\n\n\u003cp\u003eコード化することで変更履歴を Git で管理できますし、BigQuery CLI を使って簡単に Dataset や Table を作ったり、削除したりが出来ます。\u003c/p\u003e\n\n\u003cpre class=\"code\" data-lang=\"\" data-unlink\u003e$ bq mk spreadsheet1\n$ bq mk --external_table_definition=./define.json spreadsheet1.gsheet\n$ bq rm -r spreadsheet1\u003c/pre\u003e\n\n\n\u003cp\u003e破壊的な変更をする時は、バージョン名を付けた Dataset を新規作成し、LookML から参照先を変えます。こうすることで、本番環境に影響を与えずに開発することが出来ます。\u003c/p\u003e\n\n\u003cpre class=\"code\" data-lang=\"\" data-unlink\u003e$ bq mk spreadsheet1_v2\n$ bq mk --external_table_definition=./define.json spreadsheet1_v2.gsheet\u003c/pre\u003e\n\n\n\u003cp\u003eスキーマ定義は公式ドキュメントをご覧下さい。需要があればそんな記事を書きます。\u003c/p\u003e\n\n\u003cp\u003e\u003ciframe src=\"https://hatenablog-parts.com/embed?url=https%3A%2F%2Fcloud.google.com%2Fconfig-connector%2Fdocs%2Freference%2Fresource-docs%2Fbigquery%2Fbigquerytable%3Fhl%3Dja\" title=\"BigQueryTable  |  Config Connector Documentation  |  Google Cloud\" class=\"embed-card embed-webcard\" scrolling=\"no\" frameborder=\"0\" style=\"display: block; width: 100%; height: 155px; max-width: 500px; margin: 10px 0px;\"\u003e\u003c/iframe\u003e\u003c/p\u003e\n\n\u003cp\u003e他の Dataset は ETL ツール\u003csup id=\"fnref:2\"\u003e\u003ca href=\"#fn:2\" rel=\"footnote\"\u003e2\u003c/a\u003e\u003c/sup\u003eが作るためコード化はしていません。\u003c/p\u003e\n\n\u003ch3 id=\"model1modellkml\"\u003emodel1.model.lkml\u003c/h3\u003e\n\n\u003cp\u003e中心となるこのファイルは軽いです。本当にこの程度しか書いていません。\u003c/p\u003e\n\n\u003cpre class=\"code\" data-lang=\"\" data-unlink\u003econnection: \u0026#34;docs_bigquery_db\u0026#34;\n\ninclude: \u0026#34;/explores/**/*.explore\u0026#34;\ninclude: \u0026#34;/tests/model1/**/*.test\u0026#34;\n\nnamed_value_format: jpy_0 {\n  value_format: \u0026#34;\\¥#,##0\u0026#34;\n}\n\nnamed_value_format: jpy_1 {\n  value_format: \u0026#34;\\¥#,##0.0\u0026#34;\n}\n\n# for test\naccess_grant: can_view_explores_for_tests {\n  user_attribute: view_explores_for_tests\n  allowed_values: [\u0026#34;yes\u0026#34;]\n}\u003c/pre\u003e\n\n\n\u003cp\u003e必要な定義は \u003ccode\u003econnection\u003c/code\u003e と \u003ccode\u003einclude\u003c/code\u003e だけです。\u003c/p\u003e\n\n\u003cp\u003einclude 対象を全ての \u003ccode\u003e.explore.lkml\u003c/code\u003e と、このモデルに関連するテスト（\u003ccode\u003etests/feedmatic/\u003c/code\u003e 以下全ての \u003ccode\u003e.test.lkml\u003c/code\u003e）だけにしていることがポイントです。つまり \u003ccode\u003e.model.lkml\u003c/code\u003e は \u003ccode\u003e.explore.lkml\u003c/code\u003e と自分の \u003ccode\u003e.test.lkml\u003c/code\u003e しか知りません。\u003c/p\u003e\n\n\u003cp\u003eあとは蛇足で、\u003ccode\u003enamed_value_format\u003c/code\u003e と、\u003ca href=\"/entry/2021/08/30/150000\"\u003e前回紹介したテスト\u003c/a\u003eに必要な \u003ccode\u003eaccess_grant\u003c/code\u003e だけです。\u003c/p\u003e\n\n\u003ch3 id=\"explores\"\u003eexplores/\u003c/h3\u003e\n\n\u003cp\u003e1 つの explore を 1 つのファイルに定義しています。\u003c/p\u003e\n\n\u003cp\u003e\u003ccode\u003eexplores/explore1.explore.lkml\u003c/code\u003e はこのように書いています。\u003ccode\u003e.explore.lkml\u003c/code\u003e は \u003ccode\u003e.view.lkml\u003c/code\u003e しか知りません。\u003c/p\u003e\n\n\u003cpre class=\"code\" data-lang=\"\" data-unlink\u003einclude: \u0026#34;/views/**/*.view\u0026#34;\n\nexplore: explore1 {\n  # ...\n}\u003c/pre\u003e\n\n\n\u003cp\u003e紆余曲折あり、\u003ccode\u003eexplores/corp/name1.explore.lkml\u003c/code\u003e のような取引先ごとの explore もあります。\u003c/p\u003e\n\n\u003cp\u003e基本となる \u003ccode\u003eexplores/corp/base.explore.lkml\u003c/code\u003e はこのような定義です。ファイル名と explore 名を変えていることがポイントです。Ruby の慣習を参考にしました。\u003c/p\u003e\n\n\u003cpre class=\"code\" data-lang=\"\" data-unlink\u003eexplore: corp_base {\n  extension: required\n  # ...\n}\u003c/pre\u003e\n\n\n\u003cp\u003e\u003ccode\u003ecorp_base\u003c/code\u003e explore を継承する、各取引先の explore はこのような定義です。\u003c/p\u003e\n\n\u003cpre class=\"code\" data-lang=\"\" data-unlink\u003einclude: \u0026#34;./base.explore\u0026#34;\ninclude: \u0026#34;/views/**/*.view\u0026#34;\n\nexplore: corp_name1 {\n  extends: [corp_base]\n  # ...\n}\u003c/pre\u003e\n\n\n\u003ch3 id=\"views\"\u003eviews/\u003c/h3\u003e\n\n\u003cp\u003eview も explore と同様に、1 view 1 ファイルに定義しています。\u003c/p\u003e\n\n\u003cp\u003e\u003ccode\u003eviews/view1.view.lkml\u003c/code\u003e です。\u003ccode\u003e.view.lkml\u003c/code\u003e は \u003ccode\u003e.model.lkml\u003c/code\u003e, \u003ccode\u003e.explore.lkml\u003c/code\u003e, \u003ccode\u003e.test.lkml\u003c/code\u003e の誰も知りません。\u003c/p\u003e\n\n\u003cpre class=\"code\" data-lang=\"\" data-unlink\u003eview: view1 {\n  # ...\n}\u003c/pre\u003e\n\n\n\u003cp\u003e取引先ごとの view も同じです。\u003ccode\u003eviews/corp/base.view.lkml\u003c/code\u003e はこんな感じで、\u003c/p\u003e\n\n\u003cpre class=\"code\" data-lang=\"\" data-unlink\u003eview: corp_base {\n  extension: required\n  # ...\n}\u003c/pre\u003e\n\n\n\u003cp\u003e継承先の \u003ccode\u003eviews/corp/name1.view.lkml\u003c/code\u003e はこんな感じです。\u003c/p\u003e\n\n\u003cpre class=\"code\" data-lang=\"\" data-unlink\u003einclude: \u0026#34;./base.view\u0026#34;\n\nview: corp_name1 {\n  extends: [corp_base]\n  # ...\n}\u003c/pre\u003e\n\n\n\u003ch3 id=\"tests\"\u003etests/\u003c/h3\u003e\n\n\u003cp\u003eテストはかなり書いており、2021-12-13 現在、184 もあります。\u003c/p\u003e\n\n\u003cp\u003eほぼ explore 単位でファイル分割しています。分割することで、ファイル単位のテストが可能になっています。\u003c/p\u003e\n\n\u003cp\u003eこちらのベストプラクティスに従っています。\u003c/p\u003e\n\n\u003cp\u003e\u003ciframe src=\"https://hatenablog-parts.com/embed?url=https%3A%2F%2Fcommunity.looker.com%2Flookml-5%2Flookml-data-tests-recommendations-and-best-practices-20815\" title=\"LookML Data Tests: Recommendations and Best Practices | Looker Community\" class=\"embed-card embed-webcard\" scrolling=\"no\" frameborder=\"0\" style=\"display: block; width: 100%; height: 155px; max-width: 500px; margin: 10px 0px;\"\u003e\u003c/iframe\u003e\u003c/p\u003e\n\n\u003cp\u003eテスト対象はこんな感じです。\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003e(1) LookML で特別な実装をしていて、壊れても気づくのが難しそうな実装\u003c/li\u003e\n\u003cli\u003e(2) \u003ccode\u003eprimary_key\u003c/code\u003e が重複していないか？ null になっていないか？を全ての view に対して\u003c/li\u003e\n\u003c/ul\u003e\n\n\n\u003cp\u003e(2) は前回詳しく書きました。\u003c/p\u003e\n\n\u003cp\u003e\u003ciframe src=\"https://hatenablog-parts.com/embed?url=https%3A%2F%2Fdeveloper.feedforce.jp%2Fentry%2F2021%2F08%2F30%2F150000\" title=\"Looker で Join 先の view の primary_key をいい感じにテストする方法をようやく見つけた - Feedforce Developer Blog\" class=\"embed-card embed-blogcard\" scrolling=\"no\" frameborder=\"0\" style=\"display: block; width: 100%; height: 190px; max-width: 500px; margin: 10px 0px;\"\u003e\u003c/iframe\u003e\u003c/p\u003e\n\n\u003cp\u003e実行に時間がかかることが悩みで以前こんな Topic を作りましたが、反応ゼロでした。みなさん課題ではないのかしら？💦\u003c/p\u003e\n\n\u003cp\u003e\u003ciframe src=\"https://hatenablog-parts.com/embed?url=https%3A%2F%2Fcommunity.looker.com%2Flookml-5%2Fis-it-possible-to-run-tests-in-parallel-28222\" title=\"Is it possible to run tests in parallel? | Looker Community\" class=\"embed-card embed-webcard\" scrolling=\"no\" frameborder=\"0\" style=\"display: block; width: 100%; height: 155px; max-width: 500px; margin: 10px 0px;\"\u003e\u003c/iframe\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003ccode\u003eprimary_key\u003c/code\u003e は壊れた時に気づくのが難しく、LookML 開発者が私だけということもあるため、機械的に全ての \u003ccode\u003eprimary_key\u003c/code\u003e をテスト出来るようにしています。ただ、全テストは結構時間がかかるので、日に 1 回くらいの頻度で手動実行しています。CI したい...。\u003c/p\u003e\n\n\u003ch3 id=\"manifestlkml\"\u003emanifest.lkml\u003c/h3\u003e\n\n\u003cp\u003eディレクトリ構造とは関係ありませんが、manifest.lkml についても触れておきましょう。\u003c/p\u003e\n\n\u003cp\u003e\u003ccode\u003ebigquery/\u003c/code\u003e の項で書いたとおり、テーブル定義に破壊的な変更を加える時は \u003ccode\u003edataset_v2\u003c/code\u003e のように Dataset 名にゆるふわバージョンを付けています。つまり割とカジュアルに Dataset 名が変わります。\u003c/p\u003e\n\n\u003cp\u003eそのため、このように manifest.lkml で全ての Dataset 名を定義しています\u003csup id=\"fnref:3\"\u003e\u003ca href=\"#fn:3\" rel=\"footnote\"\u003e3\u003c/a\u003e\u003c/sup\u003e。Dataset 名は複数箇所で使われ得るためです。\u003c/p\u003e\n\n\u003cpre class=\"code\" data-lang=\"\" data-unlink\u003econstant: table_name1  { value: \u0026#34;`table1_v2.gsheet`\u0026#34; }\nconstant: table_name2  { value: \u0026#34;`table2.view`\u0026#34; }\u003c/pre\u003e\n\n\n\u003cp\u003e利用例です。\u003c/p\u003e\n\n\u003cpre class=\"code\" data-lang=\"\" data-unlink\u003esql_table_name: @{table_name1} ;;\u003c/pre\u003e\n\n\n\u003ch2 id=\"まとめ\"\u003eまとめ\u003c/h2\u003e\n\n\u003cp\u003e現在 LookML 開発で使っているディレクトリ構造を紹介しました。中規模くらいまでの LookML プロジェクトには使える実感があります。\u003c/p\u003e\n\n\u003cp\u003eただ、最近はファイル数が多くなってきて、\u003ccode\u003e.view.lkml\u003c/code\u003e を追加した時に変更する \u003ccode\u003e.explore.lkml\u003c/code\u003e と \u003ccode\u003e.test.lkml\u003c/code\u003e の距離が遠く、実装しづらい課題があります。\u003c/p\u003e\n\n\u003cp\u003eRefinements を使えば解決できるのだろうか、もっと再利用性のあるコードにしたいなど、悩みは尽きないです。\u003c/p\u003e\n\n\u003cp\u003eこちらの記事は読んで手も動かしたのですが、巨大なファイルを分割する、Blocks のようなライブラリをカスタマイズする（？）、以外の使い方を見いだせていません。\u003c/p\u003e\n\n\u003cp\u003e\u003ciframe src=\"https://hatenablog-parts.com/embed?url=https%3A%2F%2Fcommunity.looker.com%2F%25E3%2582%25B3%25E3%2583%25A9%25E3%2583%25A0-103%2Frefinements%25E3%2582%2592%25E4%25BD%25BF%25E3%2581%25A3%25E3%2581%25A6lookml%25E3%2581%25AE%25E3%2582%25B3%25E3%2583%25BC%25E3%2583%2589%25E3%2582%2592%25E6%2595%25B4%25E7%2590%2586%25E3%2581%2599%25E3%2582%258B-18809\" title=\"Refinementsを使ってLookMLのコードを整理する | Looker Community\" class=\"embed-card embed-webcard\" scrolling=\"no\" frameborder=\"0\" style=\"display: block; width: 100%; height: 155px; max-width: 500px; margin: 10px 0px;\"\u003e\u003c/iframe\u003e\u003c/p\u003e\n\n\u003cp\u003e皆さんのディレクトリ構造も是非教えて下さい！\u003c/p\u003e\n\n\u003ch2 id=\"2021-12-29-追記\"\u003e2021-12-29 追記\u003c/h2\u003e\n\n\u003cp\u003e\u003ca href=\"https://community.looker.com/lookml-5/what-is-the-looker-recommended-folder-structure-for-lookml-development-28826\"\u003eWhat is the looker recommended folder structure for LookML development ? | Looker Community\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eLooker Community にもお悩みの方がいらっしゃいました。返信している Dawid さんはよくお見かけする方で、かなりの熟練者だと思います。\u003c/p\u003e\n\n\u003cp\u003eそんな彼も、今回私が書いた記事のような物理的な構造が良いのか、論理的な構造が良いのか、未だに試行錯誤しているようです。\u003c/p\u003e\n\n\u003cp\u003e始めは物理的なディレクトリ構造から始めて、徐々に変化しながら論理的な構造に近づくのかもしれません。その頃にはステージに応じたベストプラクティスが出ていると良いですね。\u003c/p\u003e\n\u003cdiv class=\"footnotes\"\u003e\n\u003chr/\u003e\n\u003col\u003e\n\u003cli id=\"fn:1\"\u003e\n\u003cp\u003e正確に書くと \u003ccode\u003emanifest.lkml\u003c/code\u003e や \u003ccode\u003e.strings.json\u003c/code\u003e などもありますが、一旦考えなくて良いと思います。\u003ca href=\"#fnref:1\" rev=\"footnote\"\u003e\u0026#8617;\u003c/a\u003e\u003c/p\u003e\u003c/li\u003e\n\u003cli id=\"fn:2\"\u003e\n\u003cp\u003e\u003ca href=\"https://funnel.io/\"\u003eFunnel.io\u003c/a\u003e を使っています。\u003ca href=\"#fnref:2\" rev=\"footnote\"\u003e\u0026#8617;\u003c/a\u003e\u003c/p\u003e\u003c/li\u003e\n\u003cli id=\"fn:3\"\u003e\n\u003cp\u003e1 行で書いているのはソートしやすくするためです。\u003ca href=\"#fnref:3\" rev=\"footnote\"\u003e\u0026#8617;\u003c/a\u003e\u003c/p\u003e\u003c/li\u003e\n\u003c/ol\u003e\n\u003c/div\u003e\n\n","contentSnippet":"こんにちは、id:masutaka26 です。この記事は Looker Advent Calendar 2021 の 13 日目の記事です。qiita.com昨日は Yappli 阿部さんの「Lookerの目標値やストップワードを、Googleスプレッドシート連携でお手軽管理【Sexy Tech for You #9】」でした。Looker を使うとこのような LookML を書くだけで、ビジネスユーザーが SQL を書くことなく、本業に集中できるのはとても良いですよね。個人的には、SQL ベースの派生テーブルの中で join するよりも、explore で join したほうが Looker らしく、メンテナンス性が良い気がしました。symmetric 集計が働くため、ファンアウトも避けられます。wikipedia テーブルに関しては、永続的な派生テーブル（PDT）を使って BigQuery のスキャンサイズを抑えるのも良さそうです。、、、( ﾟдﾟ)ハッ！ついマジレスをしてしまいました。💦今回は dimension が null の measure を（0 ではなく）ø にする少しマニアックな記事を書く予定でしたが、先日の Looker User Meetup Online #7 で、LookML のディレクトリ構造を知りたいというチャットをお見かけしたので、今回はその話を書くことにしました。今回のプロジェクトの規模感デフォルトのディレクトリ構造？特別なファイル形式を知る最近使っているディレクトリ構造bigquery/model1.model.lkmlexplores/views/tests/manifest.lkmlまとめ2021-12-29 追記今回のプロジェクトの規模感プロジェクトの規模感によってディレクトリ構造は変わると思うので、先に書いておきます。Looker インスタンスに 1 つだけ LookML プロジェクトが存在するBigQuery Dataset 76 個.lkml ファイル 277 個.model.lkml ファイル 1 個.explore.lkml ファイル 56 個.view.lkml ファイル 139 個.test.lkml ファイル 78 個LookML 開発者 1 名デフォルトのディレクトリ構造？この記事を書くまで誤解をしていたのですが、デフォルトのディレクトリ構造というものはなかったのですね。この記事を書くために改めて Blank Project を作ったら、ファイルもディレクトリも何もないプロジェクトが作られました。モデルファイルを作るとこのようなコードが展開されるので、.view.lkml に関しては /views/ 以下に作る方が多いと思います。私もそうでした。include: \"/views/*.view.lkml\"                # include all views in the views/ folder in this project# include: \"/**/*.view.lkml\"                 # include all views in this project# include: \"my_dashboard.dashboard.lookml\"   # include a lookml dashboard called my_dashboard例えばこのようになります。feedmatic.model.lkmlviews├── all_media.view.lkml└── ga.view.lkml開発初期は feedmatic.model.lkml に view 以外の、explore や datagroup などをズラズラと書いていました。特別なファイル形式を知るご存知の通り、LookML のファイル形式は .lkml です。LookML 開発が続くと .model.lkml や .view.lkml などが増えていきますが、この中で唯一意味を持つのが .model.lkml です1。その他のファイル形式は整理のために自由に作ることが出来ます。例えば feedmatic.model.lkml を作ると、feedmatic というモデルが定義されます。https://{{your looker domain}}/projects で確認できます。all_media.view.lkml を作っても、何かが作られるわけではありません。以上の知識を持った上で、公式ドキュメントを読むと理解が深まるかもしれません。最近使っているディレクトリ構造こんな感じです。それぞれ解説していきます。bigquery├── spreadsheet1│   ├── define.json│   └── schema.json└── spreadsheet2    ├── define.json    └── schema.jsonmodel1.model.lkmlexplores├── corp│   ├── base.explore.lkml│   ├── name1.explore.lkml│   └── name2.explore.lkml├── explore1.explore.lkml└── explore2.explore.lkmlviews├── corp│   ├── base.view.lkml│   ├── name1.view.lkml│   └── name2.view.lkml├── view1.view.lkml└── view2.view.lkmltests└── model1    ├── corp    │   ├── name1.test.lkml    │   └── name2.test.lkml    ├── explore1.test.lkml    └── explore2.test.lkmlmanifest.lkmlbigquery/いきなり LookML 関係ありません。💦BigQuery はデータソースに Google スプレッドシートを指定でき、そのスキーマ定義はコード化することが出来ます。コード化することで変更履歴を Git で管理できますし、BigQuery CLI を使って簡単に Dataset や Table を作ったり、削除したりが出来ます。$ bq mk spreadsheet1$ bq mk --external_table_definition=./define.json spreadsheet1.gsheet$ bq rm -r spreadsheet1破壊的な変更をする時は、バージョン名を付けた Dataset を新規作成し、LookML から参照先を変えます。こうすることで、本番環境に影響を与えずに開発することが出来ます。$ bq mk spreadsheet1_v2$ bq mk --external_table_definition=./define.json spreadsheet1_v2.gsheetスキーマ定義は公式ドキュメントをご覧下さい。需要があればそんな記事を書きます。他の Dataset は ETL ツール2が作るためコード化はしていません。model1.model.lkml中心となるこのファイルは軽いです。本当にこの程度しか書いていません。connection: \"docs_bigquery_db\"include: \"/explores/**/*.explore\"include: \"/tests/model1/**/*.test\"named_value_format: jpy_0 {  value_format: \"\\¥#,##0\"}named_value_format: jpy_1 {  value_format: \"\\¥#,##0.0\"}# for testaccess_grant: can_view_explores_for_tests {  user_attribute: view_explores_for_tests  allowed_values: [\"yes\"]}必要な定義は connection と include だけです。include 対象を全ての .explore.lkml と、このモデルに関連するテスト（tests/feedmatic/ 以下全ての .test.lkml）だけにしていることがポイントです。つまり .model.lkml は .explore.lkml と自分の .test.lkml しか知りません。あとは蛇足で、named_value_format と、前回紹介したテストに必要な access_grant だけです。explores/1 つの explore を 1 つのファイルに定義しています。explores/explore1.explore.lkml はこのように書いています。.explore.lkml は .view.lkml しか知りません。include: \"/views/**/*.view\"explore: explore1 {  # ...}紆余曲折あり、explores/corp/name1.explore.lkml のような取引先ごとの explore もあります。基本となる explores/corp/base.explore.lkml はこのような定義です。ファイル名と explore 名を変えていることがポイントです。Ruby の慣習を参考にしました。explore: corp_base {  extension: required  # ...}corp_base explore を継承する、各取引先の explore はこのような定義です。include: \"./base.explore\"include: \"/views/**/*.view\"explore: corp_name1 {  extends: [corp_base]  # ...}views/view も explore と同様に、1 view 1 ファイルに定義しています。views/view1.view.lkml です。.view.lkml は .model.lkml, .explore.lkml, .test.lkml の誰も知りません。view: view1 {  # ...}取引先ごとの view も同じです。views/corp/base.view.lkml はこんな感じで、view: corp_base {  extension: required  # ...}継承先の views/corp/name1.view.lkml はこんな感じです。include: \"./base.view\"view: corp_name1 {  extends: [corp_base]  # ...}tests/テストはかなり書いており、2021-12-13 現在、184 もあります。ほぼ explore 単位でファイル分割しています。分割することで、ファイル単位のテストが可能になっています。こちらのベストプラクティスに従っています。テスト対象はこんな感じです。(1) LookML で特別な実装をしていて、壊れても気づくのが難しそうな実装(2) primary_key が重複していないか？ null になっていないか？を全ての view に対して(2) は前回詳しく書きました。実行に時間がかかることが悩みで以前こんな Topic を作りましたが、反応ゼロでした。みなさん課題ではないのかしら？💦primary_key は壊れた時に気づくのが難しく、LookML 開発者が私だけということもあるため、機械的に全ての primary_key をテスト出来るようにしています。ただ、全テストは結構時間がかかるので、日に 1 回くらいの頻度で手動実行しています。CI したい...。manifest.lkmlディレクトリ構造とは関係ありませんが、manifest.lkml についても触れておきましょう。bigquery/ の項で書いたとおり、テーブル定義に破壊的な変更を加える時は dataset_v2 のように Dataset 名にゆるふわバージョンを付けています。つまり割とカジュアルに Dataset 名が変わります。そのため、このように manifest.lkml で全ての Dataset 名を定義しています3。Dataset 名は複数箇所で使われ得るためです。constant: table_name1  { value: \"`table1_v2.gsheet`\" }constant: table_name2  { value: \"`table2.view`\" }利用例です。sql_table_name: @{table_name1} ;;まとめ現在 LookML 開発で使っているディレクトリ構造を紹介しました。中規模くらいまでの LookML プロジェクトには使える実感があります。ただ、最近はファイル数が多くなってきて、.view.lkml を追加した時に変更する .explore.lkml と .test.lkml の距離が遠く、実装しづらい課題があります。Refinements を使えば解決できるのだろうか、もっと再利用性のあるコードにしたいなど、悩みは尽きないです。こちらの記事は読んで手も動かしたのですが、巨大なファイルを分割する、Blocks のようなライブラリをカスタマイズする（？）、以外の使い方を見いだせていません。皆さんのディレクトリ構造も是非教えて下さい！2021-12-29 追記What is the looker recommended folder structure for LookML development ? | Looker CommunityLooker Community にもお悩みの方がいらっしゃいました。返信している Dawid さんはよくお見かけする方で、かなりの熟練者だと思います。そんな彼も、今回私が書いた記事のような物理的な構造が良いのか、論理的な構造が良いのか、未だに試行錯誤しているようです。始めは物理的なディレクトリ構造から始めて、徐々に変化しながら論理的な構造に近づくのかもしれません。その頃にはステージに応じたベストプラクティスが出ていると良いですね。正確に書くと manifest.lkml や .strings.json などもありますが、一旦考えなくて良いと思います。↩Funnel.io を使っています。↩1 行で書いているのはソートしやすくするためです。↩","link":"https://developer.feedforce.jp/entry/2021/12/13/110000","isoDate":"2021-12-13T02:00:00.000Z","dateMiliSeconds":1639360800000,"imageUrl":"https://cdn-ak.f.st-hatena.com/images/fotolife/m/masutaka26/20201023/20201023184859.png","authorName":"masutaka"},{"title":"Looker で Join 先の view の primary_key をいい感じにテストする方法をようやく見つけた","content":"\u003cp\u003eこんにちは、\u003ca href=\"http://blog.hatena.ne.jp/masutaka26/\" class=\"hatena-id-icon\"\u003e\u003cimg src=\"https://cdn.profile-image.st-hatena.com/users/masutaka26/profile.png\" width=\"16\" height=\"16\" alt=\"\" class=\"hatena-id-icon\"\u003eid:masutaka26\u003c/a\u003e です。\n先週はまるっと夏休みにしてました。今日からまた \u003ca href=\"https://ja.looker.com/\"\u003eLooker\u003c/a\u003e と戯れる日々が始まります。\u003c/p\u003e\n\n\u003cp\u003e丸１年 Looker と戯れてきて最近ようやく、\u003cstrong\u003eJoin 先の view でも\u003c/strong\u003e primary_key が壊れてないことを保証するテストの書き方が分かったので、今回紹介します。\u003c/p\u003e\n\n\u003cul class=\"table-of-contents\"\u003e\n    \u003cli\u003e\u003ca href=\"#Looker-における-primary_key-の役割\"\u003eLooker における primary_key の役割\u003c/a\u003e\u003c/li\u003e\n    \u003cli\u003e\u003ca href=\"#primary_key-の実装例\"\u003eprimary_key の実装例\u003c/a\u003e\u003c/li\u003e\n    \u003cli\u003e\u003ca href=\"#LookML-開発におけるテスト\"\u003eLookML 開発におけるテスト\u003c/a\u003e\u003c/li\u003e\n    \u003cli\u003e\u003ca href=\"#Join-先の-view-は-primary_key-をテスト出来ないことがある\"\u003eJoin 先の view は primary_key をテスト出来ないことがある\u003c/a\u003e\u003c/li\u003e\n    \u003cli\u003e\u003ca href=\"#Join-先の-view-の-primary_key-をいい感じにテストする\"\u003eJoin 先の view の primary_key をいい感じにテストする\u003c/a\u003e\u003c/li\u003e\n    \u003cli\u003e\u003ca href=\"#まとめと所感\"\u003eまとめと所感\u003c/a\u003e\u003c/li\u003e\n    \u003cli\u003e\u003ca href=\"#おまけ\"\u003eおまけ\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch2 id=\"Looker-における-primary_key-の役割\"\u003eLooker における primary_key の役割\u003c/h2\u003e\n\n\u003cp\u003eLooker には \u003ca href=\"https://help.looker.com/hc/en-us/articles/360023722974\"\u003eSymmetric Aggregates\u003c/a\u003e という、合計を重複させない素晴らしい仕組みがあります。以前このブログでも紹介しました。\u003c/p\u003e\n\n\u003cp\u003e\u003ciframe src=\"https://hatenablog-parts.com/embed?url=https%3A%2F%2Fdeveloper.feedforce.jp%2Fentry%2F2020%2F10%2F23%2F190000\" title=\"『4月から取り組んできたLookerの導入から実装までのお話（Redashとも比較）』という発表をした - Feedforce Developer Blog\" class=\"embed-card embed-blogcard\" scrolling=\"no\" frameborder=\"0\" style=\"display: block; width: 100%; height: 190px; max-width: 500px; margin: 10px 0px;\"\u003e\u003c/iframe\u003e\u003c/p\u003e\n\n\u003cp\u003eその Symmetric Aggregates では \u003ca href=\"https://docs.looker.com/reference/field-params/primary_key\"\u003eprimary_key\u003c/a\u003e が重要な役割を果たします。適切に設定されていないと、以下のような問題が発生します。\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eprimary_key が重複すると fanout エラーが発生することがある\u003c/li\u003e\n\u003cli\u003eprimary_key が null だと Measure が 0 になることがある\u003c/li\u003e\n\u003c/ul\u003e\n\n\n\u003cp\u003eこのような問題は大概、ふわっと質問が来て発覚します。今のタスクを保留にして調査することは精神的になかなか辛いものがあり、それなりに時間も費やすことになるため、可能な限り事前に避けたいところです。\u003c/p\u003e\n\n\u003ch2 id=\"primary_key-の実装例\"\u003eprimary_key の実装例\u003c/h2\u003e\n\n\u003cp\u003e私が所属する \u003ca href=\"https://feedmatic.net/\"\u003eFeedmatic\u003c/a\u003e では、ウェブ広告や Google Analytics のデータを扱っています。正規化されたきれいなデータは少なく、Rails の id のようなユニークなカラムは存在しないことが多いです。\u003c/p\u003e\n\n\u003cp\u003eそのため、このようにいくつかの Dimension を組み合わせて primary_key を定義します。\u003c/p\u003e\n\n\u003cpre class=\"code\" data-lang=\"\" data-unlink\u003edimension: id {\n  primary_key: yes\n  type: string\n  sql: CONCAT(${dimension1}, ${dimension2}, IFNULL(${dimension3}, \u0026#39;\u0026#39;)) ;;\n  hidden: yes\n}\u003c/pre\u003e\n\n\n\u003cp\u003e※ \u003ca href=\"https://ja.wikipedia.org/wiki/%E3%83%87%E3%83%BC%E3%82%BF%E3%82%A6%E3%82%A7%E3%82%A2%E3%83%8F%E3%82%A6%E3%82%B9\"\u003eDWH\u003c/a\u003e は BigQuery を使っています。\u003c/p\u003e\n\n\u003cp\u003eこれで済めばよいのですが、上の例だとある日突然 dimension2 が null になり始めたり、全ての string 型の Dimension を使っても重複し始めることがあります。データの性格は理解していたつもりでしたが、実際どちらもありました。😭\u003c/p\u003e\n\n\u003ch2 id=\"LookML-開発におけるテスト\"\u003eLookML 開発におけるテスト\u003c/h2\u003e\n\n\u003cp\u003e以上の課題を解決するために、\u003ca href=\"https://docs.looker.com/reference/model-params/test\"\u003etest\u003c/a\u003e パラメータが使えます。\u003c/p\u003e\n\n\u003cp\u003e例えばこのような \u003ccode\u003eparent\u003c/code\u003e explore があったとします。Join がないのでシンプルです。\u003c/p\u003e\n\n\u003cpre class=\"code\" data-lang=\"\" data-unlink\u003eexplore: parent {\n  ...\n}\n\nview: parent {\n  dimension: id {\n    primary_key: yes\n    ...\n  }\n\n  measure: count {\n    type: count\n  }\n}\u003c/pre\u003e\n\n\n\u003cp\u003e私はこのようなテストを書いて、全ての \u003ccode\u003eparent.id\u003c/code\u003e が null でないことと、重複しないことを保証させています。\u003c/p\u003e\n\n\u003cpre class=\"code\" data-lang=\"\" data-unlink\u003etest: parent_id_is_not_null {\n  explore_source: parent {\n    column: id {}\n    sorts: [parent.id: asc]\n    limit: 1\n  }\n  assert: id_is_not_null {\n    expression: NOT is_null(${parent.id}) ;;\n  }\n}\n\ntest: parent_id_is_unique {\n  explore_source: parent {\n    column: id {}\n    column: count {}\n    sorts: [parent.count: desc]\n    limit: 1\n  }\n  assert: id_is_unique {\n    expression: ${parent.count} = 1 ;;\n  }\n}\u003c/pre\u003e\n\n\n\u003cp\u003e👉 ソート時に null が先頭と末尾のどちらに来るかは、DWH の実装によります。\u003c/p\u003e\n\n\u003ch2 id=\"Join-先の-view-は-primary_key-をテスト出来ないことがある\"\u003eJoin 先の view は primary_key をテスト出来ないことがある\u003c/h2\u003e\n\n\u003cp\u003eさて、\u003ccode\u003echild\u003c/code\u003e view を Join する必要が出てきました。\u003c/p\u003e\n\n\u003cpre class=\"code\" data-lang=\"\" data-unlink\u003eexplore: parent {\n  join: child {\n    type: left_outer\n    relationship: one_to_many\n    sql_on: ... ;;\n  }\n}\n\nview: parent {\n  dimension: id {\n    primary_key: yes\n    ...\n  }\n\n  measure: count {\n    type: count\n  }\n}\n\nview: child {\n  dimension: id {\n    primary_key: yes\n    ...\n  }\n\n  measure: count {\n    type: count\n    hidden: yes\n  }\n}\u003c/pre\u003e\n\n\n\u003cp\u003e同じように \u003ccode\u003echild.id\u003c/code\u003e のテストを書きましたが、うまくいきません。\u003ccode\u003eis_not_null\u003c/code\u003e はまだしも、\u003ccode\u003eis_unique\u003c/code\u003e がダメです。\u003c/p\u003e\n\n\u003cpre class=\"code\" data-lang=\"\" data-unlink\u003e# これは OK\ntest: parent_child_id_is_not_null {\n  explore_source: parent {\n    column: id { field: child.id }\n    sorts: [child.id: asc]\n    limit: 1\n  }\n  assert: child_id_is_not_null {\n    expression: NOT is_null(${child.id}) ;;\n  }\n}\n\n# parent の count になり、テストが通らない。\ntest: parent_child_id_is_unique {\n  explore_source: parent {\n    column: id { field: child.id }\n    column: count { field: child.count }\n    sorts: [parent.count: desc]\n    limit: 1\n  }\n  assert: child_id_is_unique {\n    expression: ${child.count} = 1 ;;\n  }\n}\u003c/pre\u003e\n\n\n\u003cp\u003eよく考えれば当たり前の話で、Join した状態でテストを書いているからです。そもそも \u003ccode\u003echild\u003c/code\u003e view の primary_key のテストをしたいだけなのに、Join は邪魔です。\u003c/p\u003e\n\n\u003ch2 id=\"Join-先の-view-の-primary_key-をいい感じにテストする\"\u003eJoin 先の view の primary_key をいい感じにテストする\u003c/h2\u003e\n\n\u003cp\u003e\u003ccode\u003echild\u003c/code\u003e view と同じファイルに、こっそり \u003ccode\u003echild\u003c/code\u003e explore を定義します。\u003ca href=\"https://docs.looker.com/ja/reference/explore-params/hidden-for-explore\"\u003ehidden\u003c/a\u003e にして存在を消しています。さらに \u003ca href=\"https://docs.looker.com/reference/explore-params/required_access_grants-for-explore\"\u003erequired_access_grants\u003c/a\u003e で、開発者以外の URL 直打ちによるアクセスも防いでいます。\u003c/p\u003e\n\n\u003cpre class=\"code\" data-lang=\"\" data-unlink\u003eview: child {\n  dimension: id {\n    primary_key: yes\n    ...\n  }\n\n  measure: count {\n    type: count\n    hidden: yes\n  }\n}\n\n# Define for test\nexplore: child {\n  hidden: yes\n  required_access_grants: [can_view_explores_for_tests]\n}\u003c/pre\u003e\n\n\n\u003cp\u003e\u003ca href=\"https://docs.looker.com/reference/model-params/access_grant\"\u003eaccess_grant\u003c/a\u003e である \u003ccode\u003ecan_view_explores_for_tests\u003c/code\u003e はこのような定義です。\u003c/p\u003e\n\n\u003cpre class=\"code\" data-lang=\"\" data-unlink\u003e# For tests\naccess_grant: can_view_explores_for_tests {\n  user_attribute: view_explores_for_tests\n  allowed_values: [\u0026#34;yes\u0026#34;]\n}\u003c/pre\u003e\n\n\n\u003cp\u003e\u003ca href=\"https://docs.looker.com/admin-options/settings/user-attributes\"\u003eUser attribute\u003c/a\u003e である \u003ccode\u003eview_explores_for_tests\u003c/code\u003e は、今回のような「Join 先の view をテストすること」全般に使います。User Access は \u003ccode\u003eNone\u003c/code\u003e、Default Value も \u003ccode\u003eno\u003c/code\u003e です。開発者用の Group を作り、その Group value を \u003ccode\u003eyes\u003c/code\u003e にしました。\u003c/p\u003e\n\n\u003cp\u003eここまでやらずとも全員アクセス不可でも良いのですが、テストが落ちた時に「クエリの探索」からの調査ができなくなるので、開発者にはアクセス権を与えるポリシーにしています。\u003c/p\u003e\n\n\u003cp\u003eあとは \u003ccode\u003eparent\u003c/code\u003e explore と同じようにテストを書くだけです。\u003c/p\u003e\n\n\u003cpre class=\"code\" data-lang=\"\" data-unlink\u003etest: child_id_is_not_null {\n  explore_source: child {\n    column: id {}\n    sorts: [child.id: asc]\n    limit: 1\n  }\n  assert: id_is_not_null {\n    expression: NOT is_null(${child.id}) ;;\n  }\n}\n\ntest: child_id_is_unique {\n  explore_source: child {\n    column: id {}\n    column: count {}\n    sorts: [child.count: desc]\n    limit: 1\n  }\n  assert: id_is_unique {\n    expression: ${child.count} = 1 ;;\n  }\n}\u003c/pre\u003e\n\n\n\u003cp\u003eテストは通っても、LookML validation error が発生するかもしれません。その時は \u003ca href=\"https://docs.looker.com/ja/reference/explore-params/fields-for-explore\"\u003efields\u003c/a\u003e パラメータを使って、露出する field を限定すると良いでしょう。\u003c/p\u003e\n\n\u003cpre class=\"code\" data-lang=\"\" data-unlink\u003e# Define for test\nexplore: child {\n  hidden: yes\n  required_access_grants: [can_view_explores_for_tests]\n  fields: [child.id, child.count] # Avoid LookML validation error\n}\u003c/pre\u003e\n\n\n\u003cp\u003eこのテクニックは \u003ca href=\"https://help.looker.com/hc/en-us/articles/360023586293-Error-Unknown-or-Inaccessible-Field\"\u003eError: Unknown or Inaccessible Field – Looker Help Center\u003c/a\u003e でも紹介されています。\u003c/p\u003e\n\n\u003ch2 id=\"まとめと所感\"\u003eまとめと所感\u003c/h2\u003e\n\n\u003cp\u003eLookML 開発者で、且つテストを書いていて、且つ Join 先の view の primary_key に課題を抱えている、大変ニッチな層向けに記事を書きました。どこかの誰かに参考になれば幸いです。\u003c/p\u003e\n\n\u003cp\u003eもっと良い方法や、今回のやり方はここがマズイとかあれば \u003ca href=\"https://twitter.com/masutaka\"\u003e@masutaka\u003c/a\u003e にお知らせ頂けると大変うれしいです。🙏\u003c/p\u003e\n\n\u003cp\u003eFeedmatic では今回のような view は数十もあり、primary_key のテストはまだ書き始めたばかりです。\u003c/p\u003e\n\n\u003cp\u003eLooker ではテストは直列でしか実行されないようで、書けば書くほど全テストが遅くなるのはモヤモヤしています。さすがに要望しようと思ってますが。\u003c/p\u003e\n\n\u003cp\u003eそれに関連して、最近ディレクトリやファイル構成を再検討しました。次回はその記事を書く予定です。\u003c/p\u003e\n\n\u003ch2 id=\"おまけ\"\u003eおまけ\u003c/h2\u003e\n\n\u003cp\u003e今回の記事を書く過程で、中の人が書いたベストプラクティスを見つけました。\u003c/p\u003e\n\n\u003cp\u003e\u003ciframe src=\"https://hatenablog-parts.com/embed?url=https%3A%2F%2Fcommunity.looker.com%2Flookml-5%2Flookml-data-tests-recommendations-and-best-practices-20815\" title=\"LookML Data Tests: Recommendations and Best Practices | Looker Community\" class=\"embed-card embed-webcard\" scrolling=\"no\" frameborder=\"0\" style=\"display: block; width: 100%; height: 155px; max-width: 500px; margin: 10px 0px;\"\u003e\u003c/iframe\u003e\u003c/p\u003e\n\n\u003cp\u003e今回の記事ほど細かいテクニックは書かれていませんが、全体を網羅した良記事なので要チェックです。\u003c/p\u003e\n","contentSnippet":"こんにちは、id:masutaka26 です。先週はまるっと夏休みにしてました。今日からまた Looker と戯れる日々が始まります。丸１年 Looker と戯れてきて最近ようやく、Join 先の view でも primary_key が壊れてないことを保証するテストの書き方が分かったので、今回紹介します。Looker における primary_key の役割primary_key の実装例LookML 開発におけるテストJoin 先の view は primary_key をテスト出来ないことがあるJoin 先の view の primary_key をいい感じにテストするまとめと所感おまけLooker における primary_key の役割Looker には Symmetric Aggregates という、合計を重複させない素晴らしい仕組みがあります。以前このブログでも紹介しました。その Symmetric Aggregates では primary_key が重要な役割を果たします。適切に設定されていないと、以下のような問題が発生します。primary_key が重複すると fanout エラーが発生することがあるprimary_key が null だと Measure が 0 になることがあるこのような問題は大概、ふわっと質問が来て発覚します。今のタスクを保留にして調査することは精神的になかなか辛いものがあり、それなりに時間も費やすことになるため、可能な限り事前に避けたいところです。primary_key の実装例私が所属する Feedmatic では、ウェブ広告や Google Analytics のデータを扱っています。正規化されたきれいなデータは少なく、Rails の id のようなユニークなカラムは存在しないことが多いです。そのため、このようにいくつかの Dimension を組み合わせて primary_key を定義します。dimension: id {  primary_key: yes  type: string  sql: CONCAT(${dimension1}, ${dimension2}, IFNULL(${dimension3}, '')) ;;  hidden: yes}※ DWH は BigQuery を使っています。これで済めばよいのですが、上の例だとある日突然 dimension2 が null になり始めたり、全ての string 型の Dimension を使っても重複し始めることがあります。データの性格は理解していたつもりでしたが、実際どちらもありました。😭LookML 開発におけるテスト以上の課題を解決するために、test パラメータが使えます。例えばこのような parent explore があったとします。Join がないのでシンプルです。explore: parent {  ...}view: parent {  dimension: id {    primary_key: yes    ...  }  measure: count {    type: count  }}私はこのようなテストを書いて、全ての parent.id が null でないことと、重複しないことを保証させています。test: parent_id_is_not_null {  explore_source: parent {    column: id {}    sorts: [parent.id: asc]    limit: 1  }  assert: id_is_not_null {    expression: NOT is_null(${parent.id}) ;;  }}test: parent_id_is_unique {  explore_source: parent {    column: id {}    column: count {}    sorts: [parent.count: desc]    limit: 1  }  assert: id_is_unique {    expression: ${parent.count} = 1 ;;  }}👉 ソート時に null が先頭と末尾のどちらに来るかは、DWH の実装によります。Join 先の view は primary_key をテスト出来ないことがあるさて、child view を Join する必要が出てきました。explore: parent {  join: child {    type: left_outer    relationship: one_to_many    sql_on: ... ;;  }}view: parent {  dimension: id {    primary_key: yes    ...  }  measure: count {    type: count  }}view: child {  dimension: id {    primary_key: yes    ...  }  measure: count {    type: count    hidden: yes  }}同じように child.id のテストを書きましたが、うまくいきません。is_not_null はまだしも、is_unique がダメです。# これは OKtest: parent_child_id_is_not_null {  explore_source: parent {    column: id { field: child.id }    sorts: [child.id: asc]    limit: 1  }  assert: child_id_is_not_null {    expression: NOT is_null(${child.id}) ;;  }}# parent の count になり、テストが通らない。test: parent_child_id_is_unique {  explore_source: parent {    column: id { field: child.id }    column: count { field: child.count }    sorts: [parent.count: desc]    limit: 1  }  assert: child_id_is_unique {    expression: ${child.count} = 1 ;;  }}よく考えれば当たり前の話で、Join した状態でテストを書いているからです。そもそも child view の primary_key のテストをしたいだけなのに、Join は邪魔です。Join 先の view の primary_key をいい感じにテストするchild view と同じファイルに、こっそり child explore を定義します。hidden にして存在を消しています。さらに required_access_grants で、開発者以外の URL 直打ちによるアクセスも防いでいます。view: child {  dimension: id {    primary_key: yes    ...  }  measure: count {    type: count    hidden: yes  }}# Define for testexplore: child {  hidden: yes  required_access_grants: [can_view_explores_for_tests]}access_grant である can_view_explores_for_tests はこのような定義です。# For testsaccess_grant: can_view_explores_for_tests {  user_attribute: view_explores_for_tests  allowed_values: [\"yes\"]}User attribute である view_explores_for_tests は、今回のような「Join 先の view をテストすること」全般に使います。User Access は None、Default Value も no です。開発者用の Group を作り、その Group value を yes にしました。ここまでやらずとも全員アクセス不可でも良いのですが、テストが落ちた時に「クエリの探索」からの調査ができなくなるので、開発者にはアクセス権を与えるポリシーにしています。あとは parent explore と同じようにテストを書くだけです。test: child_id_is_not_null {  explore_source: child {    column: id {}    sorts: [child.id: asc]    limit: 1  }  assert: id_is_not_null {    expression: NOT is_null(${child.id}) ;;  }}test: child_id_is_unique {  explore_source: child {    column: id {}    column: count {}    sorts: [child.count: desc]    limit: 1  }  assert: id_is_unique {    expression: ${child.count} = 1 ;;  }}テストは通っても、LookML validation error が発生するかもしれません。その時は fields パラメータを使って、露出する field を限定すると良いでしょう。# Define for testexplore: child {  hidden: yes  required_access_grants: [can_view_explores_for_tests]  fields: [child.id, child.count] # Avoid LookML validation error}このテクニックは Error: Unknown or Inaccessible Field – Looker Help Center でも紹介されています。まとめと所感LookML 開発者で、且つテストを書いていて、且つ Join 先の view の primary_key に課題を抱えている、大変ニッチな層向けに記事を書きました。どこかの誰かに参考になれば幸いです。もっと良い方法や、今回のやり方はここがマズイとかあれば @masutaka にお知らせ頂けると大変うれしいです。🙏Feedmatic では今回のような view は数十もあり、primary_key のテストはまだ書き始めたばかりです。Looker ではテストは直列でしか実行されないようで、書けば書くほど全テストが遅くなるのはモヤモヤしています。さすがに要望しようと思ってますが。それに関連して、最近ディレクトリやファイル構成を再検討しました。次回はその記事を書く予定です。おまけ今回の記事を書く過程で、中の人が書いたベストプラクティスを見つけました。今回の記事ほど細かいテクニックは書かれていませんが、全体を網羅した良記事なので要チェックです。","link":"https://developer.feedforce.jp/entry/2021/08/30/150000","isoDate":"2021-08-30T06:00:00.000Z","dateMiliSeconds":1630303200000,"imageUrl":"https://cdn-ak.f.st-hatena.com/images/fotolife/m/masutaka26/20201023/20201023184859.png","authorName":"masutaka"},{"title":"私が１年かけて辿り着いた Looker の情報収集方法を紹介する","content":"\u003cp\u003eこんばんは、\u003cdel\u003e徳川家ｙ\u003c/del\u003e \u003ca href=\"http://blog.hatena.ne.jp/masutaka26/\" class=\"hatena-id-icon\"\u003e\u003cimg src=\"https://cdn.profile-image.st-hatena.com/users/masutaka26/profile.png\" width=\"16\" height=\"16\" alt=\"\" class=\"hatena-id-icon\"\u003eid:masutaka26\u003c/a\u003e です。\u003c/p\u003e\n\n\u003cp\u003e以前紹介したように、去年から \u003ca href=\"https://ja.looker.com/\"\u003eLooker\u003c/a\u003e を使ったウェブ広告数値の可視化や BI \u003ca href=\"#f-25b67c2a\" name=\"fn-25b67c2a\" title=\"Business Intelligence\"\u003e*1\u003c/a\u003e に取り組んでいます。\u003c/p\u003e\n\n\u003cp\u003e\u003ciframe src=\"https://hatenablog-parts.com/embed?url=https%3A%2F%2Fdeveloper.feedforce.jp%2Fentry%2F2020%2F10%2F23%2F190000\" title=\"『4月から取り組んできたLookerの導入から実装までのお話（Redashとも比較）』という発表をした - Feedforce Developer Blog\" class=\"embed-card embed-blogcard\" scrolling=\"no\" frameborder=\"0\" style=\"display: block; width: 100%; height: 190px; max-width: 500px; margin: 10px 0px;\"\u003e\u003c/iframe\u003e\u003c/p\u003e\n\n\u003cp\u003eLookML 開発者として LookML を書き始めて困ったのが、Looker の情報が少ないように見えたことです。\u003c/p\u003e\n\n\u003cp\u003eLookML を含む Looker のドキュメントは充実しているのですが、それらを組み合わせた応用的なフロー情報が少なく感じました。ビジネスユーザー向けの情報も同様です。\u003c/p\u003e\n\n\u003cp\u003e現在は網羅的、かつ集約した情報を取得できているので、その方法をご紹介します。\u003c/p\u003e\n\n\u003cul class=\"table-of-contents\"\u003e\n    \u003cli\u003e\u003ca href=\"#情報源をリストアップする\"\u003e「情報源」をリストアップする\u003c/a\u003e\u003c/li\u003e\n    \u003cli\u003e\u003ca href=\"#少し脱線\"\u003e少し脱線...\u003c/a\u003e\u003c/li\u003e\n    \u003cli\u003e\u003ca href=\"#情報源の取得方法への課題\"\u003e「情報源」の取得方法への課題\u003c/a\u003e\u003c/li\u003e\n    \u003cli\u003e\u003ca href=\"#今はどうなったか\"\u003e今はどうなったか？\u003c/a\u003e\u003c/li\u003e\n    \u003cli\u003e\u003ca href=\"#Looker-Communityのフィードが存在した件\"\u003e「Looker Community」のフィードが存在した件\u003c/a\u003e\u003c/li\u003e\n    \u003cli\u003e\u003ca href=\"#Looker-の記事一覧--DevelopersIOのフィードを作った件\"\u003e「Looker の記事一覧 | DevelopersIO」のフィードを作った件\u003c/a\u003e\u003c/li\u003e\n    \u003cli\u003e\u003ca href=\"#まとめ\"\u003eまとめ\u003c/a\u003e\u003c/li\u003e\n    \u003cli\u003e\u003ca href=\"#追記\"\u003e追記\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch2 id=\"情報源をリストアップする\"\u003e「情報源」をリストアップする\u003c/h2\u003e\n\n\u003cp\u003e初めはこれらをたまに見に行ったり、Slack の \u003ccode\u003e/feed subscribe\u003c/code\u003e \u003ca href=\"#f-e46aea89\" name=\"fn-e46aea89\" title=\"Slack に RSS フィードを追加する | Slack\"\u003e*2\u003c/a\u003e で購読したりしてました。\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://community.looker.com/\"\u003eLooker Community\u003c/a\u003e\n\n\u003cul\u003e\n\u003cli\u003e公式フォーラム。英語で Question や Conversation が出来る\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003cp\u003e\u003ca href=\"https://community.looker.com/%E3%82%B3%E3%83%9F%E3%83%A5%E3%83%8B%E3%83%86%E3%82%A3%E3%83%95%E3%82%A9%E3%83%BC%E3%83%A9%E3%83%A0-japanese-161\"\u003eLooker 日本語コミュニティフォーラム\u003c/a\u003e\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003e「Looker Community」の日本語版。\u003ca href=\"https://docs.looker.com/relnotes/intro\"\u003eRelease Notes\u003c/a\u003e の日本語訳には本当に感謝 🙏\u003c/li\u003e\n\u003cli\u003e\u003cp\u003e「ニュースと告知」「ヘルプとサポート」「コラム」はそれぞれ Subscribe 出来る。メールで通知される\u003c/p\u003e\n\n\u003cp\u003e  \u003cfigure class=\"figure-image figure-image-fotolife\" title=\"Looker 日本語コミュニティフォーラム\"\u003e\u003cspan itemscope itemtype=\"http://schema.org/Photograph\"\u003e\u003cimg src=\"https://cdn-ak.f.st-hatena.com/images/fotolife/m/masutaka26/20210815/20210815145002.png\" alt=\"f:id:masutaka26:20210815145002p:plain\" width=\"1200\" height=\"382\" loading=\"lazy\" title=\"\" class=\"hatena-fotolife\" itemprop=\"image\"\u003e\u003c/span\u003e\u003cfigcaption\u003eLooker 日本語コミュニティフォーラム\u003c/figcaption\u003e\u003c/figure\u003e\u003c/p\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003cp\u003e\u003ca href=\"https://www.facebook.com/groups/721814241538725\"\u003eLooker APAC Forum | Facebook\u003c/a\u003e\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eリリース案内や事例紹介など\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://dev.classmethod.jp/tags/looker/\"\u003eLooker の記事一覧 | DevelopersIO\u003c/a\u003e\n\n\u003cul\u003e\n\u003cli\u003eご存知クラスメソッドさんのブログ。国内最多の記事量と投稿頻度\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://zenn.dev/topics/looker\"\u003eLookerの記事一覧 | Zenn\u003c/a\u003e\n\n\u003cul\u003e\n\u003cli\u003eZenn にもそれなりの頻度で投稿される\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://qiita.com/tags/looker\"\u003eLooker - Qiita\u003c/a\u003e\n\n\u003cul\u003e\n\u003cli\u003eQiita はもう少し頻度は落ちるかな\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://twitter.com/search?q=%23looker%20lang%3Aja\u0026amp;f=live\u0026amp;vertical=default\"\u003e#looker lang:ja - Twitter 検索\u003c/a\u003e\n\n\u003cul\u003e\n\u003cli\u003e以上の情報をふわっと取得できる。\u003ccode\u003elooker lang:ja\u003c/code\u003e や \u003ccode\u003e#looker\u003c/code\u003e だとノイズが多いのでこれに落ち着いた\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\n\n\u003ch2 id=\"少し脱線\"\u003e少し脱線...\u003c/h2\u003e\n\n\u003cp\u003eLooker Community には過去一度だけ質問しました。\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://community.looker.com/lookml-5/how-do-i-dynamically-switch-view-name-in-sql-parameter-of-dimension-27831\"\u003eHow do I dynamically switch view name in sql parameter of dimension? | Looker Community\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e私は日本語サポートに頼ることが多い傾向です。最近はだいぶ減らせています。\u003c/p\u003e\n\n\u003cp\u003e扱う情報を外に出せないので、外に出せるところまで昇華するのは難しいですね。🌀\u003c/p\u003e\n\n\u003cp\u003eLooker の水野さんが日本語訳して下さっている、Looker のリリースノート \u003ca href=\"#f-c898f381\" name=\"fn-c898f381\" title=\"例: Looker 21.12 リリースノート | Looker Community\"\u003e*3\u003c/a\u003e は、去年の 12 月から社内向けにこんな記事を書いて、Looker に徹底的に向き合うようにしています。\u003c/p\u003e\n\n\u003cp\u003e\u003cfigure class=\"figure-image figure-image-fotolife\" title=\"Looker 21.12 のリリースノートを眺めてみた\"\u003e\u003cspan itemscope itemtype=\"http://schema.org/Photograph\"\u003e\u003cimg src=\"https://cdn-ak.f.st-hatena.com/images/fotolife/m/masutaka26/20210815/20210815160438.png\" alt=\"f:id:masutaka26:20210815160438p:plain\" width=\"1200\" height=\"849\" loading=\"lazy\" title=\"\" class=\"hatena-fotolife\" itemprop=\"image\"\u003e\u003c/span\u003e\u003cfigcaption\u003eLooker 21.12 のリリースノートを眺めてみた\u003c/figcaption\u003e\u003c/figure\u003e\u003c/p\u003e\n\n\u003cp\u003e今まで書いた記事です。\u003c/p\u003e\n\n\u003cp\u003e\u003cfigure class=\"figure-image figure-image-fotolife\" title=\"Looker のリリースノートを眺めてみたシリーズ\"\u003e\u003cspan itemscope itemtype=\"http://schema.org/Photograph\"\u003e\u003cimg src=\"https://cdn-ak.f.st-hatena.com/images/fotolife/m/masutaka26/20210815/20210815160356.png\" alt=\"f:id:masutaka26:20210815160356p:plain\" width=\"1200\" height=\"887\" loading=\"lazy\" title=\"\" class=\"hatena-fotolife\" itemprop=\"image\"\u003e\u003c/span\u003e\u003cfigcaption\u003eLooker のリリースノートを眺めてみたシリーズ\u003c/figcaption\u003e\u003c/figure\u003e\u003c/p\u003e\n\n\u003ch2 id=\"情報源の取得方法への課題\"\u003e「情報源」の取得方法への課題\u003c/h2\u003e\n\n\u003cp\u003eRSS/Atom（フィード）を配信していないサイトがほとんどで、見に行くのがかなり面倒でした。\u003c/p\u003e\n\n\u003cp\u003eそのものズバリなフィードは Zenn と Qiita だけです。クラスメソッドさんは Looker タグのフィードが存在せず、当時は Twitter で捕捉してました。\u003c/p\u003e\n\n\u003ch2 id=\"今はどうなったか\"\u003e今はどうなったか？\u003c/h2\u003e\n\n\u003cp\u003eほぼすべてを社内の Slack channel \u003ccode\u003e#news-looker\u003c/code\u003e に集約させることが出来ました。\u003c/p\u003e\n\n\u003cp\u003e以下が実際に購読しているフィードです。\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://community.looker.com/feed/buzzcapture\"\u003ehttps://community.looker.com/feed/buzzcapture\u003c/a\u003e\n\n\u003cul\u003e\n\u003cli\u003e「Looker Community」のフィード。後述する\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://feed43.com/developersio-looker.xml\"\u003ehttps://feed43.com/developersio-looker.xml\u003c/a\u003e\n\n\u003cul\u003e\n\u003cli\u003e「Looker の記事一覧 | DevelopersIO」のフィード。後述する\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://zenn.dev/topics/looker/feed\"\u003ehttps://zenn.dev/topics/looker/feed\u003c/a\u003e\n\n\u003cul\u003e\n\u003cli\u003e「Lookerの記事一覧 | Zenn」のフィード\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://qiita.com/tags/looker/feed\"\u003ehttps://qiita.com/tags/looker/feed\u003c/a\u003e\n\n\u003cul\u003e\n\u003cli\u003e「Looker - Qiita」のフィード\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\n\n\u003cp\u003eTwitter は \u003ca href=\"https://ifttt.com/\"\u003eIFTTT\u003c/a\u003e を使って、同 channel に POST しています。\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003eIf\u003c/code\u003e New tweet from search \u003ccode\u003e#looker OR LookML lang:ja -rt\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eThen\u003c/code\u003e Post to channel\n\n\u003cul\u003e\n\u003cli\u003eChannel: \u003ccode\u003e#news-looker\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003eMessage: \u003ccode\u003e@{{UserName}} : {{Text}} (via Twitter {{LinkToTweet}})\u003c/code\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\n\n\u003cp\u003e「Looker APAC Forum | Facebook」は集約できませんでしたが、Twitter にも流れることがあるので、一旦考えないことにしました。\u003c/p\u003e\n\n\u003ch2 id=\"Looker-Communityのフィードが存在した件\"\u003e「Looker Community」のフィードが存在した件\u003c/h2\u003e\n\n\u003cp\u003e\u003ca href=\"https://community.looker.com/%E3%83%8B%E3%83%A5%E3%83%BC%E3%82%B9%E3%81%A8%E5%91%8A%E7%9F%A5-100/%E3%82%AB%E3%83%86%E3%82%B4%E3%83%AA-the-kitchen-table-%E3%81%8C%E5%85%AC%E9%96%8B%E3%81%95%E3%82%8C%E3%81%BE%E3%81%97%E3%81%9F-24032?postid=45126#post45126\"\u003eLooker の水野さんに聞いたら、調べて教えて下さいました。\u003c/a\u003e🙏\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003e(1) 新しいトピックの投稿\n\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://community.looker.com/feed/topics\"\u003ehttps://community.looker.com/feed/topics\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e(2) 全ての新しい投稿（最初の投稿（タイトル＋ボディ）+ 全てのリプライ）\n\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://community.looker.com/feed/buzzcapture\"\u003ehttps://community.looker.com/feed/buzzcapture\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\n\n\u003cp\u003eアナウンス記事です。\n\u003ca href=\"https://community.looker.com/%E3%83%8B%E3%83%A5%E3%83%BC%E3%82%B9%E3%81%A8%E5%91%8A%E7%9F%A5-100/looker%E3%82%B3%E3%83%9F%E3%83%A5%E3%83%8B%E3%83%86%E3%82%A3%E3%81%AErss%E3%83%95%E3%82%A3%E3%83%BC%E3%83%89-25553?postid=46404#post46404\"\u003eLookerコミュニティのRSSフィード | Looker Community\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e(1) と (2) は両方とも「Looker 日本語コミュニティフォーラム」の情報も流れてきます。\u003c/p\u003e\n\n\u003cp\u003e今は (2) を購読しており、トラフィックはそれなりにあります。もちろんほぼ全て英語です。辛かったら (1) にすると良いと思います。\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://community.looker.com/\"\u003ehttps://community.looker.com/\u003c/a\u003e の HTML には RSS/Atom 情報がないので、これらのフィードに気づける人は少ないと思います。Looker さんには是非お願いしたいところです。\u003c/p\u003e\n\n\u003ch2 id=\"Looker-の記事一覧--DevelopersIOのフィードを作った件\"\u003e「Looker の記事一覧 | DevelopersIO」のフィードを作った件\u003c/h2\u003e\n\n\u003cp\u003eないものは仕方がないので、\u003ca href=\"https://feed43.com/\"\u003eFeed43\u003c/a\u003e というサービスで作りました。\u003c/p\u003e\n\n\u003cp\u003e\u003ciframe src=\"https://hatenablog-parts.com/embed?url=https%3A%2F%2Fmasutaka.net%2Fchalow%2F2021-03-14-1.html\" title=\"フィード（RSS/Atom）を配信していないサイトのフィードを Feed43 で作成する\" class=\"embed-card embed-webcard\" scrolling=\"no\" frameborder=\"0\" style=\"display: block; width: 100%; height: 155px; max-width: 500px; margin: 10px 0px;\"\u003e\u003c/iframe\u003e\u003c/p\u003e\n\n\u003cp\u003e出来たのが \u003ca href=\"https://feed43.com/developersio-looker.xml\"\u003ehttps://feed43.com/developersio-looker.xml\u003c/a\u003e です。どなたでも購読可能です。よろしければどうぞ。\u003c/p\u003e\n\n\u003cp\u003eHTML をパースしているだけなので、HTML 構造が変わったら壊れることはあると思います。気づけたら直します。\u003c/p\u003e\n\n\u003cp\u003e本当は \u003ca href=\"https://dev.classmethod.jp/tags/looker/\"\u003ehttps://dev.classmethod.jp/tags/looker/\u003c/a\u003e のフィードがあれば良いのですけどね。今後に期待です。\u003c/p\u003e\n\n\u003cp\u003e[Update] そのものズバリ \u003ca href=\"https://dev.classmethod.jp/feed/?tag=looker\"\u003ehttps://dev.classmethod.jp/feed/?tag=looker\u003c/a\u003e を \u003ca href=\"https://twitter.com/sh19910711/status/1427429573117964306\"\u003eTwitterで教えて\u003c/a\u003e頂きました。ありがとうございます！\u003c/p\u003e\n\n\u003ch2 id=\"まとめ\"\u003eまとめ\u003c/h2\u003e\n\n\u003cp\u003e私が１年かけて辿り着いた、Looker の情報取得方法をご紹介しました。\u003c/p\u003e\n\n\u003cp\u003eこれで Looker の情報は大量にインプット出来たので、今後はコミュニティにアウトプットしていきます。🔥\n※ ネタは少しあるけど、時間がない。(^^;\u003c/p\u003e\n\n\u003cp\u003e皆さんにも参考になれば幸いです。他にもあれば \u003ca href=\"https://twitter.com/masutaka\"\u003e@masutaka\u003c/a\u003e に教えて下さい！\u003c/p\u003e\n\n\u003ch2 id=\"追記\"\u003e追記\u003c/h2\u003e\n\n\u003cblockquote\u003e\u003cp\u003e他にもあれば \u003ca href=\"https://twitter.com/masutaka\"\u003e@masutaka\u003c/a\u003e に教えて下さい！\u003c/p\u003e\u003c/blockquote\u003e\n\n\u003cp\u003e記事にも登場して頂いた Looker の水野さん \u003ca href=\"https://twitter.com/tomoya_cs\"\u003e@tomoya_cs\u003c/a\u003e をフォローするとさらに捗ると思います。\u003c/p\u003e\n\n\u003cp\u003e\u003cblockquote data-conversation=\"none\" class=\"twitter-tweet\" data-lang=\"ja\"\u003e\u003cp lang=\"ja\" dir=\"ltr\"\u003eLookerの情報収集本当に至難と思いますが、まとめていただきありがとうございます😭\u003cbr\u003eあとは私をフォローいただけると最新情報が入手しやすくなるかと（アウトプットがんばります🙇‍♂️） \u003ca href=\"https://t.co/eDQz8A5VCC\"\u003ehttps://t.co/eDQz8A5VCC\u003c/a\u003e\u003c/p\u003e\u0026mdash; tomoya | Looker CS (@tomoya_cs) \u003ca href=\"https://twitter.com/tomoya_cs/status/1428194155943972872?ref_src=twsrc%5Etfw\"\u003e2021年8月19日\u003c/a\u003e\u003c/blockquote\u003e \u003cscript async src=\"https://platform.twitter.com/widgets.js\" charset=\"utf-8\"\u003e\u003c/script\u003e \u003c/p\u003e\n\u003cdiv class=\"footnote\"\u003e\n\u003cp class=\"footnote\"\u003e\u003ca href=\"#fn-25b67c2a\" name=\"f-25b67c2a\" class=\"footnote-number\"\u003e*1\u003c/a\u003e\u003cspan class=\"footnote-delimiter\"\u003e:\u003c/span\u003e\u003cspan class=\"footnote-text\"\u003e\u003ca href=\"https://ja.wikipedia.org/wiki/%E3%83%93%E3%82%B8%E3%83%8D%E3%82%B9%E3%82%A4%E3%83%B3%E3%83%86%E3%83%AA%E3%82%B8%E3%82%A7%E3%83%B3%E3%82%B9\"\u003eBusiness Intelligence\u003c/a\u003e\u003c/span\u003e\u003c/p\u003e\n\u003cp class=\"footnote\"\u003e\u003ca href=\"#fn-e46aea89\" name=\"f-e46aea89\" class=\"footnote-number\"\u003e*2\u003c/a\u003e\u003cspan class=\"footnote-delimiter\"\u003e:\u003c/span\u003e\u003cspan class=\"footnote-text\"\u003e\u003ca href=\"https://slack.com/intl/ja-jp/help/articles/218688467-Slack-%E3%81%AB-RSS-%E3%83%95%E3%82%A3%E3%83%BC%E3%83%89%E3%82%92%E8%BF%BD%E5%8A%A0%E3%81%99%E3%82%8B\"\u003eSlack に RSS フィードを追加する | Slack\u003c/a\u003e\u003c/span\u003e\u003c/p\u003e\n\u003cp class=\"footnote\"\u003e\u003ca href=\"#fn-c898f381\" name=\"f-c898f381\" class=\"footnote-number\"\u003e*3\u003c/a\u003e\u003cspan class=\"footnote-delimiter\"\u003e:\u003c/span\u003e\u003cspan class=\"footnote-text\"\u003e例: \u003ca href=\"https://community.looker.com/%E3%83%8B%E3%83%A5%E3%83%BC%E3%82%B9%E3%81%A8%E5%91%8A%E7%9F%A5-100/looker-21-12-%E3%83%AA%E3%83%AA%E3%83%BC%E3%82%B9%E3%83%8E%E3%83%BC%E3%83%88-27799\"\u003eLooker 21.12 リリースノート | Looker Community\u003c/a\u003e\u003c/span\u003e\u003c/p\u003e\n\u003c/div\u003e","contentSnippet":"こんばんは、徳川家ｙ id:masutaka26 です。以前紹介したように、去年から Looker を使ったウェブ広告数値の可視化や BI *1 に取り組んでいます。LookML 開発者として LookML を書き始めて困ったのが、Looker の情報が少ないように見えたことです。LookML を含む Looker のドキュメントは充実しているのですが、それらを組み合わせた応用的なフロー情報が少なく感じました。ビジネスユーザー向けの情報も同様です。現在は網羅的、かつ集約した情報を取得できているので、その方法をご紹介します。「情報源」をリストアップする少し脱線...「情報源」の取得方法への課題今はどうなったか？「Looker Community」のフィードが存在した件「Looker の記事一覧 | DevelopersIO」のフィードを作った件まとめ追記「情報源」をリストアップする初めはこれらをたまに見に行ったり、Slack の /feed subscribe *2 で購読したりしてました。Looker Community公式フォーラム。英語で Question や Conversation が出来るLooker 日本語コミュニティフォーラム「Looker Community」の日本語版。Release Notes の日本語訳には本当に感謝 🙏「ニュースと告知」「ヘルプとサポート」「コラム」はそれぞれ Subscribe 出来る。メールで通知される  Looker 日本語コミュニティフォーラムLooker APAC Forum | Facebookリリース案内や事例紹介などLooker の記事一覧 | DevelopersIOご存知クラスメソッドさんのブログ。国内最多の記事量と投稿頻度Lookerの記事一覧 | ZennZenn にもそれなりの頻度で投稿されるLooker - QiitaQiita はもう少し頻度は落ちるかな#looker lang:ja - Twitter 検索以上の情報をふわっと取得できる。looker lang:ja や #looker だとノイズが多いのでこれに落ち着いた少し脱線...Looker Community には過去一度だけ質問しました。How do I dynamically switch view name in sql parameter of dimension? | Looker Community私は日本語サポートに頼ることが多い傾向です。最近はだいぶ減らせています。扱う情報を外に出せないので、外に出せるところまで昇華するのは難しいですね。🌀Looker の水野さんが日本語訳して下さっている、Looker のリリースノート *3 は、去年の 12 月から社内向けにこんな記事を書いて、Looker に徹底的に向き合うようにしています。Looker 21.12 のリリースノートを眺めてみた今まで書いた記事です。Looker のリリースノートを眺めてみたシリーズ「情報源」の取得方法への課題RSS/Atom（フィード）を配信していないサイトがほとんどで、見に行くのがかなり面倒でした。そのものズバリなフィードは Zenn と Qiita だけです。クラスメソッドさんは Looker タグのフィードが存在せず、当時は Twitter で捕捉してました。今はどうなったか？ほぼすべてを社内の Slack channel #news-looker に集約させることが出来ました。以下が実際に購読しているフィードです。https://community.looker.com/feed/buzzcapture「Looker Community」のフィード。後述するhttps://feed43.com/developersio-looker.xml「Looker の記事一覧 | DevelopersIO」のフィード。後述するhttps://zenn.dev/topics/looker/feed「Lookerの記事一覧 | Zenn」のフィードhttps://qiita.com/tags/looker/feed「Looker - Qiita」のフィードTwitter は IFTTT を使って、同 channel に POST しています。If New tweet from search #looker OR LookML lang:ja -rtThen Post to channelChannel: #news-lookerMessage: @{{UserName}} : {{Text}} (via Twitter {{LinkToTweet}})「Looker APAC Forum | Facebook」は集約できませんでしたが、Twitter にも流れることがあるので、一旦考えないことにしました。「Looker Community」のフィードが存在した件Looker の水野さんに聞いたら、調べて教えて下さいました。🙏(1) 新しいトピックの投稿https://community.looker.com/feed/topics(2) 全ての新しい投稿（最初の投稿（タイトル＋ボディ）+ 全てのリプライ）https://community.looker.com/feed/buzzcaptureアナウンス記事です。LookerコミュニティのRSSフィード | Looker Community(1) と (2) は両方とも「Looker 日本語コミュニティフォーラム」の情報も流れてきます。今は (2) を購読しており、トラフィックはそれなりにあります。もちろんほぼ全て英語です。辛かったら (1) にすると良いと思います。https://community.looker.com/ の HTML には RSS/Atom 情報がないので、これらのフィードに気づける人は少ないと思います。Looker さんには是非お願いしたいところです。「Looker の記事一覧 | DevelopersIO」のフィードを作った件ないものは仕方がないので、Feed43 というサービスで作りました。出来たのが https://feed43.com/developersio-looker.xml です。どなたでも購読可能です。よろしければどうぞ。HTML をパースしているだけなので、HTML 構造が変わったら壊れることはあると思います。気づけたら直します。本当は https://dev.classmethod.jp/tags/looker/ のフィードがあれば良いのですけどね。今後に期待です。[Update] そのものズバリ https://dev.classmethod.jp/feed/?tag=looker を Twitterで教えて頂きました。ありがとうございます！まとめ私が１年かけて辿り着いた、Looker の情報取得方法をご紹介しました。これで Looker の情報は大量にインプット出来たので、今後はコミュニティにアウトプットしていきます。🔥※ ネタは少しあるけど、時間がない。(^^;皆さんにも参考になれば幸いです。他にもあれば @masutaka に教えて下さい！追記他にもあれば @masutaka に教えて下さい！記事にも登場して頂いた Looker の水野さん @tomoya_cs をフォローするとさらに捗ると思います。Lookerの情報収集本当に至難と思いますが、まとめていただきありがとうございます😭あとは私をフォローいただけると最新情報が入手しやすくなるかと（アウトプットがんばります🙇‍♂️） https://t.co/eDQz8A5VCC— tomoya | Looker CS (@tomoya_cs) 2021年8月19日  *1:Business Intelligence*2:Slack に RSS フィードを追加する | Slack*3:例: Looker 21.12 リリースノート | Looker Community","link":"https://developer.feedforce.jp/entry/2021/08/16/150000","isoDate":"2021-08-16T06:00:00.000Z","dateMiliSeconds":1629093600000,"imageUrl":"https://cdn-ak.f.st-hatena.com/images/fotolife/m/masutaka26/20201023/20201023184859.png","authorName":"masutaka"},{"title":"『ここがつらいよ普段使いのLinux』という発表をした","content":"\u003cp\u003eこんにちは \u003ca href=\"http://blog.hatena.ne.jp/masutaka26/\" class=\"hatena-id-icon\"\u003e\u003cimg src=\"https://cdn.profile-image.st-hatena.com/users/masutaka26/profile.png\" width=\"16\" height=\"16\" alt=\"\" class=\"hatena-id-icon\"\u003eid:masutaka26\u003c/a\u003e です。いよいよ明後日は \u003ca href=\"https://jp.rizinff.com/_ct/17440570\"\u003eRIZIN.28\u003c/a\u003e ですね！東京ドームで MMA（総合格闘技）のイベントが行われるのは、約 17 年半ぶりだそうです（Wikipedia 調べ）。ドキが胸胸します。\u003c/p\u003e\n\n\u003cp\u003e本日、週次の社内勉強会 \u003ca href=\"https://developer.feedforce.jp/archive/category/FFTT\"\u003eFFTT\u003c/a\u003e で『ここがつらいよ普段使いのLinux』という発表をしました。タイトルは違いますが、気にしないで下さい。\u003c/p\u003e\n\n\u003ciframe src=\"https://docs.google.com/presentation/d/e/2PACX-1vTBXZg9pczERJABgT3Uuu922Ktcc91HHl00QOtySt7fFtxrL4NZOcco1BtkK_pDuFkO0Uo-JuAwBkoC/embed?start=false\u0026loop=false\u0026delayms=3000\" frameborder=\"0\" width=\"960\" height=\"400\" allowfullscreen=\"true\" mozallowfullscreen=\"true\" webkitallowfullscreen=\"true\"\u003e\u003c/iframe\u003e\n\n\n\u003cp\u003eMac が重い時に IME 切り替えが一瞬遅れて、例えば「feedforce」とタイプする時に「ふぇえ...」になる現象に悩まされていました。\u003c/p\u003e\n\n\u003cp\u003eそこで約 10 年ぶりに Windows PC を購入して、同じく約 10 年ぶりに Linux を普段使いし始めました。\u003c/p\u003e\n\n\u003cp\u003e数々の諸問題が発生しましたが、無事全部解決（？）したお話です。\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eキーボードショートカットがつらい\u003c/li\u003e\n\u003cli\u003eタッチパッドがつらい\u003c/li\u003e\n\u003cli\u003e指紋認証出来なくてつらい\u003c/li\u003e\n\u003cli\u003eたまにスリープから復帰しなくてつらい（一番つらい）\u003c/li\u003e\n\u003cli\u003eちょっとした画像編集に GIMP を使うのはつらい\u003c/li\u003e\n\u003c/ul\u003e\n\n\n\u003cp\u003eみんなも Mac を捨てて Linux を使うといいと思うよ！\u003c/p\u003e\n\n\u003cp\u003eそれでは！\u003c/p\u003e\n\n\u003cp\u003e\u003cdiv class=\"hatena-asin-detail\"\u003e\u003ca href=\"https://www.amazon.co.jp/exec/obidos/ASIN/4871908240/hatena-blog-22/\" class=\"hatena-asin-detail-image-link\" target=\"_blank\" rel=\"noopener\"\u003e\u003cimg src=\"https://m.media-amazon.com/images/I/51NEN46FW9L._SL500_.jpg\" class=\"hatena-asin-detail-image\" alt=\"だれでもできるLinuxセットアップ―無料(ただ)なのに頼れるOSリヌクス\" title=\"だれでもできるLinuxセットアップ―無料(ただ)なのに頼れるOSリヌクス\"\u003e\u003c/a\u003e\u003cdiv class=\"hatena-asin-detail-info\"\u003e\u003cp class=\"hatena-asin-detail-title\"\u003e\u003ca href=\"https://www.amazon.co.jp/exec/obidos/ASIN/4871908240/hatena-blog-22/\" target=\"_blank\" rel=\"noopener\"\u003eだれでもできるLinuxセットアップ―無料(ただ)なのに頼れるOSリヌクス\u003c/a\u003e\u003c/p\u003e\u003cul class=\"hatena-asin-detail-meta\"\u003e\u003cli\u003e\u003cspan class=\"hatena-asin-detail-label\"\u003e作者:\u003c/span\u003e\u003ca href=\"http://d.hatena.ne.jp/keyword/%CE%EB%CC%DA%20%C5%AF%BA%C8\" class=\"keyword\"\u003e鈴木 哲哉\u003c/a\u003e\u003c/li\u003e\u003cli\u003eオーエス出版\u003c/li\u003e\u003c/ul\u003e\u003ca href=\"https://www.amazon.co.jp/exec/obidos/ASIN/4871908240/hatena-blog-22/\" class=\"asin-detail-buy\" target=\"_blank\" rel=\"noopener\"\u003eAmazon\u003c/a\u003e\u003c/div\u003e\u003c/div\u003e\u003c/p\u003e\n","contentSnippet":"こんにちは id:masutaka26 です。いよいよ明後日は RIZIN.28 ですね！東京ドームで MMA（総合格闘技）のイベントが行われるのは、約 17 年半ぶりだそうです（Wikipedia 調べ）。ドキが胸胸します。本日、週次の社内勉強会 FFTT で『ここがつらいよ普段使いのLinux』という発表をしました。タイトルは違いますが、気にしないで下さい。Mac が重い時に IME 切り替えが一瞬遅れて、例えば「feedforce」とタイプする時に「ふぇえ...」になる現象に悩まされていました。そこで約 10 年ぶりに Windows PC を購入して、同じく約 10 年ぶりに Linux を普段使いし始めました。数々の諸問題が発生しましたが、無事全部解決（？）したお話です。キーボードショートカットがつらいタッチパッドがつらい指紋認証出来なくてつらいたまにスリープから復帰しなくてつらい（一番つらい）ちょっとした画像編集に GIMP を使うのはつらいみんなも Mac を捨てて Linux を使うといいと思うよ！それでは！だれでもできるLinuxセットアップ―無料(ただ)なのに頼れるOSリヌクス作者:鈴木 哲哉オーエス出版Amazon","link":"https://developer.feedforce.jp/entry/2021/06/11/180000","isoDate":"2021-06-11T09:00:00.000Z","dateMiliSeconds":1623402000000,"imageUrl":"https://m.media-amazon.com/images/I/51NEN46FW9L._SL500_.jpg","authorName":"masutaka"},{"title":"全ての esa 新着記事を読みきれないので、最近はこの方法を使ってる","content":"\u003cp\u003eこんにちは \u003ca href=\"http://blog.hatena.ne.jp/masutaka26/\" class=\"hatena-id-icon\"\u003e\u003cimg src=\"https://cdn.profile-image.st-hatena.com/users/masutaka26/profile.png\" width=\"16\" height=\"16\" alt=\"\" class=\"hatena-id-icon\"\u003eid:masutaka26\u003c/a\u003e です。最近好きな YouTuber はシバターです。シバターかわいいよ...。シバター...\u003c/p\u003e\n\n\u003cp\u003eフィードフォースでは先日紹介したとおり、ドキュメント共有ツールに \u003ca href=\"https://esa.io/\"\u003eesa\u003c/a\u003e を使っています。\u003c/p\u003e\n\n\u003cp\u003e\u003ciframe src=\"https://hatenablog-parts.com/embed?url=https%3A%2F%2Fdeveloper.feedforce.jp%2Fentry%2F2021%2F02%2F03%2F110000\" title=\"変化に耐え得る esa のカテゴリ設計を徹底的に考えてみた - Feedforce Developer Blog\" class=\"embed-card embed-blogcard\" scrolling=\"no\" frameborder=\"0\" style=\"display: block; width: 100%; height: 190px; max-width: 500px; margin: 10px 0px;\"\u003e\u003c/iframe\u003e\u003c/p\u003e\n\n\u003cp\u003eメンバー数は 90、デイリーアクティブメンバーは 69 くらいです。2/10 の新着記事数は 106 でした。情報共有が活発な会社で、体感でもとても多いです。\u003c/p\u003e\n\n\u003cp\u003e全ての新着記事と記事へのコメントは Slack の \u003ccode\u003e#esa-notify\u003c/code\u003e に通知されます。そこを全部読めば追えはしますが、いかんせんこの数です。\u003c/p\u003e\n\n\u003cp\u003e真面目に全部読むと、私の場合はかける時間に見合わないなと感じたので、最近は esa の検索を利用した方法を使っています。\u003c/p\u003e\n\n\u003cul class=\"table-of-contents\"\u003e\n    \u003cli\u003e\u003ca href=\"#使っている方法\"\u003e使っている方法\u003c/a\u003e\u003cul\u003e\n            \u003cli\u003e\u003ca href=\"#フォローした人の新着記事を読む\"\u003eフォローした人の新着記事を読む\u003c/a\u003e\u003c/li\u003e\n            \u003cli\u003e\u003ca href=\"#エゴサーチする\"\u003eエゴサーチする\u003c/a\u003e\u003c/li\u003e\n            \u003cli\u003e\u003ca href=\"#気になるキーワードに言及した新着記事を読む\"\u003e気になるキーワードに言及した新着記事を読む\u003c/a\u003e\u003c/li\u003e\n            \u003cli\u003e\u003ca href=\"#日報以外の最近更新された記事を読む\"\u003e日報以外の最近更新された記事を読む\u003c/a\u003e\u003c/li\u003e\n            \u003cli\u003e\u003ca href=\"#直近の記事を読む\"\u003e直近の記事を読む\u003c/a\u003e\u003c/li\u003e\n        \u003c/ul\u003e\n    \u003c/li\u003e\n    \u003cli\u003e\u003ca href=\"#公式ドキュメント\"\u003e公式ドキュメント\u003c/a\u003e\u003c/li\u003e\n    \u003cli\u003e\u003ca href=\"#ちょっとした悩み\"\u003eちょっとした悩み\u003c/a\u003e\u003c/li\u003e\n    \u003cli\u003e\u003ca href=\"#所感\"\u003e所感\u003c/a\u003e\u003c/li\u003e\n    \u003cli\u003e\u003ca href=\"#おまけ-ボツにした方法\"\u003eおまけ: ボツにした方法\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch2 id=\"使っている方法\"\u003e使っている方法\u003c/h2\u003e\n\n\u003ch3 id=\"フォローした人の新着記事を読む\"\u003eフォローした人の新着記事を読む\u003c/h3\u003e\n\n\u003cp\u003e検索クエリの例:\u003c/p\u003e\n\n\u003cpre\u003e\u003ccode\u003e@alice OR @bob OR @sapp sort:created-desc\n\u003c/code\u003e\u003c/pre\u003e\n\n\u003cp\u003e🔖 ブラウザのブックマーク: \u003ca href=\"https://feedforce.esa.io/posts?q=%40alice+OR+%40bob+OR+%40sapp+sort%3Acreated-desc\"\u003eFollow\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e上の例では alice, bob, sapp をフォローしているイメージです。\u003c/p\u003e\n\n\u003cp\u003e社長やプロダクトオーナーをフォローして、最近の会社の状況を把握するようにしています。他、自分が関心がある人もフォローしています。\u003c/p\u003e\n\n\u003cp\u003eメンバーは固定ではなくたまに入れ替えます。現在 16 人をフォローしています。\u003c/p\u003e\n\n\u003ch3 id=\"エゴサーチする\"\u003eエゴサーチする\u003c/h3\u003e\n\n\u003cp\u003e検索クエリの例:\u003c/p\u003e\n\n\u003cpre\u003e\u003ccode\u003eマスタカ -@me OR ますたか -@me OR masutaka -@me OR 増田 -@me sort:created-desc\n\u003c/code\u003e\u003c/pre\u003e\n\n\u003cp\u003e🔖 ブラウザのブックマーク: \u003ca href=\"https://feedforce.esa.io/posts?q=%E3%83%9E%E3%82%B9%E3%82%BF%E3%82%AB+-%40me+OR+%E3%81%BE%E3%81%99%E3%81%9F%E3%81%8B+-%40me+OR+masutaka+-%40me+OR+%E5%A2%97%E7%94%B0+-%40me+sort%3Acreated-desc\"\u003eEgosearch\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e「マスタカ」「ますたか」「masutaka」「増田」が含まれ、且つ自分の記事を除いた新着記事を全部読んでいます。\u003c/p\u003e\n\n\u003cp\u003e空メンション \u003ccode\u003emasutaka\u003c/code\u003e やアイコン絵文字 \u003ccode\u003e:@masutaka:\u003c/code\u003e、\u003ccode\u003e\u0026lt;!-- Boku ha masutaka nari. --\u0026gt;\u003c/code\u003e のような HTML コメントも捕捉出来ます。👁\u003c/p\u003e\n\n\u003ch3 id=\"気になるキーワードに言及した新着記事を読む\"\u003e気になるキーワードに言及した新着記事を読む\u003c/h3\u003e\n\n\u003cp\u003e検索クエリの例:\u003c/p\u003e\n\n\u003cpre\u003e\u003ccode\u003elooker -@me sort:created-desc\n\u003c/code\u003e\u003c/pre\u003e\n\n\u003cp\u003e🔖 ブラウザのブックマーク: \u003ca href=\"https://feedforce.esa.io/posts?q=looker+-%40me+sort%3Acreated-desc\"\u003eSearch Looker\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e「looker」が含まれ、且つ自分の記事を除いた新着記事を全部読んでいます。\u003c/p\u003e\n\n\u003ch3 id=\"日報以外の最近更新された記事を読む\"\u003e日報以外の最近更新された記事を読む\u003c/h3\u003e\n\n\u003cp\u003e検索クエリの例:\u003c/p\u003e\n\n\u003cpre\u003e\u003ccode\u003e-category:日報 sort:updated-desc\n\u003c/code\u003e\u003c/pre\u003e\n\n\u003cp\u003e🔖 ブラウザのブックマーク: \u003ca href=\"https://feedforce.esa.io/posts?q=-category%3A%E6%97%A5%E5%A0%B1+sort%3Aupdated-desc\"\u003e日報以外\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003ccode\u003e日報/\u003c/code\u003e カテゴリ以外で、最近更新された記事をたまに読んでいます。新着記事でないことがポイントです。良さそうな WIP 記事を先取りできることがあります。🤗\u003c/p\u003e\n\n\u003ch3 id=\"直近の記事を読む\"\u003e直近の記事を読む\u003c/h3\u003e\n\n\u003cp\u003e退勤後とかは、新着記事一覧 \u003ccode\u003e/posts\u003c/code\u003e も見ます。\u003c/p\u003e\n\n\u003ch2 id=\"公式ドキュメント\"\u003e公式ドキュメント\u003c/h2\u003e\n\n\u003cp\u003eここまで使った検索クエリは、公式ドキュメント「\u003ca href=\"https://docs.esa.io/posts/104\"\u003ehelp/記事の検索方法\u003c/a\u003e」に書かれています。\u003c/p\u003e\n\n\u003cp\u003eOR 検索よりも AND 検索のほうが優先度が高いとは書かれていないので、行間を読む必要があります。括弧は使えないので、前述の「エゴサーチする」は自分にとって難易度が高かったです。\u003c/p\u003e\n\n\u003cp\u003eesa の皆様、その節はサポートありがとうございました。🙏\u003c/p\u003e\n\n\u003ch2 id=\"ちょっとした悩み\"\u003eちょっとした悩み\u003c/h2\u003e\n\n\u003cp\u003eスマホだと「フォローした人の新着記事を読む」が検索対象のメンバーアイコンで埋まるので、結構スクロールしないと記事にたどり着けません。メンバーアイコンと記事の境界も曖昧で、スクロールしすぎることがあります。\u003c/p\u003e\n\n\u003cp\u003e\u003cfigure class=\"figure-image figure-image-fotolife\" title=\"スマホだと数スクロールがメンバーアイコンで埋まる\"\u003e\u003cspan itemscope itemtype=\"http://schema.org/Photograph\"\u003e\u003cimg src=\"https://cdn-ak.f.st-hatena.com/images/fotolife/m/masutaka26/20210211/20210211183124.png\" alt=\"f:id:masutaka26:20210211183124p:plain\" width=\"200\" height=\"400\" loading=\"lazy\" title=\"\" class=\"hatena-fotolife\" itemprop=\"image\"\u003e\u003c/span\u003e\u003cfigcaption\u003eスマホだと数スクロールがメンバーアイコンで埋まる\u003c/figcaption\u003e\u003c/figure\u003e\u003c/p\u003e\n\n\u003cp\u003eもう少しメンバーアイコンのサイズが小さいと良いと思います。ﾁﾗｯﾁﾗｯ\u003c/p\u003e\n\n\u003ch2 id=\"所感\"\u003e所感\u003c/h2\u003e\n\n\u003cp\u003e全ての新着記事を読む代わりに、テーマを決めた複数の方法で esa 記事を読み、かける時間を減らしました。２ヶ月ほど使っており、なかなか満足しています。\u003c/p\u003e\n\n\u003cp\u003eただ、関心外のことが入って来づらくなることは、特にこのフルリモートワーク下では怖さを感じます。\u003c/p\u003e\n\n\u003cp\u003eカッチリやらずに、たまに \u003ccode\u003e#esa-notify\u003c/code\u003e を覗けばよいのですけどね。記事へのコメントだけを通知する Slack チャンネルでも作れば良いのかしら？\u003c/p\u003e\n\n\u003ch2 id=\"おまけ-ボツにした方法\"\u003eおまけ: ボツにした方法\u003c/h2\u003e\n\n\u003cp\u003eコメントもエゴサーチしようとしましたが、なんか期待通りの振る舞いではなかったです。\u003c/p\u003e\n\n\u003cpre\u003e\u003ccode\u003ecomment:マスタカ OR comment:ますたか OR comment:masutaka OR comment:増田 sort:created-desc\n\u003c/code\u003e\u003c/pre\u003e\n\n\u003cp\u003eコメント本文はきちんと検索出来ているようですが、検索結果はあくまで（コメント単位ではなく）記事単位なので、すでに読んだ記事のことが多いからかな？\u003c/p\u003e\n\n\u003cp\u003e他の方法で網羅できているようなので、まあいいかあと思いました。\u003c/p\u003e\n","contentSnippet":"こんにちは id:masutaka26 です。最近好きな YouTuber はシバターです。シバターかわいいよ...。シバター...フィードフォースでは先日紹介したとおり、ドキュメント共有ツールに esa を使っています。メンバー数は 90、デイリーアクティブメンバーは 69 くらいです。2/10 の新着記事数は 106 でした。情報共有が活発な会社で、体感でもとても多いです。全ての新着記事と記事へのコメントは Slack の #esa-notify に通知されます。そこを全部読めば追えはしますが、いかんせんこの数です。真面目に全部読むと、私の場合はかける時間に見合わないなと感じたので、最近は esa の検索を利用した方法を使っています。使っている方法フォローした人の新着記事を読むエゴサーチする気になるキーワードに言及した新着記事を読む日報以外の最近更新された記事を読む直近の記事を読む公式ドキュメントちょっとした悩み所感おまけ: ボツにした方法使っている方法フォローした人の新着記事を読む検索クエリの例:@alice OR @bob OR @sapp sort:created-desc🔖 ブラウザのブックマーク: Follow上の例では alice, bob, sapp をフォローしているイメージです。社長やプロダクトオーナーをフォローして、最近の会社の状況を把握するようにしています。他、自分が関心がある人もフォローしています。メンバーは固定ではなくたまに入れ替えます。現在 16 人をフォローしています。エゴサーチする検索クエリの例:マスタカ -@me OR ますたか -@me OR masutaka -@me OR 増田 -@me sort:created-desc🔖 ブラウザのブックマーク: Egosearch「マスタカ」「ますたか」「masutaka」「増田」が含まれ、且つ自分の記事を除いた新着記事を全部読んでいます。空メンション masutaka やアイコン絵文字 :@masutaka:、\u003c!-- Boku ha masutaka nari. --\u003e のような HTML コメントも捕捉出来ます。👁気になるキーワードに言及した新着記事を読む検索クエリの例:looker -@me sort:created-desc🔖 ブラウザのブックマーク: Search Looker「looker」が含まれ、且つ自分の記事を除いた新着記事を全部読んでいます。日報以外の最近更新された記事を読む検索クエリの例:-category:日報 sort:updated-desc🔖 ブラウザのブックマーク: 日報以外日報/ カテゴリ以外で、最近更新された記事をたまに読んでいます。新着記事でないことがポイントです。良さそうな WIP 記事を先取りできることがあります。🤗直近の記事を読む退勤後とかは、新着記事一覧 /posts も見ます。公式ドキュメントここまで使った検索クエリは、公式ドキュメント「help/記事の検索方法」に書かれています。OR 検索よりも AND 検索のほうが優先度が高いとは書かれていないので、行間を読む必要があります。括弧は使えないので、前述の「エゴサーチする」は自分にとって難易度が高かったです。esa の皆様、その節はサポートありがとうございました。🙏ちょっとした悩みスマホだと「フォローした人の新着記事を読む」が検索対象のメンバーアイコンで埋まるので、結構スクロールしないと記事にたどり着けません。メンバーアイコンと記事の境界も曖昧で、スクロールしすぎることがあります。スマホだと数スクロールがメンバーアイコンで埋まるもう少しメンバーアイコンのサイズが小さいと良いと思います。ﾁﾗｯﾁﾗｯ所感全ての新着記事を読む代わりに、テーマを決めた複数の方法で esa 記事を読み、かける時間を減らしました。２ヶ月ほど使っており、なかなか満足しています。ただ、関心外のことが入って来づらくなることは、特にこのフルリモートワーク下では怖さを感じます。カッチリやらずに、たまに #esa-notify を覗けばよいのですけどね。記事へのコメントだけを通知する Slack チャンネルでも作れば良いのかしら？おまけ: ボツにした方法コメントもエゴサーチしようとしましたが、なんか期待通りの振る舞いではなかったです。comment:マスタカ OR comment:ますたか OR comment:masutaka OR comment:増田 sort:created-descコメント本文はきちんと検索出来ているようですが、検索結果はあくまで（コメント単位ではなく）記事単位なので、すでに読んだ記事のことが多いからかな？他の方法で網羅できているようなので、まあいいかあと思いました。","link":"https://developer.feedforce.jp/entry/2021/02/15/110000","isoDate":"2021-02-15T02:00:00.000Z","dateMiliSeconds":1613354400000,"imageUrl":"https://cdn-ak.f.st-hatena.com/images/fotolife/m/masutaka26/20210212/20210212181026.png","authorName":"masutaka"},{"title":"変化に耐え得る esa のカテゴリ設計を徹底的に考えてみた","content":"\u003cp\u003eこんにちは \u003ca href=\"http://blog.hatena.ne.jp/masutaka26/\" class=\"hatena-id-icon\"\u003e\u003cimg src=\"https://cdn.profile-image.st-hatena.com/users/masutaka26/profile.png\" width=\"16\" height=\"16\" alt=\"\" class=\"hatena-id-icon\"\u003eid:masutaka26\u003c/a\u003e です。夜の散歩（意味深）に勤しむ毎日です。\u003c/p\u003e\n\n\u003cp\u003eフィードフォースではドキュメント共有ツールには \u003ca href=\"https://esa.io/\"\u003eesa\u003c/a\u003e と \u003ca href=\"https://www.google.com/intl/ja/docs/about/\"\u003eGoogle ドキュメント\u003c/a\u003e\u003csup id=\"fnref:1\"\u003e\u003ca href=\"#fn:1\" rel=\"footnote\"\u003e1\u003c/a\u003e\u003c/sup\u003eを、コミュニケーションツールには \u003ca href=\"https://slack.com/\"\u003eSlack\u003c/a\u003e を採用しています。\u003c/p\u003e\n\n\u003cp\u003e情報共有はかなり活発で、2021/2/1 現在の esa 記事数は 81,324 です\u003csup id=\"fnref:2\"\u003e\u003ca href=\"#fn:2\" rel=\"footnote\"\u003e2\u003c/a\u003e\u003c/sup\u003e。\u003c/p\u003e\n\n\u003cul class=\"table-of-contents\"\u003e\n    \u003cli\u003e\u003ca href=\"#現在のカテゴリ構成と課題\"\u003e現在のカテゴリ構成と課題\u003c/a\u003e\u003c/li\u003e\n    \u003cli\u003e\u003ca href=\"#チームのスピードを上げるための大原則\"\u003eチームのスピードを上げるための大原則\u003c/a\u003e\u003c/li\u003e\n    \u003cli\u003e\u003ca href=\"#チームのスピードを上げるための情報整理\"\u003eチームのスピードを上げるための情報整理\u003c/a\u003e\u003cul\u003e\n            \u003cli\u003e\u003ca href=\"#1-Flow-型と-Stock-型の記事を理解する\"\u003e1. Flow 型と Stock 型の記事を理解する\u003c/a\u003e\u003c/li\u003e\n            \u003cli\u003e\u003ca href=\"#2-基本は-Flow-型の記事にする\"\u003e2. 基本は Flow 型の記事にする\u003c/a\u003e\u003c/li\u003e\n            \u003cli\u003e\u003ca href=\"#3-議事録カテゴリは出来るだけ作らない\"\u003e3. 議事録カテゴリは出来るだけ作らない\u003c/a\u003e\u003c/li\u003e\n            \u003cli\u003e\u003ca href=\"#4-Slack-に流れていく情報も-Flow-型の記事にする\"\u003e4. Slack に流れていく情報も Flow 型の記事にする\u003c/a\u003e\u003c/li\u003e\n            \u003cli\u003e\u003ca href=\"#5-使い続けられる情報を-Stock-記事として引き上げる\"\u003e5. 使い続けられる情報を Stock 記事として引き上げる\u003c/a\u003e\u003c/li\u003e\n            \u003cli\u003e\u003ca href=\"#6-整理を頑張らないことで整理の難易度が低くなった\"\u003e6. 整理を頑張らないことで整理の難易度が低くなった\u003c/a\u003e\u003c/li\u003e\n            \u003cli\u003e\u003ca href=\"#7-esa-を全ての情報の起点にする\"\u003e7. esa を全ての情報の起点にする\u003c/a\u003e\u003c/li\u003e\n        \u003c/ul\u003e\n    \u003c/li\u003e\n    \u003cli\u003e\u003ca href=\"#それをチームでやるのは難しすぎない\"\u003eそれをチームでやるのは難しすぎない？\u003c/a\u003e\u003c/li\u003e\n    \u003cli\u003e\u003ca href=\"#esa-は難しい\"\u003eesa は難しい\u003c/a\u003e\u003c/li\u003e\n    \u003cli\u003e\u003ca href=\"#esa-の本当の正体\"\u003eesa の本当の正体\u003c/a\u003e\u003c/li\u003e\n    \u003cli\u003e\u003ca href=\"#esa-への要望\"\u003eesa への要望\u003c/a\u003e\u003c/li\u003e\n    \u003cli\u003e\u003ca href=\"#まとめ\"\u003eまとめ\u003c/a\u003e\u003c/li\u003e\n    \u003cli\u003e\u003ca href=\"#esa-公式アカウントからのアドバイス\"\u003eesa 公式アカウントからのアドバイス\u003c/a\u003e\u003c/li\u003e\n    \u003cli\u003e\u003ca href=\"#コラム\"\u003eコラム\u003c/a\u003e\u003cul\u003e\n            \u003cli\u003e\u003ca href=\"#記事のカテゴリ整理を頑張らない理由\"\u003e記事のカテゴリ整理を頑張らない理由\u003c/a\u003e\u003c/li\u003e\n            \u003cli\u003e\u003ca href=\"#Flow-カテゴリをどこまで許容するか\"\u003eFlow カテゴリをどこまで許容するか\u003c/a\u003e\u003c/li\u003e\n        \u003c/ul\u003e\n    \u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch2 id=\"現在のカテゴリ構成と課題\"\u003e現在のカテゴリ構成と課題\u003c/h2\u003e\n\n\u003cp\u003eトップカテゴリは厳密にルール化されていて、これらの種類以外のカテゴリが増えることはありません。\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003e日報/\u003c/code\u003e\n\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003e2021/02/01 (月)/masutaka\u003c/code\u003e といった記事が置かれる\u003c/li\u003e\n\u003cli\u003e曜日がないなど、型から外れた日報は小人さんによって速やかに修正される。Bot 並に早いw\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eプロダクト1/\u003c/code\u003e\n\n\u003cul\u003e\n\u003cli\u003e実際には \u003ccode\u003eFeedmatic\u003c/code\u003e などのプロダクト名が入る\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e︙\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eプロダクトN/\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eプロジェクト/\u003c/code\u003e\n\n\u003cul\u003e\n\u003cli\u003e期間が決まっている系のプロジェクトカテゴリが並ぶ\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eチーム/\u003c/code\u003e\n\n\u003cul\u003e\n\u003cli\u003e人事や情報セキュリティなどのチーム系カテゴリが並ぶ\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eコミュニティ/\u003c/code\u003e\n\n\u003cul\u003e\n\u003cli\u003e技術系や読書会などのコミュニティ系カテゴリが並ぶ\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eノウハウ/\u003c/code\u003e\n\n\u003cul\u003e\n\u003cli\u003e各種ツールのノウハウ系カテゴリが並ぶ\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eFeedforce Inc./\u003c/code\u003e\n\n\u003cul\u003e\n\u003cli\u003e会社全体に関係する記事が置かれる\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eUsers/\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eTemplates/\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eArchived/\u003c/code\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\n\n\u003cp\u003e例えば「プロダクト1」の下は、議事録系を除き基本的に \u003ca href=\"https://docs.esa.io/posts/298\"\u003eStock 型の記事\u003c/a\u003eになっており、「マニュアル」カテゴリの下にはさらに 15 の子カテゴリが生えているとします。\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003eプロダクト1/\u003c/code\u003e\n\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003e議事録/\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e開発/\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eコンサルティング/\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eマーケティング/\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eインシデント/\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eナレッジ/\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eマニュアル/\u003c/code\u003e\n\n\u003cul\u003e\n\u003cli\u003e子カテゴリ数は 15\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e︙\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eその他/\u003c/code\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\n\n\u003cp\u003e※ 複数のプロダクトから作った架空カテゴリです。\u003c/p\u003e\n\n\u003cp\u003eここまでならよく整理されているように見えますが、実際は古くてメンテナンスされていない記事が多く、言ってしまえばノイズが多い状況です。情報共有されればされるほど、ノイズが増えてしまう悪循環です。\u003c/p\u003e\n\n\u003cp\u003eSlack に目を向けると、こちらもオープンではありますが、時にブログ記事並みのメッセージが投稿されることがあります。未読メッセージを読み進めると手が止まり、読み切るのが難しいと想像されます。\u003c/p\u003e\n\n\u003cp\u003e\u003cfigure class=\"figure-image figure-image-fotolife\" title=\"ブログ記事並みのメッセージ例。これで半分です。\"\u003e\u003cspan itemscope itemtype=\"http://schema.org/Photograph\"\u003e\u003cimg src=\"https://cdn-ak.f.st-hatena.com/images/fotolife/m/masutaka26/20210202/20210202171748.png\" alt=\"f:id:masutaka26:20210202171748p:plain\" width=\"800\" height=\"674\" loading=\"lazy\" title=\"\" class=\"hatena-fotolife\" itemprop=\"image\"\u003e\u003c/span\u003e\u003cfigcaption\u003eブログ記事並みのメッセージ例。これで半分です。\u003c/figcaption\u003e\u003c/figure\u003e\u003c/p\u003e\n\n\u003cp\u003e細切れの情報も多く川の流れのようで、断片化した情報をつなぎ合わせるのは難しいと思います。\u003c/p\u003e\n\n\u003cp\u003e世の中には情報共有が足りないことに悩む組織は多いと思いますが、活発になったとしても、適切に整理されていなければその量に溺れてしまいます。\u003c/p\u003e\n\n\u003cp\u003e一方で、最近のコロナ禍もあって 10 年前と今とでは変化のスピードは上がっています。変化に強いチーム設計、つまりは変化に強い情報整理設計が重要です。これをやらなければ、チームのスピードは徐々に下がっていくでしょう。\u003c/p\u003e\n\n\u003ch2 id=\"チームのスピードを上げるための大原則\"\u003eチームのスピードを上げるための大原則\u003c/h2\u003e\n\n\u003cp\u003e私が社内で様々なプロダクトを渡り歩いた経験上、チームのスピードを上げるためには以下の 2 点が重要だと感じています。\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eノイズを減らす\u003c/li\u003e\n\u003cli\u003e情報を一ヶ所に集める\u003c/li\u003e\n\u003c/ul\u003e\n\n\n\u003cp\u003eマネージャーはこれらの阻害要因を減らす仕掛けを作る必要があります。\u003c/p\u003e\n\n\u003cp\u003eただ、そういったことが得意な方ばかりではありません。むしろ情報量が一番多く、一番困っているのは彼らかもしれません。マネージャーに余裕がなければ、それがボトルネックとなりチームのスピードが下がります。\u003c/p\u003e\n\n\u003cp\u003eこれからその対策を考察していきます。\u003c/p\u003e\n\n\u003ch2 id=\"チームのスピードを上げるための情報整理\"\u003eチームのスピードを上げるための情報整理\u003c/h2\u003e\n\n\u003cp\u003eはじめに書いておくと、出来るだけ整理を頑張らないことが重要です。\u003c/p\u003e\n\n\u003ch3 id=\"1-Flow-型と-Stock-型の記事を理解する\"\u003e1. Flow 型と Stock 型の記事を理解する\u003c/h3\u003e\n\n\u003cp\u003eまずは公式ドキュメント「\u003ca href=\"https://docs.esa.io/posts/298\"\u003e記事のストック・フローの分類と検索\u003c/a\u003e」を読んで、Flow 型と Stock 型の記事の存在を知り、理解します。\u003c/p\u003e\n\n\u003ch3 id=\"2-基本は-Flow-型の記事にする\"\u003e2. 基本は Flow 型の記事にする\u003c/h3\u003e\n\n\u003cp\u003e全て Flow 型にするくらいの気持ちで記事を作ります。記事が多くなっても視界に入りづらいし、整理する必要もないためです。\u003c/p\u003e\n\n\u003cp\u003e\u003cfigure class=\"figure-image figure-image-fotolife\" title=\"Flow 型記事の例\"\u003e\u003cspan itemscope itemtype=\"http://schema.org/Photograph\"\u003e\u003cimg src=\"https://cdn-ak.f.st-hatena.com/images/fotolife/m/masutaka26/20210131/20210131224825.png\" alt=\"f:id:masutaka26:20210131224825p:plain\" width=\"1024\" height=\"309\" loading=\"lazy\" title=\"\" class=\"hatena-fotolife\" itemprop=\"image\"\u003e\u003c/span\u003e\u003cfigcaption\u003eFlow 型記事の例\u003c/figcaption\u003e\u003c/figure\u003e\u003c/p\u003e\n\n\u003cp\u003e書き捨ての記事であれば \u003ccode\u003eプロダクト1/2021/02/01/タイトル\u003c/code\u003e、今月中は更新する記事であれば \u003ccode\u003eプロダクト1/2021/02/タイトル\u003c/code\u003e で良いと思います。ただ、さすがに今年中更新する記事は Stock 型の記事にしたほうが良いと思います。\u003c/p\u003e\n\n\u003ch3 id=\"3-議事録カテゴリは出来るだけ作らない\"\u003e3. 議事録カテゴリは出来るだけ作らない\u003c/h3\u003e\n\n\u003cp\u003e\u003ccode\u003eプロダクト1/議事録/\u003c/code\u003e のような議事録カテゴリはできるだけ作らず、\u003ccode\u003eプロダクト1/2021/02/01/〇〇会議 議事録\u003c/code\u003e のようなカテゴリとタイトルにします。議事録のような使い続けない記事を視界に入れるのは、どちらかと言えばノイズだからです。\u003c/p\u003e\n\n\u003cp\u003e社内で以下のような階層をよく見かけますが\u003csup id=\"fnref:3\"\u003e\u003ca href=\"#fn:3\" rel=\"footnote\"\u003e3\u003c/a\u003e\u003c/sup\u003e、一回限りの会議の置き場所に悩んでしまいます。\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003eプロダクト1/議事録/\u003c/code\u003e\n\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003e〇〇会議/YYYY/MM/DD/〇〇会議\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eプランニング/YYYY/MM/DD/プランニング\u003c/code\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\n\n\u003cp\u003e\u003ccode\u003eプロダクト1/議事録/20210201 〇×会議 議事録\u003c/code\u003e のような自由なパターンも現れたりして、さらに悩ましくなります。\u003c/p\u003e\n\n\u003cp\u003e過去の議事録をたどる目的でカテゴリを分けたいのであれば、記事の最初に「議事録一覧はこちら」みたいな検索リンクがあれば十分でしょう。\u003c/p\u003e\n\n\u003cp\u003e\u003cfigure class=\"figure-image figure-image-fotolife\" title=\"「議事録一覧はこちら」の一例\"\u003e\u003cspan itemscope itemtype=\"http://schema.org/Photograph\"\u003e\u003cimg src=\"https://cdn-ak.f.st-hatena.com/images/fotolife/m/masutaka26/20210203/20210203114624.png\" alt=\"f:id:masutaka26:20210203114624p:plain\" width=\"800\" height=\"274\" loading=\"lazy\" title=\"\" class=\"hatena-fotolife\" itemprop=\"image\"\u003e\u003c/span\u003e\u003cfigcaption\u003e「議事録一覧はこちら」の一例\u003c/figcaption\u003e\u003c/figure\u003e\u003c/p\u003e\n\n\u003cp\u003eそれでも作りたい場合は \u003ccode\u003eプロダクト1/議事録/〇〇会議/2021/02/01/〇〇会議 議事録\u003c/code\u003e のような記事名にして、後から \u003ccode\u003eプロダクト1/2021/02/01/〇〇会議 議事録\u003c/code\u003e に一括変換して視界から消せるように、設計するのが良いと思います。\u003c/p\u003e\n\n\u003cp\u003e一括変換の仕方は公式ドキュメント「\u003ca href=\"https://docs.esa.io/posts/207\"\u003e記事のカテゴリを一括変更\u003c/a\u003e」が分かりやすいです。\u003c/p\u003e\n\n\u003ch3 id=\"4-Slack-に流れていく情報も-Flow-型の記事にする\"\u003e4. Slack に流れていく情報も Flow 型の記事にする\u003c/h3\u003e\n\n\u003cp\u003eSlack にはブログ記事並みのメッセージが投稿されることがあります。\u003c/p\u003e\n\n\u003cp\u003eそうなりそうになったら迷わず \u003ccode\u003eプロダクト1/2021/02/01/○○のお願い\u003c/code\u003e といった Flow 型の記事を作り、その URL を Slack で共有します。\u003c/p\u003e\n\n\u003cp\u003e他の場面で引用したい時は意外とあるものですし、内容をあとで更新したいこともあります。Slack だと特にあとからの更新には不向きです。\u003c/p\u003e\n\n\u003cp\u003e何より当該記事をブラウザで開き、残りの Slack 未読メッセージをスイスイと読むことが出来ます。Slack に投稿されてしまうと、その長いメッセージを読みながら、他の channel に移動するのは億劫です。\u003c/p\u003e\n\n\u003ch3 id=\"5-使い続けられる情報を-Stock-記事として引き上げる\"\u003e5. 使い続けられる情報を Stock 記事として引き上げる\u003c/h3\u003e\n\n\u003cp\u003e結局のところ、ほとんどの情報は使い続けることはありません。具体的すぎるからです。そのような具体的な情報は寝かすことで、抽象度の高い情報、例えばカテゴリ名を炙り出せることがあります。\u003c/p\u003e\n\n\u003cp\u003e良いカテゴリ名が思いつかない時は、まだ抽象度が高くないと思うので、引き上げないほうが良いでしょう。\u003c/p\u003e\n\n\u003cp\u003eいくつかの Flow 記事をしばらく寝かしたら、あとから汎用的な抽象度の高い Stock 記事のアイディアが湧くこともあります。\u003c/p\u003e\n\n\u003cp\u003e\u003cfigure class=\"figure-image figure-image-fotolife\" title=\"あとで Stock 記事として抽出する\"\u003e\u003cspan itemscope itemtype=\"http://schema.org/Photograph\"\u003e\u003cimg src=\"https://cdn-ak.f.st-hatena.com/images/fotolife/m/masutaka26/20210201/20210201002905.png\" alt=\"f:id:masutaka26:20210201002905p:plain\" width=\"250\" height=\"466\" loading=\"lazy\" title=\"\" class=\"hatena-fotolife\" itemprop=\"image\"\u003e\u003c/span\u003e\u003c/figure\u003e\u003c/p\u003e\n\n\u003ch3 id=\"6-整理を頑張らないことで整理の難易度が低くなった\"\u003e6. 整理を頑張らないことで整理の難易度が低くなった\u003c/h3\u003e\n\n\u003cp\u003eここまででほとんどの記事は Flow 型の記事のはずです。冒頭に述べたノイズになるような記事は少なく、情報に溺れる確率は低いと思います。\u003c/p\u003e\n\n\u003cp\u003e使い回しが効かない具体的な情報を Flow 型の記事に追いやることで、整理の難易度を低くすることが出来ました。\u003c/p\u003e\n\n\u003ch3 id=\"7-esa-を全ての情報の起点にする\"\u003e7. esa を全ての情報の起点にする\u003c/h3\u003e\n\n\u003cp\u003eでは、Google ドキュメントも同じようにしましょう！とは思っていません。esa を全ての情報の起点にする勢いで、適宜 Google ドキュメントにリンクを張ると良いでしょう。\u003c/p\u003e\n\n\u003cp\u003eGoogle ドキュメントのフォルダ整理は出来るだけやらないほうが良いです。時間がいくらあっても足りません。Google Drive はただの情報プールです。Google Drive 内検索も優秀です。\u003c/p\u003e\n\n\u003ch2 id=\"それをチームでやるのは難しすぎない\"\u003eそれをチームでやるのは難しすぎない？\u003c/h2\u003e\n\n\u003cp\u003eそう思った方、正しい感覚です。\u003c/p\u003e\n\n\u003cp\u003e「チームのスピードを上げるための情報整理」は「私が考える esa 原理主義」に振り切って書きました。情報整理のスキルに関して少数精鋭チームでないと、運用するのは難しいと思います。\u003c/p\u003e\n\n\u003cp\u003e現在私は開発者 1 人、ビジネスメンバー 2 人のチームに所属しています。私主導でカテゴリを決めているので、これまで書いた方法で整理し、うまくいっている実感があります。\u003c/p\u003e\n\n\u003cp\u003e\u003cfigure class=\"figure-image figure-image-fotolife\" title=\"Flow 型の記事に対して、Stock 型の記事を少なく保てている\"\u003e\u003cspan itemscope itemtype=\"http://schema.org/Photograph\"\u003e\u003cimg src=\"https://cdn-ak.f.st-hatena.com/images/fotolife/m/masutaka26/20210131/20210131231051.png\" alt=\"f:id:masutaka26:20210131231051p:plain\" width=\"250\" height=\"373\" loading=\"lazy\" title=\"\" class=\"hatena-fotolife\" itemprop=\"image\"\u003e\u003c/span\u003e\u003cfigcaption\u003eFlow 型の記事に対して、Stock 型の記事を少なく保てている。\u003c/figcaption\u003e\u003c/figure\u003e\u003c/p\u003e\n\n\u003cp\u003eそういえば初期は Flow 型の記事しか作りませんでした。\u003c/p\u003e\n\n\u003ch2 id=\"esa-は難しい\"\u003eesa は難しい\u003c/h2\u003e\n\n\u003cp\u003eフィードフォースでは 1 年半ほど前まで Qiita:Team を使っていました。\u003c/p\u003e\n\n\u003cp\u003e\u003ciframe src=\"https://hatenablog-parts.com/embed?url=https%3A%2F%2Fdeveloper.feedforce.jp%2Fentry%2F2019%2F08%2F22%2F141055\" title=\"社内の情報共有ツールを Qiita:Team から esa に乗り換えました - Feedforce Developer Blog\" class=\"embed-card embed-blogcard\" scrolling=\"no\" frameborder=\"0\" style=\"display: block; width: 100%; height: 190px; max-width: 500px; margin: 10px 0px;\"\u003e\u003c/iframe\u003e\u003c/p\u003e\n\n\u003cp\u003eQiita:Team はほぼ Flow 型の記事しか書けないため、これまで話した問題は出てきませんでした。いや「表面化しなかった」が正確でしょう。\u003c/p\u003e\n\n\u003cp\u003eesa は Stock 型の記事も書けます。ブログと wiki が合体したようなツールなので、難しくないわけがありません。\u003c/p\u003e\n\n\u003cp\u003ewiki を書くためには抽象的思考が必要です。私の観測範囲では、半分以上の方は具体的思考に寄り過ぎているため、得意ではないという実感です。意識したことがないかもしれません。\u003c/p\u003e\n\n\u003ch2 id=\"esa-の本当の正体\"\u003eesa の本当の正体\u003c/h2\u003e\n\n\u003cp\u003e正直言って現在の esa は「情報整理のスキルに関して少数精鋭チーム」でないと、乗りこなすのは難しいと思います。\u003c/p\u003e\n\n\u003cp\u003eこれに気づいた時、Ruby という言語に似ていると思いました。\u003c/p\u003e\n\n\u003cp\u003eRuby は esa で採用されているプログラミング言語です。初心者はにこやかに迎えてくれますが、本番環境で使い続けるためには、コードで表現されていない振る舞いを読み解く必要があるなど、実は少数精鋭チーム向けの言語です。\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://team.esa.io/\"\u003eesa LLC\u003c/a\u003e は少数精鋭チームのようなので、良くも悪くも「コンウェイの法則」が働いて、そのようなサービスになったのだと勝手に想像します。\u003c/p\u003e\n\n\u003ch2 id=\"esa-への要望\"\u003eesa への要望\u003c/h2\u003e\n\n\u003cp\u003e社員数 100 人オーバーが見えてくると、型（制約）の必要性を感じます。\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003e新規作成時にデフォルトカテゴリが Flow 型になるような、型を設定できると良い？\n\n\u003cul\u003e\n\u003cli\u003e例: \u003ccode\u003eプロダクト1/\u003c/code\u003e 以下での新規作成は、デフォルトカテゴリが \u003ccode\u003eプロダクト1/YYYY/MM/DD/\u003c/code\u003e になる\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eフレームワーク的に、何らかのパターン以外のカテゴリを作れないようにする？\u003c/li\u003e\n\u003cli\u003e第一階層カテゴリ以下で、そのようなパターンを数種類から選べるようにする？\u003c/li\u003e\n\u003c/ul\u003e\n\n\n\u003cp\u003eどれも難しい話ですかね...？\u003c/p\u003e\n\n\u003cp\u003e現在社内で抱えている課題として「記事整理にハードルがある」は間違いなくあると思います。\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eたくさんの記事を移動すると、\u003ccode\u003e/posts\u003c/code\u003e がその情報で埋まる\u003csup id=\"fnref:4\"\u003e\u003ca href=\"#fn:4\" rel=\"footnote\"\u003e4\u003c/a\u003e\u003c/sup\u003e\u003c/li\u003e\n\u003cli\u003e移動しただけなのに、記事に自分の小さなアイコンが付く\u003c/li\u003e\n\u003cli\u003eそもそも記事を 1 つ 1 つ移動するのが大変\u003c/li\u003e\n\u003cli\u003eタイトルに入れてしまった日付をカテゴリにして...とかまですると、API を使わざるを得ない\u003c/li\u003e\n\u003c/ul\u003e\n\n\n\u003cp\u003e出来れば Windows のエクスプローラのようなカジュアルさで、且つ履歴が残るとうれしいです。\u003c/p\u003e\n\n\u003cp\u003eあと、要望したことはありますが、現在の「カテゴリ以下の記事全て」に加えて、「カテゴリ直下の記事」「アーカイブした記事」を切り替えるような機能が欲しいです。\u003c/p\u003e\n\n\u003cp\u003eイメージとしては、GitHub の UI に「カテゴリ直下の記事」を加えたものです。\u003c/p\u003e\n\n\u003cp\u003e\u003cfigure class=\"figure-image figure-image-fotolife\" title=\"In, On, Archived を切り替えられるイメージ\"\u003e\u003cspan itemscope itemtype=\"http://schema.org/Photograph\"\u003e\u003cimg src=\"https://cdn-ak.f.st-hatena.com/images/fotolife/m/masutaka26/20210131/20210131231704.png\" alt=\"f:id:masutaka26:20210131231704p:plain\" width=\"400\" height=\"55\" loading=\"lazy\" title=\"\" class=\"hatena-fotolife\" itemprop=\"image\"\u003e\u003c/span\u003e\u003cfigcaption\u003eIn, On, Archived を切り替えられるイメージ\u003c/figcaption\u003e\u003c/figure\u003e\u003c/p\u003e\n\n\u003cp\u003e「カテゴリ直下の記事」は \u003ccode\u003eon:カテゴリ\u003c/code\u003e で検索できますが、知っているユーザーはごく僅かです。\u003c/p\u003e\n\n\u003cp\u003eアーカイブの認知も怪しくて、古い記事が残る要因かもしれません。一部カテゴリではこんな工夫をしています。\u003c/p\u003e\n\n\u003cp\u003e\u003cfigure class=\"figure-image figure-image-fotolife\" title=\"アーカイブという手段を認知させている例\"\u003e\u003cspan itemscope itemtype=\"http://schema.org/Photograph\"\u003e\u003cimg src=\"https://cdn-ak.f.st-hatena.com/images/fotolife/m/masutaka26/20210131/20210131232059.png\" alt=\"f:id:masutaka26:20210131232059p:plain\" width=\"800\" height=\"438\" loading=\"lazy\" title=\"\" class=\"hatena-fotolife\" itemprop=\"image\"\u003e\u003c/span\u003e\u003cfigcaption\u003eアーカイブという手段を認知させている例\u003c/figcaption\u003e\u003c/figure\u003e\u003c/p\u003e\n\n\u003cp\u003e難しいと思いますが、情報整理のスキルがそれほど高くなくても使える UI 設計をお願いしたいところです。🙏\u003c/p\u003e\n\n\u003cp\u003eもし、もっと詳しく私にヒアリングしたいなどあれば、masutaka@feedforce.jp または \u003ca href=\"https://twitter.com/masutaka\"\u003e@masutaka\u003c/a\u003e の DM までお知らせ下さい。\u003c/p\u003e\n\n\u003ch2 id=\"まとめ\"\u003eまとめ\u003c/h2\u003e\n\n\u003cp\u003e私から見える、フィードフォースで抱えている情報整理の課題をまとめ、チームのスピードを上げるための整理方法を提案しました。\u003c/p\u003e\n\n\u003cp\u003eただ、それは「私が考える esa 原理主義」に振り切っているため、チームで採用するのは難しいと思います。\u003c/p\u003e\n\n\u003cp\u003eカテゴリがデフォルト Flow 型になるなど、情報整理を頑張らず済む使い勝手になると、とてもうれしいです。\u003c/p\u003e\n\n\u003ch2 id=\"esa-公式アカウントからのアドバイス\"\u003eesa 公式アカウントからのアドバイス\u003c/h2\u003e\n\n\u003cblockquote\u003e\u003cul\u003e\n\u003cli\u003e新規作成時にデフォルトカテゴリが Flow 型になるような、型を設定できると良い？\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eこちらのアドバイスを頂いたので早速試しました。良さそうです！\u003c/p\u003e\n\n\u003cp\u003e\u003cblockquote data-conversation=\"none\" class=\"twitter-tweet\" data-lang=\"ja\"\u003e\u003cp lang=\"ja\" dir=\"ltr\"\u003eあるカテゴリ配下で \u0026quot;Create a new post\u0026quot; ボタンで記事を新規作成するときに、カテゴリが一致するFlowのテンプレートがあれば、そのテンプレートが自動的にプリセットされるという機能があります。（続く→）\u003c/p\u003e\u0026mdash; esa_io (@esa_io) \u003ca href=\"https://twitter.com/esa_io/status/1356808249601712128?ref_src=twsrc%5Etfw\"\u003e2021年2月3日\u003c/a\u003e\u003c/blockquote\u003e \u003cscript async src=\"https://platform.twitter.com/widgets.js\" charset=\"utf-8\"\u003e\u003c/script\u003e \u003c/p\u003e\n\n\u003cp\u003e\u003cblockquote data-conversation=\"none\" class=\"twitter-tweet\" data-lang=\"ja\"\u003e\u003cp lang=\"ja\" dir=\"ltr\"\u003e例えば以下のテンプレートがあったとして\u003cbr\u003e\u003cbr\u003e- Templates/カテゴリ1/YYYY/MM/DD/テンプレートA\u003cbr\u003e- Templates/カテゴリ1/サブカテゴリ1/YYYY/MM/DD/テンプレートB\u003cbr\u003e\u003cbr\u003e「カテゴリ1」配下で記事作成→ テンプレートA \u003cbr\u003e「カテゴリ1/サブカテゴリ2」配下で記事作成 →テンプレートB \u003cbr\u003e\u003cbr\u003eがそれぞれ自動適用されます\u003c/p\u003e\u0026mdash; esa_io (@esa_io) \u003ca href=\"https://twitter.com/esa_io/status/1356808846379937795?ref_src=twsrc%5Etfw\"\u003e2021年2月3日\u003c/a\u003e\u003c/blockquote\u003e \u003cscript async src=\"https://platform.twitter.com/widgets.js\" charset=\"utf-8\"\u003e\u003c/script\u003e \u003c/p\u003e\n\n\u003cp\u003e後日アンサー記事も頂きました！「所感」にこの記事の感想が書いてあります。\n\u003ca href=\"https://docs.esa.io/posts/394\"\u003eProTip/2021/02/03/特定のカテゴリ配下の記事作成時に、テンプレートを適用する - docs.esa.io\u003c/a\u003e\u003c/p\u003e\n\n\u003ch2 id=\"コラム\"\u003eコラム\u003c/h2\u003e\n\n\u003cp\u003e自分の思いを書ききれないので、コラムに逃しました。(^^;\u003c/p\u003e\n\n\u003ch3 id=\"記事のカテゴリ整理を頑張らない理由\"\u003e記事のカテゴリ整理を頑張らない理由\u003c/h3\u003e\n\n\u003cp\u003eこんな理由からです。\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003e歴史が証明している\u003c/li\u003e\n\u003cli\u003eesa の検索がそこそこ優秀\u003c/li\u003e\n\u003c/ol\u003e\n\n\n\u003cp\u003e今では信じられないかもしれませんが、1990 年代の Yahoo! JAPAN は、人間のスタッフがウェブサイトの情報を収集してカテゴリ分類して登録する、ディレクトリ型検索サービスでした\u003csup id=\"fnref:5\"\u003e\u003ca href=\"#fn:5\" rel=\"footnote\"\u003e5\u003c/a\u003e\u003c/sup\u003e。今はロボット型検索が使われているのは周知のとおりです。\u003c/p\u003e\n\n\u003cp\u003eそのため Stock 型の記事だけを作り続けるといずれ破綻することは、\u003ccode\u003e1\u003c/code\u003e 歴史が証明していると言えます（やや大げさ）。\u003c/p\u003e\n\n\u003cp\u003e\u003ccode\u003e2\u003c/code\u003e については、公式ドキュメント「\u003ca href=\"https://docs.esa.io/posts/104\"\u003e記事の検索方法\u003c/a\u003e」にある検索クエリで、それなりに検索できます（諸説あり）。「\u003ca href=\"https://docs.esa.io/posts/389\"\u003eキーワード検索しやすい記事にするコツ\u003c/a\u003e」も参考にすると良いでしょう。\u003c/p\u003e\n\n\u003ch3 id=\"Flow-カテゴリをどこまで許容するか\"\u003eFlow カテゴリをどこまで許容するか\u003c/h3\u003e\n\n\u003cp\u003eFlow カテゴリをどこまで許容するかは、悩ましいところです。\u003c/p\u003e\n\n\u003cp\u003e(a) 制約をつけずに自由に作ることを許容するか。\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eプロダクト1\n\n\u003cul\u003e\n\u003cli\u003eセールス\n\n\u003cul\u003e\n\u003cli\u003e...\u003c/li\u003e\n\u003cli\u003eYYYY\n\n\u003cul\u003e\n\u003cli\u003eMM\n\n\u003cul\u003e\n\u003cli\u003eDD\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e開発\n\n\u003cul\u003e\n\u003cli\u003e○○機能\n\n\u003cul\u003e\n\u003cli\u003eYYYY\n\n\u003cul\u003e\n\u003cli\u003eMM\n\n\u003cul\u003e\n\u003cli\u003eDD\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eYYYY\n\n\u003cul\u003e\n\u003cli\u003eMM\n\n\u003cul\u003e\n\u003cli\u003eDD\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eYYYY\n\n\u003cul\u003e\n\u003cli\u003eMM\n\n\u003cul\u003e\n\u003cli\u003eDD\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\n\n\u003cp\u003e(b) 原理主義っぽく、１つの Flow カテゴリしか許容しないか。\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eプロダクト1\n\n\u003cul\u003e\n\u003cli\u003eセールス\n\n\u003cul\u003e\n\u003cli\u003e...\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e開発\n\n\u003cul\u003e\n\u003cli\u003e...\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eYYYY\n\n\u003cul\u003e\n\u003cli\u003eMM\n\n\u003cul\u003e\n\u003cli\u003eDD\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\n\n\u003cp\u003e(a) は職種横断的な情報共有を重視しないチームに合うと思います。中規模以上のチームです。\u003c/p\u003e\n\n\u003cp\u003e(b) は職種横断的な情報共有を重視するチームに合うと思います。小さなチームです。\u003c/p\u003e\n\n\u003cp\u003eはじめは (b) で作ってみて、やりづらくなってきたら (a) にすると良いでしょう。ただし、(a) の \u003ccode\u003eプロダクト1/開発/○○機能/YYYY/MM/DD/\u003c/code\u003e まで細かく Flow カテゴリを作るのは、把握が難しくなりそうですので、オススメはしません。\u003c/p\u003e\n\u003cdiv class=\"footnotes\"\u003e\n\u003chr/\u003e\n\u003col\u003e\n\u003cli id=\"fn:1\"\u003e\n\u003cp\u003e\u003ca href=\"https://workspace.google.co.jp/intl/ja/\"\u003eGoogle Workspace\u003c/a\u003e（旧称 G Suite）を契約しています。\u003ca href=\"#fnref:1\" rev=\"footnote\"\u003e\u0026#8617;\u003c/a\u003e\u003c/p\u003e\u003c/li\u003e\n\u003cli id=\"fn:2\"\u003e\n\u003cp\u003e現在のメンバー数は 90、最古の記事は 2014/4/3 です。\u003ca href=\"#fnref:2\" rev=\"footnote\"\u003e\u0026#8617;\u003c/a\u003e\u003c/p\u003e\u003c/li\u003e\n\u003cli id=\"fn:3\"\u003e\n\u003cp\u003e過去に推奨したことあります。ｽﾏﾇｽﾏﾇ\u0026hellip;。\u003ca href=\"#fnref:3\" rev=\"footnote\"\u003e\u0026#8617;\u003c/a\u003e\u003c/p\u003e\u003c/li\u003e\n\u003cli id=\"fn:4\"\u003e\n\u003cp\u003e\u003ccode\u003eArchived/\u003c/code\u003e 以下への移動は更新日時が変わらず \u003ccode\u003e/posts\u003c/code\u003e に現れないので、\u003ca href=\"https://docs.esa.io/posts/207\"\u003eカテゴリ一括変更\u003c/a\u003eと組み合わせれば、一応回避はできます。\u003ca href=\"#fnref:4\" rev=\"footnote\"\u003e\u0026#8617;\u003c/a\u003e\u003c/p\u003e\u003c/li\u003e\n\u003cli id=\"fn:5\"\u003e\n\u003cp\u003e今回の件で調べたところ、その\u003ca href=\"https://jp.techcrunch.com/2017/06/29/yahoo-to-shut-down-directory-search/\"\u003e「Yahoo!カテゴリ」は2018年3月29日まで動いていた\u003c/a\u003eことを知りびっくりしました\u003ca href=\"#fnref:5\" rev=\"footnote\"\u003e\u0026#8617;\u003c/a\u003e\u003c/p\u003e\u003c/li\u003e\n\u003c/ol\u003e\n\u003c/div\u003e\n\n","contentSnippet":"こんにちは id:masutaka26 です。夜の散歩（意味深）に勤しむ毎日です。フィードフォースではドキュメント共有ツールには esa と Google ドキュメント1を、コミュニケーションツールには Slack を採用しています。情報共有はかなり活発で、2021/2/1 現在の esa 記事数は 81,324 です2。現在のカテゴリ構成と課題チームのスピードを上げるための大原則チームのスピードを上げるための情報整理1. Flow 型と Stock 型の記事を理解する2. 基本は Flow 型の記事にする3. 議事録カテゴリは出来るだけ作らない4. Slack に流れていく情報も Flow 型の記事にする5. 使い続けられる情報を Stock 記事として引き上げる6. 整理を頑張らないことで整理の難易度が低くなった7. esa を全ての情報の起点にするそれをチームでやるのは難しすぎない？esa は難しいesa の本当の正体esa への要望まとめesa 公式アカウントからのアドバイスコラム記事のカテゴリ整理を頑張らない理由Flow カテゴリをどこまで許容するか現在のカテゴリ構成と課題トップカテゴリは厳密にルール化されていて、これらの種類以外のカテゴリが増えることはありません。日報/2021/02/01 (月)/masutaka といった記事が置かれる曜日がないなど、型から外れた日報は小人さんによって速やかに修正される。Bot 並に早いwプロダクト1/実際には Feedmatic などのプロダクト名が入る︙プロダクトN/プロジェクト/期間が決まっている系のプロジェクトカテゴリが並ぶチーム/人事や情報セキュリティなどのチーム系カテゴリが並ぶコミュニティ/技術系や読書会などのコミュニティ系カテゴリが並ぶノウハウ/各種ツールのノウハウ系カテゴリが並ぶFeedforce Inc./会社全体に関係する記事が置かれるUsers/Templates/Archived/例えば「プロダクト1」の下は、議事録系を除き基本的に Stock 型の記事になっており、「マニュアル」カテゴリの下にはさらに 15 の子カテゴリが生えているとします。プロダクト1/議事録/開発/コンサルティング/マーケティング/インシデント/ナレッジ/マニュアル/子カテゴリ数は 15︙その他/※ 複数のプロダクトから作った架空カテゴリです。ここまでならよく整理されているように見えますが、実際は古くてメンテナンスされていない記事が多く、言ってしまえばノイズが多い状況です。情報共有されればされるほど、ノイズが増えてしまう悪循環です。Slack に目を向けると、こちらもオープンではありますが、時にブログ記事並みのメッセージが投稿されることがあります。未読メッセージを読み進めると手が止まり、読み切るのが難しいと想像されます。ブログ記事並みのメッセージ例。これで半分です。細切れの情報も多く川の流れのようで、断片化した情報をつなぎ合わせるのは難しいと思います。世の中には情報共有が足りないことに悩む組織は多いと思いますが、活発になったとしても、適切に整理されていなければその量に溺れてしまいます。一方で、最近のコロナ禍もあって 10 年前と今とでは変化のスピードは上がっています。変化に強いチーム設計、つまりは変化に強い情報整理設計が重要です。これをやらなければ、チームのスピードは徐々に下がっていくでしょう。チームのスピードを上げるための大原則私が社内で様々なプロダクトを渡り歩いた経験上、チームのスピードを上げるためには以下の 2 点が重要だと感じています。ノイズを減らす情報を一ヶ所に集めるマネージャーはこれらの阻害要因を減らす仕掛けを作る必要があります。ただ、そういったことが得意な方ばかりではありません。むしろ情報量が一番多く、一番困っているのは彼らかもしれません。マネージャーに余裕がなければ、それがボトルネックとなりチームのスピードが下がります。これからその対策を考察していきます。チームのスピードを上げるための情報整理はじめに書いておくと、出来るだけ整理を頑張らないことが重要です。1. Flow 型と Stock 型の記事を理解するまずは公式ドキュメント「記事のストック・フローの分類と検索」を読んで、Flow 型と Stock 型の記事の存在を知り、理解します。2. 基本は Flow 型の記事にする全て Flow 型にするくらいの気持ちで記事を作ります。記事が多くなっても視界に入りづらいし、整理する必要もないためです。Flow 型記事の例書き捨ての記事であれば プロダクト1/2021/02/01/タイトル、今月中は更新する記事であれば プロダクト1/2021/02/タイトル で良いと思います。ただ、さすがに今年中更新する記事は Stock 型の記事にしたほうが良いと思います。3. 議事録カテゴリは出来るだけ作らないプロダクト1/議事録/ のような議事録カテゴリはできるだけ作らず、プロダクト1/2021/02/01/〇〇会議 議事録 のようなカテゴリとタイトルにします。議事録のような使い続けない記事を視界に入れるのは、どちらかと言えばノイズだからです。社内で以下のような階層をよく見かけますが3、一回限りの会議の置き場所に悩んでしまいます。プロダクト1/議事録/〇〇会議/YYYY/MM/DD/〇〇会議プランニング/YYYY/MM/DD/プランニングプロダクト1/議事録/20210201 〇×会議 議事録 のような自由なパターンも現れたりして、さらに悩ましくなります。過去の議事録をたどる目的でカテゴリを分けたいのであれば、記事の最初に「議事録一覧はこちら」みたいな検索リンクがあれば十分でしょう。「議事録一覧はこちら」の一例それでも作りたい場合は プロダクト1/議事録/〇〇会議/2021/02/01/〇〇会議 議事録 のような記事名にして、後から プロダクト1/2021/02/01/〇〇会議 議事録 に一括変換して視界から消せるように、設計するのが良いと思います。一括変換の仕方は公式ドキュメント「記事のカテゴリを一括変更」が分かりやすいです。4. Slack に流れていく情報も Flow 型の記事にするSlack にはブログ記事並みのメッセージが投稿されることがあります。そうなりそうになったら迷わず プロダクト1/2021/02/01/○○のお願い といった Flow 型の記事を作り、その URL を Slack で共有します。他の場面で引用したい時は意外とあるものですし、内容をあとで更新したいこともあります。Slack だと特にあとからの更新には不向きです。何より当該記事をブラウザで開き、残りの Slack 未読メッセージをスイスイと読むことが出来ます。Slack に投稿されてしまうと、その長いメッセージを読みながら、他の channel に移動するのは億劫です。5. 使い続けられる情報を Stock 記事として引き上げる結局のところ、ほとんどの情報は使い続けることはありません。具体的すぎるからです。そのような具体的な情報は寝かすことで、抽象度の高い情報、例えばカテゴリ名を炙り出せることがあります。良いカテゴリ名が思いつかない時は、まだ抽象度が高くないと思うので、引き上げないほうが良いでしょう。いくつかの Flow 記事をしばらく寝かしたら、あとから汎用的な抽象度の高い Stock 記事のアイディアが湧くこともあります。6. 整理を頑張らないことで整理の難易度が低くなったここまででほとんどの記事は Flow 型の記事のはずです。冒頭に述べたノイズになるような記事は少なく、情報に溺れる確率は低いと思います。使い回しが効かない具体的な情報を Flow 型の記事に追いやることで、整理の難易度を低くすることが出来ました。7. esa を全ての情報の起点にするでは、Google ドキュメントも同じようにしましょう！とは思っていません。esa を全ての情報の起点にする勢いで、適宜 Google ドキュメントにリンクを張ると良いでしょう。Google ドキュメントのフォルダ整理は出来るだけやらないほうが良いです。時間がいくらあっても足りません。Google Drive はただの情報プールです。Google Drive 内検索も優秀です。それをチームでやるのは難しすぎない？そう思った方、正しい感覚です。「チームのスピードを上げるための情報整理」は「私が考える esa 原理主義」に振り切って書きました。情報整理のスキルに関して少数精鋭チームでないと、運用するのは難しいと思います。現在私は開発者 1 人、ビジネスメンバー 2 人のチームに所属しています。私主導でカテゴリを決めているので、これまで書いた方法で整理し、うまくいっている実感があります。Flow 型の記事に対して、Stock 型の記事を少なく保てている。そういえば初期は Flow 型の記事しか作りませんでした。esa は難しいフィードフォースでは 1 年半ほど前まで Qiita:Team を使っていました。Qiita:Team はほぼ Flow 型の記事しか書けないため、これまで話した問題は出てきませんでした。いや「表面化しなかった」が正確でしょう。esa は Stock 型の記事も書けます。ブログと wiki が合体したようなツールなので、難しくないわけがありません。wiki を書くためには抽象的思考が必要です。私の観測範囲では、半分以上の方は具体的思考に寄り過ぎているため、得意ではないという実感です。意識したことがないかもしれません。esa の本当の正体正直言って現在の esa は「情報整理のスキルに関して少数精鋭チーム」でないと、乗りこなすのは難しいと思います。これに気づいた時、Ruby という言語に似ていると思いました。Ruby は esa で採用されているプログラミング言語です。初心者はにこやかに迎えてくれますが、本番環境で使い続けるためには、コードで表現されていない振る舞いを読み解く必要があるなど、実は少数精鋭チーム向けの言語です。esa LLC は少数精鋭チームのようなので、良くも悪くも「コンウェイの法則」が働いて、そのようなサービスになったのだと勝手に想像します。esa への要望社員数 100 人オーバーが見えてくると、型（制約）の必要性を感じます。新規作成時にデフォルトカテゴリが Flow 型になるような、型を設定できると良い？例: プロダクト1/ 以下での新規作成は、デフォルトカテゴリが プロダクト1/YYYY/MM/DD/ になるフレームワーク的に、何らかのパターン以外のカテゴリを作れないようにする？第一階層カテゴリ以下で、そのようなパターンを数種類から選べるようにする？どれも難しい話ですかね...？現在社内で抱えている課題として「記事整理にハードルがある」は間違いなくあると思います。たくさんの記事を移動すると、/posts がその情報で埋まる4移動しただけなのに、記事に自分の小さなアイコンが付くそもそも記事を 1 つ 1 つ移動するのが大変タイトルに入れてしまった日付をカテゴリにして...とかまですると、API を使わざるを得ない出来れば Windows のエクスプローラのようなカジュアルさで、且つ履歴が残るとうれしいです。あと、要望したことはありますが、現在の「カテゴリ以下の記事全て」に加えて、「カテゴリ直下の記事」「アーカイブした記事」を切り替えるような機能が欲しいです。イメージとしては、GitHub の UI に「カテゴリ直下の記事」を加えたものです。In, On, Archived を切り替えられるイメージ「カテゴリ直下の記事」は on:カテゴリ で検索できますが、知っているユーザーはごく僅かです。アーカイブの認知も怪しくて、古い記事が残る要因かもしれません。一部カテゴリではこんな工夫をしています。アーカイブという手段を認知させている例難しいと思いますが、情報整理のスキルがそれほど高くなくても使える UI 設計をお願いしたいところです。🙏もし、もっと詳しく私にヒアリングしたいなどあれば、masutaka@feedforce.jp または @masutaka の DM までお知らせ下さい。まとめ私から見える、フィードフォースで抱えている情報整理の課題をまとめ、チームのスピードを上げるための整理方法を提案しました。ただ、それは「私が考える esa 原理主義」に振り切っているため、チームで採用するのは難しいと思います。カテゴリがデフォルト Flow 型になるなど、情報整理を頑張らず済む使い勝手になると、とてもうれしいです。esa 公式アカウントからのアドバイス新規作成時にデフォルトカテゴリが Flow 型になるような、型を設定できると良い？こちらのアドバイスを頂いたので早速試しました。良さそうです！あるカテゴリ配下で \"Create a new post\" ボタンで記事を新規作成するときに、カテゴリが一致するFlowのテンプレートがあれば、そのテンプレートが自動的にプリセットされるという機能があります。（続く→）— esa_io (@esa_io) 2021年2月3日  例えば以下のテンプレートがあったとして- Templates/カテゴリ1/YYYY/MM/DD/テンプレートA- Templates/カテゴリ1/サブカテゴリ1/YYYY/MM/DD/テンプレートB「カテゴリ1」配下で記事作成→ テンプレートA 「カテゴリ1/サブカテゴリ2」配下で記事作成 →テンプレートB がそれぞれ自動適用されます— esa_io (@esa_io) 2021年2月3日  後日アンサー記事も頂きました！「所感」にこの記事の感想が書いてあります。ProTip/2021/02/03/特定のカテゴリ配下の記事作成時に、テンプレートを適用する - docs.esa.ioコラム自分の思いを書ききれないので、コラムに逃しました。(^^;記事のカテゴリ整理を頑張らない理由こんな理由からです。歴史が証明しているesa の検索がそこそこ優秀今では信じられないかもしれませんが、1990 年代の Yahoo! JAPAN は、人間のスタッフがウェブサイトの情報を収集してカテゴリ分類して登録する、ディレクトリ型検索サービスでした5。今はロボット型検索が使われているのは周知のとおりです。そのため Stock 型の記事だけを作り続けるといずれ破綻することは、1 歴史が証明していると言えます（やや大げさ）。2 については、公式ドキュメント「記事の検索方法」にある検索クエリで、それなりに検索できます（諸説あり）。「キーワード検索しやすい記事にするコツ」も参考にすると良いでしょう。Flow カテゴリをどこまで許容するかFlow カテゴリをどこまで許容するかは、悩ましいところです。(a) 制約をつけずに自由に作ることを許容するか。プロダクト1セールス...YYYYMMDD開発○○機能YYYYMMDDYYYYMMDDYYYYMMDD(b) 原理主義っぽく、１つの Flow カテゴリしか許容しないか。プロダクト1セールス...開発...YYYYMMDD(a) は職種横断的な情報共有を重視しないチームに合うと思います。中規模以上のチームです。(b) は職種横断的な情報共有を重視するチームに合うと思います。小さなチームです。はじめは (b) で作ってみて、やりづらくなってきたら (a) にすると良いでしょう。ただし、(a) の プロダクト1/開発/○○機能/YYYY/MM/DD/ まで細かく Flow カテゴリを作るのは、把握が難しくなりそうですので、オススメはしません。Google Workspace（旧称 G Suite）を契約しています。↩現在のメンバー数は 90、最古の記事は 2014/4/3 です。↩過去に推奨したことあります。ｽﾏﾇｽﾏﾇ…。↩Archived/ 以下への移動は更新日時が変わらず /posts に現れないので、カテゴリ一括変更と組み合わせれば、一応回避はできます。↩今回の件で調べたところ、その「Yahoo!カテゴリ」は2018年3月29日まで動いていたことを知りびっくりしました↩","link":"https://developer.feedforce.jp/entry/2021/02/03/110000","isoDate":"2021-02-03T02:00:00.000Z","dateMiliSeconds":1612317600000,"imageUrl":"https://cdn-ak.f.st-hatena.com/images/fotolife/m/masutaka26/20210202/20210202122517.png","authorName":"masutaka"},{"title":"優先度より優先順位のほうが偉い","content":"この記事は Feedforce Advent Calendar 2020 の 3 日目の記事です。\n昨日は kysnrm の「さよなら湯島 」でした。私も今のところに住んで来年で 6 年になるので、8 回目の引っ越しを少し考えてますが、まだ状況が流動的なので悩ましい\u0026hellip;。\n（ここから歌詞）\n優先度を付けると、高高高高高高とかになることあるよね。みんな優先度が高い。\nでも人間は一度に複数のタスクを処理することは出来ないよ。\nそれに実際終わってみたら、終わった順番が付いているはずだよ。\nじゃあ 1, 2, 3\u0026hellip; とタスクに順番を付けてみようか。つまりは優先順位ね。\n優先度より優先順位のほうが偉い。ダンダン\n優先度は優先順位を決める１つの要素でしかないよ。区別しようか。\n例えば他にもこんなのを考慮する必要があるよ。\n・期日\n・かかる時間\n・かかるお金\n・サービスへのインパクト（顧客増加、顧客満足度など）\n・他のタスクがどれだけ効率化するか？\n優先度より優先順位のほうが偉い。ダンダンダン\n先の例だと、優先度はだいたい「期日」と「サービスへのインパクト」でふんわり決まっていることが多いと思うよ。\n作業者は他の要素も考慮して「優先順位」を決めると良いよ。\nとは言え、考えすぎても難しいから、最初は「優先度」「かかる時間」「期日」から「優先順位」を決めると良いよ。\nタスクAのほうが優先度が高いけど、タスクBはすぐ終わりそうだし、タスクAの期日までまだ余裕があるから、タスクBを先にやろう的な。\n優先度より優先順位のほうが偉い。ダンダンダ、ダン\nつまりは優先度よりも優先順位は上位のレイヤー、優先度より優先順位のほうが偉いということよ！\n優先度より優先順位のほうが偉い。ダンダンダ、ダダン（号泣してみんな立ち上がる）\n（歌詞終わり）\n次回（？）は、私が使っている優先順位を決めるための具体的なテクニックをご紹介します。\n明日の Feedforce Advent Calendar 2020 は、八百くんがよく日報に書いていた AI Quest の話をしてくれるみたいです。お楽しみに。","contentSnippet":"この記事は Feedforce Advent Calendar 2020 の 3 日目の記事です。昨日は kysnrm の「さよなら湯島 」でした。私も今のところに住んで来年で 6 年になるので、8 回目の引っ越しを少し考えてますが、まだ状況が流動的なので悩ましい…。（ここから歌詞）優先度を付けると、高高高高高高とかになることあるよね。みんな優先度が高い。でも人間は一度に複数のタスクを処理することは出来ないよ。それに実際終わってみたら、終わった順番が付いているはずだよ。じゃあ 1, 2, 3… とタスクに順番を付けてみようか。つまりは優先順位ね。優先度より優先順位のほうが偉い。ダンダン優先度は優先順位を決める１つの要素でしかないよ。区別しようか。例えば他にもこんなのを考慮する必要があるよ。・期日・かかる時間・かかるお金・サービスへのインパクト（顧客増加、顧客満足度など）・他のタスクがどれだけ効率化するか？優先度より優先順位のほうが偉い。ダンダンダン先の例だと、優先度はだいたい「期日」と「サービスへのインパクト」でふんわり決まっていることが多いと思うよ。作業者は他の要素も考慮して「優先順位」を決めると良いよ。とは言え、考えすぎても難しいから、最初は「優先度」「かかる時間」「期日」から「優先順位」を決めると良いよ。タスクAのほうが優先度が高いけど、タスクBはすぐ終わりそうだし、タスクAの期日までまだ余裕があるから、タスクBを先にやろう的な。優先度より優先順位のほうが偉い。ダンダンダ、ダンつまりは優先度よりも優先順位は上位のレイヤー、優先度より優先順位のほうが偉いということよ！優先度より優先順位のほうが偉い。ダンダンダ、ダダン（号泣してみんな立ち上がる）（歌詞終わり）次回（？）は、私が使っている優先順位を決めるための具体的なテクニックをご紹介します。明日の Feedforce Advent Calendar 2020 は、八百くんがよく日報に書いていた AI Quest の話をしてくれるみたいです。お楽しみに。","link":"https://masutaka.net/2020-12-03-1/","isoDate":"2020-12-03T00:00:00.000Z","dateMiliSeconds":1606953600000,"authorName":"masutaka"},{"title":"『4月から取り組んできたLookerの導入から実装までのお話（Redashとも比較）』という発表をした","content":"\u003cp\u003eこんにちは \u003ca href=\"http://blog.hatena.ne.jp/masutaka26/\" class=\"hatena-id-icon\"\u003e\u003cimg src=\"https://cdn.profile-image.st-hatena.com/users/masutaka26/profile.png\" width=\"16\" height=\"16\" alt=\"\" class=\"hatena-id-icon\"\u003eid:masutaka26\u003c/a\u003e です。最近の趣味はリハビリと YouTube 鑑賞です。\u003c/p\u003e\n\n\u003cp\u003e本日、週次の社内勉強会 \u003ca href=\"https://developer.feedforce.jp/archive/category/FFTT\"\u003eFFTT\u003c/a\u003e で『4月から取り組んできたLookerの導入から実装までのお話（Redashとも比較）』という発表をしました。\u003c/p\u003e\n\n\u003ciframe src=\"https://docs.google.com/presentation/d/e/2PACX-1vQWgD1o2eZC69Mt9F9ln3xQL6Wx82W782cHe1YJEIPHWAdqp6tLEH_I29CyrMBbA9Ag0jmkMoQZ0QQp/embed?start=false\u0026loop=false\u0026delayms=3000\" frameborder=\"0\" width=\"960\" height=\"400\" allowfullscreen=\"true\" mozallowfullscreen=\"true\" webkitallowfullscreen=\"true\"\u003e\u003c/iframe\u003e\n\n\n\u003cp\u003e4 月から \u003ca href=\"https://jp.feedmatic.net/\"\u003eFeedmatic\u003c/a\u003e という弊社フィードフォースの広告運用サービスに BI ツールである \u003ca href=\"https://ja.looker.com/\"\u003eLooker\u003c/a\u003e を導入すべく、検討と実装をしてきました。\u003c/p\u003e\n\n\u003cp\u003e関わっているエンジニアは私一人で、社内の他のエンジニアからは何やってきたか分からないと思っていたので、今までのまとめ的な発表をしました。\u003c/p\u003e\n\n\u003cp\u003eネット上を探しても導入時の具体的な話は見つけられなかったので、誰かの参考になることも期待して、外向けも意識しています。\u003c/p\u003e\n\n\u003cp\u003eLooker ユーザ向けには P30 から「Symmetric 集計」を頑張って解説しています。説明が雑なのは認めます。🙏\u003c/p\u003e\n\n\u003cp\u003eLooker は学習コストは高いですが、かなりパワフルなツールなので、個人的には非常にやる気を出して燃えています。🔥\u003c/p\u003e\n\n\u003cp\u003eそれでは！\u003c/p\u003e\n","contentSnippet":"こんにちは id:masutaka26 です。最近の趣味はリハビリと YouTube 鑑賞です。本日、週次の社内勉強会 FFTT で『4月から取り組んできたLookerの導入から実装までのお話（Redashとも比較）』という発表をしました。4 月から Feedmatic という弊社フィードフォースの広告運用サービスに BI ツールである Looker を導入すべく、検討と実装をしてきました。関わっているエンジニアは私一人で、社内の他のエンジニアからは何やってきたか分からないと思っていたので、今までのまとめ的な発表をしました。ネット上を探しても導入時の具体的な話は見つけられなかったので、誰かの参考になることも期待して、外向けも意識しています。Looker ユーザ向けには P30 から「Symmetric 集計」を頑張って解説しています。説明が雑なのは認めます。🙏Looker は学習コストは高いですが、かなりパワフルなツールなので、個人的には非常にやる気を出して燃えています。🔥それでは！","link":"https://developer.feedforce.jp/entry/2020/10/23/190000","isoDate":"2020-10-23T10:00:00.000Z","dateMiliSeconds":1603447200000,"imageUrl":"https://cdn-ak.f.st-hatena.com/images/fotolife/m/masutaka26/20201023/20201023184859.png","authorName":"masutaka"},{"title":"個人的に実践している、Slack に振り回されない方法","content":"\u003cp\u003eこんにちは \u003ca href=\"http://blog.hatena.ne.jp/masutaka26/\" class=\"hatena-id-icon\"\u003e\u003cimg src=\"https://cdn.profile-image.st-hatena.com/users/masutaka26/profile.png\" width=\"16\" height=\"16\" alt=\"\" class=\"hatena-id-icon\"\u003eid:masutaka26\u003c/a\u003e です。足底筋膜炎は誤診のようでした。リハビリに勤しむ日々です。\u003c/p\u003e\n\n\u003cp\u003e今回は社内向けに書いた esa 記事が好評でしたので、少し改変してお届けします。\u003c/p\u003e\n\n\u003cp\u003eフィードフォースでは Slack を使っており、リモートワークにおけるコミュニケーションの手段も Slack がメインです。\u003c/p\u003e\n\n\u003cp\u003eSlack はチャットツールであるため、ある程度のリアルタイム性を求められますが、ただそれに従っていると振り回されてしまいます。\u003c/p\u003e\n\n\u003cp\u003e今回は私が実践しているいくつかの工夫を紹介します。他に良い方法があれば、是非教えてください。\u003c/p\u003e\n\n\u003cul class=\"table-of-contents\"\u003e\n    \u003cli\u003e\u003ca href=\"#今すぐできないことあとでやるあとで確認するは自分にリマインドする\"\u003e今すぐできないこと（あとでやる＆あとで確認する）は自分にリマインドする\u003c/a\u003e\u003c/li\u003e\n    \u003cli\u003e\u003ca href=\"#自分が他の人に依頼した時もリマインドを設定する\"\u003e自分が他の人に依頼した時もリマインドを設定する\u003c/a\u003e\u003c/li\u003e\n    \u003cli\u003e\u003ca href=\"#チャンネルは優先度を付ける\"\u003eチャンネルは優先度を付ける\u003c/a\u003e\u003c/li\u003e\n    \u003cli\u003e\u003ca href=\"#見なくなったチャンネルからはこまめに抜ける\"\u003e見なくなったチャンネルからはこまめに抜ける\u003c/a\u003e\u003c/li\u003e\n    \u003cli\u003e\u003ca href=\"#未読チャンネルはショートカットキーで移動する\"\u003e未読チャンネルはショートカットキーで移動する\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch2 id=\"今すぐできないことあとでやるあとで確認するは自分にリマインドする\"\u003e今すぐできないこと（あとでやる＆あとで確認する）は自分にリマインドする\u003c/h2\u003e\n\n\u003cp\u003e自分にリマインドすることで忘れることが出来る。同期的コミュニケーションを非同期に逃がす感じ。\u003c/p\u003e\n\n\u003cp\u003e\u003cspan itemscope itemtype=\"http://schema.org/Photograph\"\u003e\u003cimg src=\"https://cdn-ak.f.st-hatena.com/images/fotolife/m/masutaka26/20200627/20200627014903.png\" alt=\"f:id:masutaka26:20200627014903p:plain\" title=\"f:id:masutaka26:20200627014903p:plain\" class=\"hatena-fotolife\" itemprop=\"image\"\u003e\u003c/span\u003e\u003c/p\u003e\n\n\u003cp\u003e👇 \u003ccode\u003eslackbot\u003c/code\u003e からの DM で通知される。\u003c/p\u003e\n\n\u003cp\u003e\u003cspan itemscope itemtype=\"http://schema.org/Photograph\"\u003e\u003cimg src=\"https://cdn-ak.f.st-hatena.com/images/fotolife/m/masutaka26/20200627/20200627013415.jpg\" alt=\"f:id:masutaka26:20200627013415j:plain\" title=\"f:id:masutaka26:20200627013415j:plain\" class=\"hatena-fotolife\" itemprop=\"image\"\u003e\u003c/span\u003e\u003c/p\u003e\n\n\u003cp\u003eすぐ出来なくてさらに先延ばししたければ、Snooze する。出来ない時はゆるふわで良いので Snooze することが大事。放置しないようにしている。\u003c/p\u003e\n\n\u003cp\u003e👇 たまに \u003ccode\u003eslackbot\u003c/code\u003e の DM とかで \u003ccode\u003e/remind list\u003c/code\u003e して確認している。Snooze し忘れたりして、過去のリマインドが残っているとこんな感じになる。→ \u003ccode\u003ePast and Incomplete\u003c/code\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003cspan itemscope itemtype=\"http://schema.org/Photograph\"\u003e\u003cimg src=\"https://cdn-ak.f.st-hatena.com/images/fotolife/m/masutaka26/20200627/20200627013716.png\" alt=\"f:id:masutaka26:20200627013716p:plain\" title=\"f:id:masutaka26:20200627013716p:plain\" class=\"hatena-fotolife\" itemprop=\"image\"\u003e\u003c/span\u003e\u003c/p\u003e\n\n\u003cp\u003e🌀 本当は Gmail の Inbox（受信トレイ）でリマインド管理したい。Snooze が使いやすいし。\u003c/p\u003e\n\n\u003ch2 id=\"自分が他の人に依頼した時もリマインドを設定する\"\u003e自分が他の人に依頼した時もリマインドを設定する\u003c/h2\u003e\n\n\u003cp\u003e相手が忘れても大丈夫になる。これも同期コミュニケーションから非同期への変換。\u003c/p\u003e\n\n\u003ch2 id=\"チャンネルは優先度を付ける\"\u003eチャンネルは優先度を付ける\u003c/h2\u003e\n\n\u003cp\u003e私の場合は \u003ccode\u003eStarred\u003c/code\u003e \u003e \u003ccode\u003eLow Priority\u003c/code\u003e \u003e \u003ccode\u003eChannels\u003c/code\u003e という優先度にしてます。\n（優先度が分からなくなるので、\u003ca href=\"https://slack.com/intl/ja-jp/help/articles/226410907-%E5%85%A8%E3%81%A6%E3%81%AE%E6%9C%AA%E8%AA%AD%E3%83%A1%E3%83%83%E3%82%BB%E3%83%BC%E3%82%B8%E3%82%92%E7%A2%BA%E8%AA%8D%E3%81%99%E3%82%8B\"\u003e全未読機能\u003c/a\u003eは使っていません）\u003c/p\u003e\n\n\u003cp\u003e\u003cspan itemscope itemtype=\"http://schema.org/Photograph\"\u003e\u003cimg src=\"https://cdn-ak.f.st-hatena.com/images/fotolife/m/masutaka26/20200627/20200627014706.png\" alt=\"f:id:masutaka26:20200627014706p:plain\" title=\"f:id:masutaka26:20200627014706p:plain\" class=\"hatena-fotolife\" itemprop=\"image\"\u003e\u003c/span\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003ccode\u003eStarred\u003c/code\u003e と \u003ccode\u003eChannels\u003c/code\u003e は最初からあるグルーピングです。\u003ccode\u003eLow Priority\u003c/code\u003e は自分で作りました。\u003c/p\u003e\n\n\u003cp\u003e公式ヘルプ: \u003ca href=\"https://slack.com/intl/ja-jp/help/articles/201331016-%E3%83%81%E3%83%A3%E3%83%B3%E3%83%8D%E3%83%AB%E3%82%84%E3%83%80%E3%82%A4%E3%83%AC%E3%82%AF%E3%83%88%E3%83%A1%E3%83%83%E3%82%BB%E3%83%BC%E3%82%B8%E3%81%AB%E3%82%B9%E3%82%BF%E3%83%BC%E3%82%92%E4%BB%98%E3%81%91%E3%82%8B\"\u003eチャンネルやダイレクトメッセージにスターを付ける | Slack\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e💡 \u003ccode\u003eChannels\u003c/code\u003e の中には mute しているチャンネルもあります。\u003c/p\u003e\n\n\u003ch2 id=\"見なくなったチャンネルからはこまめに抜ける\"\u003e見なくなったチャンネルからはこまめに抜ける\u003c/h2\u003e\n\n\u003cp\u003e抜けたいチャンネルで \u003ccode\u003e/leave\u003c/code\u003e と発言すると、一瞬で抜けられるよ。\u003c/p\u003e\n\n\u003ch2 id=\"未読チャンネルはショートカットキーで移動する\"\u003e未読チャンネルはショートカットキーで移動する\u003c/h2\u003e\n\n\u003cul\u003e\n\u003cli\u003eWindows\n\n\u003cul\u003e\n\u003cli\u003e前の未読チャンネルや DM に移動: \u003ccode\u003eAlt\u003c/code\u003e \u003ccode\u003eShift\u003c/code\u003e \u003ccode\u003e↑\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e次の未読チャンネルや DM に移動: \u003ccode\u003eAlt\u003c/code\u003e \u003ccode\u003eShift\u003c/code\u003e \u003ccode\u003e↓\u003c/code\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eMac\n\n\u003cul\u003e\n\u003cli\u003e前の未読チャンネルや DM に移動: \u003ccode\u003eOption\u003c/code\u003e \u003ccode\u003eShift\u003c/code\u003e \u003ccode\u003e↑\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e次の未読チャンネルや DM に移動: \u003ccode\u003eOption\u003c/code\u003e \u003ccode\u003eShift\u003c/code\u003e \u003ccode\u003e↓\u003c/code\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\n\n\u003cp\u003e公式ヘルプ: \u003ca href=\"https://slack.com/intl/ja-jp/help/articles/201374536-Slack-%E3%81%AE%E3%82%AD%E3%83%BC%E3%83%9C%E3%83%BC%E3%83%89%E3%82%B7%E3%83%A7%E3%83%BC%E3%83%88%E3%82%AB%E3%83%83%E3%83%88\"\u003eSlack のキーボードショートカット | Slack\u003c/a\u003e\u003c/p\u003e\n","contentSnippet":"こんにちは id:masutaka26 です。足底筋膜炎は誤診のようでした。リハビリに勤しむ日々です。今回は社内向けに書いた esa 記事が好評でしたので、少し改変してお届けします。フィードフォースでは Slack を使っており、リモートワークにおけるコミュニケーションの手段も Slack がメインです。Slack はチャットツールであるため、ある程度のリアルタイム性を求められますが、ただそれに従っていると振り回されてしまいます。今回は私が実践しているいくつかの工夫を紹介します。他に良い方法があれば、是非教えてください。今すぐできないこと（あとでやる＆あとで確認する）は自分にリマインドする自分が他の人に依頼した時もリマインドを設定するチャンネルは優先度を付ける見なくなったチャンネルからはこまめに抜ける未読チャンネルはショートカットキーで移動する今すぐできないこと（あとでやる＆あとで確認する）は自分にリマインドする自分にリマインドすることで忘れることが出来る。同期的コミュニケーションを非同期に逃がす感じ。👇 slackbot からの DM で通知される。すぐ出来なくてさらに先延ばししたければ、Snooze する。出来ない時はゆるふわで良いので Snooze することが大事。放置しないようにしている。👇 たまに slackbot の DM とかで /remind list して確認している。Snooze し忘れたりして、過去のリマインドが残っているとこんな感じになる。→ Past and Incomplete🌀 本当は Gmail の Inbox（受信トレイ）でリマインド管理したい。Snooze が使いやすいし。自分が他の人に依頼した時もリマインドを設定する相手が忘れても大丈夫になる。これも同期コミュニケーションから非同期への変換。チャンネルは優先度を付ける私の場合は Starred \u003e Low Priority \u003e Channels という優先度にしてます。（優先度が分からなくなるので、全未読機能は使っていません）Starred と Channels は最初からあるグルーピングです。Low Priority は自分で作りました。公式ヘルプ: チャンネルやダイレクトメッセージにスターを付ける | Slack💡 Channels の中には mute しているチャンネルもあります。見なくなったチャンネルからはこまめに抜ける抜けたいチャンネルで /leave と発言すると、一瞬で抜けられるよ。未読チャンネルはショートカットキーで移動するWindows前の未読チャンネルや DM に移動: Alt Shift ↑次の未読チャンネルや DM に移動: Alt Shift ↓Mac前の未読チャンネルや DM に移動: Option Shift ↑次の未読チャンネルや DM に移動: Option Shift ↓公式ヘルプ: Slack のキーボードショートカット | Slack","link":"https://developer.feedforce.jp/entry/2020/06/29/140000","isoDate":"2020-06-29T05:00:00.000Z","dateMiliSeconds":1593406800000,"imageUrl":"https://cdn-ak.f.st-hatena.com/images/fotolife/m/masutaka26/20200627/20200627155056.png","authorName":"masutaka"},{"title":"『HerokuでSidekiqを監視する方法を確立した』という発表をした","content":"\u003cp\u003eこんにちは \u003ca href=\"http://blog.hatena.ne.jp/masutaka26/\" class=\"hatena-id-icon\"\u003e\u003cimg src=\"https://cdn.profile-image.st-hatena.com/users/masutaka26/profile.png\" width=\"16\" height=\"16\" alt=\"\" class=\"hatena-id-icon\"\u003eid:masutaka26\u003c/a\u003e です。最近はドラクエウォークと足底筋膜炎との両立に悩んでいます。\u003c/p\u003e\n\n\u003cp\u003e先週の金曜日、週次の社内勉強会 \u003ca href=\"https://developer.feedforce.jp/archive/category/FFTT\"\u003eFFTT\u003c/a\u003e で『HerokuでSidekiqを監視する方法を確立した』という発表をしました。\u003c/p\u003e\n\n\u003ciframe src=\"https://docs.google.com/presentation/d/e/2PACX-1vTZAByBIEhPjehZJ8Jb3atZBJSpu1R371Z3qQZcolE99poCpdYHWfWl5tlH2pQxwBedoCBPYK8rTwoI/embed?start=false\u0026loop=false\u0026delayms=3000\" frameborder=\"0\" width=\"960\" height=\"400\" allowfullscreen=\"true\" mozallowfullscreen=\"true\" webkitallowfullscreen=\"true\"\u003e\u003c/iframe\u003e\n\n\n\u003cp\u003eHeroku で Sidekiq を監視する知見を見つけられなかったのが、このお題を選んだ経緯です。どなたかが参考になるとうれしいです。\u003c/p\u003e\n\n\u003cp\u003e今回は自宅からのリモート発表でした。物理発表と違って、話した内容よりもリアクションの分からなさによる戸惑いが気になってしまいました。（オイ\u003c/p\u003e\n\n\u003cp\u003e※ リアクションはしてくれてたみたいです。🙏\u003c/p\u003e\n\n\u003cp\u003e複数モニター必須とか、いろいろ知見がありそうなので、今後蓄積出来ると良さそうです。\u003c/p\u003e\n","contentSnippet":"こんにちは id:masutaka26 です。最近はドラクエウォークと足底筋膜炎との両立に悩んでいます。先週の金曜日、週次の社内勉強会 FFTT で『HerokuでSidekiqを監視する方法を確立した』という発表をしました。Heroku で Sidekiq を監視する知見を見つけられなかったのが、このお題を選んだ経緯です。どなたかが参考になるとうれしいです。今回は自宅からのリモート発表でした。物理発表と違って、話した内容よりもリアクションの分からなさによる戸惑いが気になってしまいました。（オイ※ リアクションはしてくれてたみたいです。🙏複数モニター必須とか、いろいろ知見がありそうなので、今後蓄積出来ると良さそうです。","link":"https://developer.feedforce.jp/entry/2020/03/02/140000","isoDate":"2020-03-02T05:00:00.000Z","dateMiliSeconds":1583125200000,"imageUrl":"https://cdn-ak.f.st-hatena.com/images/fotolife/m/masutaka26/20200302/20200302102630.png","authorName":"masutaka"},{"title":"Heroku Ruby Language Metrics のメトリクス収集の仕組みを調べた","content":"\u003cp\u003eこんにちは。\u003ca href=\"http://blog.hatena.ne.jp/masutaka26/\" class=\"hatena-id-icon\"\u003e\u003cimg src=\"https://cdn.profile-image.st-hatena.com/users/masutaka26/profile.png\" width=\"16\" height=\"16\" alt=\"\" class=\"hatena-id-icon\"\u003eid:masutaka26\u003c/a\u003e です。\u003c/p\u003e\n\n\u003cp\u003e半年くらい前から \u003ca href=\"https://devcenter.heroku.com/articles/language-runtime-metrics-ruby\"\u003eHeroku の Ruby Language Metrics\u003c/a\u003e (Public Beta) を使い始めました。その時、どのようにメトリクスを収集しているか調べたので、この記事にまとめます。（なぜこのタイミング...）\u003c/p\u003e\n\n\u003cp\u003e有効にする方法は前述の公式ドキュメントをどうぞ。\u003ca href=\"http://blog.hatena.ne.jp/sho7650/\" class=\"hatena-id-icon\"\u003e\u003cimg src=\"https://cdn.profile-image.st-hatena.com/users/sho7650/profile.png\" width=\"16\" height=\"16\" alt=\"\" class=\"hatena-id-icon\"\u003eid:sho7650\u003c/a\u003e の記事も併せて読むと分かりやすいと思います。\u003c/p\u003e\n\n\u003cp\u003e\u003ciframe src=\"https://hatenablog-parts.com/embed?url=https%3A%2F%2Fqiita.com%2Fsho7650%2Fitems%2F7315e78fa3e6aa75b85b\" title=\"[Ruby] より細かくMetricsを取得したい [Heroku] - Qiita\" class=\"embed-card embed-webcard\" scrolling=\"no\" frameborder=\"0\" style=\"display: block; width: 100%; height: 155px; max-width: 500px; margin: 10px 0px;\"\u003e\u003c/iframe\u003e\u003ccite class=\"hatena-citation\"\u003e\u003ca href=\"https://qiita.com/sho7650/items/7315e78fa3e6aa75b85b\"\u003eqiita.com\u003c/a\u003e\u003c/cite\u003e\u003c/p\u003e\n\n\u003cp\u003eところで、いつから Public Beta だったのですかね？ GA はいつになるのかな...？\u003c/p\u003e\n\n\u003ch2\u003e概要\u003c/h2\u003e\n\n\u003cp\u003e今回は Rails 前提で説明します。このような仕組みでメトリクスの収集と送信が行われます。\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/heroku/heroku-buildpack-metrics/\"\u003eheroku/metrics buildpack\u003c/a\u003e により、Dyno 起動時に \u003ca href=\"https://github.com/heroku/agentmon\"\u003eagentmon\u003c/a\u003e がインストールされ、常駐する\u003c/li\u003e\n\u003cli\u003eRails が起動すると、\u003ca href=\"https://github.com/heroku/barnes\"\u003ebarnes\u003c/a\u003e gem がメトリクスを収集し始め、定期的に localhost の agentmon に送信する\u003c/li\u003e\n\u003cli\u003eagentmon は \u003ccode\u003ehttps://app.metrics.heroku.com/\u0026lt;dyno id\u0026gt;\u003c/code\u003e にメトリクスを送信する\u003c/li\u003e\n\u003cli\u003eエンジニアは Heroku Dashboard から Ruby のメトリクスを閲覧できる\u003c/li\u003e\n\u003c/ol\u003e\n\n\n\u003ch2\u003eagentmon のインストールと起動\u003c/h2\u003e\n\n\u003cp\u003e\u003ca href=\"https://github.com/heroku/heroku-buildpack-metrics/\"\u003eheroku/metrics buildpack\u003c/a\u003e によって、agentmon というデーモンがインストールされます。\u003c/p\u003e\n\n\u003cp\u003e\u003ca class=\"embedly-card\" href=\"https://github.com/heroku/agentmon\"\u003eheroku/agentmon\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eagentmon は後述する barnes gem から受け取ったメトリクスを \u003ccode\u003ehttps://app.metrics.heroku.com/\u0026lt;dyno id\u0026gt;\u003c/code\u003e に送信します。\u003c/p\u003e\n\n\u003cp\u003eこの URL は環境変数 \u003ccode\u003eHEROKU_METRICS_URL\u003c/code\u003e の値で、Heroku Dashboard から Enhanced Language Metrics を有効にすると、各 Dyno で定義されます。\u003c/p\u003e\n\n\u003cp\u003e面白いのは、Slug 生成時には \u003ca href=\"https://github.com/heroku/heroku-buildpack-metrics/blob/053529d2488d1108d8fd777c2ef6575d899dcf20/bin/compile#L15-L17\"\u003e/app/.profile.d/heroku-metrics-daemon.sh がインストールされる\u003c/a\u003eだけで、Dyno 起動時にこのスクリプトが実行され、\u003ca href=\"https://github.com/heroku/heroku-buildpack-metrics/blob/053529d2488d1108d8fd777c2ef6575d899dcf20/.profile.d/heroku-metrics-daemon.sh\"\u003eagentmon のインストールと起動が行われる\u003c/a\u003eことです。\u003c/p\u003e\n\n\u003cp\u003eDyno では通常 Puma などのプロセスしか起動されませんが、このような方法を使えばデーモンも起動できることを初めて知りました。\u003c/p\u003e\n\n\u003cp\u003eちなみに \u003ca href=\"https://devcenter.heroku.com/articles/buildpack-api#profile-d-scripts\"\u003eDyno が起動する時 /etc/profile によって \u003ccode\u003e/app/.profile.d/*.sh\u003c/code\u003e がすべて実行されます\u003c/a\u003e。\u003c/p\u003e\n\n\u003ch2\u003ebarnes gem によるメトリクス収集と送信\u003c/h2\u003e\n\n\u003cp\u003e\u003ca class=\"embedly-card\" href=\"https://github.com/heroku/barnes\"\u003eheroku/barnes\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eRails が起動すると、\u003ca href=\"https://github.com/heroku/barnes/blob/v0.0.8/lib/barnes.rb#L40-L64\"\u003eBarnes.start\u003c/a\u003e から呼ばれる \u003ca href=\"https://github.com/heroku/barnes/blob/v0.0.8/lib/barnes/periodic.rb#L31-L67\"\u003eBarnes::Periodic.new\u003c/a\u003e で Ruby のスレッドが作られます。\u003c/p\u003e\n\n\u003cp\u003e\u003ccode\u003eBarnes.start\u003c/code\u003e はすぐに終了しますが、作られたスレッドは非同期で実行されます。無限ループのスレッドなので、Rails が起動している間、起動し続けます。\u003c/p\u003e\n\n\u003cp\u003eこの無限ループでは 10 秒に 1 回、後述するメトリクスを収集し、localhost の agentmon に送信します。\u003c/p\u003e\n\n\u003cp\u003e送信するのはスレッド中のインスタンス変数 \u003ccode\u003e@reporter\u003c/code\u003e です。これは \u003ca href=\"https://github.com/heroku/barnes/blob/v0.0.8/lib/barnes/reporter.rb\"\u003eBarnes::Reporter\u003c/a\u003e のインスタンスで、\u003ccode\u003estatsd_client\u003c/code\u003e を介して agentmon に送信します。\u003c/p\u003e\n\n\u003cp\u003e\u003ccode\u003estatsd_client\u003c/code\u003e は \u003ccode\u003eBarnes::Reporter.new\u003c/code\u003e 時に渡されます。\n\u003ca href=\"https://github.com/heroku/barnes/blob/v0.0.8/lib/barnes.rb#L51\"\u003ehttps://github.com/heroku/barnes/blob/v0.0.8/lib/barnes.rb#L51\u003c/a\u003e\u003c/p\u003e\n\n\u003ch2\u003e収集されるメトリクス\u003c/h2\u003e\n\n\u003cp\u003e\u003ccode\u003eBarnes::ResourceUsage\u003c/code\u003e では収集されるメトリクスを一望できます。\n\u003ca href=\"https://github.com/heroku/barnes/blob/v0.0.8/lib/barnes/resource_usage.rb#L28-L63\"\u003ehttps://github.com/heroku/barnes/blob/v0.0.8/lib/barnes/resource_usage.rb#L28-L63\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e収集されるメトリクスと、収集方法です。\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003ePuma のメトリクス（ \u003ccode\u003eBarnes::Instruments::PumaInstrument\u003c/code\u003e ）\n\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/heroku/barnes/blob/v0.0.8/lib/barnes/instruments/puma_instrument.rb#L33-L48\"\u003ehttps://github.com/heroku/barnes/blob/v0.0.8/lib/barnes/instruments/puma_instrument.rb#L33-L48\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eCPU 実行時間等のメトリクス（ \u003ccode\u003eBarnes::Instruments::Stopwatch\u003c/code\u003e ）\n\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/heroku/barnes/blob/v0.0.8/lib/barnes/instruments/stopwatch.rb#L36-L58\"\u003ehttps://github.com/heroku/barnes/blob/v0.0.8/lib/barnes/instruments/stopwatch.rb#L36-L58\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://docs.ruby-lang.org/ja/2.7.0/class/ObjectSpace.html#M_COUNT_OBJECTS\"\u003eObjectSpace.count_objects\u003c/a\u003e の結果（ \u003ccode\u003eBarnes::Instruments::ObjectSpaceCounter\u003c/code\u003e ）\n\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/heroku/barnes/blob/v0.0.8/lib/barnes/instruments/object_space_counter.rb#L27-L30\"\u003ehttps://github.com/heroku/barnes/blob/v0.0.8/lib/barnes/instruments/object_space_counter.rb#L27-L30\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://docs.ruby-lang.org/ja/2.7.0/method/GC/s/stat.html\"\u003eGC.stat\u003c/a\u003e の結果（ \u003ccode\u003eBarnes::Instruments::RubyGC\u003c/code\u003e ）\n\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/heroku/barnes/blob/v0.0.8/lib/barnes/instruments/ruby_gc.rb#L62-L84\"\u003ehttps://github.com/heroku/barnes/blob/v0.0.8/lib/barnes/instruments/ruby_gc.rb#L62-L84\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\n\n\u003ch2\u003eまとめ\u003c/h2\u003e\n\n\u003cp\u003eHeroku Ruby Language Metrics のメトリクス収集の仕組みを調べました。\u003c/p\u003e\n\n\u003cp\u003eただ有効にするだけだと、他のエンジニアに説明することができなかったことが、今回調べた動機です。\u003c/p\u003e\n\n\u003cp\u003e今回に限りませんが、Heroku は完全なブラックボックスではなく、調べると実装が透けて見えるのがとても良いと思います。\u003c/p\u003e\n\n\u003cscript async src=\"//cdn.embedly.com/widgets/platform.js\" charset=\"UTF-8\"\u003e\u003c/script\u003e\n\n","contentSnippet":"こんにちは。id:masutaka26 です。半年くらい前から Heroku の Ruby Language Metrics (Public Beta) を使い始めました。その時、どのようにメトリクスを収集しているか調べたので、この記事にまとめます。（なぜこのタイミング...）有効にする方法は前述の公式ドキュメントをどうぞ。id:sho7650 の記事も併せて読むと分かりやすいと思います。qiita.comところで、いつから Public Beta だったのですかね？ GA はいつになるのかな...？概要今回は Rails 前提で説明します。このような仕組みでメトリクスの収集と送信が行われます。heroku/metrics buildpack により、Dyno 起動時に agentmon がインストールされ、常駐するRails が起動すると、barnes gem がメトリクスを収集し始め、定期的に localhost の agentmon に送信するagentmon は https://app.metrics.heroku.com/\u003cdyno id\u003e にメトリクスを送信するエンジニアは Heroku Dashboard から Ruby のメトリクスを閲覧できるagentmon のインストールと起動heroku/metrics buildpack によって、agentmon というデーモンがインストールされます。heroku/agentmonagentmon は後述する barnes gem から受け取ったメトリクスを https://app.metrics.heroku.com/\u003cdyno id\u003e に送信します。この URL は環境変数 HEROKU_METRICS_URL の値で、Heroku Dashboard から Enhanced Language Metrics を有効にすると、各 Dyno で定義されます。面白いのは、Slug 生成時には /app/.profile.d/heroku-metrics-daemon.sh がインストールされるだけで、Dyno 起動時にこのスクリプトが実行され、agentmon のインストールと起動が行われることです。Dyno では通常 Puma などのプロセスしか起動されませんが、このような方法を使えばデーモンも起動できることを初めて知りました。ちなみに Dyno が起動する時 /etc/profile によって /app/.profile.d/*.sh がすべて実行されます。barnes gem によるメトリクス収集と送信heroku/barnesRails が起動すると、Barnes.start から呼ばれる Barnes::Periodic.new で Ruby のスレッドが作られます。Barnes.start はすぐに終了しますが、作られたスレッドは非同期で実行されます。無限ループのスレッドなので、Rails が起動している間、起動し続けます。この無限ループでは 10 秒に 1 回、後述するメトリクスを収集し、localhost の agentmon に送信します。送信するのはスレッド中のインスタンス変数 @reporter です。これは Barnes::Reporter のインスタンスで、statsd_client を介して agentmon に送信します。statsd_client は Barnes::Reporter.new 時に渡されます。https://github.com/heroku/barnes/blob/v0.0.8/lib/barnes.rb#L51収集されるメトリクスBarnes::ResourceUsage では収集されるメトリクスを一望できます。https://github.com/heroku/barnes/blob/v0.0.8/lib/barnes/resource_usage.rb#L28-L63収集されるメトリクスと、収集方法です。Puma のメトリクス（ Barnes::Instruments::PumaInstrument ）https://github.com/heroku/barnes/blob/v0.0.8/lib/barnes/instruments/puma_instrument.rb#L33-L48CPU 実行時間等のメトリクス（ Barnes::Instruments::Stopwatch ）https://github.com/heroku/barnes/blob/v0.0.8/lib/barnes/instruments/stopwatch.rb#L36-L58ObjectSpace.count_objects の結果（ Barnes::Instruments::ObjectSpaceCounter ）https://github.com/heroku/barnes/blob/v0.0.8/lib/barnes/instruments/object_space_counter.rb#L27-L30GC.stat の結果（ Barnes::Instruments::RubyGC ）https://github.com/heroku/barnes/blob/v0.0.8/lib/barnes/instruments/ruby_gc.rb#L62-L84まとめHeroku Ruby Language Metrics のメトリクス収集の仕組みを調べました。ただ有効にするだけだと、他のエンジニアに説明することができなかったことが、今回調べた動機です。今回に限りませんが、Heroku は完全なブラックボックスではなく、調べると実装が透けて見えるのがとても良いと思います。","link":"https://developer.feedforce.jp/entry/2020/02/13/150000","isoDate":"2020-02-13T06:00:00.000Z","dateMiliSeconds":1581573600000,"imageUrl":"https://cdn-ak.f.st-hatena.com/images/fotolife/m/masutaka26/20181113/20181113190345.png","authorName":"masutaka"},{"title":"Heroku Meetup #27 で『デプロイで止まらないバッチ処理を求めて』という話をしてきた #herokujp","content":"\u003cp\u003e土曜日にこんにちは \u003ca href=\"http://blog.hatena.ne.jp/masutaka26/\" class=\"hatena-id-icon\"\u003e\u003cimg src=\"https://cdn.profile-image.st-hatena.com/users/masutaka26/profile.png\" width=\"16\" height=\"16\" alt=\"\" class=\"hatena-id-icon\"\u003eid:masutaka26\u003c/a\u003e です。\u003c/p\u003e\n\n\u003cp\u003eこの記事は Heroku Advent Calendar 2019 の 14 日目の記事です。\u003c/p\u003e\n\n\u003cp\u003e\u003ciframe src=\"https://hatenablog-parts.com/embed?url=https%3A%2F%2Fqiita.com%2Fadvent-calendar%2F2019%2Fheroku\" title=\"Heroku Advent Calendar 2019 - Qiita\" class=\"embed-card embed-webcard\" scrolling=\"no\" frameborder=\"0\" style=\"display: block; width: 100%; height: 155px; max-width: 500px; margin: 10px 0px;\"\u003e\u003c/iframe\u003e\u003ccite class=\"hatena-citation\"\u003e\u003ca href=\"https://qiita.com/advent-calendar/2019/heroku\"\u003eqiita.com\u003c/a\u003e\u003c/cite\u003e\u003c/p\u003e\n\n\u003cp\u003e昨日は \u003ca href=\"https://qiita.com/takahito0508\"\u003e@takahito0508\u003c/a\u003e さんの『\u003ca href=\"https://qiita.com/takahito0508/items/0f30e441dd5fba673560\"\u003eSalesforce の Org Development 用の Buildpack を作った話\u003c/a\u003e』でした。Heroku の Buildpack は割と簡単な仕組みなので、ハードルが低いですよね。\u003c/p\u003e\n\n\u003cp\u003eさて、同じ日（2019/12/13）に開催された \u003ca href=\"https://herokujp.doorkeeper.jp/events/99972\"\u003eHeroku Meetup #27 \"Heroku Vitamin!\"\u003c/a\u003e で『デプロイで止まらないバッチ処理を求めて』というお題で発表してきました。\u003c/p\u003e\n\n\u003ciframe src=\"https://docs.google.com/presentation/d/e/2PACX-1vRVD7Gx345OvUDpoGaRxv5sYQB9uCpvFORJvhgKWySCxNd3WqQQEM4Gfpx0OJYoOyf2sY8GVUKD3spA/embed?start=false\u0026loop=false\u0026delayms=3000\" frameborder=\"0\" width=\"960\" height=\"400\" allowfullscreen=\"true\" mozallowfullscreen=\"true\" webkitallowfullscreen=\"true\"\u003e\u003c/iframe\u003e\n\n\n\u003cp\u003eHeroku meetup は\u003ca href=\"https://herokujp.doorkeeper.jp/events/93092\"\u003e前々回 #25\u003c/a\u003e 以来の参加と登壇です。\u003c/p\u003e\n\n\u003cp\u003e\u003ciframe src=\"https://hatenablog-parts.com/embed?url=https%3A%2F%2Fdeveloper.feedforce.jp%2Fentry%2F2019%2F07%2F29%2F140000\" title=\"Heroku Meetup #25 \u0026quot;Heroku Ghost\u0026quot; で 2 回話してきた #herokujp - Feedforce Developer Blog\" class=\"embed-card embed-blogcard\" scrolling=\"no\" frameborder=\"0\" style=\"display: block; width: 100%; height: 190px; max-width: 500px; margin: 10px 0px;\"\u003e\u003c/iframe\u003e\u003ccite class=\"hatena-citation\"\u003e\u003ca href=\"https://developer.feedforce.jp/entry/2019/07/29/140000\"\u003edeveloper.feedforce.jp\u003c/a\u003e\u003c/cite\u003e\u003c/p\u003e\n\n\u003ch2\u003e所感\u003c/h2\u003e\n\n\u003cp\u003e世の中では割と多くのバッチ処理が動いていると思います。ですが、Heroku 上でのバッチ処理はあまり情報がないので、今回紹介させて頂きました。技術スタックとしては、Rails の Active Job と Sidekiq です。\u003c/p\u003e\n\n\u003cp\u003e今回もニッチな発表ができてとても満足しています。会場にいる一人に刺されば大成功くらいの気持ちで発表していました。\u003c/p\u003e\n\n\u003cp\u003e中の人曰く、こんな One-Off Dyno の使い方をする人は初めて見たとのこと。(^^;\u003c/p\u003e\n\n\u003cp\u003e使い方としては問題ないそうですが、\u003ca href=\"https://devcenter.heroku.com/articles/dyno-runtime#private-spaces-runtime\"\u003ePrivate Spaces\u003c/a\u003e では Dyno の起動が遅いそうなので、そこはやや注意とのこと。\u003c/p\u003e\n\n\u003cp\u003e※ \u003ca href=\"https://ecbooster.jp/\"\u003eEC Booster\u003c/a\u003e では一般向けの \u003ca href=\"https://devcenter.heroku.com/articles/dyno-runtime#common-runtime\"\u003eCommon Runtime\u003c/a\u003e を使っています。\u003c/p\u003e\n\n\u003cp\u003eとは言え、\u003ca href=\"https://devcenter.heroku.com/articles/platform-api-reference#dyno-create\"\u003eDyno Create API\u003c/a\u003e は Dyno の起動完了を待たずに即座に終了するため、Private Spaces でも大丈夫みたいです。\u003c/p\u003e\n\n\u003cp\u003e\u003cblockquote class=\"twitter-tweet\" data-lang=\"ja\"\u003e\u003cp lang=\"ja\" dir=\"ltr\"\u003e.\u003ca href=\"https://twitter.com/masutaka?ref_src=twsrc%5Etfw\"\u003e@masutaka\u003c/a\u003e さんのお話 \u003ca href=\"https://twitter.com/hashtag/herokujp?src=hash\u0026amp;ref_src=twsrc%5Etfw\"\u003e#herokujp\u003c/a\u003e \u003ca href=\"https://t.co/RZnLFWq9qn\"\u003epic.twitter.com/RZnLFWq9qn\u003c/a\u003e\u003c/p\u003e\u0026mdash; Satoshi Nagano (@thisisnagano) \u003ca href=\"https://twitter.com/thisisnagano/status/1205437869453500416?ref_src=twsrc%5Etfw\"\u003e2019年12月13日\u003c/a\u003e\u003c/blockquote\u003e\u003cscript async src=\"https://platform.twitter.com/widgets.js\" charset=\"utf-8\"\u003e\u003c/script\u003e\u003c/p\u003e\n\n\u003cp\u003e明日は \u003ca href=\"https://qiita.com/seijikohara\"\u003e@seijikohara\u003c/a\u003e さんです。お楽しみに。\u003c/p\u003e\n","contentSnippet":"土曜日にこんにちは id:masutaka26 です。この記事は Heroku Advent Calendar 2019 の 14 日目の記事です。qiita.com昨日は @takahito0508 さんの『Salesforce の Org Development 用の Buildpack を作った話』でした。Heroku の Buildpack は割と簡単な仕組みなので、ハードルが低いですよね。さて、同じ日（2019/12/13）に開催された Heroku Meetup #27 \"Heroku Vitamin!\" で『デプロイで止まらないバッチ処理を求めて』というお題で発表してきました。Heroku meetup は前々回 #25 以来の参加と登壇です。developer.feedforce.jp所感世の中では割と多くのバッチ処理が動いていると思います。ですが、Heroku 上でのバッチ処理はあまり情報がないので、今回紹介させて頂きました。技術スタックとしては、Rails の Active Job と Sidekiq です。今回もニッチな発表ができてとても満足しています。会場にいる一人に刺されば大成功くらいの気持ちで発表していました。中の人曰く、こんな One-Off Dyno の使い方をする人は初めて見たとのこと。(^^;使い方としては問題ないそうですが、Private Spaces では Dyno の起動が遅いそうなので、そこはやや注意とのこと。※ EC Booster では一般向けの Common Runtime を使っています。とは言え、Dyno Create API は Dyno の起動完了を待たずに即座に終了するため、Private Spaces でも大丈夫みたいです。.@masutaka さんのお話 #herokujp pic.twitter.com/RZnLFWq9qn— Satoshi Nagano (@thisisnagano) 2019年12月13日明日は @seijikohara さんです。お楽しみに。","link":"https://developer.feedforce.jp/entry/2019/12/14/153000","isoDate":"2019-12-14T06:30:00.000Z","dateMiliSeconds":1576305000000,"imageUrl":"https://cdn-ak.f.st-hatena.com/images/fotolife/m/masutaka26/20191214/20191214151304.jpg","authorName":"masutaka"},{"title":"月末に起動したいバッチを sidekiq-cron で指定し、healthchecks.io で監視する","content":"\u003cp\u003eこんにちは。\u003ca href=\"http://blog.hatena.ne.jp/masutaka26/\" class=\"hatena-id-icon\"\u003e\u003cimg src=\"https://cdn.profile-image.st-hatena.com/users/masutaka26/profile.png\" width=\"16\" height=\"16\" alt=\"\" class=\"hatena-id-icon\"\u003eid:masutaka26\u003c/a\u003e です。\u003c/p\u003e\n\n\u003cp\u003e去年の 6/30 からジムに通い始めて、なんとか週に 2~3 のペースで続いています。サプリメントも半信半疑ながら毎日飲んでいますが、ドラッグストアや Amazon で買うと割と高いと思います。\u003c/p\u003e\n\n\u003cp\u003e個人的には \u003ca href=\"https://jp.iherb.com/\"\u003eiHerb\u003c/a\u003e がだいぶオススメです。以前 3.6kg のプロテインを買ったらなぜかキャンペーンが適用されて、30% オフの 6,517 円になりました。\u003c/p\u003e\n\n\u003cp\u003eさらにこの\u003ca href=\"https://www.youtube.com/watch?v=ue0EFA_SxZc\"\u003e案件動画\u003c/a\u003eを見て、プレワークアウトサプリ（C4 SPORT）にも手を出してしまいました。BCAA も飲んでいます。\u003c/p\u003e\n\n\u003cp\u003eTwitter とかで検索すると、初回 10% OFF の紹介コードが見つかると思います。さらにお得です。\u003c/p\u003e\n\n\u003cp\u003e何の記事でしたっけ...？そうだ、この記事は \u003ca href=\"https://adventar.org/calendars/4169\"\u003eFeedforce Advent Calendar 2019\u003c/a\u003e の 5 日目の記事です！\u003c/p\u003e\n\n\u003cp\u003e昨日は \u003ca href=\"http://blog.hatena.ne.jp/kano-e/\" class=\"hatena-id-icon\"\u003e\u003cimg src=\"https://cdn.profile-image.st-hatena.com/users/kano-e/profile.png\" width=\"16\" height=\"16\" alt=\"\" class=\"hatena-id-icon\"\u003eid:kano-e\u003c/a\u003e の「2019 年に会社ボドゲ棚から自宅に持ち帰ったボドゲたち」でした。変わらぬボドゲ愛・・・！\u003c/p\u003e\n\n\u003cp\u003e\u003ciframe src=\"https://hatenablog-parts.com/embed?url=http%3A%2F%2Fff-boardgame.hatenablog.com%2Fentry%2F2019%2F12%2F04%2F000000\" title=\"2019 年に会社ボドゲ棚から自宅に持ち帰ったボドゲたち - フィードフォース ボドゲ部\" class=\"embed-card embed-blogcard\" scrolling=\"no\" frameborder=\"0\" style=\"display: block; width: 100%; height: 190px; max-width: 500px; margin: 10px 0px;\"\u003e\u003c/iframe\u003e\u003ccite class=\"hatena-citation\"\u003e\u003ca href=\"http://ff-boardgame.hatenablog.com/entry/2019/12/04/000000\"\u003eff-boardgame.hatenablog.com\u003c/a\u003e\u003c/cite\u003e\u003c/p\u003e\n\n\u003ch2\u003esidekiq-cron で月末を指定する\u003c/h2\u003e\n\n\u003cp\u003e脈絡ありませんが、\u003ca href=\"https://github.com/ondrejbartas/sidekiq-cron\"\u003esidekiq-cron\u003c/a\u003e では \u003ccode\u003elast\u003c/code\u003e で月末を指定することが出来ます。\u003c/p\u003e\n\n\u003cp\u003e例えば \u003ccode\u003e0 12 last * * Asia/Tokyo\u003c/code\u003e の次回実行は \u003ccode\u003e2019/12/31 12:00 JST\u003c/code\u003e です。\u003ccode\u003e2019/11/30 12:00 JST\u003c/code\u003e は無事動きました。\u003c/p\u003e\n\n\u003cp\u003eこのような設定になります。\u003c/p\u003e\n\n\u003cpre class=\"code lang-yaml\" data-lang=\"yaml\" data-unlink\u003e\u003cspan class=\"synIdentifier\"\u003esample_job\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e:\u003c/span\u003e\n  \u003cspan class=\"synIdentifier\"\u003eactive_job\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e:\u003c/span\u003e \u003cspan class=\"synConstant\"\u003etrue\u003c/span\u003e\n  \u003cspan class=\"synIdentifier\"\u003ecron\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e:\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;0 12 last * * Asia/Tokyo\u0026quot;\u003c/span\u003e\n  \u003cspan class=\"synIdentifier\"\u003eclass\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e:\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;SampleJob\u0026quot;\u003c/span\u003e\n  \u003cspan class=\"synIdentifier\"\u003equeue\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e:\u003c/span\u003e default\n\u003c/pre\u003e\n\n\n\u003cp\u003eこの cron 書式は sidekiq-cron が依存する \u003ca href=\"https://github.com/floraison/fugit\"\u003efugit\u003c/a\u003e による実装です。\u003c/p\u003e\n\n\u003cp\u003e確認はしていませんが、\u003ccode\u003elast\u003c/code\u003e の他にも \u003ccode\u003e-1\u003c/code\u003e や \u003ccode\u003eL\u003c/code\u003e などが使えるようです。\u003c/p\u003e\n\n\u003cp\u003e🔗 \u003ca href=\"https://github.com/floraison/fugit/blob/v1.3.3/spec/cron_spec.rb#L734-L747\"\u003ehttps://github.com/floraison/fugit/blob/v1.3.3/spec/cron_spec.rb#L734-L747\u003c/a\u003e\u003c/p\u003e\n\n\u003cpre class=\"code lang-ruby\" data-lang=\"ruby\" data-unlink\u003econtext \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003e\u003cspan class=\"synConstant\"\u003enegative monthdays\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003e \u003cspan class=\"synStatement\"\u003edo\u003c/span\u003e\n\n  [\n    [ \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e* * -1 * *\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003e, \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e* * -1 * *\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003e ],\n    [ \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e* * -7--1 * *\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003e, \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e* * -7,-6,-5,-4,-3,-2,-1 * *\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003e ],\n    [ \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e* * -1--27 * *\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003e, \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e* * -31,-30,-29,-28,-27,-1 * *\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003e ],\n    [ \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e* * -7--1/2 * *\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003e, \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e* * -7,-5,-3,-1 * *\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003e ],\n    [ \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e* * L * *\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003e, \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e* * -1 * *\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003e ],\n    [ \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e* * -7-L * *\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003e, \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e* * -7,-6,-5,-4,-3,-2,-1 * *\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003e ],\n    [ \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e* * last * *\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003e, \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e* * -1 * *\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003e ],\n  ].each { |\u003cspan class=\"synIdentifier\"\u003ec\u003c/span\u003e, \u003cspan class=\"synIdentifier\"\u003ee\u003c/span\u003e|\n    it(\u003cspan class=\"synSpecial\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"synConstant\"\u003eparses \u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e#{\u003c/span\u003ec\u003cspan class=\"synSpecial\"\u003e}\u0026quot;\u003c/span\u003e) { expect(\u003cspan class=\"synType\"\u003eFugit\u003c/span\u003e::\u003cspan class=\"synType\"\u003eCron\u003c/span\u003e.parse(c).to_cron_s).to eq(e) }\n  }\n\u003cspan class=\"synStatement\"\u003eend\u003c/span\u003e\n\u003c/pre\u003e\n\n\n\u003cp\u003e\u003ccode\u003enegative monthdays\u003c/code\u003e って表現は面白い。\u003c/p\u003e\n\n\u003ch2\u003ehealthchecks.io で月末のバッチを監視する\u003c/h2\u003e\n\n\u003cp\u003eバッチが本当に起動したかを監視するのは難しいと思います。月末の監視はさらに難しいと思います。\u003c/p\u003e\n\n\u003cp\u003e過度な依存は禁物ですが、\u003ca href=\"https://healthchecks.io/\"\u003ehealthchecks.io\u003c/a\u003e は選択肢に入れても良いかもしれません。以下の記事をどうぞ。\u003c/p\u003e\n\n\u003cp\u003e\u003ciframe src=\"https://hatenablog-parts.com/embed?url=https%3A%2F%2Fdeveloper.feedforce.jp%2Fentry%2F2018%2F10%2F09%2F140000\" title=\"terraform-provider-healthchecksio に足りない機能を実装したらコラボレータになれた - Feedforce Developer Blog\" class=\"embed-card embed-blogcard\" scrolling=\"no\" frameborder=\"0\" style=\"display: block; width: 100%; height: 190px; max-width: 500px; margin: 10px 0px;\"\u003e\u003c/iframe\u003e\u003ccite class=\"hatena-citation\"\u003e\u003ca href=\"https://developer.feedforce.jp/entry/2018/10/09/140000\"\u003edeveloper.feedforce.jp\u003c/a\u003e\u003c/cite\u003e\u003c/p\u003e\n\n\u003cp\u003e前述の cron 設定だと \u003ccode\u003e0 12 l * *\u003c/code\u003e で監視することが出来ます。\u003ccode\u003el\u003c/code\u003e は小文字のエルです。\u003c/p\u003e\n\n\u003cp\u003eterraform-provider-healthchecksio の設定例です。\u003c/p\u003e\n\n\u003cpre class=\"code lang-tf\" data-lang=\"tf\" data-unlink\u003eresource \u0026quot;\u003cspan class=\"synConstant\"\u003ehealthchecksio_check\u003c/span\u003e\u0026quot; \u0026quot;\u003cspan class=\"synConstant\"\u003esample_job\u003c/span\u003e\u0026quot; \u003cspan class=\"synSpecial\"\u003e{\u003c/span\u003e\n  name     \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u0026quot;\u003cspan class=\"synConstant\"\u003eSampleJob\u003c/span\u003e\u0026quot;\n  tags     \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e[\u003c/span\u003e\u0026quot;\u003cspan class=\"synConstant\"\u003eproduction\u003c/span\u003e\u0026quot;\u003cspan class=\"synSpecial\"\u003e]\u003c/span\u003e\n  grace    \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u0026quot;\u003cspan class=\"synConstant\"\u003e60\u003c/span\u003e\u0026quot;\n  schedule \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u0026quot;\u003cspan class=\"synConstant\"\u003e0 12 l * *\u003c/span\u003e\u0026quot;\n  timezone \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u0026quot;\u003cspan class=\"synConstant\"\u003eAsia/Tokyo\u003c/span\u003e\u0026quot;\n  channels \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e[\u003c/span\u003edata.healthchecksio_channel.slack.id\u003cspan class=\"synSpecial\"\u003e]\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e}\u003c/span\u003e\n\ndata \u0026quot;\u003cspan class=\"synConstant\"\u003ehealthchecksio_channel\u003c/span\u003e\u0026quot; \u0026quot;\u003cspan class=\"synConstant\"\u003eslack\u003c/span\u003e\u0026quot; \u003cspan class=\"synSpecial\"\u003e{\u003c/span\u003e\n  kind \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u0026quot;\u003cspan class=\"synConstant\"\u003eslack\u003c/span\u003e\u0026quot;\n\u003cspan class=\"synSpecial\"\u003e}\u003c/span\u003e\n\u003c/pre\u003e\n\n\n\u003cp\u003eこちらの cron 書式は \u003ca href=\"https://github.com/healthchecks/healthchecks\"\u003ehealthchecks\u003c/a\u003e が依存する \u003ca href=\"https://github.com/taichino/croniter\"\u003ecroniter\u003c/a\u003e による実装です。\u003c/p\u003e\n\n\u003cp\u003e\u003ccode\u003el\u003c/code\u003e 以外の指定は見当たりませんでした。\u003c/p\u003e\n\n\u003cp\u003e🔗 \u003ca href=\"https://github.com/taichino/croniter/blob/0.3.29/src/croniter/tests/test_croniter.py#L209-L223\"\u003ehttps://github.com/taichino/croniter/blob/0.3.29/src/croniter/tests/test_croniter.py#L209-L223\u003c/a\u003e\u003c/p\u003e\n\n\u003cpre class=\"code lang-python\" data-lang=\"python\" data-unlink\u003e\u003cspan class=\"synStatement\"\u003edef\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003etestLastDayOfMonth\u003c/span\u003e(self):\n    base = datetime(\u003cspan class=\"synConstant\"\u003e2015\u003c/span\u003e, \u003cspan class=\"synConstant\"\u003e9\u003c/span\u003e, \u003cspan class=\"synConstant\"\u003e4\u003c/span\u003e)\n    itr = croniter(\u003cspan class=\"synConstant\"\u003e'0 0 l * *'\u003c/span\u003e, base)\n    n1 = itr.get_next(datetime)\n    self.assertEqual(n1.month, \u003cspan class=\"synConstant\"\u003e9\u003c/span\u003e)\n    self.assertEqual(n1.day, \u003cspan class=\"synConstant\"\u003e30\u003c/span\u003e)\n    n2 = itr.get_next(datetime)\n    self.assertEqual(n2.month, \u003cspan class=\"synConstant\"\u003e10\u003c/span\u003e)\n    self.assertEqual(n2.day, \u003cspan class=\"synConstant\"\u003e31\u003c/span\u003e)\n    n3 = itr.get_next(datetime)\n    self.assertEqual(n3.month, \u003cspan class=\"synConstant\"\u003e11\u003c/span\u003e)\n    self.assertEqual(n3.day, \u003cspan class=\"synConstant\"\u003e30\u003c/span\u003e)\n    n4 = itr.get_next(datetime)\n    self.assertEqual(n4.month, \u003cspan class=\"synConstant\"\u003e12\u003c/span\u003e)\n    self.assertEqual(n4.day, \u003cspan class=\"synConstant\"\u003e31\u003c/span\u003e)\n\u003c/pre\u003e\n\n\n\u003cp\u003e2019 年もそろそろ終わりです。年末にだけ動くバッチを設定＆監視するのも良いかもしれません。\u003c/p\u003e\n\n\u003cp\u003e明日は、こばりゅうの記事です。ひこうきかっけー！？お楽しみに。\u003c/p\u003e\n","contentSnippet":"こんにちは。id:masutaka26 です。去年の 6/30 からジムに通い始めて、なんとか週に 2~3 のペースで続いています。サプリメントも半信半疑ながら毎日飲んでいますが、ドラッグストアや Amazon で買うと割と高いと思います。個人的には iHerb がだいぶオススメです。以前 3.6kg のプロテインを買ったらなぜかキャンペーンが適用されて、30% オフの 6,517 円になりました。さらにこの案件動画を見て、プレワークアウトサプリ（C4 SPORT）にも手を出してしまいました。BCAA も飲んでいます。Twitter とかで検索すると、初回 10% OFF の紹介コードが見つかると思います。さらにお得です。何の記事でしたっけ...？そうだ、この記事は Feedforce Advent Calendar 2019 の 5 日目の記事です！昨日は id:kano-e の「2019 年に会社ボドゲ棚から自宅に持ち帰ったボドゲたち」でした。変わらぬボドゲ愛・・・！ff-boardgame.hatenablog.comsidekiq-cron で月末を指定する脈絡ありませんが、sidekiq-cron では last で月末を指定することが出来ます。例えば 0 12 last * * Asia/Tokyo の次回実行は 2019/12/31 12:00 JST です。2019/11/30 12:00 JST は無事動きました。このような設定になります。sample_job:  active_job: true  cron: \"0 12 last * * Asia/Tokyo\"  class: \"SampleJob\"  queue: defaultこの cron 書式は sidekiq-cron が依存する fugit による実装です。確認はしていませんが、last の他にも -1 や L などが使えるようです。🔗 https://github.com/floraison/fugit/blob/v1.3.3/spec/cron_spec.rb#L734-L747context 'negative monthdays' do  [    [ '* * -1 * *', '* * -1 * *' ],    [ '* * -7--1 * *', '* * -7,-6,-5,-4,-3,-2,-1 * *' ],    [ '* * -1--27 * *', '* * -31,-30,-29,-28,-27,-1 * *' ],    [ '* * -7--1/2 * *', '* * -7,-5,-3,-1 * *' ],    [ '* * L * *', '* * -1 * *' ],    [ '* * -7-L * *', '* * -7,-6,-5,-4,-3,-2,-1 * *' ],    [ '* * last * *', '* * -1 * *' ],  ].each { |c, e|    it(\"parses #{c}\") { expect(Fugit::Cron.parse(c).to_cron_s).to eq(e) }  }endnegative monthdays って表現は面白い。healthchecks.io で月末のバッチを監視するバッチが本当に起動したかを監視するのは難しいと思います。月末の監視はさらに難しいと思います。過度な依存は禁物ですが、healthchecks.io は選択肢に入れても良いかもしれません。以下の記事をどうぞ。developer.feedforce.jp前述の cron 設定だと 0 12 l * * で監視することが出来ます。l は小文字のエルです。terraform-provider-healthchecksio の設定例です。resource \"healthchecksio_check\" \"sample_job\" {  name     = \"SampleJob\"  tags     = [\"production\"]  grace    = \"60\"  schedule = \"0 12 l * *\"  timezone = \"Asia/Tokyo\"  channels = [data.healthchecksio_channel.slack.id]}data \"healthchecksio_channel\" \"slack\" {  kind = \"slack\"}こちらの cron 書式は healthchecks が依存する croniter による実装です。l 以外の指定は見当たりませんでした。🔗 https://github.com/taichino/croniter/blob/0.3.29/src/croniter/tests/test_croniter.py#L209-L223def testLastDayOfMonth(self):    base = datetime(2015, 9, 4)    itr = croniter('0 0 l * *', base)    n1 = itr.get_next(datetime)    self.assertEqual(n1.month, 9)    self.assertEqual(n1.day, 30)    n2 = itr.get_next(datetime)    self.assertEqual(n2.month, 10)    self.assertEqual(n2.day, 31)    n3 = itr.get_next(datetime)    self.assertEqual(n3.month, 11)    self.assertEqual(n3.day, 30)    n4 = itr.get_next(datetime)    self.assertEqual(n4.month, 12)    self.assertEqual(n4.day, 31)2019 年もそろそろ終わりです。年末にだけ動くバッチを設定＆監視するのも良いかもしれません。明日は、こばりゅうの記事です。ひこうきかっけー！？お楽しみに。","link":"https://developer.feedforce.jp/entry/2019/12/05/101931","isoDate":"2019-12-05T01:19:31.000Z","dateMiliSeconds":1575508771000,"imageUrl":"https://cdn-ak.f.st-hatena.com/images/fotolife/m/masutaka26/20191205/20191205000250.png","authorName":"masutaka"},{"title":"Heroku Meetup #25 \"Heroku Ghost\" で 2 回話してきた #herokujp","content":"\u003cp\u003eこんにちは \u003ca href=\"http://blog.hatena.ne.jp/masutaka26/\" class=\"hatena-id-icon\"\u003e\u003cimg src=\"https://cdn.profile-image.st-hatena.com/users/masutaka26/profile.png\" width=\"16\" height=\"16\" alt=\"\" class=\"hatena-id-icon\"\u003eid:masutaka26\u003c/a\u003e です。\u003c/p\u003e\n\n\u003cp\u003e先週金曜日（2019/7/26）に開催された \u003ca href=\"https://herokujp.doorkeeper.jp/events/93092\"\u003eHeroku Meetup #25 \"Heroku Ghost\"\u003c/a\u003e で『デプロイ元をCircleCIからHerokuに乗り換えた』というお題で発表してきました。\u003c/p\u003e\n\n\u003ciframe src=\"https://docs.google.com/presentation/d/e/2PACX-1vRy7z2A77VE4UNCp7EhpFgeQr7fl8XqHolYwsaokN76rGCvoeo1SKh1hkNg3ew2D4pSLoQAz-iefLnR/embed?start=false\u0026loop=false\u0026delayms=3000\" frameborder=\"0\" width=\"960\" height=\"400\" allowfullscreen=\"true\" mozallowfullscreen=\"true\" webkitallowfullscreen=\"true\"\u003e\u003c/iframe\u003e\n\n\n\u003cp\u003eつい先日、現在関わっている \u003ca href=\"https://app.ecbooster.jp/\"\u003eEC Booster\u003c/a\u003e のデプロイフローを改善し、それなりに知見を得られたためです。\u003c/p\u003e\n\n\u003cp\u003eHeroku Meetup の参加は\u003ca href=\"https://herokujp.doorkeeper.jp/events/91348\"\u003e前回 #24\u003c/a\u003e に引き続き、セッションでの発表は\u003ca href=\"https://herokujp.doorkeeper.jp/events/82754\"\u003e前々回 #23\u003c/a\u003e 以来です。\u003c/p\u003e\n\n\u003cp\u003e前々回 #23 については自分のブログにも書きました。\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://masutaka.net/chalow/2018-11-28-1.html\"\u003eHeroku Meetup #23 \"Heroku Dynamite!!\" で話してきた #herokujp / マスタカの ChangeLog メモ\u003c/a\u003e\u003c/p\u003e\n\n\u003ch2\u003eLT でも話した\u003c/h2\u003e\n\n\u003cp\u003eLT でも飛び込みで話しました。内容は \u003ca href=\"https://github.com/heroku/heroku-buildpack-google-chrome\"\u003eheroku-buildpack-google-chrome\u003c/a\u003e と \u003ca href=\"https://github.com/heroku/heroku-buildpack-chromedriver\"\u003eheroku-buildpack-chromedriver\u003c/a\u003e の細かすぎる話です。動かない Chrome や chromedriver のバイナリが本番環境にデプロイされることを防ぐ方法や、それに関して PR を出した話など。スライドの 41~43 ページ目が相当します。\u003c/p\u003e\n\n\u003cp\u003e無駄に元気な 1 日でした。\u003c/p\u003e\n\n\u003cp\u003e\u003cblockquote class=\"twitter-tweet\" data-lang=\"ja\"\u003e\u003cp lang=\"ja\" dir=\"ltr\"\u003e今日は会社で LT 1 本やって、Heroku meetup で通常セッション 1 本、その後に飛び込み（？）で LT 1 本やった。さすがにもうこの数をやることないかな？ \u003ca href=\"https://twitter.com/hashtag/herokujp?src=hash\u0026amp;ref_src=twsrc%5Etfw\"\u003e#herokujp\u003c/a\u003e\u003c/p\u003e\u0026mdash; Takashi MASUDA (@masutaka) \u003ca href=\"https://twitter.com/masutaka/status/1154719579374936065?ref_src=twsrc%5Etfw\"\u003e2019年7月26日\u003c/a\u003e\u003c/blockquote\u003e\u003cscript async src=\"https://platform.twitter.com/widgets.js\" charset=\"utf-8\"\u003e\u003c/script\u003e\u003c/p\u003e\n\n\u003cp\u003e※ 44~45 ページ目は、尺の関係で削ったブランチ戦略のメモです。ベストな戦略ではないので改善予定。\u003c/p\u003e\n\n\u003ch2\u003e雑感\u003c/h2\u003e\n\n\u003cp\u003e初心者向けの知見に比べて、一歩進んだ Heroku 知見はあまり Web 上に存在しない印象です。\u003c/p\u003e\n\n\u003cp\u003eここ 1 年近く、それなりに Heroku を学習してきて「かなりの規模まで Heroku で十分では？」「デプロイや Dyno の再起動で中断されるため苦手とされがちなバッチ処理も、簡単に克服できるのでは？」などと、考えが変わってきています。\u003c/p\u003e\n\n\u003cp\u003eこれからもブログや登壇などで、コミュニティに還元していきます。\u003c/p\u003e\n\n\u003cp\u003e\u003cblockquote class=\"twitter-tweet\" data-lang=\"ja\"\u003e\u003cp lang=\"ja\" dir=\"ltr\"\u003e本日の頂き物。キャップはスピーカー特典 \u003ca href=\"https://twitter.com/hashtag/herokujp?src=hash\u0026amp;ref_src=twsrc%5Etfw\"\u003e#herokujp\u003c/a\u003e \u003ca href=\"https://t.co/Whc3UVJrbg\"\u003epic.twitter.com/Whc3UVJrbg\u003c/a\u003e\u003c/p\u003e\u0026mdash; Takashi MASUDA (@masutaka) \u003ca href=\"https://twitter.com/masutaka/status/1154746086814150658?ref_src=twsrc%5Etfw\"\u003e2019年7月26日\u003c/a\u003e\u003c/blockquote\u003e\u003cscript async src=\"https://platform.twitter.com/widgets.js\" charset=\"utf-8\"\u003e\u003c/script\u003e\u003c/p\u003e\n","contentSnippet":"こんにちは id:masutaka26 です。先週金曜日（2019/7/26）に開催された Heroku Meetup #25 \"Heroku Ghost\" で『デプロイ元をCircleCIからHerokuに乗り換えた』というお題で発表してきました。つい先日、現在関わっている EC Booster のデプロイフローを改善し、それなりに知見を得られたためです。Heroku Meetup の参加は前回 #24 に引き続き、セッションでの発表は前々回 #23 以来です。前々回 #23 については自分のブログにも書きました。Heroku Meetup #23 \"Heroku Dynamite!!\" で話してきた #herokujp / マスタカの ChangeLog メモLT でも話したLT でも飛び込みで話しました。内容は heroku-buildpack-google-chrome と heroku-buildpack-chromedriver の細かすぎる話です。動かない Chrome や chromedriver のバイナリが本番環境にデプロイされることを防ぐ方法や、それに関して PR を出した話など。スライドの 41~43 ページ目が相当します。無駄に元気な 1 日でした。今日は会社で LT 1 本やって、Heroku meetup で通常セッション 1 本、その後に飛び込み（？）で LT 1 本やった。さすがにもうこの数をやることないかな？ #herokujp— Takashi MASUDA (@masutaka) 2019年7月26日※ 44~45 ページ目は、尺の関係で削ったブランチ戦略のメモです。ベストな戦略ではないので改善予定。雑感初心者向けの知見に比べて、一歩進んだ Heroku 知見はあまり Web 上に存在しない印象です。ここ 1 年近く、それなりに Heroku を学習してきて「かなりの規模まで Heroku で十分では？」「デプロイや Dyno の再起動で中断されるため苦手とされがちなバッチ処理も、簡単に克服できるのでは？」などと、考えが変わってきています。これからもブログや登壇などで、コミュニティに還元していきます。本日の頂き物。キャップはスピーカー特典 #herokujp pic.twitter.com/Whc3UVJrbg— Takashi MASUDA (@masutaka) 2019年7月26日","link":"https://developer.feedforce.jp/entry/2019/07/29/140000","isoDate":"2019-07-29T05:00:00.000Z","dateMiliSeconds":1564376400000,"imageUrl":"https://cdn-ak.f.st-hatena.com/images/fotolife/m/masutaka26/20181113/20181113190345.png","authorName":"masutaka"},{"title":"esa をネタに Emacs Lisp と Elm を無理やり繋げた発表をした","content":"\u003cp\u003eこんにちは。増田（\u003ca href=\"http://blog.hatena.ne.jp/masutaka26/\" class=\"hatena-id-icon\"\u003e\u003cimg src=\"https://cdn.profile-image.st-hatena.com/users/masutaka26/profile.png\" width=\"16\" height=\"16\" alt=\"\" class=\"hatena-id-icon\"\u003eid:masutaka26\u003c/a\u003e）です。今回はネタ探しに特に苦労しました。\u003c/p\u003e\n\n\u003cp\u003e週次の社内勉強会 \u003ca href=\"https://developer.feedforce.jp/archive/category/FFTT\"\u003eFFTT\u003c/a\u003e で『esaを支えたい技術』という発表をしました。\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://esa.io/\"\u003eesa\u003c/a\u003e をネタに Emacs Lisp と \u003ca href=\"https://elm-lang.org/\"\u003eElm\u003c/a\u003e を無理やり繋げた内容です。ちょっと強引だった。\u003c/p\u003e\n\n\u003ch2\u003e発表の内容\u003c/h2\u003e\n\n\u003cscript async class=\"speakerdeck-embed\" data-id=\"61df048e1aec4413bd797af156bc5f21\" data-ratio=\"1.33333333333333\" src=\"//speakerdeck.com/assets/embed.js\"\u003e\u003c/script\u003e\n\n\n\u003cp\u003e流れとしては、↓ こんな感じです。\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003e先月 \u003ca href=\"https://github.com/masutaka/emacs-helm-esa\"\u003eemacs-helm-esa\u003c/a\u003e というツールを作ったよ\u003c/li\u003e\n\u003cli\u003eElm を学んだら、Emacs Lisp と Syntax が似ていたよ\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/masutaka/sandbox-elm-esa\"\u003eesa の検索をするだけの簡単なツール\u003c/a\u003eを作ったよ\u003c/li\u003e\n\u003c/ul\u003e\n\n\n\u003ch2\u003e発表の感想\u003c/h2\u003e\n\n\u003cp\u003e付箋紙に感想を書いてくれました。\u003ci class=\"blogicon-comment\" aria-hidden=\"true\"\u003e\u003c/i\u003e は私からのコメントです。\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003e関数型言語について学んでみたいと思っていたので、おすすめの順序を提示してくださり、参考になりました！\n\n\u003cul\u003e\n\u003cli\u003e\u003ci class=\"blogicon-comment\" aria-hidden=\"true\"\u003e\u003c/i\u003e 良かったです。Elm はだいぶ学びやすかったです\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eElm、こうして見てみると Haskell にめっちゃ似てますね！\n\n\u003cul\u003e\n\u003cli\u003e\u003ci class=\"blogicon-comment\" aria-hidden=\"true\"\u003e\u003c/i\u003e そうなんですね\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e発表の流れで Elm の話になると思わなかった\n\n\u003cul\u003e\n\u003cli\u003e\u003ci class=\"blogicon-comment\" aria-hidden=\"true\"\u003e\u003c/i\u003e 強引でしたね (^^;\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eElm ならふだんバックエンドのコード書いている人でもモダンなフロントエンド書けるって聞いたので勉強がんばる（決意）\n\n\u003cul\u003e\n\u003cli\u003e\u003ci class=\"blogicon-comment\" aria-hidden=\"true\"\u003e\u003c/i\u003e 刺激になってよかったです\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e良かったです！規模が大きくなってきても同じノリで書けるのも Elm は良い\n\n\u003cul\u003e\n\u003cli\u003e\u003ci class=\"blogicon-comment\" aria-hidden=\"true\"\u003e\u003c/i\u003e そういう感じなんですね。コンパイルが通ればだいたい動くのが楽でした\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eElm の HTML を作るのがすごいですね！\n\n\u003cul\u003e\n\u003cli\u003e\u003ci class=\"blogicon-comment\" aria-hidden=\"true\"\u003e\u003c/i\u003e ですよね。\u003ca href=\"https://github.com/masutaka/sandbox-elm-esa/blob/b46bb8d405030a96ab3049a8aac1450decf0adf9/src/Main.elm#L93\"\u003eこの辺りの div や i\u003c/a\u003e は全部関数ですからね\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eネタバレに慎重になりすぎでは！？\n\n\u003cul\u003e\n\u003cli\u003e\u003ci class=\"blogicon-comment\" aria-hidden=\"true\"\u003e\u003c/i\u003e 自分でも全く理解できません\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e来週にはこれが Chrome 拡張になっているんですかね？\n\n\u003cul\u003e\n\u003cli\u003e\u003ci class=\"blogicon-comment\" aria-hidden=\"true\"\u003e\u003c/i\u003e はい、次回以降の当番の方が必ず・・・！\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eElm おもしろそう 🏃‍♀️🚶‍♂️ emacs ってすごいんですね\n\n\u003cul\u003e\n\u003cli\u003e\u003ci class=\"blogicon-comment\" aria-hidden=\"true\"\u003e\u003c/i\u003e とは言え、今の時代は emacs の他に優先順位の高いものがたくさんありますね 💦\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eまさかの Elm とは！？\n\n\u003cul\u003e\n\u003cli\u003e\u003ci class=\"blogicon-comment\" aria-hidden=\"true\"\u003e\u003c/i\u003e 考えに考えた末の Elm です...\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eこれで EC Booster Front 開発できますね\n\n\u003cul\u003e\n\u003cli\u003e\u003ci class=\"blogicon-comment\" aria-hidden=\"true\"\u003e\u003c/i\u003e 見ててくださいよ！これからのマスタカを！！１\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\n\n\u003ch2\u003e所感\u003c/h2\u003e\n\n\u003cp\u003e正直、外したかな？と思いながら発表してましたが、感想を読むと良い刺激を与えられたようで良かったです。\u003c/p\u003e\n\n\u003cp\u003e一方で新しい言語の説明は難しいうえ、皆さんに馴染みがない Emacs Lisp との比較をしたので、余計に分かりづらかったという...。\u003c/p\u003e\n\n\u003cp\u003eこうするとあまり盛り上がらないという学びを得たことと、個人的には大変満足のいく内容だったので、結果的には良かったです。\u003c/p\u003e\n\n\u003cp\u003eさて、次回の勉強会のネタはどうするかな...。\u003c/p\u003e\n\n\u003cp\u003e\u003cdiv class=\"hatena-asin-detail\"\u003e\u003ca href=\"https://www.amazon.co.jp/exec/obidos/ASIN/4863542224/hatena-blog-22/\"\u003e\u003cimg src=\"https://m.media-amazon.com/images/I/51G32HC7rSL.jpg\" class=\"hatena-asin-detail-image\" alt=\"基礎からわかる Elm\" title=\"基礎からわかる Elm\"\u003e\u003c/a\u003e\u003cdiv class=\"hatena-asin-detail-info\"\u003e\u003cp class=\"hatena-asin-detail-title\"\u003e\u003ca href=\"https://www.amazon.co.jp/exec/obidos/ASIN/4863542224/hatena-blog-22/\"\u003e基礎からわかる Elm\u003c/a\u003e\u003c/p\u003e\u003cul\u003e\u003cli\u003e\u003cspan class=\"hatena-asin-detail-label\"\u003e作者:\u003c/span\u003e\u003ca href=\"http://d.hatena.ne.jp/keyword/%C4%BB%B5%EF%20%CD%DB%B2%F0\" class=\"keyword\"\u003e鳥居 陽介\u003c/a\u003e\u003c/li\u003e\u003cli\u003e\u003cspan class=\"hatena-asin-detail-label\"\u003e発売日:\u003c/span\u003e 2019/02/27\u003c/li\u003e\u003cli\u003e\u003cspan class=\"hatena-asin-detail-label\"\u003eメディア:\u003c/span\u003e 単行本（ソフトカバー）\u003c/li\u003e\u003c/ul\u003e\u003c/div\u003e\u003cdiv class=\"hatena-asin-detail-foot\"\u003e\u003c/div\u003e\u003c/div\u003e\u003c/p\u003e\n","contentSnippet":"こんにちは。増田（id:masutaka26）です。今回はネタ探しに特に苦労しました。週次の社内勉強会 FFTT で『esaを支えたい技術』という発表をしました。esa をネタに Emacs Lisp と Elm を無理やり繋げた内容です。ちょっと強引だった。発表の内容流れとしては、↓ こんな感じです。先月 emacs-helm-esa というツールを作ったよElm を学んだら、Emacs Lisp と Syntax が似ていたよesa の検索をするだけの簡単なツールを作ったよ発表の感想付箋紙に感想を書いてくれました。 は私からのコメントです。関数型言語について学んでみたいと思っていたので、おすすめの順序を提示してくださり、参考になりました！ 良かったです。Elm はだいぶ学びやすかったですElm、こうして見てみると Haskell にめっちゃ似てますね！ そうなんですね発表の流れで Elm の話になると思わなかった 強引でしたね (^^;Elm ならふだんバックエンドのコード書いている人でもモダンなフロントエンド書けるって聞いたので勉強がんばる（決意） 刺激になってよかったです良かったです！規模が大きくなってきても同じノリで書けるのも Elm は良い そういう感じなんですね。コンパイルが通ればだいたい動くのが楽でしたElm の HTML を作るのがすごいですね！ ですよね。この辺りの div や i は全部関数ですからねネタバレに慎重になりすぎでは！？ 自分でも全く理解できません来週にはこれが Chrome 拡張になっているんですかね？ はい、次回以降の当番の方が必ず・・・！Elm おもしろそう 🏃‍♀️🚶‍♂️ emacs ってすごいんですね とは言え、今の時代は emacs の他に優先順位の高いものがたくさんありますね 💦まさかの Elm とは！？ 考えに考えた末の Elm です...これで EC Booster Front 開発できますね 見ててくださいよ！これからのマスタカを！！１所感正直、外したかな？と思いながら発表してましたが、感想を読むと良い刺激を与えられたようで良かったです。一方で新しい言語の説明は難しいうえ、皆さんに馴染みがない Emacs Lisp との比較をしたので、余計に分かりづらかったという...。こうするとあまり盛り上がらないという学びを得たことと、個人的には大変満足のいく内容だったので、結果的には良かったです。さて、次回の勉強会のネタはどうするかな...。基礎からわかる Elm作者:鳥居 陽介発売日: 2019/02/27メディア: 単行本（ソフトカバー）","link":"https://developer.feedforce.jp/entry/2019/07/01/140000","isoDate":"2019-07-01T05:00:00.000Z","dateMiliSeconds":1561957200000,"imageUrl":"https://images-fe.ssl-images-amazon.com/images/I/51G32HC7rSL._SL160_.jpg","authorName":"masutaka"},{"title":"Heroku で Chrome を使ったクローラの IP アドレスを固定する","content":"\u003cp\u003eこんにちは \u003ca href=\"http://blog.hatena.ne.jp/masutaka26/\" class=\"hatena-id-icon\"\u003e\u003cimg src=\"https://cdn.profile-image.st-hatena.com/users/masutaka26/profile.png\" width=\"16\" height=\"16\" alt=\"\" class=\"hatena-id-icon\"\u003eid:masutaka26\u003c/a\u003e です。\u003c/p\u003e\n\n\u003cp\u003e少し前に、Heroku の worker Dyno 上で動く、Chrome のクローラで IP アドレスを固定化出来ないか調査しました。\u003c/p\u003e\n\n\u003cp\u003e実装は見送られましたが、想定よりも難しく調査に時間がかかったので、この記事に残しておきます。\u003c/p\u003e\n\n\u003cp\u003e方法だけ知りたい方は、下の方にある「手順」をご覧ください。\u003c/p\u003e\n\n\u003cul class=\"table-of-contents\"\u003e\n    \u003cli\u003e\u003ca href=\"#Heroku-Add-on-を比較する\"\u003eHeroku Add-on を比較する\u003c/a\u003e\u003cul\u003e\n            \u003cli\u003e\u003ca href=\"#開発組織\"\u003e開発組織\u003c/a\u003e\u003c/li\u003e\n            \u003cli\u003e\u003ca href=\"#実装\"\u003e実装\u003c/a\u003e\u003c/li\u003e\n            \u003cli\u003e\u003ca href=\"#プラン\"\u003eプラン\u003c/a\u003e\u003c/li\u003e\n            \u003cli\u003e\u003ca href=\"#CLI-のインストール\"\u003eCLI のインストール\u003c/a\u003e\u003c/li\u003e\n            \u003cli\u003e\u003ca href=\"#Heroku-Buildpack\"\u003eHeroku Buildpack\u003c/a\u003e\u003c/li\u003e\n        \u003c/ul\u003e\n    \u003c/li\u003e\n    \u003cli\u003e\u003ca href=\"#コラム-固定-IP-アドレスへの私見\"\u003e[コラム] 固定 IP アドレスへの私見\u003c/a\u003e\u003c/li\u003e\n    \u003cli\u003e\u003ca href=\"#Chrome-のクローラで-IP-アドレスを固定化する\"\u003eChrome のクローラで IP アドレスを固定化する\u003c/a\u003e\u003cul\u003e\n            \u003cli\u003e\u003ca href=\"#試行錯誤の日々\"\u003e試行錯誤の日々\u003c/a\u003e\u003c/li\u003e\n            \u003cli\u003e\u003ca href=\"#ついに成功\"\u003eついに成功\u003c/a\u003e\u003c/li\u003e\n            \u003cli\u003e\u003ca href=\"#手順\"\u003e手順\u003c/a\u003e\u003c/li\u003e\n        \u003c/ul\u003e\n    \u003c/li\u003e\n    \u003cli\u003e\u003ca href=\"#QuotaGuard-Static-の注意事項\"\u003eQuotaGuard Static の注意事項\u003c/a\u003e\u003c/li\u003e\n    \u003cli\u003e\u003ca href=\"#まとめ\"\u003eまとめ\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch2 id=\"Heroku-Add-on-を比較する\"\u003eHeroku Add-on を比較する\u003c/h2\u003e\n\n\u003cp\u003e今回は \u003ca href=\"https://elements.heroku.com/addons/proximo\"\u003eProximo\u003c/a\u003e と \u003ca href=\"https://elements.heroku.com/addons/quotaguardstatic\"\u003eQuotaGuard Static\u003c/a\u003e を検討し、最終的に QuotaGuard Static を採用しました。\u003c/p\u003e\n\n\u003cp\u003e💡 他に \u003ca href=\"https://elements.heroku.com/addons/fixie\"\u003eFixie\u003c/a\u003e, \u003ca href=\"https://elements.heroku.com/addons/fixie-socks\"\u003eFixie Socks\u003c/a\u003e, \u003ca href=\"https://elements.heroku.com/addons/guru301\"\u003eGuru301\u003c/a\u003e などがあるようです。\u003c/p\u003e\n\n\u003cp\u003e以下、その理由です。\u003c/p\u003e\n\n\u003ch3 id=\"開発組織\"\u003e開発組織\u003c/h3\u003e\n\n\u003cp\u003eProximo は \u003ca href=\"https://github.com/pirateradio\"\u003ehttps://github.com/pirateradio\u003c/a\u003e を見た感じ \u003ca href=\"https://github.com/ddollar\"\u003e@ddollar\u003c/a\u003e の個人開発のようです。この方は \u003ca href=\"https://github.com/ddollar/foreman\"\u003eforeman\u003c/a\u003e などを作っており、多分すごい人です。\u003c/p\u003e\n\n\u003cp\u003eQuotaGuard Static は \u003ca href=\"https://www.quotaguard.com/\"\u003ehttps://www.quotaguard.com/\u003c/a\u003e によると \u003ca href=\"https://www.alpineshark.com/\"\u003eAlpine Shark, LLC\u003c/a\u003e のようです。会社のほうがちょっとだけ安心できます。\u003c/p\u003e\n\n\u003ch3 id=\"実装\"\u003e実装\u003c/h3\u003e\n\n\u003cp\u003eProximo は 1 つのようですが、QuotaGuard Static は 2 つの Proxy サーバで冗長化されているようです。Proxy サーバが落ちる確率は低いかもしれませんが、冗長化されているに越したことはありません。\u003c/p\u003e\n\n\u003cp\u003e🔗 \u003ca href=\"https://devcenter.heroku.com/articles/proximo#provisioning-the-proximo-add-on\"\u003ehttps://devcenter.heroku.com/articles/proximo#provisioning-the-proximo-add-on\u003c/a\u003e\u003c/p\u003e\n\n\u003cpre class=\"code\" data-lang=\"\" data-unlink\u003e$ heroku addons:create proximo:development\nAdding proximo to sharp-mountain-4005... done, v18 ($5/mo)\nYour static IP address is 10.9.8.7\u003c/pre\u003e\n\n\n\u003cp\u003e🔗 \u003ca href=\"https://devcenter.heroku.com/articles/quotaguardstatic#provisioning-the-add-on\"\u003ehttps://devcenter.heroku.com/articles/quotaguardstatic#provisioning-the-add-on\u003c/a\u003e\u003c/p\u003e\n\n\u003cpre class=\"code\" data-lang=\"\" data-unlink\u003e$ heroku addons:create quotaguardstatic:starter\n-----\u0026gt; Adding quotaguardstatic:starter to sharp-mountain-4005... done, v18 (free)\n-----\u0026gt; Your static IPs are [10.11.12.13, 14.15.16.17]\u003c/pre\u003e\n\n\n\u003ch3 id=\"プラン\"\u003eプラン\u003c/h3\u003e\n\n\u003cp\u003eQuotaGuard Static は無料プランがあるので始めやすいです。Proximo のプランは \u003ccode\u003e$5/mo\u003c/code\u003e からです。\u003c/p\u003e\n\n\u003cp\u003eちなみにどちらも \u003ccode\u003ePROXIMO_MASK\u003c/code\u003e や \u003ccode\u003eQUOTAGUARDSTATIC_MASK\u003c/code\u003e という環境変数を設定すると、一部のレンジの送信だけこれらのサービス経由にすることができ、料金を節約できます。\u003c/p\u003e\n\n\u003cp\u003e💡 正確に書くと \u003ccode\u003eQUOTAGUARDSTATIC_MASK\u003c/code\u003e は後述する qgsocksify 用の環境変数です。\u003c/p\u003e\n\n\u003ch3 id=\"CLI-のインストール\"\u003eCLI のインストール\u003c/h3\u003e\n\n\u003cp\u003eどちらも CLI が提供されており、必要に応じてインストールします。\u003c/p\u003e\n\n\u003cp\u003eProximo はインストール元が http なのがイマイチでした。https に変えてもアクセス不可です。\u003c/p\u003e\n\n\u003cpre class=\"code\" data-lang=\"\" data-unlink\u003e$ curl http://downloads.proximo.io/proximo-stacklet.tgz | tar xz\u003c/pre\u003e\n\n\n\u003cp\u003eQuotaGuard Static は普通に https でインストール出来ます。\u003c/p\u003e\n\n\u003cpre class=\"code\" data-lang=\"\" data-unlink\u003e$ curl https://s3.amazonaws.com/quotaguard/qgtunnel-latest.tar.gz | tar xz\n$ curl https://s3.amazonaws.com/quotaguard/quotaguard-socksify-latest.tar.gz | tar xz\u003c/pre\u003e\n\n\n\u003ch3 id=\"Heroku-Buildpack\"\u003eHeroku Buildpack\u003c/h3\u003e\n\n\u003cp\u003e今回の調査の過程で Heroku Buildpack を作りました。バイナリファイルをリポジトリに commit せずに済みます。よかったらどうぞ。\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/masutaka/heroku-buildpack-proximo\"\u003ehttps://github.com/masutaka/heroku-buildpack-proximo\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/masutaka/heroku-buildpack-qgtunnel\"\u003ehttps://github.com/masutaka/heroku-buildpack-qgtunnel\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/masutaka/heroku-buildpack-qgsocksify\"\u003ehttps://github.com/masutaka/heroku-buildpack-qgsocksify\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\n\n\u003ch2 id=\"コラム-固定-IP-アドレスへの私見\"\u003e[コラム] 固定 IP アドレスへの私見\u003c/h2\u003e\n\n\u003cp\u003eIP アドレスを固定化したいのは、どんなケースでしょうか。\u003c/p\u003e\n\n\u003cp\u003e多くはセキュリティ要件だと思いますが、私はあまり賛同できないです。\u003c/p\u003e\n\n\u003cp\u003eそもそも当該 IP アドレスは認証されておらず、所有者が変わることがあります。仕組み上それに気づくことは難しいため、逆にセキュリティリスクを増やすことになります。そういう意味では電話番号とよく似ています。\u003c/p\u003e\n\n\u003cp\u003eサービスのスケールの観点からもデメリットがあります。例えば Heroku から AWS に引っ越す時、固定 IP アドレスは変わってしまうでしょう。顧客との調整が必要ですし、間に開発会社が入っていると、より時間がかかります。\u003c/p\u003e\n\n\u003ch2 id=\"Chrome-のクローラで-IP-アドレスを固定化する\"\u003eChrome のクローラで IP アドレスを固定化する\u003c/h2\u003e\n\n\u003cp\u003e今回のケースでは Heroku の worker Dyno 上に \u003ca href=\"https://rubygems.org/gems/sidekiq\"\u003esidekiq\u003c/a\u003e が起動しており、\u003ca href=\"https://rubygems.org/gems/selenium-webdriver\"\u003eselenium-webdriver\u003c/a\u003e 経由で Chrome が子プロセスとして起動し、クロールします。\u003c/p\u003e\n\n\u003cpre\u003e\u003ccode\u003esidekiq\n└ Chrome\n   ↓\n   クロール先\n\u003c/code\u003e\u003c/pre\u003e\n\n\u003ch3 id=\"試行錯誤の日々\"\u003e試行錯誤の日々\u003c/h3\u003e\n\n\u003cp\u003e当初は sidekiq 自体に qgtunnel や qgsocksify をラップしましたが、うまくいきませんでした。よく考えたら納得です。\u003c/p\u003e\n\n\u003cp\u003eChrome に \u003ccode\u003e--proxy-server=http://\u0026lt;USERNAME\u0026gt;:\u0026lt;PASSWORD\u0026gt;@\u0026lt;HOSTNAME\u0026gt;:\u0026lt;PORT\u0026gt;\u003c/code\u003e や \u003ccode\u003e--proxy-auth=\u0026lt;USERNAME\u0026gt;:\u0026lt;PASSWORD\u0026gt;\u003c/code\u003e を指定してもダメ。\u003c/p\u003e\n\n\u003cp\u003eどうやら少なくとも Chrome 73 ではセキュリティ上の理由から、コマンドラインオプションから認証情報を設定できないようです。認証なしプロクシなら大丈夫ですが、QuotaGuard Static は商用サービスなので認証は必須です。\u003c/p\u003e\n\n\u003ch3 id=\"ついに成功\"\u003eついに成功\u003c/h3\u003e\n\n\u003cp\u003eダメ元で QuotaGuard Static のサポートに聞いたら、方法を知っており、無事クロール先にアクセスすることが出来ました。\u003c/p\u003e\n\n\u003cp\u003e👇 Dyno とクロール先を SOCKS5 トンネルで繋ぎ、それ経由でアクセスします。\u003c/p\u003e\n\n\u003cpre\u003e\u003ccode\u003esidekiq\n└ Chrome (4443 port)\n   ↓ (SOCKS5 tunnel)\n   QuotaGuard Static\n   ↓ (SOCKS5 tunnel)\n   クロール先 (443 port)\n\u003c/code\u003e\u003c/pre\u003e\n\n\u003cp\u003eTCP アクセスならなんでも IP アドレスを固定化出来そうです。\u003c/p\u003e\n\n\u003ch3 id=\"手順\"\u003e手順\u003c/h3\u003e\n\n\u003cp\u003e(1) 当該 Heroku App に QuotaGuard Static Add-on をインストールします。\u003c/p\u003e\n\n\u003cp\u003e(2) qgtunnel CLI もインストールします。前述の heroku-buildpack-qgtunnel を使うとお手軽です。\u003c/p\u003e\n\n\u003cpre class=\"code\" data-lang=\"\" data-unlink\u003e$ curl https://s3.amazonaws.com/quotaguard/qgtunnel-latest.tar.gz | tar xz\u003c/pre\u003e\n\n\n\u003cp\u003e(3) Heroku のダッシュボードから、QuotaGuard Static のダッシュボードに進み、\u003ccode\u003eSettings\u003c/code\u003e → \u003ccode\u003eSetup\u003c/code\u003e とクリックします。\u003c/p\u003e\n\n\u003cp\u003e\u003cspan itemscope itemtype=\"http://schema.org/Photograph\"\u003e\u003cimg src=\"https://cdn-ak.f.st-hatena.com/images/fotolife/m/masutaka26/20190425/20190425193848.png\" alt=\"f:id:masutaka26:20190425193848p:plain\" title=\"\" class=\"hatena-fotolife\" itemprop=\"image\"\u003e\u003c/span\u003e\u003c/p\u003e\n\n\u003cp\u003e(4) さらに \u003ccode\u003eTunnel\u003c/code\u003e → \u003ccode\u003eCreate Tunnel\u003c/code\u003e とクリックします。\u003c/p\u003e\n\n\u003cp\u003e\u003cspan itemscope itemtype=\"http://schema.org/Photograph\"\u003e\u003cimg src=\"https://cdn-ak.f.st-hatena.com/images/fotolife/m/masutaka26/20190425/20190425192905.png\" alt=\"f:id:masutaka26:20190425192905p:plain\" title=\"\" class=\"hatena-fotolife\" itemprop=\"image\"\u003e\u003c/span\u003e\u003c/p\u003e\n\n\u003cp\u003e(5) \u003ccode\u003eRemote Destination\u003c/code\u003e にクロール先を、\u003ccode\u003eLocal Port\u003c/code\u003e は 4443、\u003ccode\u003eTransparent\u003c/code\u003e は true に設定します。\u003ccode\u003eEncrypted\u003c/code\u003e は設定しません。\u003c/p\u003e\n\n\u003cp\u003e\u003cspan itemscope itemtype=\"http://schema.org/Photograph\"\u003e\u003cimg src=\"https://cdn-ak.f.st-hatena.com/images/fotolife/m/masutaka26/20190425/20190425193342.png\" alt=\"f:id:masutaka26:20190425193342p:plain\" title=\"\" class=\"hatena-fotolife\" itemprop=\"image\"\u003e\u003c/span\u003e\u003c/p\u003e\n\n\u003cp\u003e(6) トンネルが出来ました。\u003c/p\u003e\n\n\u003cp\u003e\u003cspan itemscope itemtype=\"http://schema.org/Photograph\"\u003e\u003cimg src=\"https://cdn-ak.f.st-hatena.com/images/fotolife/m/masutaka26/20190425/20190425193614.png\" alt=\"f:id:masutaka26:20190425193614p:plain\" title=\"\" class=\"hatena-fotolife\" itemprop=\"image\"\u003e\u003c/span\u003e\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003e127.0.0.1:4443 へのアクセスは destination.example.com:443 へのトンネルになります\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eTransparent\u003c/code\u003e を有効したことにより、destination.example.com の DNS が 127.0.0.1 に上書きされました。destination.example.com:4443 へのアクセスは destination.example.com:443 と等価になります\u003c/li\u003e\n\u003cli\u003eすでに HTTPS を使っているため、\u003ccode\u003eEncrypted\u003c/code\u003e は必要ありません\u003c/li\u003e\n\u003c/ul\u003e\n\n\n\u003cp\u003e(7) selenium-webdriver に与える Chrome のバイナリを qgtunnel でラッピングします。今回は以下のようなシェルスクリプト bin/google-chrome-qgtunnel を作り、selenium-webdriver に指定しました。\u003c/p\u003e\n\n\u003cpre class=\"code lang-sh\" data-lang=\"sh\" data-unlink\u003e\u003cspan class=\"synComment\"\u003e#!/bin/sh -eu\u003c/span\u003e\n\n\u003cspan class=\"synStatement\"\u003eexec\u003c/span\u003e bin/qgtunnel \u003cspan class=\"synStatement\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"synPreProc\"\u003e$GOOGLE_CHROME_SHIM\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e\u0026quot;\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"synPreProc\"\u003e$@\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e\u0026quot;\u003c/span\u003e\n\u003c/pre\u003e\n\n\n\u003cp\u003e💡 \u003ca href=\"https://github.com/heroku/heroku-buildpack-google-chrome\"\u003eheroku-buildpack-google-chrome\u003c/a\u003e と \u003ca href=\"https://github.com/heroku/heroku-buildpack-chromedriver.git\"\u003eheroku-buildpack-chromedriver\u003c/a\u003e を使っています。環境変数 \u003ccode\u003eGOOGLE_CHROME_SHIM\u003c/code\u003e は \u003ccode\u003e/app/.apt/usr/bin/google-chrome\u003c/code\u003e です。\u003c/p\u003e\n\n\u003cp\u003e(8) 左側の \u003ccode\u003eOutbound\u003c/code\u003e をクリックし、SOCKS5 url を Heroku の環境変数 \u003ccode\u003eQUOTAGUARDSTATIC_URL\u003c/code\u003e に上書きします。\u003c/p\u003e\n\n\u003cp\u003e\u003cspan itemscope itemtype=\"http://schema.org/Photograph\"\u003e\u003cimg src=\"https://cdn-ak.f.st-hatena.com/images/fotolife/m/masutaka26/20190425/20190425191501.png\" alt=\"f:id:masutaka26:20190425191501p:plain\" title=\"\" class=\"hatena-fotolife\" itemprop=\"image\"\u003e\u003c/span\u003e\u003c/p\u003e\n\n\u003cp\u003e(9) 左側の \u003ccode\u003eTunnel\u003c/code\u003e から \u003ccode\u003eDownload Configuration\u003c/code\u003e をクリックし、\u003ccode\u003e.qgtunnel\u003c/code\u003e ファイルをリポジトリに commit します。\u003c/p\u003e\n\n\u003cp\u003e\u003cspan itemscope itemtype=\"http://schema.org/Photograph\"\u003e\u003cimg src=\"https://cdn-ak.f.st-hatena.com/images/fotolife/m/masutaka26/20190425/20190425203447.png\" alt=\"f:id:masutaka26:20190425203447p:plain\" title=\"\" class=\"hatena-fotolife\" itemprop=\"image\"\u003e\u003c/span\u003e\u003c/p\u003e\n\n\u003cp\u003e(10) 以上の設定により、destination.example.com:4443 へのアクセスが destination.example.com:443 に変換され、且つ IP アドレスも固定されます。\u003c/p\u003e\n\n\u003cp\u003eなにかトラブルがあったら Heroku の環境変数 \u003ccode\u003eQGTUNNEL_DEBUG\u003c/code\u003e に true をセットして、ログを確認すると良いと思います。\u003c/p\u003e\n\n\u003ch2 id=\"QuotaGuard-Static-の注意事項\"\u003eQuotaGuard Static の注意事項\u003c/h2\u003e\n\n\u003cp\u003eapp.json の addons に \u003ccode\u003equotaguardstatic\u003c/code\u003e を追加して、Review App を作ると Micro plan \u003ccode\u003e$19/mo\u003c/code\u003e で作られてしまいます。\u003ccode\u003equotaguardstatic:starter\u003c/code\u003e とかにしても同じです。\u003c/p\u003e\n\n\u003cp\u003eQuotaGuard Static のサポートに聞いたところ、Heroku のアカウント単位で設定を変える必要があるそう。問い合わせが必要です。\u003c/p\u003e\n\n\u003ch2 id=\"まとめ\"\u003eまとめ\u003c/h2\u003e\n\n\u003cp\u003eHeroku の worker Dyno 上で動く、Chrome のクローラで IP アドレスを固定化しました。\u003c/p\u003e\n\n\u003cp\u003e固定 IP アドレス対応は出来るだけ避けたほうが良いと思いますが、どうしても必要な時にこの記事が参考になれば幸いです。\u003c/p\u003e\n","contentSnippet":"こんにちは id:masutaka26 です。少し前に、Heroku の worker Dyno 上で動く、Chrome のクローラで IP アドレスを固定化出来ないか調査しました。実装は見送られましたが、想定よりも難しく調査に時間がかかったので、この記事に残しておきます。方法だけ知りたい方は、下の方にある「手順」をご覧ください。Heroku Add-on を比較する開発組織実装プランCLI のインストールHeroku Buildpack[コラム] 固定 IP アドレスへの私見Chrome のクローラで IP アドレスを固定化する試行錯誤の日々ついに成功手順QuotaGuard Static の注意事項まとめHeroku Add-on を比較する今回は Proximo と QuotaGuard Static を検討し、最終的に QuotaGuard Static を採用しました。💡 他に Fixie, Fixie Socks, Guru301 などがあるようです。以下、その理由です。開発組織Proximo は https://github.com/pirateradio を見た感じ @ddollar の個人開発のようです。この方は foreman などを作っており、多分すごい人です。QuotaGuard Static は https://www.quotaguard.com/ によると Alpine Shark, LLC のようです。会社のほうがちょっとだけ安心できます。実装Proximo は 1 つのようですが、QuotaGuard Static は 2 つの Proxy サーバで冗長化されているようです。Proxy サーバが落ちる確率は低いかもしれませんが、冗長化されているに越したことはありません。🔗 https://devcenter.heroku.com/articles/proximo#provisioning-the-proximo-add-on$ heroku addons:create proximo:developmentAdding proximo to sharp-mountain-4005... done, v18 ($5/mo)Your static IP address is 10.9.8.7🔗 https://devcenter.heroku.com/articles/quotaguardstatic#provisioning-the-add-on$ heroku addons:create quotaguardstatic:starter-----\u003e Adding quotaguardstatic:starter to sharp-mountain-4005... done, v18 (free)-----\u003e Your static IPs are [10.11.12.13, 14.15.16.17]プランQuotaGuard Static は無料プランがあるので始めやすいです。Proximo のプランは $5/mo からです。ちなみにどちらも PROXIMO_MASK や QUOTAGUARDSTATIC_MASK という環境変数を設定すると、一部のレンジの送信だけこれらのサービス経由にすることができ、料金を節約できます。💡 正確に書くと QUOTAGUARDSTATIC_MASK は後述する qgsocksify 用の環境変数です。CLI のインストールどちらも CLI が提供されており、必要に応じてインストールします。Proximo はインストール元が http なのがイマイチでした。https に変えてもアクセス不可です。$ curl http://downloads.proximo.io/proximo-stacklet.tgz | tar xzQuotaGuard Static は普通に https でインストール出来ます。$ curl https://s3.amazonaws.com/quotaguard/qgtunnel-latest.tar.gz | tar xz$ curl https://s3.amazonaws.com/quotaguard/quotaguard-socksify-latest.tar.gz | tar xzHeroku Buildpack今回の調査の過程で Heroku Buildpack を作りました。バイナリファイルをリポジトリに commit せずに済みます。よかったらどうぞ。https://github.com/masutaka/heroku-buildpack-proximohttps://github.com/masutaka/heroku-buildpack-qgtunnelhttps://github.com/masutaka/heroku-buildpack-qgsocksify[コラム] 固定 IP アドレスへの私見IP アドレスを固定化したいのは、どんなケースでしょうか。多くはセキュリティ要件だと思いますが、私はあまり賛同できないです。そもそも当該 IP アドレスは認証されておらず、所有者が変わることがあります。仕組み上それに気づくことは難しいため、逆にセキュリティリスクを増やすことになります。そういう意味では電話番号とよく似ています。サービスのスケールの観点からもデメリットがあります。例えば Heroku から AWS に引っ越す時、固定 IP アドレスは変わってしまうでしょう。顧客との調整が必要ですし、間に開発会社が入っていると、より時間がかかります。Chrome のクローラで IP アドレスを固定化する今回のケースでは Heroku の worker Dyno 上に sidekiq が起動しており、selenium-webdriver 経由で Chrome が子プロセスとして起動し、クロールします。sidekiq└ Chrome   ↓   クロール先試行錯誤の日々当初は sidekiq 自体に qgtunnel や qgsocksify をラップしましたが、うまくいきませんでした。よく考えたら納得です。Chrome に --proxy-server=http://\u003cUSERNAME\u003e:\u003cPASSWORD\u003e@\u003cHOSTNAME\u003e:\u003cPORT\u003e や --proxy-auth=\u003cUSERNAME\u003e:\u003cPASSWORD\u003e を指定してもダメ。どうやら少なくとも Chrome 73 ではセキュリティ上の理由から、コマンドラインオプションから認証情報を設定できないようです。認証なしプロクシなら大丈夫ですが、QuotaGuard Static は商用サービスなので認証は必須です。ついに成功ダメ元で QuotaGuard Static のサポートに聞いたら、方法を知っており、無事クロール先にアクセスすることが出来ました。👇 Dyno とクロール先を SOCKS5 トンネルで繋ぎ、それ経由でアクセスします。sidekiq└ Chrome (4443 port)   ↓ (SOCKS5 tunnel)   QuotaGuard Static   ↓ (SOCKS5 tunnel)   クロール先 (443 port)TCP アクセスならなんでも IP アドレスを固定化出来そうです。手順(1) 当該 Heroku App に QuotaGuard Static Add-on をインストールします。(2) qgtunnel CLI もインストールします。前述の heroku-buildpack-qgtunnel を使うとお手軽です。$ curl https://s3.amazonaws.com/quotaguard/qgtunnel-latest.tar.gz | tar xz(3) Heroku のダッシュボードから、QuotaGuard Static のダッシュボードに進み、Settings → Setup とクリックします。(4) さらに Tunnel → Create Tunnel とクリックします。(5) Remote Destination にクロール先を、Local Port は 4443、Transparent は true に設定します。Encrypted は設定しません。(6) トンネルが出来ました。127.0.0.1:4443 へのアクセスは destination.example.com:443 へのトンネルになりますTransparent を有効したことにより、destination.example.com の DNS が 127.0.0.1 に上書きされました。destination.example.com:4443 へのアクセスは destination.example.com:443 と等価になりますすでに HTTPS を使っているため、Encrypted は必要ありません(7) selenium-webdriver に与える Chrome のバイナリを qgtunnel でラッピングします。今回は以下のようなシェルスクリプト bin/google-chrome-qgtunnel を作り、selenium-webdriver に指定しました。#!/bin/sh -euexec bin/qgtunnel \"$GOOGLE_CHROME_SHIM\" \"$@\"💡 heroku-buildpack-google-chrome と heroku-buildpack-chromedriver を使っています。環境変数 GOOGLE_CHROME_SHIM は /app/.apt/usr/bin/google-chrome です。(8) 左側の Outbound をクリックし、SOCKS5 url を Heroku の環境変数 QUOTAGUARDSTATIC_URL に上書きします。(9) 左側の Tunnel から Download Configuration をクリックし、.qgtunnel ファイルをリポジトリに commit します。(10) 以上の設定により、destination.example.com:4443 へのアクセスが destination.example.com:443 に変換され、且つ IP アドレスも固定されます。なにかトラブルがあったら Heroku の環境変数 QGTUNNEL_DEBUG に true をセットして、ログを確認すると良いと思います。QuotaGuard Static の注意事項app.json の addons に quotaguardstatic を追加して、Review App を作ると Micro plan $19/mo で作られてしまいます。quotaguardstatic:starter とかにしても同じです。QuotaGuard Static のサポートに聞いたところ、Heroku のアカウント単位で設定を変える必要があるそう。問い合わせが必要です。まとめHeroku の worker Dyno 上で動く、Chrome のクローラで IP アドレスを固定化しました。固定 IP アドレス対応は出来るだけ避けたほうが良いと思いますが、どうしても必要な時にこの記事が参考になれば幸いです。","link":"https://developer.feedforce.jp/entry/2019/04/26/154540","isoDate":"2019-04-26T06:45:40.000Z","dateMiliSeconds":1556261140000,"imageUrl":"https://cdn-ak.f.st-hatena.com/images/fotolife/m/masutaka26/20181113/20181113190345.png","authorName":"masutaka"},{"title":"Heroku の Preboot 機能を深掘りした","content":"\u003cp\u003eこんにちは \u003ca href=\"http://blog.hatena.ne.jp/masutaka26/\" class=\"hatena-id-icon\"\u003e\u003cimg src=\"https://cdn.profile-image.st-hatena.com/users/masutaka26/profile.png\" width=\"16\" height=\"16\" alt=\"\" class=\"hatena-id-icon\"\u003eid:masutaka26\u003c/a\u003e です。\u003c/p\u003e\n\n\u003cp\u003eこの記事は Heroku Advent Calendar 2018 の 12 日目の記事です。\u003c/p\u003e\n\n\u003cp\u003e\u003ciframe src=\"https://hatenablog-parts.com/embed?url=https%3A%2F%2Fqiita.com%2Fadvent-calendar%2F2018%2Fheroku\" title=\"heroku Advent Calendar 2018 - Qiita\" class=\"embed-card embed-webcard\" scrolling=\"no\" frameborder=\"0\" style=\"display: block; width: 100%; height: 155px; max-width: 500px; margin: 10px 0px;\"\u003e\u003c/iframe\u003e\u003ccite class=\"hatena-citation\"\u003e\u003ca href=\"https://qiita.com/advent-calendar/2018/heroku\"\u003eqiita.com\u003c/a\u003e\u003c/cite\u003e\u003c/p\u003e\n\n\u003cp\u003e昨日は \u003ca href=\"https://qiita.com/takuchalle\"\u003e@takuchalle\u003c/a\u003e さんの『\u003ca href=\"https://blog.takuchalle.me/post/2018/12/11/heroku_use_wkhtmltoimage/\"\u003eHeroku で wkhtmltoimage を使う方法\u003c/a\u003e』でした。似たツールの \u003ca href=\"http://www.paulhammond.org/webkit2png/\"\u003ewebkit2png\u003c/a\u003e は使ったことがあります。webkit2png が動作するのは macOS だけですが、\u003ca href=\"https://wkhtmltopdf.org/\"\u003ewkhtmltoimage\u003c/a\u003e は Windows と Linux でも動作するのですね。へぇー。\u003c/p\u003e\n\n\u003cp\u003e先月、Heroku の Preboot 機能を調べる機会がありました。Web 上の日本語記事は Preboot が GA になった 2014 年頃の情報が多く、若干情報が古かったため、2018 年時点の最新の情報をまとめます。\u003c/p\u003e\n\n\u003cul class=\"table-of-contents\"\u003e\n    \u003cli\u003e\u003ca href=\"#Preboot-機能とは何か\"\u003ePreboot 機能とは何か\u003c/a\u003e\u003c/li\u003e\n    \u003cli\u003e\u003ca href=\"#どのように有効にするのか\"\u003eどのように有効にするのか\u003c/a\u003e\u003c/li\u003e\n    \u003cli\u003e\u003ca href=\"#使用する-Procfile\"\u003e使用する Procfile\u003c/a\u003e\u003c/li\u003e\n    \u003cli\u003e\u003ca href=\"#デプロイによる-heroku-ps-の変化\"\u003eデプロイによる heroku ps の変化\u003c/a\u003e\u003c/li\u003e\n    \u003cli\u003e\u003ca href=\"#デプロイ時の挙動\"\u003eデプロイ時の挙動\u003c/a\u003e\u003c/li\u003e\n    \u003cli\u003e\u003ca href=\"#デプロイ時のログ\"\u003eデプロイ時のログ\u003c/a\u003e\u003c/li\u003e\n    \u003cli\u003e\u003ca href=\"#再起動時の挙動\"\u003e再起動時の挙動\u003c/a\u003e\u003c/li\u003e\n    \u003cli\u003e\u003ca href=\"#再起動時のログ\"\u003e再起動時のログ\u003c/a\u003e\u003cul\u003e\n            \u003cli\u003e\u003ca href=\"#Web-dyno-1-台目\"\u003eWeb dyno 1 台目\u003c/a\u003e\u003c/li\u003e\n            \u003cli\u003e\u003ca href=\"#Web-dyno-2-台目\"\u003eWeb dyno 2 台目\u003c/a\u003e\u003c/li\u003e\n        \u003c/ul\u003e\n    \u003c/li\u003e\n    \u003cli\u003e\u003ca href=\"#注意事項\"\u003e注意事項\u003c/a\u003e\u003c/li\u003e\n    \u003cli\u003e\u003ca href=\"#まとめ\"\u003eまとめ\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch2 id=\"Preboot-機能とは何か\"\u003ePreboot 機能とは何か\u003c/h2\u003e\n\n\u003cp\u003e\u003ca href=\"https://devcenter.heroku.com/articles/production-check#dyno-redundancy\"\u003eProduction Check \u003e Dyno redundancy\u003c/a\u003e に書いてあるとおり、Heroku では冗長性確保のため、本番環境の Web Dyno は 2 台以上が奨励されています。\u003c/p\u003e\n\n\u003cblockquote\u003e\u003cp\u003eRunning at least 2 web dynos for any mission-critical app increases the probability that the app will remain available during a catastrophic event. Multiple dynos are also more likely to run on different physical infrastructure (for example, separate AWS Availability Zones), further increasing redundancy.\u003c/p\u003e\u003c/blockquote\u003e\n\n\u003cp\u003eただし、それだけだとデプロイや 1 日 1 回の自動再起動で、処理の遅延（\u003ca href=\"https://devcenter.heroku.com/articles/error-codes#h27-client-request-interrupted\"\u003eH27 - Client Request Interrupted\u003c/a\u003e）や \u003ca href=\"https://devcenter.heroku.com/articles/error-codes#h28-client-connection-idle\"\u003eH28 - Client Connection Idle\u003c/a\u003e が発生することがあります。\u003c/p\u003e\n\n\u003cp\u003e以下のグラフは Dyno Restart のタイミングで H27 と H28 Error が発生している様子です。このグラフはダッシュボードの Metrics から確認できます。\u003c/p\u003e\n\n\u003cp\u003e\u003cspan itemscope itemtype=\"http://schema.org/Photograph\"\u003e\u003cimg src=\"https://cdn-ak.f.st-hatena.com/images/fotolife/m/masutaka26/20181210/20181210191451.png\" alt=\"f:id:masutaka26:20181210191451p:plain\" title=\"f:id:masutaka26:20181210191451p:plain\" class=\"hatena-fotolife\" itemprop=\"image\"\u003e\u003c/span\u003e\u003c/p\u003e\n\n\u003cp\u003eこれを回避できるのが \u003ca href=\"https://devcenter.heroku.com/articles/preboot\"\u003ePreboot\u003c/a\u003e 機能です。\u003c/p\u003e\n\n\u003ch2 id=\"どのように有効にするのか\"\u003eどのように有効にするのか\u003c/h2\u003e\n\n\u003cp\u003eHeroku CLI で有効にできます。\u003c/p\u003e\n\n\u003cpre class=\"code console\" data-lang=\"console\" data-unlink\u003e$ heroku features:enable preboot -a YOUR_APP_NAME\u003c/pre\u003e\n\n\n\u003cp\u003e有効になりました。簡単ですね。\u003c/p\u003e\n\n\u003cpre class=\"code console\" data-lang=\"console\" data-unlink\u003e$ heroku features:info preboot -a YOUR_APP_NAME\n=== preboot\nDescription: Provide seamless web dyno deploys [general]\nDocs:        https://devcenter.heroku.com/articles/preboot\nEnabled:     true\u003c/pre\u003e\n\n\n\u003ch2 id=\"使用する-Procfile\"\u003e使用する Procfile\u003c/h2\u003e\n\n\u003cp\u003e今回はこの Procfile を使います。\u003c/p\u003e\n\n\u003cpre class=\"code lang-apache\" data-lang=\"apache\" data-unlink\u003erelease: bin/rails \u003cspan class=\"synConstant\"\u003edb\u003c/span\u003e:migrate \u003cspan class=\"synConstant\"\u003edb\u003c/span\u003e:seed\n\n\u003cspan class=\"synComment\"\u003e# Web app\u003c/span\u003e\nweb: bin/rails s -p $PORT -e $RAILS_ENV\nworker: PROCESS_TYPE=worker bundle exec sidekiq -C config/sidekiq.yml\n\n\u003cspan class=\"synComment\"\u003e# Ad app\u003c/span\u003e\nad_worker: PROCESS_TYPE=ad_worker bundle exec sidekiq -C config/sidekiq.yml\n\u003c/pre\u003e\n\n\n\u003cp\u003e\u003ccode\u003eweb\u003c/code\u003e, \u003ccode\u003eworker\u003c/code\u003e, \u003ccode\u003ead_worker\u003c/code\u003e という 3 つの process type を定義しています。今回注目する process type は \u003ccode\u003eweb\u003c/code\u003e だけです。\u003c/p\u003e\n\n\u003cp\u003e1 行目で \u003ccode\u003erelease\u003c/code\u003e も定義しているため、デプロイ時には One-Off Dyno\u003csup id=\"fnref:1\"\u003e\u003ca href=\"#fn:1\" rel=\"footnote\"\u003e1\u003c/a\u003e\u003c/sup\u003e で release 処理をしたあと、生成した Slug が Dyno に展開されていきます。\u003c/p\u003e\n\n\u003ch2 id=\"デプロイによる-heroku-ps-の変化\"\u003eデプロイによる heroku ps の変化\u003c/h2\u003e\n\n\u003cp\u003eそれでは \u003ccode\u003e$ watch 'heroku ps -a YOUR_APP_NAME'\u003c/code\u003e しつつ、デプロイの様子を観察していきましょう。macOS では watch コマンドは \u003ccode\u003e$ brew install watch\u003c/code\u003e 等でインストール出来ます。\u003c/p\u003e\n\n\u003cp\u003eWeb Dyno 1 台の場合、release Dyno の実行が終わると、web.1 Dyno のステータスが up → starting → up と変化します。starting 中にリクエストがあると、クライアントは待たされ、前述の H27 や H28 Error が発生します。\u003c/p\u003e\n\n\u003cp\u003e\u003cfigure class=\"figure-image figure-image-fotolife\" title=\"Web Dyno 1 台でデプロイした様子\"\u003e\u003cspan itemscope itemtype=\"http://schema.org/Photograph\"\u003e\u003cimg src=\"https://cdn-ak.f.st-hatena.com/images/fotolife/m/masutaka26/20181211/20181211131034.gif\" alt=\"f:id:masutaka26:20181211131034g:plain\" title=\"f:id:masutaka26:20181211131034g:plain\" class=\"hatena-fotolife\" itemprop=\"image\"\u003e\u003c/span\u003e\u003cfigcaption\u003eWeb Dyno 1 台でデプロイした様子\u003c/figcaption\u003e\u003c/figure\u003e\u003c/p\u003e\n\n\u003cp\u003eWeb Dyno 2 台かつ Preboot 無効でも、基本的に同じです。2 台同時に up → starting → up と変化します。\u003c/p\u003e\n\n\u003cp\u003e\u003cfigure class=\"figure-image figure-image-fotolife\" title=\"Web Dyno 2 台かつ Preboot 無効でデプロイした様子\"\u003e\u003cspan itemscope itemtype=\"http://schema.org/Photograph\"\u003e\u003cimg src=\"https://cdn-ak.f.st-hatena.com/images/fotolife/m/masutaka26/20181211/20181211131128.gif\" alt=\"f:id:masutaka26:20181211131128g:plain\" title=\"f:id:masutaka26:20181211131128g:plain\" class=\"hatena-fotolife\" itemprop=\"image\"\u003e\u003c/span\u003e\u003cfigcaption\u003eWeb Dyno 2 台かつ Preboot 無効でデプロイした様子\u003c/figcaption\u003e\u003c/figure\u003e\u003c/p\u003e\n\n\u003cp\u003eWeb Dyno 2 台かつ Preboot を有効にすると、期待した通り、1 台ずつ up → starting → up に\u003cstrong\u003eなりませんでした・・・！あれ？\u003c/strong\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003cfigure class=\"figure-image figure-image-fotolife\" title=\"Web Dyno 2 台かつ Preboot 有効でデプロイした様子\"\u003e\u003cspan itemscope itemtype=\"http://schema.org/Photograph\"\u003e\u003cimg src=\"https://cdn-ak.f.st-hatena.com/images/fotolife/m/masutaka26/20181211/20181211133556.gif\" alt=\"f:id:masutaka26:20181211133556g:plain\" title=\"f:id:masutaka26:20181211133556g:plain\" class=\"hatena-fotolife\" itemprop=\"image\"\u003e\u003c/span\u003e\u003cfigcaption\u003eWeb Dyno 2 台かつ Preboot 有効でデプロイした様子\u003c/figcaption\u003e\u003c/figure\u003e\u003c/p\u003e\n\n\u003cblockquote\u003e\u003cul\u003e\n\u003cli\u003eLogs will show new dynos starting soon after the slug compile is finished. The output of \u003ccode\u003eheroku ps\u003c/code\u003e will immediately show the state (for example, \u003ccode\u003estarting\u003c/code\u003e or \u003ccode\u003eup\u003c/code\u003e) of the new dynos. Old dynos are still running but won’t appear in \u003ccode\u003eheroku ps\u003c/code\u003e.\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003e\u003ca href=\"https://devcenter.heroku.com/articles/preboot\"\u003ePreboot のドキュメント\u003c/a\u003eによると、heroku ps では確認できないようです。ただしログでは確認できるそう。\u003c/p\u003e\n\n\u003ch2 id=\"デプロイ時の挙動\"\u003eデプロイ時の挙動\u003c/h2\u003e\n\n\u003cblockquote\u003e\u003cul\u003e\n\u003cli\u003eApproximately 3 minutes after the deploy completes (or 2 minutes after your app’s boot timeout limit, which defaults to 1 minute), HTTP requests will start routing to the new dynos and simultaneously stop routing to the old dynos.\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003e遅くともデプロイ完了から約 3 分後、もしくはアプリケーションの起動タイムアウトリミット 2 分（デフォルトは 1 分）後、HTTP リクエストは新 Dyno に Routing されるそうです。\u003c/p\u003e\n\n\u003cblockquote\u003e\u003cul\u003e\n\u003cli\u003eShortly after the new dynos are fully live and serving user requests, the old dynos will be shut down. You’ll see them shut down in the logs as usual.\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003e新 Dyno が完全に起動し、ユーザリクエストを処理するとすぐに、旧 Dyno はシャットダウンされるようです。これもログで確認可能とのこと。\u003c/p\u003e\n\n\u003cp\u003eでは実際にログを見てみましょう。\u003c/p\u003e\n\n\u003ch2 id=\"デプロイ時のログ\"\u003eデプロイ時のログ\u003c/h2\u003e\n\n\u003cp\u003egit push 後まもなく、Web dyno の状態が \u003ccode\u003eup\u003c/code\u003e から \u003ccode\u003estarting\u003c/code\u003e に変わりました。\u003c/p\u003e\n\n\u003cpre class=\"code\" data-lang=\"\" data-unlink\u003eNov 28 14:58:51 heroku[web] notice Restarting\nNov 28 14:58:51 heroku[web] notice State changed from up to starting\nNov 28 14:58:51 heroku[web] notice Restarting\nNov 28 14:58:51 heroku[web] notice State changed from up to starting\u003c/pre\u003e\n\n\n\u003cp\u003e新 Web dyno 2 台で Puma (Web server) がそれぞれ起動を開始しました。\u003c/p\u003e\n\n\u003cpre class=\"code\" data-lang=\"\" data-unlink\u003eNov 28 14:59:17 heroku[web] notice Starting process with command `bin/rails s -p 24256 -e production`\nNov 28 14:59:19 heroku[web] notice Starting process with command `bin/rails s -p 15417 -e production`\nNov 28 14:59:21 app[web] info [heroku-exec] Starting\nNov 28 14:59:22 app[web] info [heroku-exec] Starting\nNov 28 14:59:31 app[web] info =\u0026gt; Booting Puma\nNov 28 14:59:31 app[web] info =\u0026gt; Rails 5.2.1 application starting in production\nNov 28 14:59:31 app[web] info =\u0026gt; Run `rails server -h` for more startup options\nNov 28 14:59:32 app[web] info =\u0026gt; Booting Puma\nNov 28 14:59:32 app[web] info =\u0026gt; Rails 5.2.1 application starting in production\nNov 28 14:59:32 app[web] info =\u0026gt; Run `rails server -h` for more startup options\u003c/pre\u003e\n\n\n\u003cp\u003eWeb dyno の状態が \u003ccode\u003estarting\u003c/code\u003e から \u003ccode\u003eup\u003c/code\u003e に変わりました。まだ Puma は起動しきっていません。\u003c/p\u003e\n\n\u003cpre class=\"code\" data-lang=\"\" data-unlink\u003eNov 28 14:59:33 heroku[web] notice State changed from starting to up\nNov 28 14:59:34 heroku[web] notice State changed from starting to up\u003c/pre\u003e\n\n\n\u003cp\u003e新 Web dyno 1 台で Puma が起動しきりました。問題はありませんが、手元で起動するよりずいぶん遅い気がします。\u003c/p\u003e\n\n\u003cpre class=\"code\" data-lang=\"\" data-unlink\u003eNov 28 15:02:03 app[web] info Puma starting in single mode...\nNov 28 15:02:03 app[web] info * Version 3.12.0 (ruby 2.5.3-p105), codename: Llamas in Pajamas\nNov 28 15:02:03 app[web] info * Min threads: 11, max threads: 11\nNov 28 15:02:03 app[web] info * Environment: production\nNov 28 15:02:03 app[web] info * Listening on tcp://0.0.0.0:24256\nNov 28 15:02:03 app[web] info Use Ctrl-C to stop\u003c/pre\u003e\n\n\n\u003cp\u003e旧 Web dyno 1 台で Puma が終了しました。前述の意訳では約 3 分とあるため合っています。\u003c/p\u003e\n\n\u003cpre class=\"code\" data-lang=\"\" data-unlink\u003eNov 28 15:02:19 heroku[web] notice Stopping all processes with SIGTERM\nNov 28 15:02:19 app[web] info Gracefully stopping, waiting for requests to finish\nNov 28 15:02:19 app[web] info === puma shutdown: 2018-11-28 06:02:19 +0000 ===\nNov 28 15:02:19 app[web] info Goodbye!\nNov 28 15:02:19 app[web] info Exiting\nNov 28 15:02:19 heroku[web] notice Process exited with status 143\u003c/pre\u003e\n\n\n\u003cp\u003eもうひとつの旧 Web dyno 1 台で Puma が終了しました。これも意訳のとおりです。\u003c/p\u003e\n\n\u003cpre class=\"code\" data-lang=\"\" data-unlink\u003eNov 28 15:03:25 heroku[web] notice Stopping all processes with SIGTERM\nNov 28 15:03:25 app[web] info Gracefully stopping, waiting for requests to finish\nNov 28 15:03:25 app[web] info === puma shutdown: 2018-11-28 06:03:25 +0000 ===\nNov 28 15:03:25 app[web] info Goodbye!\nNov 28 15:03:25 app[web] info Exiting\nNov 28 15:03:25 heroku[web] notice Process exited with status 143\u003c/pre\u003e\n\n\n\u003cp\u003eもうひとつの新 Web dyno 1 台で Puma が起動しきりました。\u003ccode\u003eBooting Puma\u003c/code\u003e からずいぶんと時間がかかりました。\u003c/p\u003e\n\n\u003cpre class=\"code\" data-lang=\"\" data-unlink\u003eNov 28 15:05:08 app[web] info Puma starting in single mode...\nNov 28 15:05:08 app[web] info * Version 3.12.0 (ruby 2.5.3-p105), codename: Llamas in Pajamas\nNov 28 15:05:08 app[web] info * Min threads: 11, max threads: 11\nNov 28 15:05:08 app[web] info * Environment: production\nNov 28 15:05:08 app[web] info * Listening on tcp://0.0.0.0:15417\nNov 28 15:05:08 app[web] info Use Ctrl-C to stop\u003c/pre\u003e\n\n\n\u003cp\u003ePuma の起動に時間がかかるのは謎ですが、Preboot のドキュメントと相違ないと理解しました。\u003c/p\u003e\n\n\u003ch2 id=\"再起動時の挙動\"\u003e再起動時の挙動\u003c/h2\u003e\n\n\u003cp\u003e再起動時の挙動も確認します。\u003c/p\u003e\n\n\u003cp\u003eHeroku ではアプリケーションの健全性を維持するため、\u003ca href=\"https://devcenter.heroku.com/articles/dynos#automatic-dyno-restarts\"\u003eDyno は 1 日に 1 回、自動的に再起動します\u003c/a\u003e。Dyno は差し替えられるため、ローカルファイルシステムの変更はすべて破棄されます。\u003c/p\u003e\n\n\u003cblockquote\u003e\u003cp\u003eThe new dynos will start receiving requests as soon as it binds to its assigned port. At this point, both the old and new dynos are receiving requests.\u003c/p\u003e\u003c/blockquote\u003e\n\n\u003cp\u003e新 Dyno は割り当てられたポートにバインドされると、すぐにリクエストを受信し始めます。この時点で、新旧の Dyno がリクエストを受信するそう。\u003c/p\u003e\n\n\u003cblockquote\u003e\u003cp\u003eApproximately 4 to 6 minutes after the restart is invoked, the old dynos will be shut down. You’ll see them shut down in the logs as usual.\u003c/p\u003e\u003c/blockquote\u003e\n\n\u003cp\u003e再起動が行われてから、約 4~6 分後に旧 Dyno がシャットダウンされるようです。これもログで確認可能とのこと。\u003c/p\u003e\n\n\u003cp\u003ePreboot が GA になった 2014 年頃は、まだ 1 日 1 回の再起動には対応していないようでした。現在は対応しているようです。\u003c/p\u003e\n\n\u003ch2 id=\"再起動時のログ\"\u003e再起動時のログ\u003c/h2\u003e\n\n\u003cp\u003e結論から書くと、1 台目が再起動し終えてから 2 台目が再起動していました。再起動においても、ドキュメントの通りに Preboot が機能しているようです。\u003c/p\u003e\n\n\u003ch3 id=\"Web-dyno-1-台目\"\u003eWeb dyno 1 台目\u003c/h3\u003e\n\n\u003cp\u003eWeb dyno 1 台の状態が \u003ccode\u003eup\u003c/code\u003e から \u003ccode\u003estarting\u003c/code\u003e に変わりました。\u003c/p\u003e\n\n\u003cpre class=\"code\" data-lang=\"\" data-unlink\u003eNov 30 11:41:22 heroku[web] notice Cycling\nNov 30 11:41:22 heroku[web] notice State changed from up to starting\u003c/pre\u003e\n\n\n\u003cp\u003e新 Web dyno 1 台で Puma が起動を開始しました。\u003c/p\u003e\n\n\u003cpre class=\"code\" data-lang=\"\" data-unlink\u003eNov 30 11:41:42 heroku[web] notice Starting process with command `bin/rails s -p 32434 -e production`\nNov 30 11:41:44 app[web] info [heroku-exec] Starting\nNov 30 11:41:50 app[web] info =\u0026gt; Booting Puma\nNov 30 11:41:50 app[web] info =\u0026gt; Rails 5.2.1.1 application starting in production\nNov 30 11:41:50 app[web] info =\u0026gt; Run `rails server -h` for more startup options\u003c/pre\u003e\n\n\n\u003cp\u003eWeb dyno 1 台の状態が \u003ccode\u003estarting\u003c/code\u003e から \u003ccode\u003eup\u003c/code\u003e に変わりました。まだ Puma は起動しきっていません。\u003c/p\u003e\n\n\u003cpre class=\"code\" data-lang=\"\" data-unlink\u003eNov 30 11:41:51 heroku[web] notice State changed from starting to up\u003c/pre\u003e\n\n\n\u003cp\u003e新 Web dyno 1 台で Puma が起動しきりました。相変わらず時間がかかります。\u003c/p\u003e\n\n\u003cpre class=\"code\" data-lang=\"\" data-unlink\u003eNov 30 11:45:45 app[web] info Puma starting in single mode...\nNov 30 11:45:45 app[web] info * Version 3.12.0 (ruby 2.5.3-p105), codename: Llamas in Pajamas\nNov 30 11:45:45 app[web] info * Min threads: 11, max threads: 11\nNov 30 11:45:45 app[web] info * Environment: production\nNov 30 11:45:45 app[web] info * Listening on tcp://0.0.0.0:32434\nNov 30 11:45:45 app[web] info Use Ctrl-C to stop\u003c/pre\u003e\n\n\n\u003cp\u003e旧 Web dyno 1 台で Puma が終了しました。前述の意訳では約 4~6 分後とありましたが、間を置かずに終了しました。\u003c/p\u003e\n\n\u003cpre class=\"code\" data-lang=\"\" data-unlink\u003eNov 30 11:45:55 heroku[web] notice Stopping all processes with SIGTERM\nNov 30 11:45:56 app[web] info Gracefully stopping, waiting for requests to finish\nNov 30 11:45:56 app[web] info === puma shutdown: 2018-11-30 02:45:55 +0000 ===\nNov 30 11:45:56 app[web] info Goodbye!\nNov 30 11:45:56 app[web] info Exiting\nNov 30 11:45:56 heroku[web] notice Process exited with status 143\u003c/pre\u003e\n\n\n\u003ch3 id=\"Web-dyno-2-台目\"\u003eWeb dyno 2 台目\u003c/h3\u003e\n\n\u003cp\u003eもうひとつの Web dyno 1 台の状態が \u003ccode\u003eup\u003c/code\u003e から \u003ccode\u003estarting\u003c/code\u003e に変わりました。14 分くらい差があります。\u003ca href=\"https://devcenter.heroku.com/articles/dynos#automatic-dyno-restarts\"\u003e最大 216 分のランダムな差がある\u003c/a\u003eようなので、記載通りです。\u003c/p\u003e\n\n\u003cpre class=\"code\" data-lang=\"\" data-unlink\u003eNov 30 12:00:41 heroku[web] notice Cycling\nNov 30 12:00:41 heroku[web] notice State changed from up to starting\u003c/pre\u003e\n\n\n\u003cp\u003e新 Web dyno 1 台で Puma が起動を開始しました。\u003c/p\u003e\n\n\u003cpre class=\"code\" data-lang=\"\" data-unlink\u003eNov 30 12:00:59 heroku[web] notice Starting process with command `bin/rails s -p 16965 -e production`\nNov 30 12:01:01 app[web] info [heroku-exec] Starting\nNov 30 12:01:08 app[web] info =\u0026gt; Booting Puma\nNov 30 12:01:08 app[web] info =\u0026gt; Rails 5.2.1.1 application starting in production\nNov 30 12:01:08 app[web] info =\u0026gt; Run `rails server -h` for more startup options\u003c/pre\u003e\n\n\n\u003cp\u003eWeb dyno 1 台の状態が \u003ccode\u003estarting\u003c/code\u003e から \u003ccode\u003eup\u003c/code\u003e に変わりました。まだ Puma は起動しきっていません。\u003c/p\u003e\n\n\u003cpre class=\"code\" data-lang=\"\" data-unlink\u003eNov 30 12:01:10 heroku[web] notice State changed from starting to up\u003c/pre\u003e\n\n\n\u003cp\u003e新 Web dyno 1 台で Puma が起動しきりました。今回は時間がかかりませんでした。\u003c/p\u003e\n\n\u003cpre class=\"code\" data-lang=\"\" data-unlink\u003eNov 30 12:01:15 app[web] info Puma starting in single mode...\nNov 30 12:01:15 app[web] info * Version 3.12.0 (ruby 2.5.3-p105), codename: Llamas in Pajamas\nNov 30 12:01:15 app[web] info * Min threads: 11, max threads: 11\nNov 30 12:01:15 app[web] info * Environment: production\nNov 30 12:01:15 app[web] info * Listening on tcp://0.0.0.0:16965\nNov 30 12:01:15 app[web] info Use Ctrl-C to stop\u003c/pre\u003e\n\n\n\u003cp\u003e旧 Web dyno 1 台で Puma が終了しました。今度は時間がかかりました。前述の意訳では約 4~6 分後とあるため合っています。\u003c/p\u003e\n\n\u003cpre class=\"code\" data-lang=\"\" data-unlink\u003eNov 30 12:05:14 heroku[web] notice Stopping all processes with SIGTERM\nNov 30 12:05:14 app[web] info Gracefully stopping, waiting for requests to finish\nNov 30 12:05:14 app[web] info === puma shutdown: 2018-11-30 03:05:14 +0000 ===\nNov 30 12:05:14 app[web] info Goodbye!\nNov 30 12:05:14 app[web] info Exiting\nNov 30 12:05:14 heroku[web] notice Process exited with status 143\u003c/pre\u003e\n\n\n\u003ch2 id=\"注意事項\"\u003e注意事項\u003c/h2\u003e\n\n\u003cp\u003ePreboot を有効にしてデプロイすると、無効時よりも時間をかけて Dyno が差し替わります。全ての Dyno に反映されるまで数分かかることもあるようです。この点はチームで把握しておく必要があります。\u003c/p\u003e\n\n\u003cp\u003e最大 3 分間、新旧の Dyno が重複するため、Add-on の同時接続数の制限に達する可能性があります。Heroku Postgres の場合は \u003ca href=\"https://github.com/heroku/heroku-buildpack-pgbouncer\"\u003epgbouncer buildpack\u003c/a\u003e を使うことが奨励されています。\u003c/p\u003e\n\n\u003cp\u003e新旧の Dyno が混在することにより、一度のデプロイで DB schema とアプリケーションコードを変更すると、不具合が発生する可能性があります。Preboot 機能を一旦無効にすることを勧めています。でも、Procfile に \u003ccode\u003erelease\u003c/code\u003e process type を定義していれば同じなので、個人的には気にならないですね。\u003c/p\u003e\n\n\u003cp\u003ePreboot 機能を使うためには、\u003cstrong\u003eDyno type が Standard-1X 以上\u003c/strong\u003eである必要があります。Dyno type が \u003ccode\u003eFree\u003c/code\u003e と \u003ccode\u003eHobby\u003c/code\u003e では Preboot を有効に出来ません。\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003ePreboot が適用されるのは Web Dyno だけ\u003c/strong\u003eです。自分で定義した \u003ccode\u003eworker\u003c/code\u003e Dyno 等は対象外です。\u003c/p\u003e\n\n\u003ch2 id=\"まとめ\"\u003eまとめ\u003c/h2\u003e\n\n\u003cp\u003eHeroku の Preboot 機能を深掘りし、有効にする必要性を理解しました。\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eWeb Dyno を 2 台以上にしたら Preboot を有効にすると良さそう\u003c/li\u003e\n\u003cli\u003e前述の「注意事項」には留意したほうが良い\u003c/li\u003e\n\u003c/ul\u003e\n\n\n\u003cp\u003eしかし、こんなに長い記事になるとは...。\u003c/p\u003e\n\n\u003cp\u003e明日の \u003ca href=\"https://qiita.com/advent-calendar/2018/heroku\"\u003eheroku Advent Calendar 2018\u003c/a\u003e はまたまた \u003ca href=\"http://blog.hatena.ne.jp/masutaka26/\" class=\"hatena-id-icon\"\u003e\u003cimg src=\"https://cdn.profile-image.st-hatena.com/users/masutaka26/profile.png\" width=\"16\" height=\"16\" alt=\"\" class=\"hatena-id-icon\"\u003eid:masutaka26\u003c/a\u003e です。Bitbar の便利な Heroku plugin を紹介してくれるみたいです。お楽しみに。\u003c/p\u003e\n\u003cdiv class=\"footnotes\"\u003e\n\u003chr/\u003e\n\u003col\u003e\n\u003cli id=\"fn:1\"\u003e\n\u003cp\u003eこのような使い捨ての Dyno を \u003ca href=\"https://devcenter.heroku.com/articles/one-off-dynos\"\u003eOne-Off Dyno\u003c/a\u003e と呼びます。heroku run で使われる Dyno もそうです。\u003ca href=\"#fnref:1\" rev=\"footnote\"\u003e\u0026#8617;\u003c/a\u003e\u003c/p\u003e\u003c/li\u003e\n\u003c/ol\u003e\n\u003c/div\u003e\n\n","contentSnippet":"こんにちは id:masutaka26 です。この記事は Heroku Advent Calendar 2018 の 12 日目の記事です。qiita.com昨日は @takuchalle さんの『Heroku で wkhtmltoimage を使う方法』でした。似たツールの webkit2png は使ったことがあります。webkit2png が動作するのは macOS だけですが、wkhtmltoimage は Windows と Linux でも動作するのですね。へぇー。先月、Heroku の Preboot 機能を調べる機会がありました。Web 上の日本語記事は Preboot が GA になった 2014 年頃の情報が多く、若干情報が古かったため、2018 年時点の最新の情報をまとめます。Preboot 機能とは何かどのように有効にするのか使用する Procfileデプロイによる heroku ps の変化デプロイ時の挙動デプロイ時のログ再起動時の挙動再起動時のログWeb dyno 1 台目Web dyno 2 台目注意事項まとめPreboot 機能とは何かProduction Check \u003e Dyno redundancy に書いてあるとおり、Heroku では冗長性確保のため、本番環境の Web Dyno は 2 台以上が奨励されています。Running at least 2 web dynos for any mission-critical app increases the probability that the app will remain available during a catastrophic event. Multiple dynos are also more likely to run on different physical infrastructure (for example, separate AWS Availability Zones), further increasing redundancy.ただし、それだけだとデプロイや 1 日 1 回の自動再起動で、処理の遅延（H27 - Client Request Interrupted）や H28 - Client Connection Idle が発生することがあります。以下のグラフは Dyno Restart のタイミングで H27 と H28 Error が発生している様子です。このグラフはダッシュボードの Metrics から確認できます。これを回避できるのが Preboot 機能です。どのように有効にするのかHeroku CLI で有効にできます。$ heroku features:enable preboot -a YOUR_APP_NAME有効になりました。簡単ですね。$ heroku features:info preboot -a YOUR_APP_NAME=== prebootDescription: Provide seamless web dyno deploys [general]Docs:        https://devcenter.heroku.com/articles/prebootEnabled:     true使用する Procfile今回はこの Procfile を使います。release: bin/rails db:migrate db:seed# Web appweb: bin/rails s -p $PORT -e $RAILS_ENVworker: PROCESS_TYPE=worker bundle exec sidekiq -C config/sidekiq.yml# Ad appad_worker: PROCESS_TYPE=ad_worker bundle exec sidekiq -C config/sidekiq.ymlweb, worker, ad_worker という 3 つの process type を定義しています。今回注目する process type は web だけです。1 行目で release も定義しているため、デプロイ時には One-Off Dyno1 で release 処理をしたあと、生成した Slug が Dyno に展開されていきます。デプロイによる heroku ps の変化それでは $ watch 'heroku ps -a YOUR_APP_NAME' しつつ、デプロイの様子を観察していきましょう。macOS では watch コマンドは $ brew install watch 等でインストール出来ます。Web Dyno 1 台の場合、release Dyno の実行が終わると、web.1 Dyno のステータスが up → starting → up と変化します。starting 中にリクエストがあると、クライアントは待たされ、前述の H27 や H28 Error が発生します。Web Dyno 1 台でデプロイした様子Web Dyno 2 台かつ Preboot 無効でも、基本的に同じです。2 台同時に up → starting → up と変化します。Web Dyno 2 台かつ Preboot 無効でデプロイした様子Web Dyno 2 台かつ Preboot を有効にすると、期待した通り、1 台ずつ up → starting → up になりませんでした・・・！あれ？Web Dyno 2 台かつ Preboot 有効でデプロイした様子Logs will show new dynos starting soon after the slug compile is finished. The output of heroku ps will immediately show the state (for example, starting or up) of the new dynos. Old dynos are still running but won’t appear in heroku ps.Preboot のドキュメントによると、heroku ps では確認できないようです。ただしログでは確認できるそう。デプロイ時の挙動Approximately 3 minutes after the deploy completes (or 2 minutes after your app’s boot timeout limit, which defaults to 1 minute), HTTP requests will start routing to the new dynos and simultaneously stop routing to the old dynos.遅くともデプロイ完了から約 3 分後、もしくはアプリケーションの起動タイムアウトリミット 2 分（デフォルトは 1 分）後、HTTP リクエストは新 Dyno に Routing されるそうです。Shortly after the new dynos are fully live and serving user requests, the old dynos will be shut down. You’ll see them shut down in the logs as usual.新 Dyno が完全に起動し、ユーザリクエストを処理するとすぐに、旧 Dyno はシャットダウンされるようです。これもログで確認可能とのこと。では実際にログを見てみましょう。デプロイ時のログgit push 後まもなく、Web dyno の状態が up から starting に変わりました。Nov 28 14:58:51 heroku[web] notice RestartingNov 28 14:58:51 heroku[web] notice State changed from up to startingNov 28 14:58:51 heroku[web] notice RestartingNov 28 14:58:51 heroku[web] notice State changed from up to starting新 Web dyno 2 台で Puma (Web server) がそれぞれ起動を開始しました。Nov 28 14:59:17 heroku[web] notice Starting process with command `bin/rails s -p 24256 -e production`Nov 28 14:59:19 heroku[web] notice Starting process with command `bin/rails s -p 15417 -e production`Nov 28 14:59:21 app[web] info [heroku-exec] StartingNov 28 14:59:22 app[web] info [heroku-exec] StartingNov 28 14:59:31 app[web] info =\u003e Booting PumaNov 28 14:59:31 app[web] info =\u003e Rails 5.2.1 application starting in productionNov 28 14:59:31 app[web] info =\u003e Run `rails server -h` for more startup optionsNov 28 14:59:32 app[web] info =\u003e Booting PumaNov 28 14:59:32 app[web] info =\u003e Rails 5.2.1 application starting in productionNov 28 14:59:32 app[web] info =\u003e Run `rails server -h` for more startup optionsWeb dyno の状態が starting から up に変わりました。まだ Puma は起動しきっていません。Nov 28 14:59:33 heroku[web] notice State changed from starting to upNov 28 14:59:34 heroku[web] notice State changed from starting to up新 Web dyno 1 台で Puma が起動しきりました。問題はありませんが、手元で起動するよりずいぶん遅い気がします。Nov 28 15:02:03 app[web] info Puma starting in single mode...Nov 28 15:02:03 app[web] info * Version 3.12.0 (ruby 2.5.3-p105), codename: Llamas in PajamasNov 28 15:02:03 app[web] info * Min threads: 11, max threads: 11Nov 28 15:02:03 app[web] info * Environment: productionNov 28 15:02:03 app[web] info * Listening on tcp://0.0.0.0:24256Nov 28 15:02:03 app[web] info Use Ctrl-C to stop旧 Web dyno 1 台で Puma が終了しました。前述の意訳では約 3 分とあるため合っています。Nov 28 15:02:19 heroku[web] notice Stopping all processes with SIGTERMNov 28 15:02:19 app[web] info Gracefully stopping, waiting for requests to finishNov 28 15:02:19 app[web] info === puma shutdown: 2018-11-28 06:02:19 +0000 ===Nov 28 15:02:19 app[web] info Goodbye!Nov 28 15:02:19 app[web] info ExitingNov 28 15:02:19 heroku[web] notice Process exited with status 143もうひとつの旧 Web dyno 1 台で Puma が終了しました。これも意訳のとおりです。Nov 28 15:03:25 heroku[web] notice Stopping all processes with SIGTERMNov 28 15:03:25 app[web] info Gracefully stopping, waiting for requests to finishNov 28 15:03:25 app[web] info === puma shutdown: 2018-11-28 06:03:25 +0000 ===Nov 28 15:03:25 app[web] info Goodbye!Nov 28 15:03:25 app[web] info ExitingNov 28 15:03:25 heroku[web] notice Process exited with status 143もうひとつの新 Web dyno 1 台で Puma が起動しきりました。Booting Puma からずいぶんと時間がかかりました。Nov 28 15:05:08 app[web] info Puma starting in single mode...Nov 28 15:05:08 app[web] info * Version 3.12.0 (ruby 2.5.3-p105), codename: Llamas in PajamasNov 28 15:05:08 app[web] info * Min threads: 11, max threads: 11Nov 28 15:05:08 app[web] info * Environment: productionNov 28 15:05:08 app[web] info * Listening on tcp://0.0.0.0:15417Nov 28 15:05:08 app[web] info Use Ctrl-C to stopPuma の起動に時間がかかるのは謎ですが、Preboot のドキュメントと相違ないと理解しました。再起動時の挙動再起動時の挙動も確認します。Heroku ではアプリケーションの健全性を維持するため、Dyno は 1 日に 1 回、自動的に再起動します。Dyno は差し替えられるため、ローカルファイルシステムの変更はすべて破棄されます。The new dynos will start receiving requests as soon as it binds to its assigned port. At this point, both the old and new dynos are receiving requests.新 Dyno は割り当てられたポートにバインドされると、すぐにリクエストを受信し始めます。この時点で、新旧の Dyno がリクエストを受信するそう。Approximately 4 to 6 minutes after the restart is invoked, the old dynos will be shut down. You’ll see them shut down in the logs as usual.再起動が行われてから、約 4~6 分後に旧 Dyno がシャットダウンされるようです。これもログで確認可能とのこと。Preboot が GA になった 2014 年頃は、まだ 1 日 1 回の再起動には対応していないようでした。現在は対応しているようです。再起動時のログ結論から書くと、1 台目が再起動し終えてから 2 台目が再起動していました。再起動においても、ドキュメントの通りに Preboot が機能しているようです。Web dyno 1 台目Web dyno 1 台の状態が up から starting に変わりました。Nov 30 11:41:22 heroku[web] notice CyclingNov 30 11:41:22 heroku[web] notice State changed from up to starting新 Web dyno 1 台で Puma が起動を開始しました。Nov 30 11:41:42 heroku[web] notice Starting process with command `bin/rails s -p 32434 -e production`Nov 30 11:41:44 app[web] info [heroku-exec] StartingNov 30 11:41:50 app[web] info =\u003e Booting PumaNov 30 11:41:50 app[web] info =\u003e Rails 5.2.1.1 application starting in productionNov 30 11:41:50 app[web] info =\u003e Run `rails server -h` for more startup optionsWeb dyno 1 台の状態が starting から up に変わりました。まだ Puma は起動しきっていません。Nov 30 11:41:51 heroku[web] notice State changed from starting to up新 Web dyno 1 台で Puma が起動しきりました。相変わらず時間がかかります。Nov 30 11:45:45 app[web] info Puma starting in single mode...Nov 30 11:45:45 app[web] info * Version 3.12.0 (ruby 2.5.3-p105), codename: Llamas in PajamasNov 30 11:45:45 app[web] info * Min threads: 11, max threads: 11Nov 30 11:45:45 app[web] info * Environment: productionNov 30 11:45:45 app[web] info * Listening on tcp://0.0.0.0:32434Nov 30 11:45:45 app[web] info Use Ctrl-C to stop旧 Web dyno 1 台で Puma が終了しました。前述の意訳では約 4~6 分後とありましたが、間を置かずに終了しました。Nov 30 11:45:55 heroku[web] notice Stopping all processes with SIGTERMNov 30 11:45:56 app[web] info Gracefully stopping, waiting for requests to finishNov 30 11:45:56 app[web] info === puma shutdown: 2018-11-30 02:45:55 +0000 ===Nov 30 11:45:56 app[web] info Goodbye!Nov 30 11:45:56 app[web] info ExitingNov 30 11:45:56 heroku[web] notice Process exited with status 143Web dyno 2 台目もうひとつの Web dyno 1 台の状態が up から starting に変わりました。14 分くらい差があります。最大 216 分のランダムな差があるようなので、記載通りです。Nov 30 12:00:41 heroku[web] notice CyclingNov 30 12:00:41 heroku[web] notice State changed from up to starting新 Web dyno 1 台で Puma が起動を開始しました。Nov 30 12:00:59 heroku[web] notice Starting process with command `bin/rails s -p 16965 -e production`Nov 30 12:01:01 app[web] info [heroku-exec] StartingNov 30 12:01:08 app[web] info =\u003e Booting PumaNov 30 12:01:08 app[web] info =\u003e Rails 5.2.1.1 application starting in productionNov 30 12:01:08 app[web] info =\u003e Run `rails server -h` for more startup optionsWeb dyno 1 台の状態が starting から up に変わりました。まだ Puma は起動しきっていません。Nov 30 12:01:10 heroku[web] notice State changed from starting to up新 Web dyno 1 台で Puma が起動しきりました。今回は時間がかかりませんでした。Nov 30 12:01:15 app[web] info Puma starting in single mode...Nov 30 12:01:15 app[web] info * Version 3.12.0 (ruby 2.5.3-p105), codename: Llamas in PajamasNov 30 12:01:15 app[web] info * Min threads: 11, max threads: 11Nov 30 12:01:15 app[web] info * Environment: productionNov 30 12:01:15 app[web] info * Listening on tcp://0.0.0.0:16965Nov 30 12:01:15 app[web] info Use Ctrl-C to stop旧 Web dyno 1 台で Puma が終了しました。今度は時間がかかりました。前述の意訳では約 4~6 分後とあるため合っています。Nov 30 12:05:14 heroku[web] notice Stopping all processes with SIGTERMNov 30 12:05:14 app[web] info Gracefully stopping, waiting for requests to finishNov 30 12:05:14 app[web] info === puma shutdown: 2018-11-30 03:05:14 +0000 ===Nov 30 12:05:14 app[web] info Goodbye!Nov 30 12:05:14 app[web] info ExitingNov 30 12:05:14 heroku[web] notice Process exited with status 143注意事項Preboot を有効にしてデプロイすると、無効時よりも時間をかけて Dyno が差し替わります。全ての Dyno に反映されるまで数分かかることもあるようです。この点はチームで把握しておく必要があります。最大 3 分間、新旧の Dyno が重複するため、Add-on の同時接続数の制限に達する可能性があります。Heroku Postgres の場合は pgbouncer buildpack を使うことが奨励されています。新旧の Dyno が混在することにより、一度のデプロイで DB schema とアプリケーションコードを変更すると、不具合が発生する可能性があります。Preboot 機能を一旦無効にすることを勧めています。でも、Procfile に release process type を定義していれば同じなので、個人的には気にならないですね。Preboot 機能を使うためには、Dyno type が Standard-1X 以上である必要があります。Dyno type が Free と Hobby では Preboot を有効に出来ません。Preboot が適用されるのは Web Dyno だけです。自分で定義した worker Dyno 等は対象外です。まとめHeroku の Preboot 機能を深掘りし、有効にする必要性を理解しました。Web Dyno を 2 台以上にしたら Preboot を有効にすると良さそう前述の「注意事項」には留意したほうが良いしかし、こんなに長い記事になるとは...。明日の heroku Advent Calendar 2018 はまたまた id:masutaka26 です。Bitbar の便利な Heroku plugin を紹介してくれるみたいです。お楽しみに。このような使い捨ての Dyno を One-Off Dyno と呼びます。heroku run で使われる Dyno もそうです。↩","link":"https://developer.feedforce.jp/entry/2018/12/12/120000","isoDate":"2018-12-12T03:00:00.000Z","dateMiliSeconds":1544583600000,"imageUrl":"https://cdn-ak.f.st-hatena.com/images/fotolife/m/masutaka26/20181113/20181113190345.png","authorName":"masutaka"},{"title":"ジム通いと食生活改善を５ヶ月続けたので中間報告をする","content":"ｺﾞﾎｺﾞﾎ\u0026hellip;この記事は feedforce Advent Calendar 2018 の 7 日目の記事です。健康的な記事を書くつもりが、月曜日から水曜日まで寝込んでいました（白目）。\n6 日目はふねさんの『リモート勤務が出来るようになったので煮込みがはかどる話 』でした。\n煮込み料理( ・∀・)ｲｲ!!ですね。無職時代に、カレーを作りながら採用面接向けの課題をやっていたことを思い出しました。(ToT)\nそんな私の記事は [2016-12-14-1] と [2017-12-19-1] に引き続き、またまた健康・生活に関する記事です。40 を超えると、健康の話しかしませんよね？\nさっそく中間報告 トレーナー曰く「今のところ順調に筋肉量が増え、体脂肪率が減っている」とのこと。さすがに CM みたいに極端には結果は出ないですね。初期の体脂肪率が 31.4% とかはおかしいので機械の故障でしょう\u0026hellip;。\n※ ジムで InBody を使っての計測\n自宅では 2014 年から Withings の体重計で毎朝測っています。\n※ Withings Smart Body Analyzer での計測\n③の傾斜角が今回の成果になります。2kg 程度ですが、私の身長は 161cm ほどなので、これでも体つきに変化が出ています。筋肉量を増やしつつ、体重が減っていますからね。\n①は朝食を MCT オイル＆バター＆コーヒーにしていた頃です。筋トレはしていません。\n②は一週間でこの変化です。一週間熱が出続けて寝込んだらこうなりました。出社したら痩せたと言われました。\nどちらも見事にリバウンドしていますね\u0026hellip;。\nなぜまたジムに通い始めたか 週に 2〜3 回、晩酌する習慣がついてしまい、人生最大の体重と体脂肪率になったからです。\n実は 2 年前まで近所のジムに通っていました。あまり合わずに 3 ヶ月ほどで辞めた後、近所のエニタイムフィットネス に行こうと思い 2 年が経ってしまいました。\nこれ以上延ばすのはまずいと思い、申し込んだのが [2018-06-30-1] というわけです。\nジムに行く頻度と内容 週 3 回目標で、最低週 2 回で続けています。もう 6 ヶ月目です。雨の日も風の日も台風の日も通います。何も考えずに通うことが重要です。「一度決めたことを忠実に繰り返してしまう」という私の性格に大変助かっています。","contentSnippet":"ｺﾞﾎｺﾞﾎ…この記事は feedforce Advent Calendar 2018 の 7 日目の記事です。健康的な記事を書くつもりが、月曜日から水曜日まで寝込んでいました（白目）。6 日目はふねさんの『リモート勤務が出来るようになったので煮込みがはかどる話 』でした。煮込み料理( ・∀・)ｲｲ!!ですね。無職時代に、カレーを作りながら採用面接向けの課題をやっていたことを思い出しました。(ToT)そんな私の記事は [2016-12-14-1] と [2017-12-19-1] に引き続き、またまた健康・生活に関する記事です。40 を超えると、健康の話しかしませんよね？さっそく中間報告 トレーナー曰く「今のところ順調に筋肉量が増え、体脂肪率が減っている」とのこと。さすがに CM みたいに極端には結果は出ないですね。初期の体脂肪率が 31.4% とかはおかしいので機械の故障でしょう…。※ ジムで InBody を使っての計測自宅では 2014 年から Withings の体重計で毎朝測っています。※ Withings Smart Body Analyzer での計測③の傾斜角が今回の成果になります。2kg 程度ですが、私の身長は 161cm ほどなので、これでも体つきに変化が出ています。筋肉量を増やしつつ、体重が減っていますからね。①は朝食を MCT オイル＆バター＆コーヒーにしていた頃です。筋トレはしていません。②は一週間でこの変化です。一週間熱が出続けて寝込んだらこうなりました。出社したら痩せたと言われました。どちらも見事にリバウンドしていますね…。なぜまたジムに通い始めたか 週に 2〜3 回、晩酌する習慣がついてしまい、人生最大の体重と体脂肪率になったからです。実は 2 年前まで近所のジムに通っていました。あまり合わずに 3 ヶ月ほどで辞めた後、近所のエニタイムフィットネス に行こうと思い 2 年が経ってしまいました。これ以上延ばすのはまずいと思い、申し込んだのが [2018-06-30-1] というわけです。ジムに行く頻度と内容 週 3 回目標で、最低週 2 回で続けています。もう 6 ヶ月目です。雨の日も風の日も台風の日も通います。何も考えずに通うことが重要です。「一度決めたことを忠実に繰り返してしまう」という私の性格に大変助かっています。","link":"https://masutaka.net/2018-12-07-1/","isoDate":"2018-12-07T00:00:00.000Z","dateMiliSeconds":1544140800000,"authorName":"masutaka"},{"title":"『Heroku と EC Booster と私』と『Heroku ちょこっと Deep Dive』という発表をした","content":"\u003cp\u003eこんにちは。増田（\u003ca href=\"http://blog.hatena.ne.jp/masutaka26/\" class=\"hatena-id-icon\"\u003e\u003cimg src=\"https://cdn.profile-image.st-hatena.com/users/masutaka26/profile.png\" width=\"16\" height=\"16\" alt=\"\" class=\"hatena-id-icon\"\u003eid:masutaka26\u003c/a\u003e）です。以前住んだ街を訪れるのが趣味です。\u003c/p\u003e\n\n\u003cp\u003e週次の社内勉強会 \u003ca href=\"https://developer.feedforce.jp/archive/category/FFTT\"\u003eFFTT\u003c/a\u003e で『Heroku と EC Booster と私』と『Heroku ちょこっと Deep Dive』という発表をしました。\u003c/p\u003e\n\n\u003cp\u003eまさかのダブルタイトル・・・！ スライドを作っていたら別々の話のような気がして、こうなりました。\u003c/p\u003e\n\n\u003ch2\u003e発表の内容\u003c/h2\u003e\n\n\u003cscript async class=\"speakerdeck-embed\" data-id=\"868618a13fbb4e8d8baf8f00c1f2e962\" data-ratio=\"1.33333333333333\" src=\"//speakerdeck.com/assets/embed.js\"\u003e\u003c/script\u003e\n\n\n\u003cp\u003e『Heroku と EC Booster と私』は主に社内向けの話です。最近の EC Booster のインフラを紹介する機会がなかったので、今回の発表の場を借りました。\u003c/p\u003e\n\n\u003cp\u003e『Heroku ちょこっと Deep Dive』では Heroku の Slug について、ちょこっと調べました。\u003c/p\u003e\n\n\u003cp\u003eHeroku では \u003ca href=\"https://jp.heroku.com/dynos\"\u003eDyno\u003c/a\u003e という軽量コンテナ上で、アプリケーションが動作します。アプリケーションは \u003ca href=\"https://devcenter.heroku.com/articles/slug-compiler\"\u003eSlug というパッケージに固められて\u003c/a\u003eいます。Slug にはアプリケーションコードの他に Buildpack や、Ruby なら bundle install されたライブラリ等が含められています。\u003c/p\u003e\n\n\u003cp\u003e最近 Heroku を Terraform で管理し始めた時に、\u003ca href=\"https://www.terraform.io/docs/providers/heroku/r/slug.html\"\u003eheroku_slug\u003c/a\u003e というリソースを見つけました。使いはしなかったのですが、自分で Slug を変更できる感覚がよく分からなくて調べたことが始まりでした。\u003c/p\u003e\n\n\u003cp\u003eまさか Scratch から作れるとは思いませんでしたし、Slug の中身やサイズの増減を把握する方法が分かったことは大きな収穫でした。\u003c/p\u003e\n\n\u003cp\u003e発表では話し忘れたのですが、Heroku は Stack に日々セキュリティパッチが当たって、24 時間以内に適用されることは大きなメリットです。小さなチームで当てるべきパッチの把握や適用をするのは、相当しんどいですからね。\u003c/p\u003e\n\n\u003cp\u003eそれでは、発表後に書いてくれた付箋への返信です。\u003c/p\u003e\n\n\u003ch2\u003e発表の感想\u003c/h2\u003e\n\n\u003cp\u003e付箋紙に感想を書いてくれました。\u003ci class=\"blogicon-comment\" aria-hidden=\"true\"\u003e\u003c/i\u003e は私からのコメントです。\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003e\u003cspan itemscope itemtype=\"http://schema.org/Photograph\"\u003e\u003cimg src=\"https://cdn-ak.f.st-hatena.com/images/fotolife/m/masutaka26/20181112/20181112233219.jpg\" alt=\"Heroku by yousuke?\" title=\"f:id:masutaka26:20181112233219j:plain\" class=\"hatena-fotolife\" itemprop=\"image\"\u003e\u003c/span\u003e\n\n\u003cul\u003e\n\u003cli\u003e\u003ci class=\"blogicon-comment\" aria-hidden=\"true\"\u003e\u003c/i\u003e いつもありがとうございます\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eふだん Heroku Review App しか使ってなかったんですが、興味を持ちました\n\n\u003cul\u003e\n\u003cli\u003e\u003ci class=\"blogicon-comment\" aria-hidden=\"true\"\u003e\u003c/i\u003e Rails アプリの公開にも、小さなスクリプトの定期実行にも使えるので便利ですよ\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eマッスル マスタカ！💪\n\n\u003cul\u003e\n\u003cli\u003e\u003ci class=\"blogicon-comment\" aria-hidden=\"true\"\u003e\u003c/i\u003e マッスル マッスル！💪\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eHeroku 未だに HTTP 1.1 なんですよね\n\n\u003cul\u003e\n\u003cli\u003e\u003ci class=\"blogicon-comment\" aria-hidden=\"true\"\u003e\u003c/i\u003e そうなんですよねー 💦 さすがにそろそろ...\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e早く AWS + CloudFront 使いたい\n\n\u003cul\u003e\n\u003cli\u003e\u003ci class=\"blogicon-comment\" aria-hidden=\"true\"\u003e\u003c/i\u003e assets は CDN に逃したいですねー\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e(dfplus.)io はいまだにフロントは Heroku 使ってマスタカ\n\n\u003cul\u003e\n\u003cli\u003e\u003ci class=\"blogicon-comment\" aria-hidden=\"true\"\u003e\u003c/i\u003e そうでありマスタカ\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003ePush された tar ball に build された file が入るんですか\n\n\u003cul\u003e\n\u003cli\u003e\u003ci class=\"blogicon-comment\" aria-hidden=\"true\"\u003e\u003c/i\u003e そんな感じですー\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eEC Booster のリリース時に Heroku を徹底的につかいたおすことを目標にしていたので、この発表もマスタカさんのふだんの仕事もとても感謝しています\n\n\u003cul\u003e\n\u003cli\u003e\u003ci class=\"blogicon-comment\" aria-hidden=\"true\"\u003e\u003c/i\u003e もったいないお言葉、ありがとうございます！\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e「Heroku は良いサービス」めっちゃわかる\n\n\u003cul\u003e\n\u003cli\u003e\u003ci class=\"blogicon-comment\" aria-hidden=\"true\"\u003e\u003c/i\u003e だよねー\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eHeroku は良しなにやってくれるけど、その「良しなに」部分もちゃんとオープンになっているのすばらしい\n\n\u003cul\u003e\n\u003cli\u003e\u003ci class=\"blogicon-comment\" aria-hidden=\"true\"\u003e\u003c/i\u003e ですねー。ずっと謎だった Slug の正体が分かってよかったです\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eプロダクション環境での Heroku 運用、勉強になりました\n\n\u003cul\u003e\n\u003cli\u003e\u003ci class=\"blogicon-comment\" aria-hidden=\"true\"\u003e\u003c/i\u003e まだまだ小さなサービスですからね。これから大きくなると、問題がたくさん出てきそうです\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eなんか push したら動かしてくれる Heroku が裏で何やってるか知れてよかったです！ 最近便利な機能知って Heroku いいなーってなってます！\n\n\u003cul\u003e\n\u003cli\u003e\u003ci class=\"blogicon-comment\" aria-hidden=\"true\"\u003e\u003c/i\u003e ありがとうございます。他にも \u003ca href=\"https://www.heroku.com/continuous-integration\"\u003eHeroku CI\u003c/a\u003e や \u003ca href=\"https://devcenter.heroku.com/articles/pipelines#promoting\"\u003ePromoting\u003c/a\u003e など、まだ試せていない機能がありますねー\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e資料が分かりやすいです\n\n\u003cul\u003e\n\u003cli\u003e\u003ci class=\"blogicon-comment\" aria-hidden=\"true\"\u003e\u003c/i\u003e 安心安全な資料作りを心がけて参ります\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e資料の文字数がちょうど良くてとても見やすいと思いました\n\n\u003cul\u003e\n\u003cli\u003e\u003ci class=\"blogicon-comment\" aria-hidden=\"true\"\u003e\u003c/i\u003e 本当はもっと減らしたいのですが、あとから読める資料としても作ったので、今回の長さになりました\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eボトルネックがないようなら Heroku 便利そう\n\n\u003cul\u003e\n\u003cli\u003e\u003ci class=\"blogicon-comment\" aria-hidden=\"true\"\u003e\u003c/i\u003e とは言え、パフォーマンスを突き詰めると厳しいと感じています。現在は割とバックグラウンド＆バッチ処理にフォーカスしています\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eさすが弊社で Heroku に一番詳しい男！！\n\n\u003cul\u003e\n\u003cli\u003e\u003ci class=\"blogicon-comment\" aria-hidden=\"true\"\u003e\u003c/i\u003e 引き続きニッチな領域を攻めていきます\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eマスタカさんは説明が上手だなと思いました（こなみ）\n\n\u003cul\u003e\n\u003cli\u003e\u003ci class=\"blogicon-comment\" aria-hidden=\"true\"\u003e\u003c/i\u003e ありがとうございます！\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eHeroku..... なんだかんだ、難しいイメージがあります...\n\n\u003cul\u003e\n\u003cli\u003e\u003ci class=\"blogicon-comment\" aria-hidden=\"true\"\u003e\u003c/i\u003e 私も最初はそうでしたねー\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e身近に仕事で Heroku 使ってる人だー\n\n\u003cul\u003e\n\u003cli\u003e\u003ci class=\"blogicon-comment\" aria-hidden=\"true\"\u003e\u003c/i\u003e いえす！\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e初心者でも使えるけど奥が深い Heroku\n\n\u003cul\u003e\n\u003cli\u003e\u003ci class=\"blogicon-comment\" aria-hidden=\"true\"\u003e\u003c/i\u003e ですねー\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\n\n\u003ch2\u003e発表の感想の感想\u003c/h2\u003e\n\n\u003cp\u003eHeroku はバックエンドエンジニアには概ね好評ですが、フロントエンドエンジニアには割と不評な印象を受けました。\u003c/p\u003e\n\n\u003cp\u003eHTTP/3 という話が出てきた今、未だに HTTP/1.1 なのはだいぶ遅れてますし、パフォーマンスを突き詰めると、どうしてもレイテンシー問題に直面してしまいます。逆に言えば、この辺どうにかなれば最強だと思うのですが。🌀\u003c/p\u003e\n\n\u003cp\u003eHeroku の先を見据えてやっていきます。💪\u003c/p\u003e\n","contentSnippet":"こんにちは。増田（id:masutaka26）です。以前住んだ街を訪れるのが趣味です。週次の社内勉強会 FFTT で『Heroku と EC Booster と私』と『Heroku ちょこっと Deep Dive』という発表をしました。まさかのダブルタイトル・・・！ スライドを作っていたら別々の話のような気がして、こうなりました。発表の内容『Heroku と EC Booster と私』は主に社内向けの話です。最近の EC Booster のインフラを紹介する機会がなかったので、今回の発表の場を借りました。『Heroku ちょこっと Deep Dive』では Heroku の Slug について、ちょこっと調べました。Heroku では Dyno という軽量コンテナ上で、アプリケーションが動作します。アプリケーションは Slug というパッケージに固められています。Slug にはアプリケーションコードの他に Buildpack や、Ruby なら bundle install されたライブラリ等が含められています。最近 Heroku を Terraform で管理し始めた時に、heroku_slug というリソースを見つけました。使いはしなかったのですが、自分で Slug を変更できる感覚がよく分からなくて調べたことが始まりでした。まさか Scratch から作れるとは思いませんでしたし、Slug の中身やサイズの増減を把握する方法が分かったことは大きな収穫でした。発表では話し忘れたのですが、Heroku は Stack に日々セキュリティパッチが当たって、24 時間以内に適用されることは大きなメリットです。小さなチームで当てるべきパッチの把握や適用をするのは、相当しんどいですからね。それでは、発表後に書いてくれた付箋への返信です。発表の感想付箋紙に感想を書いてくれました。 は私からのコメントです。 いつもありがとうございますふだん Heroku Review App しか使ってなかったんですが、興味を持ちました Rails アプリの公開にも、小さなスクリプトの定期実行にも使えるので便利ですよマッスル マスタカ！💪 マッスル マッスル！💪Heroku 未だに HTTP 1.1 なんですよね そうなんですよねー 💦 さすがにそろそろ...早く AWS + CloudFront 使いたい assets は CDN に逃したいですねー(dfplus.)io はいまだにフロントは Heroku 使ってマスタカ そうでありマスタカPush された tar ball に build された file が入るんですか そんな感じですーEC Booster のリリース時に Heroku を徹底的につかいたおすことを目標にしていたので、この発表もマスタカさんのふだんの仕事もとても感謝しています もったいないお言葉、ありがとうございます！「Heroku は良いサービス」めっちゃわかる だよねーHeroku は良しなにやってくれるけど、その「良しなに」部分もちゃんとオープンになっているのすばらしい ですねー。ずっと謎だった Slug の正体が分かってよかったですプロダクション環境での Heroku 運用、勉強になりました まだまだ小さなサービスですからね。これから大きくなると、問題がたくさん出てきそうですなんか push したら動かしてくれる Heroku が裏で何やってるか知れてよかったです！ 最近便利な機能知って Heroku いいなーってなってます！ ありがとうございます。他にも Heroku CI や Promoting など、まだ試せていない機能がありますねー資料が分かりやすいです 安心安全な資料作りを心がけて参ります資料の文字数がちょうど良くてとても見やすいと思いました 本当はもっと減らしたいのですが、あとから読める資料としても作ったので、今回の長さになりましたボトルネックがないようなら Heroku 便利そう とは言え、パフォーマンスを突き詰めると厳しいと感じています。現在は割とバックグラウンド＆バッチ処理にフォーカスしていますさすが弊社で Heroku に一番詳しい男！！ 引き続きニッチな領域を攻めていきますマスタカさんは説明が上手だなと思いました（こなみ） ありがとうございます！Heroku..... なんだかんだ、難しいイメージがあります... 私も最初はそうでしたねー身近に仕事で Heroku 使ってる人だー いえす！初心者でも使えるけど奥が深い Heroku ですねー発表の感想の感想Heroku はバックエンドエンジニアには概ね好評ですが、フロントエンドエンジニアには割と不評な印象を受けました。HTTP/3 という話が出てきた今、未だに HTTP/1.1 なのはだいぶ遅れてますし、パフォーマンスを突き詰めると、どうしてもレイテンシー問題に直面してしまいます。逆に言えば、この辺どうにかなれば最強だと思うのですが。🌀Heroku の先を見据えてやっていきます。💪","link":"https://developer.feedforce.jp/entry/2018/11/14/140000","isoDate":"2018-11-14T05:00:00.000Z","dateMiliSeconds":1542171600000,"imageUrl":"https://cdn-ak.f.st-hatena.com/images/fotolife/m/masutaka26/20181113/20181113190345.png","authorName":"masutaka"},{"title":"terraform-provider-healthchecksio に足りない機能を実装したらコラボレータになれた","content":"\u003cp\u003eこんにちは、増田（\u003ca href=\"http://blog.hatena.ne.jp/masutaka26/\" class=\"hatena-id-icon\"\u003e\u003cimg src=\"https://cdn.profile-image.st-hatena.com/users/masutaka26/profile.png\" width=\"16\" height=\"16\" alt=\"\" class=\"hatena-id-icon\"\u003eid:masutaka26\u003c/a\u003e）です。秋は体が急に冷え、一年で一番体調を崩しやすいので、意識して風呂に浸かっています。元気です。\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"http://blog.hatena.ne.jp/critical_alert/\" class=\"hatena-id-icon\"\u003e\u003cimg src=\"https://cdn.profile-image.st-hatena.com/users/critical_alert/profile.png\" width=\"16\" height=\"16\" alt=\"\" class=\"hatena-id-icon\"\u003eid:critical_alert\u003c/a\u003e から \u003ca href=\"https://healthchecks.io/\"\u003ehttps://healthchecks.io/\u003c/a\u003e を教えてもらいました。\u003c/p\u003e\n\n\u003cp\u003e\u003cspan itemscope itemtype=\"http://schema.org/Photograph\"\u003e\u003cimg src=\"https://cdn-ak.f.st-hatena.com/images/fotolife/m/masutaka26/20181007/20181007221520.png\" alt=\"f:id:masutaka26:20181007221520p:plain\" title=\"f:id:masutaka26:20181007221520p:plain\" class=\"hatena-fotolife\" itemprop=\"image\"\u003e\u003c/span\u003e\u003c/p\u003e\n\n\u003cp\u003ecron 系の定期実行ジョブが本当に実行されたかを監視してくれるサービスです。\u003c/p\u003e\n\n\u003cp\u003e以前、\u003ca href=\"https://github.com/ondrejbartas/sidekiq-cron\"\u003esidekiq-cron\u003c/a\u003e のバグで定期実行ジョブが実行されないことがあったので、なんらかの方法でお手軽に監視したいモチベーションがありました。\u003c/p\u003e\n\n\u003ch2\u003eterraform-provider-healthchecksio を発見\u003c/h2\u003e\n\n\u003cp\u003eコード化したいなーと思って調べたら、非公式の Terraform provider を発見。\u003c/p\u003e\n\n\u003cp\u003e\u003ca class=\"embedly-card\" href=\"https://github.com/kristofferahl/terraform-provider-healthchecksio\"\u003ekristofferahl/terraform-provider-healthchecksio\u003c/a\u003e\u003c/p\u003e\n\n\u003cscript async src=\"//cdn.embedly.com/widgets/platform.js\" charset=\"UTF-8\"\u003e\u003c/script\u003e\n\n\n\u003cp\u003eこういった設定は属人化しやすいため、Terraform でコード化できるのは助かります。\u003c/p\u003e\n\n\u003cp\u003eただ、この時点では schedule や timezone などに対応していなかったため、採用は断念しました。\u003c/p\u003e\n\n\u003cp\u003ehealthchecks.io 上でポチポチと監視用のエンドポイントを作成し、ビジネスロジックにも ping するコードを埋め込み、いい感じに動作していました。\u003c/p\u003e\n\n\u003ch2\u003e実装開始\u003c/h2\u003e\n\n\u003cp\u003e悶々とした日を送り続けたある日、調べてみたら意外と簡単に機能が実装できそうなことが分かりました。\u003c/p\u003e\n\n\u003cp\u003e👇 それで送ったのがこの PR。可能な限りのパラメータを使えるようになりました。\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/kristofferahl/terraform-provider-healthchecksio/pull/1\"\u003eAdd parameters by masutaka · Pull Request #1\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\n\n\u003cp\u003eterraform import もしたいなーと調べたら、たったの 3 行で対応出来ることが判明。👇 2 つ目の PR を出して無事マージされました。\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/kristofferahl/terraform-provider-healthchecksio/pull/2\"\u003eIntroduce terraform import by masutaka · Pull Request #2\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\n\n\u003cp\u003eついでにしれっとコラボレータに招待してくれて、commit 権を頂けました。やったぜ！\u003c/p\u003e\n\n\u003cp\u003e👇 先ほど 3 つ目の PR を出しました。非公式の Terraform provider なので、自分でバイナリを設置する必要があるのですよね。参考になりそうな Makefile を作りました。\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/kristofferahl/terraform-provider-healthchecksio/pull/3\"\u003eAdd examples/Makefile by masutaka · Pull Request #3\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\n\n\u003ch2\u003e今後の予定\u003c/h2\u003e\n\n\u003cblockquote\u003e\u003cp\u003eThe database failover process is manual, and the ops team consists of a single person, so multi-hour or even multi-day outages are possible!\u003c/p\u003e\n\n\u003cp\u003eWhile we can only guarantee a best effort availability, in practice the availability has exceeded 99.9% since the service publicly launched in July 2015.\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://healthchecks.io/about/\"\u003ehttps://healthchecks.io/about/\u003c/a\u003e\u003c/p\u003e\u003c/blockquote\u003e\n\n\u003cp\u003ehealthchecks.io は安定稼働しており、2015 年 7 月のサービス開始以来、稼働率は 99.9% を超えているそうです。ただあくまでベストエフォート型の可用性しか保証していないので、過信は禁物です。いわゆる 1 人開発プロジェクトでもあります。\u003c/p\u003e\n\n\u003cp\u003e今後は Datadog で同じ監視が出来るか調査して、healthchecks.io と併用したいなーと思っています。\u003ca href=\"https://cronitor.io/\"\u003eCronitor\u003c/a\u003e も頭の片隅にあるけど、少しオーバースペック感があります。\u003c/p\u003e\n\n\u003ch2\u003eおまけ\u003c/h2\u003e\n\n\u003cp\u003ehealthchecks.io は OSS でもあり、GitHub 上にコードが公開されています。Django で実装されています。\u003c/p\u003e\n\n\u003cp\u003e\u003ca class=\"embedly-card\" href=\"https://github.com/healthchecks/healthchecks\"\u003ehealthchecks/healthchecks\u003c/a\u003e\u003c/p\u003e\n","contentSnippet":"こんにちは、増田（id:masutaka26）です。秋は体が急に冷え、一年で一番体調を崩しやすいので、意識して風呂に浸かっています。元気です。id:critical_alert から https://healthchecks.io/ を教えてもらいました。cron 系の定期実行ジョブが本当に実行されたかを監視してくれるサービスです。以前、sidekiq-cron のバグで定期実行ジョブが実行されないことがあったので、なんらかの方法でお手軽に監視したいモチベーションがありました。terraform-provider-healthchecksio を発見コード化したいなーと思って調べたら、非公式の Terraform provider を発見。kristofferahl/terraform-provider-healthchecksioこういった設定は属人化しやすいため、Terraform でコード化できるのは助かります。ただ、この時点では schedule や timezone などに対応していなかったため、採用は断念しました。healthchecks.io 上でポチポチと監視用のエンドポイントを作成し、ビジネスロジックにも ping するコードを埋め込み、いい感じに動作していました。実装開始悶々とした日を送り続けたある日、調べてみたら意外と簡単に機能が実装できそうなことが分かりました。👇 それで送ったのがこの PR。可能な限りのパラメータを使えるようになりました。Add parameters by masutaka · Pull Request #1terraform import もしたいなーと調べたら、たったの 3 行で対応出来ることが判明。👇 2 つ目の PR を出して無事マージされました。Introduce terraform import by masutaka · Pull Request #2ついでにしれっとコラボレータに招待してくれて、commit 権を頂けました。やったぜ！👇 先ほど 3 つ目の PR を出しました。非公式の Terraform provider なので、自分でバイナリを設置する必要があるのですよね。参考になりそうな Makefile を作りました。Add examples/Makefile by masutaka · Pull Request #3今後の予定The database failover process is manual, and the ops team consists of a single person, so multi-hour or even multi-day outages are possible!While we can only guarantee a best effort availability, in practice the availability has exceeded 99.9% since the service publicly launched in July 2015.https://healthchecks.io/about/healthchecks.io は安定稼働しており、2015 年 7 月のサービス開始以来、稼働率は 99.9% を超えているそうです。ただあくまでベストエフォート型の可用性しか保証していないので、過信は禁物です。いわゆる 1 人開発プロジェクトでもあります。今後は Datadog で同じ監視が出来るか調査して、healthchecks.io と併用したいなーと思っています。Cronitor も頭の片隅にあるけど、少しオーバースペック感があります。おまけhealthchecks.io は OSS でもあり、GitHub 上にコードが公開されています。Django で実装されています。healthchecks/healthchecks","link":"https://developer.feedforce.jp/entry/2018/10/09/140000","isoDate":"2018-10-09T05:00:00.000Z","dateMiliSeconds":1539061200000,"imageUrl":"https://cdn-ak.f.st-hatena.com/images/fotolife/m/masutaka26/20181007/20181007221520.png","authorName":"masutaka"},{"title":"先期の MVP に選ばれた","content":"\u003cp\u003eお元気にしてますか。増田（\u003ca href=\"http://blog.hatena.ne.jp/masutaka26/\" class=\"hatena-id-icon\"\u003e\u003cimg src=\"https://cdn.profile-image.st-hatena.com/users/masutaka26/profile.png\" width=\"16\" height=\"16\" alt=\"\" class=\"hatena-id-icon\"\u003eid:masutaka26\u003c/a\u003e）です。\u003c/p\u003e\n\n\u003cp\u003e先週の金曜日にフィードフォースにおける 2017 年度（2017年6月 〜 2018年5月）の納会が行われ、その中で初の MVP を受賞することができました。🎉\u003c/p\u003e\n\n\u003cp\u003e\u003cfigure class=\"figure-image figure-image-fotolife\" title=\"喜びのコメントを表明中のしがないますたか\"\u003e\u003cspan itemscope itemtype=\"http://schema.org/Photograph\"\u003e\u003cimg src=\"https://cdn-ak.f.st-hatena.com/images/fotolife/m/masutaka26/20180608/20180608194920.jpg\" alt=\"f:id:masutaka26:20180608194920j:plain\" title=\"f:id:masutaka26:20180608194920j:plain\" class=\"hatena-fotolife\" itemprop=\"image\"\u003e\u003c/span\u003e\u003cfigcaption\u003e喜びのコメントを表明中のしがないますたか\u003c/figcaption\u003e\u003c/figure\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003cfigure class=\"figure-image figure-image-fotolife\" title=\"チーム賞ももらったヨ\"\u003e\u003cspan itemscope itemtype=\"http://schema.org/Photograph\"\u003e\u003cimg src=\"https://cdn-ak.f.st-hatena.com/images/fotolife/m/masutaka26/20180614/20180614005507.jpg\" alt=\"f:id:masutaka26:20180614005507j:plain\" title=\"f:id:masutaka26:20180614005507j:plain\" class=\"hatena-fotolife\" itemprop=\"image\"\u003e\u003c/span\u003e\u003cfigcaption\u003eチーム賞ももらったヨ\u003c/figcaption\u003e\u003c/figure\u003e\u003c/p\u003e\n\n\u003cp\u003e会社で賞を頂いたのは 4 年前のルーキー賞以来です。\u003c/p\u003e\n\n\u003cp\u003e\u003ciframe src=\"https://hatenablog-parts.com/embed?url=https%3A%2F%2Fmasutaka.net%2Fchalow%2F2014-06-13-1.html\" title=\"会社でルーキー賞に選ばれた\" class=\"embed-card embed-webcard\" scrolling=\"no\" frameborder=\"0\" style=\"display: block; width: 100%; height: 155px; max-width: 500px; margin: 10px 0px;\"\u003e\u003c/iframe\u003e\u003ccite class=\"hatena-citation\"\u003e\u003ca href=\"https://masutaka.net/chalow/2014-06-13-1.html\"\u003emasutaka.net\u003c/a\u003e\u003c/cite\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003cdel\u003e四年寝太郎としては、取るべくして取った賞だと思いました（ｷﾘｯ\u003c/del\u003e\u003c/p\u003e\n\n\u003cp\u003e正直なところ、頑張ったで賞くらいはもらえたりして？とボンヤリ思っていましたが\u003ca href=\"#f-3841f537\" name=\"fn-3841f537\" title=\"そのような賞はありません\"\u003e*1\u003c/a\u003e、まさか MVP とは思いもよらず、発表の瞬間は素で驚きました。\u003c/p\u003e\n\n\u003cp\u003e2017 年度は以下のチームに所属していました。\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003e2017 年 6 月 〜 2018 年 3 月\n\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://dfplus.feedforce.jp/\"\u003eDF PLUS\u003c/a\u003e（社内では DF Maker と呼ばれる）\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e2018 年 4 月 〜 2018 年 5 月\n\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://ecbooster.jp/\"\u003eEC Booster\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\n\n\u003cp\u003eDF Maker ではサービスの信頼性向上にひたすら努める毎日でした。ECS でとんでもない量のエラーが発生して、３連休の間は暇を見つけてエラーログを確認してたなー（遠い目）。\u003c/p\u003e\n\n\u003cp\u003eEC Booster ではチームビルディングから始めました。👇️以下の記事にまとまっています。\u003c/p\u003e\n\n\u003cp\u003e\u003ciframe src=\"https://hatenablog-parts.com/embed?url=https%3A%2F%2Fdeveloper.feedforce.jp%2Fentry%2F2018%2F05%2F21%2F150000\" title=\"『開発基盤チームとして課題を探したらマネジメントをしていた』という発表をした - Feedforce Developer Blog\" class=\"embed-card embed-blogcard\" scrolling=\"no\" frameborder=\"0\" style=\"display: block; width: 100%; height: 190px; max-width: 500px; margin: 10px 0px;\"\u003e\u003c/iframe\u003e\u003ccite class=\"hatena-citation\"\u003e\u003ca href=\"https://developer.feedforce.jp/entry/2018/05/21/150000\"\u003edeveloper.feedforce.jp\u003c/a\u003e\u003c/cite\u003e\u003c/p\u003e\n\n\u003cp\u003eどちらにも共通することが、2 年目の優秀な若者と仕事ができたことです。私が若者を引っ張っていくぜーという感じではなくむしろ逆で、すでにサービスを知り尽くした若者から学ぶ日々でした（今もそうです）。\u003c/p\u003e\n\n\u003cp\u003eその中で、「こうすればチーム開発がドライブするだろう」や「こうすればサービスの質を高められるだろう」というアイディアを出し、実践し、小さな改善と失敗を繰り返したことが、結果としてチームの状況を良くしたりサービスの質を高めることが出来たのだと思います（現在進行系）。\u003c/p\u003e\n\n\u003cp\u003eもちろん、一緒に働くことができたチームの皆さんの協力があっての賞です。ありがとうございます。🙏\u003c/p\u003e\n\n\u003cp\u003eそれではまた 4 年後にお会いしましょう💤\u003c/p\u003e\n\u003cdiv class=\"footnote\"\u003e\n\u003cp class=\"footnote\"\u003e\u003ca href=\"#fn-3841f537\" name=\"f-3841f537\" class=\"footnote-number\"\u003e*1\u003c/a\u003e\u003cspan class=\"footnote-delimiter\"\u003e:\u003c/span\u003e\u003cspan class=\"footnote-text\"\u003eそのような賞はありません\u003c/span\u003e\u003c/p\u003e\n\u003c/div\u003e","contentSnippet":"お元気にしてますか。増田（id:masutaka26）です。先週の金曜日にフィードフォースにおける 2017 年度（2017年6月 〜 2018年5月）の納会が行われ、その中で初の MVP を受賞することができました。🎉喜びのコメントを表明中のしがないますたかチーム賞ももらったヨ会社で賞を頂いたのは 4 年前のルーキー賞以来です。masutaka.net四年寝太郎としては、取るべくして取った賞だと思いました（ｷﾘｯ正直なところ、頑張ったで賞くらいはもらえたりして？とボンヤリ思っていましたが*1、まさか MVP とは思いもよらず、発表の瞬間は素で驚きました。2017 年度は以下のチームに所属していました。2017 年 6 月 〜 2018 年 3 月DF PLUS（社内では DF Maker と呼ばれる）2018 年 4 月 〜 2018 年 5 月EC BoosterDF Maker ではサービスの信頼性向上にひたすら努める毎日でした。ECS でとんでもない量のエラーが発生して、３連休の間は暇を見つけてエラーログを確認してたなー（遠い目）。EC Booster ではチームビルディングから始めました。👇️以下の記事にまとまっています。developer.feedforce.jpどちらにも共通することが、2 年目の優秀な若者と仕事ができたことです。私が若者を引っ張っていくぜーという感じではなくむしろ逆で、すでにサービスを知り尽くした若者から学ぶ日々でした（今もそうです）。その中で、「こうすればチーム開発がドライブするだろう」や「こうすればサービスの質を高められるだろう」というアイディアを出し、実践し、小さな改善と失敗を繰り返したことが、結果としてチームの状況を良くしたりサービスの質を高めることが出来たのだと思います（現在進行系）。もちろん、一緒に働くことができたチームの皆さんの協力があっての賞です。ありがとうございます。🙏それではまた 4 年後にお会いしましょう💤*1:そのような賞はありません","link":"https://developer.feedforce.jp/entry/2018/06/15/130000","isoDate":"2018-06-15T04:00:00.000Z","dateMiliSeconds":1529035200000,"imageUrl":"https://cdn-ak.f.st-hatena.com/images/fotolife/m/masutaka26/20180614/20180614005507.jpg","authorName":"masutaka"},{"title":"『開発基盤チームとして課題を探したらマネジメントをしていた』という発表をした","content":"\u003cp\u003eこんにちは。増田（\u003ca href=\"http://blog.hatena.ne.jp/masutaka26/\" class=\"hatena-id-icon\"\u003e\u003cimg src=\"https://cdn.profile-image.st-hatena.com/users/masutaka26/profile.png\" width=\"16\" height=\"16\" alt=\"\" class=\"hatena-id-icon\"\u003eid:masutaka26\u003c/a\u003e）です。発表が無事終わり、何かゲームでも買おうかなと思ってます。\u003c/p\u003e\n\n\u003cp\u003eさて、フィードフォースでは毎週金曜日 16:00 から、社内技術勉強会を開催しています。当番制の持ち回りで技術に関連したことを発表します。\u003c/p\u003e\n\n\u003cp\u003e先週金曜日は私の当番で『開発基盤チームとして課題を探したらマネジメントをしていた』という発表をしました。\u003c/p\u003e\n\n\u003cp\u003e技術チーム以外の方もたくさん聞きに来てくれて、ありがたかったです。🙏\u003c/p\u003e\n\n\u003ch2\u003e発表の内容\u003c/h2\u003e\n\n\u003cscript async class=\"speakerdeck-embed\" data-id=\"978c7016bb7b473693f547116e8e704f\" data-ratio=\"1.33333333333333\" src=\"//speakerdeck.com/assets/embed.js\"\u003e\u003c/script\u003e\n\n\n\u003cp\u003e\u003ca href=\"http://developer.feedforce.jp/entry/2017/10/16/150000\"\u003e前回\u003c/a\u003e含めて、これまでの発表は全てコードが登場していました。今回のようなコードが登場しないマネジメントの話は、内容が拡散しがちで難しかったです。結局まとまりませんでした...。\u003c/p\u003e\n\n\u003cp\u003e今回は敢えて後から読めるプレゼン資料にしました。なのでプレゼン資料としては冗長な書き方になっています。\u003c/p\u003e\n\n\u003cp\u003eまとめるとこんな内容です。\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eコミュニケーションの不確実性を解消することが、マネジメント（やチームビルディング）に必要なはず\u003c/li\u003e\n\u003cli\u003eそのため自ら場に飛び込んで、情報の非対称性を解消していった\u003c/li\u003e\n\u003cli\u003eこれからもソフトウェアを書くこと以外に課題解決の手段があればやっていく\u003c/li\u003e\n\u003cli\u003eそして徐々にマネジメントにかける時間を減らし、コードを書く時間を増やしていく\u003c/li\u003e\n\u003c/ul\u003e\n\n\n\u003cp\u003e今思えば、話し忘れたことがポロポロと出てきます。\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eそもそもチームメンバーは自走できる方々で、ホワイトボード整理の時も方針だけ話したら勝手に整理されていった\n\n\u003cul\u003e\n\u003cli\u003e私は方向性を決めただけ\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eチームに入りたてのときは少々オーバーリアクションを心がけ、徐々に普通に戻していく。\n\n\u003cul\u003e\n\u003cli\u003e何考えている人か分かってもらうことで、その後のコミュニケーションをスムーズにする\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\n\n\u003cp\u003e完璧な発表などありませんね。\u003c/p\u003e\n\n\u003ch2\u003e発表の感想\u003c/h2\u003e\n\n\u003cp\u003e付箋紙に感想を書いてくれました。\u003ci class=\"blogicon-comment\" aria-hidden=\"true\"\u003e\u003c/i\u003e は私からのコメントです。\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eジョハリの窓の紹介ありがとうございます。勉強になります！\n\n\u003cul\u003e\n\u003cli\u003e\u003ci class=\"blogicon-comment\" aria-hidden=\"true\"\u003e\u003c/i\u003e 私も『\u003ca href=\"https://www.amazon.co.jp/dp/B079TLW41L/\"\u003eエンジニアリング組織論への招待\u003c/a\u003e』で初めて知りました。数年前にプロダクトオーナーの学習をした以来ですから...\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e自分はまだマネジメントからは程遠い存在なのですが、話しかけやすいオーラを出すことや、くだらないと思うことも質問することなどは、今すぐにでも実行出来るし、目指すことだと思いました。ありがとうございました！\n\n\u003cul\u003e\n\u003cli\u003e\u003ci class=\"blogicon-comment\" aria-hidden=\"true\"\u003e\u003c/i\u003e はい、個々が意識することが自走するチームや、個々のリーダーシップに繋がると思います\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e共感できる良い話でした\n\n\u003cul\u003e\n\u003cli\u003e\u003ci class=\"blogicon-comment\" aria-hidden=\"true\"\u003e\u003c/i\u003e あざす！\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e初公開の画像が見られて良かったです\n\n\u003cul\u003e\n\u003cli\u003e\u003ci class=\"blogicon-comment\" aria-hidden=\"true\"\u003e\u003c/i\u003e お粗末さまでした...\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e早くインフラ朝会にもどって来てください\n\n\u003cul\u003e\n\u003cli\u003e\u003ci class=\"blogicon-comment\" aria-hidden=\"true\"\u003e\u003c/i\u003e 今回の件が落ち着いたらインフラ朝会にもどりますよ。待っていてくださいね！\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e必要な情報とそうでもない情報の整理はものすごい HP/MP を消費しそう\n\n\u003cul\u003e\n\u003cli\u003e\u003ci class=\"blogicon-comment\" aria-hidden=\"true\"\u003e\u003c/i\u003e そうですね...\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eマネジメントの成果はすぐには結果に現れないかも？どの位の頻度で振り返るべきなのか？\n\n\u003cul\u003e\n\u003cli\u003e\u003ci class=\"blogicon-comment\" aria-hidden=\"true\"\u003e\u003c/i\u003e イテレーションごとの振り返りで、チームを観察すれば良いです。マネジメントの成果かどうかは重要ではないと思います\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e◯◯を支える技術\n\n\u003cul\u003e\n\u003cli\u003e\u003ci class=\"blogicon-comment\" aria-hidden=\"true\"\u003e\u003c/i\u003e 次回はコードの話をしよう...\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e知識科学やり直さなきゃ・・・\n\n\u003cul\u003e\n\u003cli\u003e\u003ci class=\"blogicon-comment\" aria-hidden=\"true\"\u003e\u003c/i\u003e 私は今回で終了ですw\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eチームの問題点を発見して、それを解決する手段を選ばないスタンスがすごい\n\n\u003cul\u003e\n\u003cli\u003e\u003ci class=\"blogicon-comment\" aria-hidden=\"true\"\u003e\u003c/i\u003e もう必死ですよ（笑）\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e「内心ではなく行動に注目する」は、認知行動療法などでも使われていますね（最近のトレンド？）\n\n\u003cul\u003e\n\u003cli\u003e\u003ci class=\"blogicon-comment\" aria-hidden=\"true\"\u003e\u003c/i\u003e へぇ〜\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eなかなかボリュームある資料でしたが、作るのにどれくらいかかったのか気になります\n\n\u003cul\u003e\n\u003cli\u003e\u003ci class=\"blogicon-comment\" aria-hidden=\"true\"\u003e\u003c/i\u003e 先週土曜日の夜に草稿を作り「これでいけそう」という感触を得て、今週は平日の夜２日くらいで整理をしました。話す内容については一ヶ月くらい前から頭の中で考えたり、『\u003ca href=\"https://www.amazon.co.jp/dp/B079TLW41L/\"\u003eエンジニアリング組織論への招待\u003c/a\u003e』を全部読んだりしてました\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e最近疲弊してそうで心配でしたが、今日の発表で色々アウトプットしてもらって安心しました\n\n\u003cul\u003e\n\u003cli\u003e\u003ci class=\"blogicon-comment\" aria-hidden=\"true\"\u003e\u003c/i\u003e 気にかけて頂いてありがとうございます。これからも安心安全のマスタカをお届けして参ります\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eうなずきすぎて首もげる\n\n\u003cul\u003e\n\u003cli\u003e\u003ci class=\"blogicon-comment\" aria-hidden=\"true\"\u003e\u003c/i\u003e ありがとうございます。参考になったことが各チームに還元されるとうれしいです\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eマスタカさん自体はマネジメントよりコード書く方が好きなんでしょうか？\n\n\u003cul\u003e\n\u003cli\u003e\u003ci class=\"blogicon-comment\" aria-hidden=\"true\"\u003e\u003c/i\u003e そうですね。引き篭もってコードを書きたいです\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eますたかさんのおかげでチームがちゃんと回りはじめた気がします\n\n\u003cul\u003e\n\u003cli\u003e\u003ci class=\"blogicon-comment\" aria-hidden=\"true\"\u003e\u003c/i\u003e そう言って頂けるとうれしいです。今がスタート地点だと捉え、精進してまいります\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e増田さんが参加されてから何かがスムーズになった実感があります（情報や知識だけでなく）\n\n\u003cul\u003e\n\u003cli\u003e\u003ci class=\"blogicon-comment\" aria-hidden=\"true\"\u003e\u003c/i\u003e うれしいですね。マネジメントは空気のような存在が良いと考えています\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eマネジメントってどうやるか？のテクニックの面もあるけど、誰がやるか？の面も大きい気がしてます\n\n\u003cul\u003e\n\u003cli\u003e\u003ci class=\"blogicon-comment\" aria-hidden=\"true\"\u003e\u003c/i\u003e そうですね。例えば入ったばかりの職場だと、信頼関係を築くことから始まると思います。今回は同じ会社ということと、過去に一緒に働いたメンバーがいたことに助けられました\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eEC Booster のこれからに期待しています！\n\n\u003cul\u003e\n\u003cli\u003e\u003ci class=\"blogicon-comment\" aria-hidden=\"true\"\u003e\u003c/i\u003e 💪\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e「場に飛び込む」「正しく伝わったと思わない」肝に銘じます！\n\n\u003cul\u003e\n\u003cli\u003e\u003ci class=\"blogicon-comment\" aria-hidden=\"true\"\u003e\u003c/i\u003e よろしくお願いします！\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e「エンジニアが発見した課題の解決フロー」読みたいです\n\n\u003cul\u003e\n\u003cli\u003e\u003ci class=\"blogicon-comment\" aria-hidden=\"true\"\u003e\u003c/i\u003e Slack で書いたとおり、割と普通のフローです。発表で話したエンジニア以外の方からの依頼と整合性を合わせてこうしました。まだ始めて間もなく 1 イテレーションも回してない状態ですがね...\n\n\u003col\u003e\n\u003cli\u003e Issue を作ると EC Booster waffle.io の Planning カラムに入る\u003c/li\u003e\n\u003cli\u003e 次の開発ミーティングで Planning カラムを空にする\u003c/li\u003e\n\u003cli\u003e スプリントでは Sprint Backlog に集中する\u003c/li\u003e\n\u003c/ol\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003efeedforce だとマネジメントオンリーじゃなくて、開発+マネジメントが最強という話を昨日クリストフとした\n\n\u003cul\u003e\n\u003cli\u003e\u003ci class=\"blogicon-comment\" aria-hidden=\"true\"\u003e\u003c/i\u003e 最強かは分かりませんが、コードも分かったほうが捗ると思います\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e仕事でもプライベートでも、コミュニティ内でオープンな発信をする人が多いと、円滑に物事が進みやすいなと考えられました。その逆もまた然りだったので...。かつ、人に伝えるときは具体的にするというのも大切かと思いました\n\n\u003cul\u003e\n\u003cli\u003e\u003ci class=\"blogicon-comment\" aria-hidden=\"true\"\u003e\u003c/i\u003e 他人は自分でないので、分かりやすく具体的なコミュニケーションが大事ですね\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003cspan itemscope itemtype=\"http://schema.org/Photograph\"\u003e\u003cimg src=\"https://cdn-ak.f.st-hatena.com/images/fotolife/m/masutaka26/20180519/20180519155210.jpg\" alt=\"masutaka by yousuke\" title=\"f:id:masutaka26:20180519155210j:plain\" class=\"hatena-fotolife\" itemprop=\"image\"\u003e\u003c/span\u003e\n\n\u003cul\u003e\n\u003cli\u003e\u003ci class=\"blogicon-comment\" aria-hidden=\"true\"\u003e\u003c/i\u003e え、誰？（困惑）\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\n\n\u003ch2\u003e最後に\u003c/h2\u003e\n\n\u003cp\u003e\u003cdiv class=\"hatena-asin-detail\"\u003e\u003ca href=\"http://www.amazon.co.jp/exec/obidos/ASIN/4774196053/hatena-blog-22/\"\u003e\u003cimg src=\"https://images-fe.ssl-images-amazon.com/images/I/51zMvVL4MeL._SL160_.jpg\" class=\"hatena-asin-detail-image\" alt=\"エンジニアリング組織論への招待 ~不確実性に向き合う思考と組織のリファクタリング\" title=\"エンジニアリング組織論への招待 ~不確実性に向き合う思考と組織のリファクタリング\"\u003e\u003c/a\u003e\u003cdiv class=\"hatena-asin-detail-info\"\u003e\u003cp class=\"hatena-asin-detail-title\"\u003e\u003ca href=\"http://www.amazon.co.jp/exec/obidos/ASIN/4774196053/hatena-blog-22/\"\u003eエンジニアリング組織論への招待 ~不確実性に向き合う思考と組織のリファクタリング\u003c/a\u003e\u003c/p\u003e\u003cul\u003e\u003cli\u003e\u003cspan class=\"hatena-asin-detail-label\"\u003e作者:\u003c/span\u003e 広木大地\u003c/li\u003e\u003cli\u003e\u003cspan class=\"hatena-asin-detail-label\"\u003e出版社/メーカー:\u003c/span\u003e 技術評論社\u003c/li\u003e\u003cli\u003e\u003cspan class=\"hatena-asin-detail-label\"\u003e発売日:\u003c/span\u003e 2018/02/22\u003c/li\u003e\u003cli\u003e\u003cspan class=\"hatena-asin-detail-label\"\u003eメディア:\u003c/span\u003e 単行本（ソフトカバー）\u003c/li\u003e\u003cli\u003e\u003ca href=\"http://d.hatena.ne.jp/asin/4774196053/hatena-blog-22\" target=\"_blank\"\u003eこの商品を含むブログ (2件) を見る\u003c/a\u003e\u003c/li\u003e\u003c/ul\u003e\u003c/div\u003e\u003cdiv class=\"hatena-asin-detail-foot\"\u003e\u003c/div\u003e\u003c/div\u003e\u003c/p\u003e\n\n\u003cp\u003e良かったぞ。「エンジニア組織論」ではないことに注目。プロダクトオーナーやエンジニア以外の職種の方にも是非読んでもらいたいです。\u003c/p\u003e\n","contentSnippet":"こんにちは。増田（id:masutaka26）です。発表が無事終わり、何かゲームでも買おうかなと思ってます。さて、フィードフォースでは毎週金曜日 16:00 から、社内技術勉強会を開催しています。当番制の持ち回りで技術に関連したことを発表します。先週金曜日は私の当番で『開発基盤チームとして課題を探したらマネジメントをしていた』という発表をしました。技術チーム以外の方もたくさん聞きに来てくれて、ありがたかったです。🙏発表の内容前回含めて、これまでの発表は全てコードが登場していました。今回のようなコードが登場しないマネジメントの話は、内容が拡散しがちで難しかったです。結局まとまりませんでした...。今回は敢えて後から読めるプレゼン資料にしました。なのでプレゼン資料としては冗長な書き方になっています。まとめるとこんな内容です。コミュニケーションの不確実性を解消することが、マネジメント（やチームビルディング）に必要なはずそのため自ら場に飛び込んで、情報の非対称性を解消していったこれからもソフトウェアを書くこと以外に課題解決の手段があればやっていくそして徐々にマネジメントにかける時間を減らし、コードを書く時間を増やしていく今思えば、話し忘れたことがポロポロと出てきます。そもそもチームメンバーは自走できる方々で、ホワイトボード整理の時も方針だけ話したら勝手に整理されていった私は方向性を決めただけチームに入りたてのときは少々オーバーリアクションを心がけ、徐々に普通に戻していく。何考えている人か分かってもらうことで、その後のコミュニケーションをスムーズにする完璧な発表などありませんね。発表の感想付箋紙に感想を書いてくれました。 は私からのコメントです。ジョハリの窓の紹介ありがとうございます。勉強になります！ 私も『エンジニアリング組織論への招待』で初めて知りました。数年前にプロダクトオーナーの学習をした以来ですから...自分はまだマネジメントからは程遠い存在なのですが、話しかけやすいオーラを出すことや、くだらないと思うことも質問することなどは、今すぐにでも実行出来るし、目指すことだと思いました。ありがとうございました！ はい、個々が意識することが自走するチームや、個々のリーダーシップに繋がると思います共感できる良い話でした あざす！初公開の画像が見られて良かったです お粗末さまでした...早くインフラ朝会にもどって来てください 今回の件が落ち着いたらインフラ朝会にもどりますよ。待っていてくださいね！必要な情報とそうでもない情報の整理はものすごい HP/MP を消費しそう そうですね...マネジメントの成果はすぐには結果に現れないかも？どの位の頻度で振り返るべきなのか？ イテレーションごとの振り返りで、チームを観察すれば良いです。マネジメントの成果かどうかは重要ではないと思います◯◯を支える技術 次回はコードの話をしよう...知識科学やり直さなきゃ・・・ 私は今回で終了ですwチームの問題点を発見して、それを解決する手段を選ばないスタンスがすごい もう必死ですよ（笑）「内心ではなく行動に注目する」は、認知行動療法などでも使われていますね（最近のトレンド？） へぇ〜なかなかボリュームある資料でしたが、作るのにどれくらいかかったのか気になります 先週土曜日の夜に草稿を作り「これでいけそう」という感触を得て、今週は平日の夜２日くらいで整理をしました。話す内容については一ヶ月くらい前から頭の中で考えたり、『エンジニアリング組織論への招待』を全部読んだりしてました最近疲弊してそうで心配でしたが、今日の発表で色々アウトプットしてもらって安心しました 気にかけて頂いてありがとうございます。これからも安心安全のマスタカをお届けして参りますうなずきすぎて首もげる ありがとうございます。参考になったことが各チームに還元されるとうれしいですマスタカさん自体はマネジメントよりコード書く方が好きなんでしょうか？ そうですね。引き篭もってコードを書きたいですますたかさんのおかげでチームがちゃんと回りはじめた気がします そう言って頂けるとうれしいです。今がスタート地点だと捉え、精進してまいります増田さんが参加されてから何かがスムーズになった実感があります（情報や知識だけでなく） うれしいですね。マネジメントは空気のような存在が良いと考えていますマネジメントってどうやるか？のテクニックの面もあるけど、誰がやるか？の面も大きい気がしてます そうですね。例えば入ったばかりの職場だと、信頼関係を築くことから始まると思います。今回は同じ会社ということと、過去に一緒に働いたメンバーがいたことに助けられましたEC Booster のこれからに期待しています！ 💪「場に飛び込む」「正しく伝わったと思わない」肝に銘じます！ よろしくお願いします！「エンジニアが発見した課題の解決フロー」読みたいです Slack で書いたとおり、割と普通のフローです。発表で話したエンジニア以外の方からの依頼と整合性を合わせてこうしました。まだ始めて間もなく 1 イテレーションも回してない状態ですがね... Issue を作ると EC Booster waffle.io の Planning カラムに入る 次の開発ミーティングで Planning カラムを空にする スプリントでは Sprint Backlog に集中するfeedforce だとマネジメントオンリーじゃなくて、開発+マネジメントが最強という話を昨日クリストフとした 最強かは分かりませんが、コードも分かったほうが捗ると思います仕事でもプライベートでも、コミュニティ内でオープンな発信をする人が多いと、円滑に物事が進みやすいなと考えられました。その逆もまた然りだったので...。かつ、人に伝えるときは具体的にするというのも大切かと思いました 他人は自分でないので、分かりやすく具体的なコミュニケーションが大事ですね え、誰？（困惑）最後にエンジニアリング組織論への招待 ~不確実性に向き合う思考と組織のリファクタリング作者: 広木大地出版社/メーカー: 技術評論社発売日: 2018/02/22メディア: 単行本（ソフトカバー）この商品を含むブログ (2件) を見る良かったぞ。「エンジニア組織論」ではないことに注目。プロダクトオーナーやエンジニア以外の職種の方にも是非読んでもらいたいです。","link":"https://developer.feedforce.jp/entry/2018/05/21/150000","isoDate":"2018-05-21T06:00:00.000Z","dateMiliSeconds":1526882400000,"imageUrl":"https://images-fe.ssl-images-amazon.com/images/I/51zMvVL4MeL._SL160_.jpg","authorName":"masutaka"},{"title":"これまで試したダイエット７つを紹介する（※全部失敗）","content":"この記事は feedforce Advent Calendar 2017 の 19 日目の記事です。\n18 日目はなべはるさんの『ITベンチャー企業の人事が使っている SaaS\n10選！ 』でした。なべはるさんは一日に食べるアイスと同じくらい SaaS\nを活用していてすごいと思います！\n昨年 [2016-12-14-1] に引き続き、今年も生活に関する記事です。ダイエッ\nトは皆さん興味があると思うので、とても有用な情報かと思います。\n実際試して、結果的に全部失敗しています。この記事をアンチパターンと\nして試せば、成功するのではないでしょうか？（えぇ..）\n1. ヘルシア緑茶を 3 ヶ月間飲み続ける 川崎の平間に住んでいた頃なので、2004 年秋頃だと思います。\n経緯は忘れましたが、ヘルシア緑茶を毎日 1 本、3 ヶ月間飲み続けまし\nた。毎日バラで買うのは大変なので、近所の酒屋での箱買いです。\n「ヘルシア緑茶飲んでいるからへーきへーき」と食事制限はしませんでした。\n★結果: 何も変わらず。むしろ増えた記憶が。ヘルシア緑茶のようにほろ\n苦い思い出です。\n2. ジムに毎日通う 時は流れ、2010 年 9 月。それまで全く運動をしていなかったのに、急に\n近所のジムに通い始めました。今は無きクイックシェイプというジムです。\n最初の何ヶ月かは本当に毎日通っていて、行かないのはジムが休みの金曜\n日と、たまの飲み会の日くらいでした。\nこれらの記事に意識高くまとまっています。\n[2011-03-05-1] [2011-03-05-2] [2011-03-05-3] 今でもなぜあそこまでやる気があったのか分かりません。\n★結果: 意識が高くなりすぎて、新卒から 11 年在籍した会社を退職\n[2011-04-22-1] 。スタートアップで社員第一号として働き始める。\nダイエットには失敗。\n西明石に引っ越した 2011 年 4 月末まで、7 ヶ月間通いました。\n3. 野々池貯水池でウォーキング 一階のダイニングキッチンがオフィス、二階の各部屋に若者と住んでいた\nこの家の近所には、ジムなんて便利なものはありません。あるのは田んぼ\nくらいでした。\n自転車でいけるくらいの距離に野々池貯水池があり、老若男女がジョギン\nグやウォーキング、犬の散歩などをしていました。","contentSnippet":"この記事は feedforce Advent Calendar 2017 の 19 日目の記事です。18 日目はなべはるさんの『ITベンチャー企業の人事が使っている SaaS10選！ 』でした。なべはるさんは一日に食べるアイスと同じくらい SaaSを活用していてすごいと思います！昨年 [2016-12-14-1] に引き続き、今年も生活に関する記事です。ダイエットは皆さん興味があると思うので、とても有用な情報かと思います。実際試して、結果的に全部失敗しています。この記事をアンチパターンとして試せば、成功するのではないでしょうか？（えぇ..）1. ヘルシア緑茶を 3 ヶ月間飲み続ける 川崎の平間に住んでいた頃なので、2004 年秋頃だと思います。経緯は忘れましたが、ヘルシア緑茶を毎日 1 本、3 ヶ月間飲み続けました。毎日バラで買うのは大変なので、近所の酒屋での箱買いです。「ヘルシア緑茶飲んでいるからへーきへーき」と食事制限はしませんでした。★結果: 何も変わらず。むしろ増えた記憶が。ヘルシア緑茶のようにほろ苦い思い出です。2. ジムに毎日通う 時は流れ、2010 年 9 月。それまで全く運動をしていなかったのに、急に近所のジムに通い始めました。今は無きクイックシェイプというジムです。最初の何ヶ月かは本当に毎日通っていて、行かないのはジムが休みの金曜日と、たまの飲み会の日くらいでした。これらの記事に意識高くまとまっています。[2011-03-05-1] [2011-03-05-2] [2011-03-05-3] 今でもなぜあそこまでやる気があったのか分かりません。★結果: 意識が高くなりすぎて、新卒から 11 年在籍した会社を退職[2011-04-22-1] 。スタートアップで社員第一号として働き始める。ダイエットには失敗。西明石に引っ越した 2011 年 4 月末まで、7 ヶ月間通いました。3. 野々池貯水池でウォーキング 一階のダイニングキッチンがオフィス、二階の各部屋に若者と住んでいたこの家の近所には、ジムなんて便利なものはありません。あるのは田んぼくらいでした。自転車でいけるくらいの距離に野々池貯水池があり、老若男女がジョギングやウォーキング、犬の散歩などをしていました。","link":"https://masutaka.net/2017-12-19-1/","isoDate":"2017-12-19T00:00:00.000Z","dateMiliSeconds":1513641600000,"authorName":"masutaka"},{"title":"github-nippou という gem を golang で書き直したという発表をした","content":"\u003cp\u003eこんにちは。増田（\u003ca href=\"http://blog.hatena.ne.jp/masutaka26/\" class=\"hatena-id-icon\"\u003e\u003cimg src=\"https://cdn1.www.st-hatena.com/users/ma/masutaka26/profile.gif\" width=\"16\" height=\"16\" alt=\"\" class=\"hatena-id-icon\"\u003eid:masutaka26\u003c/a\u003e）です。社内勉強会の順番が来ると、２ヶ月前くらいからソワソワしてきます。\u003c/p\u003e\n\n\u003cp\u003eそんなわけで今回は『日報を golang で支える技術』というお題で発表しました。\u003c/p\u003e\n\n\u003ch2\u003e発表の内容\u003c/h2\u003e\n\n\u003cscript async class=\"speakerdeck-embed\" data-id=\"b96e99d03504492f85e58bff0c8d1171\" data-ratio=\"1.33333333333333\" src=\"//speakerdeck.com/assets/embed.js\"\u003e\u003c/script\u003e\n\n\n\u003cp\u003e以下、スライドからの抜粋です。\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003e背景など\n\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://masutaka.net/chalow/2016-04-09-1.html\"\u003e以前の社内勉強会で github-nippou という gem を紹介した\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003eひとつの ruby スクリプトからそこそこ作り込み、毎日便利に使っている\u003c/li\u003e\n\u003cli\u003e先日も同僚の \u003ca href=\"https://github.com/ryz310\"\u003e@ryz310\u003c/a\u003e から pull request をもらって、さらに便利になった\u003c/li\u003e\n\u003cli\u003eからの、golang への書き換えをした。その場でライブリリース\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eモチベーション\n\n\u003cul\u003e\n\u003cli\u003e以前 \u003ca href=\"https://github.com/github/hub/releases/tag/v2.2.0\"\u003ehub コマンドが ruby から golang に移行した\u003c/a\u003eのを見て、一度やってみたかった\u003c/li\u003e\n\u003cli\u003erubygems の CLI を Dockerize してポータビリティを高めるのは何かが違うという気持ち\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/ryz310\"\u003e@ryz310\u003c/a\u003e からもらった元気\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e当たり前だけど、全て代わりの方法を調べて実装しなければいけなかった\n\n\u003cul\u003e\n\u003cli\u003eoctokit → go-github, thor → cobra など。Assets の取り扱いも変わる\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e良かったこと\n\n\u003cul\u003e\n\u003cli\u003e１バイナリになったのでインストールやアップデートが容易になった\u003c/li\u003e\n\u003cli\u003eパフォーマンスも予想外に上がった（当社比約２倍）\n\n\u003cul\u003e\n\u003cli\u003e以前調べた時は GitHub への API アクセスがボトルネックだったので、そこまで変わらないと思っていた\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e結果的にいろんなライブラリを使えて、良い素振りになった\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e困ったこと\n\n\u003cul\u003e\n\u003cli\u003eとにかく関数が長くなりがち\u003c/li\u003e\n\u003cli\u003egetXXX() 多くなりすぎ\u003c/li\u003e\n\u003cli\u003eファイル分割の意味\u003c/li\u003e\n\u003cli\u003e書けば書くほど golang っぽい書き方が分からなくなる\u003c/li\u003e\n\u003cli\u003eOOP ではないことへの戸惑い\u003c/li\u003e\n\u003cli\u003eruby が柔軟すぎて移植は難しかった。オススメはしない\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e疑問など\n\n\u003cul\u003e\n\u003cli\u003eclass設計で便利だった、private method の代わり\n\n\u003cul\u003e\n\u003cli\u003e設計し直すべきか\u003c/li\u003e\n\u003cli\u003eclassを 使わなかった頃の JS の知見を知りたい\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eビジネスロジックのパッケージ名はどうすれば\n\n\u003cul\u003e\n\u003cli\u003e今回は lib にした\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e感想\n\n\u003cul\u003e\n\u003cli\u003e今後、rubygems で CLI ツールを作ることはないと思う。継続利用を考えると勧めづらい\u003c/li\u003e\n\u003cli\u003egolang は単一ファイルでの実装と実行に一番ハードルが低い気がしている\n\n\u003cul\u003e\n\u003cli\u003eもっと楽な言語あったら教えて\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e今後の予定\n\n\u003cul\u003e\n\u003cli\u003egolang っぽい書き方にする\u003c/li\u003e\n\u003cli\u003eもっとテストを書く\u003c/li\u003e\n\u003cli\u003egolang on Lambda や API サーバも学習する\u003c/li\u003e\n\u003cli\u003e『\u003ca href=\"https://www.amazon.co.jp/dp/B01FH3KRTI\"\u003eスターティングGo言語\u003c/a\u003e』を読み切る\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\n\n\u003ch2\u003e結果\u003c/h2\u003e\n\n\u003cp\u003e\u003cspan itemscope itemtype=\"http://schema.org/Photograph\"\u003e\u003cimg src=\"https://cdn-ak.f.st-hatena.com/images/fotolife/m/masutaka26/20171014/20171014163806.png\" alt=\"f:id:masutaka26:20171014163806p:plain\" title=\"f:id:masutaka26:20171014163806p:plain\" class=\"hatena-fotolife\" itemprop=\"image\"\u003e\u003c/span\u003e\u003c/p\u003e\n\n\u003cp\u003e↓\u003c/p\u003e\n\n\u003cp\u003e\u003cspan itemscope itemtype=\"http://schema.org/Photograph\"\u003e\u003cimg src=\"https://cdn-ak.f.st-hatena.com/images/fotolife/m/masutaka26/20171014/20171014163802.png\" alt=\"f:id:masutaka26:20171014163802p:plain\" title=\"f:id:masutaka26:20171014163802p:plain\" class=\"hatena-fotolife\" itemprop=\"image\"\u003e\u003c/span\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://github.com/masutaka/github-nippou\"\u003ehttps://github.com/masutaka/github-nippou\u003c/a\u003e\u003c/p\u003e\n\n\u003ch2\u003e発表の感想\u003c/h2\u003e\n\n\u003cp\u003e付箋紙に感想を書いてくれました。\u003ci class=\"blogicon-comment\" aria-hidden=\"true\"\u003e\u003c/i\u003e は私からのコメントです。\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eクラス設計周りの話は自分も悩んでいます\n\n\u003cul\u003e\n\u003cli\u003e\u003ci class=\"blogicon-comment\" aria-hidden=\"true\"\u003e\u003c/i\u003e ライブラリとか読んで学習します！\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eGraphQL 対応の PR 出すぞ\n\n\u003cul\u003e\n\u003cli\u003e\u003ci class=\"blogicon-comment\" aria-hidden=\"true\"\u003e\u003c/i\u003e お待ちしております！\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eGo の GraphQL のクライアント側はまだなさそう\n\n\u003cul\u003e\n\u003cli\u003e\u003ci class=\"blogicon-comment\" aria-hidden=\"true\"\u003e\u003c/i\u003e \u003ca href=\"https://github.com/graphql-go/graphql\"\u003egithub.com/graphql-go/graphql\u003c/a\u003e を見つけました。API リクエストを 1 回に出来るのかな？\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eCLI は ruby \u0026lt; golang わかる。mruby も良いかも\n\n\u003cul\u003e\n\u003cli\u003e\u003ci class=\"blogicon-comment\" aria-hidden=\"true\"\u003e\u003c/i\u003e mruby はエコシステムが大変そうで...\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eMakefile 参考にします\n\n\u003cul\u003e\n\u003cli\u003e\u003ci class=\"blogicon-comment\" aria-hidden=\"true\"\u003e\u003c/i\u003e あざす！\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eMakefile 全く分からない... 勉強しないと！！\n\n\u003cul\u003e\n\u003cli\u003e\u003ci class=\"blogicon-comment\" aria-hidden=\"true\"\u003e\u003c/i\u003e 基本だったら１日くらいで分かりますよ。make はビルドを必要な時だけに抑えられるので良いです\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e流石ますたかさん とても面白く熱量ある発表でした\n\n\u003cul\u003e\n\u003cli\u003e\u003ci class=\"blogicon-comment\" aria-hidden=\"true\"\u003e\u003c/i\u003e ありがとうございます。熱量は大事にしてます\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e神回ですね\n\n\u003cul\u003e\n\u003cli\u003e\u003ci class=\"blogicon-comment\" aria-hidden=\"true\"\u003e\u003c/i\u003e もっと技術レベル上げていきます！\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e刺激を受けるいい話だった\n\n\u003cul\u003e\n\u003cli\u003e\u003ci class=\"blogicon-comment\" aria-hidden=\"true\"\u003e\u003c/i\u003e 刺激を与えるのがエンジニアとして使命のひとつだと思っています\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eスピード up は nice 発見\n\n\u003cul\u003e\n\u003cli\u003e\u003ci class=\"blogicon-comment\" aria-hidden=\"true\"\u003e\u003c/i\u003e ですね\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eやっぱりはやくなるものなんだなー\u003c/p\u003e\n\n\u003cp\u003e  \u003cspan itemscope itemtype=\"http://schema.org/Photograph\"\u003e\u003cimg src=\"https://cdn-ak.f.st-hatena.com/images/fotolife/m/masutaka26/20171014/20171014160652.jpg\" alt=\"f:id:masutaka26:20171014160652j:plain\" title=\"f:id:masutaka26:20171014160652j:plain\" class=\"hatena-fotolife\" itemprop=\"image\"\u003e\u003c/span\u003e\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003e\u003ci class=\"blogicon-comment\" aria-hidden=\"true\"\u003e\u003c/i\u003e 速いだけでテンションが上がります\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003egolang 熱の高まり・・・！！\n\n\u003cul\u003e\n\u003cli\u003e\u003ci class=\"blogicon-comment\" aria-hidden=\"true\"\u003e\u003c/i\u003e やりましょう！\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003ego モチベーションの高さの理由が分かりました！！\n\n\u003cul\u003e\n\u003cli\u003e\u003ci class=\"blogicon-comment\" aria-hidden=\"true\"\u003e\u003c/i\u003e もう必死ですよ\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eずっと Go 書いてたのはこれだったのかー（棒）\n\n\u003cul\u003e\n\u003cli\u003e\u003ci class=\"blogicon-comment\" aria-hidden=\"true\"\u003e\u003c/i\u003e そうなんですよー（棒）\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eGo 書きたい\n\n\u003cul\u003e\n\u003cli\u003e\u003ci class=\"blogicon-comment\" aria-hidden=\"true\"\u003e\u003c/i\u003e 今書きましょう！\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eゴー書いてく！！\u003c/p\u003e\n\n\u003cp\u003e  \u003cspan itemscope itemtype=\"http://schema.org/Photograph\"\u003e\u003cimg src=\"https://cdn-ak.f.st-hatena.com/images/fotolife/m/masutaka26/20171014/20171014160710.jpg\" alt=\"f:id:masutaka26:20171014160710j:plain\" title=\"f:id:masutaka26:20171014160710j:plain\" class=\"hatena-fotolife\" itemprop=\"image\"\u003e\u003c/span\u003e\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003e\u003ci class=\"blogicon-comment\" aria-hidden=\"true\"\u003e\u003c/i\u003e ｱ､ﾊｲ\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eざんねん！！わたし（@ryz310）の PR はここでおわってしまった！！\n\n\u003cul\u003e\n\u003cli\u003e\u003ci class=\"blogicon-comment\" aria-hidden=\"true\"\u003e\u003c/i\u003e またお待ちしております！（笑）\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eバイナリ配布うれしい！\n\n\u003cul\u003e\n\u003cli\u003e\u003ci class=\"blogicon-comment\" aria-hidden=\"true\"\u003e\u003c/i\u003e ユーザの皆様のことを第一に考えております\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eCLI は golang \u003cdel\u003eWeb やる気にはなら…\u003c/del\u003e\n\n\u003cul\u003e\n\u003cli\u003e\u003ci class=\"blogicon-comment\" aria-hidden=\"true\"\u003e\u003c/i\u003e 配布を考えるとそうですねー。今は GitHub でリリースしておけば、Homebrew や zplug など配布手段はいろいろありますし\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eディストリビューション大変だなー\n\n\u003cul\u003e\n\u003cli\u003e\u003ci class=\"blogicon-comment\" aria-hidden=\"true\"\u003e\u003c/i\u003e gox で簡単に並列ビルドできるので、それほど大変ではなかったですね\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e知見 ライブデプロイ is つらい\n\n\u003cul\u003e\n\u003cli\u003e\u003ci class=\"blogicon-comment\" aria-hidden=\"true\"\u003e\u003c/i\u003e もうハラハラドキドキですよ\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eライブデプロイメント\n\n\u003cul\u003e\n\u003cli\u003e\u003ci class=\"blogicon-comment\" aria-hidden=\"true\"\u003e\u003c/i\u003e やはり初回の CI は絶対失敗しますね...\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e（社内 Slack の）#golang を今後ともよろしくお願いします\n\n\u003cul\u003e\n\u003cli\u003e\u003ci class=\"blogicon-comment\" aria-hidden=\"true\"\u003e\u003c/i\u003e こちらこそ！\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\n\n\u003ch2\u003e最後に\u003c/h2\u003e\n\n\u003cp\u003eとにかく設計が目下の悩みです。良い情報があれば教えてください！\u003c/p\u003e\n","contentSnippet":"こんにちは。増田（id:masutaka26）です。社内勉強会の順番が来ると、２ヶ月前くらいからソワソワしてきます。そんなわけで今回は『日報を golang で支える技術』というお題で発表しました。発表の内容以下、スライドからの抜粋です。背景など以前の社内勉強会で github-nippou という gem を紹介したひとつの ruby スクリプトからそこそこ作り込み、毎日便利に使っている先日も同僚の @ryz310 から pull request をもらって、さらに便利になったからの、golang への書き換えをした。その場でライブリリースモチベーション以前 hub コマンドが ruby から golang に移行したのを見て、一度やってみたかったrubygems の CLI を Dockerize してポータビリティを高めるのは何かが違うという気持ち@ryz310 からもらった元気当たり前だけど、全て代わりの方法を調べて実装しなければいけなかったoctokit → go-github, thor → cobra など。Assets の取り扱いも変わる良かったこと１バイナリになったのでインストールやアップデートが容易になったパフォーマンスも予想外に上がった（当社比約２倍）以前調べた時は GitHub への API アクセスがボトルネックだったので、そこまで変わらないと思っていた結果的にいろんなライブラリを使えて、良い素振りになった困ったこととにかく関数が長くなりがちgetXXX() 多くなりすぎファイル分割の意味書けば書くほど golang っぽい書き方が分からなくなるOOP ではないことへの戸惑いruby が柔軟すぎて移植は難しかった。オススメはしない疑問などclass設計で便利だった、private method の代わり設計し直すべきかclassを 使わなかった頃の JS の知見を知りたいビジネスロジックのパッケージ名はどうすれば今回は lib にした感想今後、rubygems で CLI ツールを作ることはないと思う。継続利用を考えると勧めづらいgolang は単一ファイルでの実装と実行に一番ハードルが低い気がしているもっと楽な言語あったら教えて今後の予定golang っぽい書き方にするもっとテストを書くgolang on Lambda や API サーバも学習する『スターティングGo言語』を読み切る結果↓https://github.com/masutaka/github-nippou発表の感想付箋紙に感想を書いてくれました。 は私からのコメントです。クラス設計周りの話は自分も悩んでいます ライブラリとか読んで学習します！GraphQL 対応の PR 出すぞ お待ちしております！Go の GraphQL のクライアント側はまだなさそう github.com/graphql-go/graphql を見つけました。API リクエストを 1 回に出来るのかな？CLI は ruby \u003c golang わかる。mruby も良いかも mruby はエコシステムが大変そうで...Makefile 参考にします あざす！Makefile 全く分からない... 勉強しないと！！ 基本だったら１日くらいで分かりますよ。make はビルドを必要な時だけに抑えられるので良いです流石ますたかさん とても面白く熱量ある発表でした ありがとうございます。熱量は大事にしてます神回ですね もっと技術レベル上げていきます！刺激を受けるいい話だった 刺激を与えるのがエンジニアとして使命のひとつだと思っていますスピード up は nice 発見 ですねやっぱりはやくなるものなんだなー   速いだけでテンションが上がりますgolang 熱の高まり・・・！！ やりましょう！go モチベーションの高さの理由が分かりました！！ もう必死ですよずっと Go 書いてたのはこれだったのかー（棒） そうなんですよー（棒）Go 書きたい 今書きましょう！ゴー書いてく！！   ｱ､ﾊｲざんねん！！わたし（@ryz310）の PR はここでおわってしまった！！ またお待ちしております！（笑）バイナリ配布うれしい！ ユーザの皆様のことを第一に考えておりますCLI は golang Web やる気にはなら… 配布を考えるとそうですねー。今は GitHub でリリースしておけば、Homebrew や zplug など配布手段はいろいろありますしディストリビューション大変だなー gox で簡単に並列ビルドできるので、それほど大変ではなかったですね知見 ライブデプロイ is つらい もうハラハラドキドキですよライブデプロイメント やはり初回の CI は絶対失敗しますね...（社内 Slack の）#golang を今後ともよろしくお願いします こちらこそ！最後にとにかく設計が目下の悩みです。良い情報があれば教えてください！","link":"https://developer.feedforce.jp/entry/2017/10/16/150000","isoDate":"2017-10-16T06:00:00.000Z","dateMiliSeconds":1508133600000,"imageUrl":"https://cdn-ak.f.st-hatena.com/images/fotolife/m/masutaka26/20171014/20171014163802.png","authorName":"masutaka"},{"title":"不惑の年に風呂の良さを知った","content":"この記事は feedforce Advent Calendar 2016 の 14 日目の記事です。\n13 日目はハッシーの『フィードフォースでの映像制作について 』でした。\n彼らがつい二週間前にリリース(?)したシンゴジラのパロディムービーは、\n密かに今までで一番のお気に入りです。社内限定で今までのムービー見ら\nれないかなー。\nさて、私も表題の年齢になり、季節の変わり目はひどい肩こりや頭痛に悩\nまされる日が出てきました。普段は気になりませんが、この時だけはたま\nらず整体に行きます。あまりにひどいと寝込んでしまうことも。\nとは言え、昔から体だけは丈夫で、体調が悪くなることはそうそうありま\nせん。寝込むのは年に一度くらい。あと二日酔い。二日酔いツライ。\nただ、体が冷えるとあっさり風邪を引くことが分かってきたので、会社で\nは毛布モドキを被り、家では着ぐるみモドキ を履き、だいぶ気を付けてい\nます。\n10 月のあの日もそうでした。急に気温が下がり、肩がこり、こりゃ風邪\n引くかなーと思っていたところ、何の気なしに湯船にお湯を張り風呂に入\nりました。１年前に引っ越してから初めての風呂です（汚くはない）。\nそしたらびっくり。肩こりがすーっと消え、体もポカポカです。その日を\n境に、週に何度か風呂に入る日が始まりました。\nどのようにして風呂に入るか 詳しく説明させて頂きます。\n何はなくともまずは掃除です。今の部屋に引っ越してから、CaSy に月一\nで来てもらっている [2015-12-27-1] ので、基本的にはきれいです。でも\n入る前の掃除はもちろんします。\n掃除が終わったらお湯を溜めます。10 月だと 44 度、今だったら 45 度\nくらいを 10 分ですね。私は昔から熱い風呂は好きではないのですが、風\n呂の蓋は買ってないので設定温度は熱めです。\n未だにお湯張りタイマーの使い方が分かりません。一度、90 リットルの\nつもりが、90 度のお湯を溜めてしまい、泣きながら水で薄め続けました。\nお湯が溜まったら速やかに風呂に入ります。iPhone をドアの外に置き、\n静かな音楽をかけます。給水用のお茶や水も置きます。間違ってもついで\nの洗濯は止めましょう。静かな音楽が台無しです。\n軽くお湯で体を流し、湯船にゆっくりと浸かります。歯磨きをするのも良\nいでしょう。\n適度に暖まったら体を洗います。朝の忙しい時間ではないので、ゆっくり\n出来るのが良いですね。洗い終わったらまた湯船に浸かります。この辺で\n給水するのも良いでしょう。\n次は頭を洗います。最近は意識高いので、３日に一度はこちらで皮脂をズ\nビっと落としています。リンスやコンディショナー必須。\nそれ以外はこちらを使っています。逆に皮脂を落としすぎないシャンプー\nです。リンスやコンディショナー不要です。前々職の先輩に教えてもらい\nました。\nどちらも安くないですが、一日あたりに換算すると大したことないので、\nここ数年使っています。\n顔を洗いつつ髭を剃ったら、最後の湯船です。風呂で髭を剃る人って、ど\nのくらいいるのですかね？\n出る時に潔くお湯を捨てます。以前は洗濯に使っていましたが、水道代が","contentSnippet":"この記事は feedforce Advent Calendar 2016 の 14 日目の記事です。13 日目はハッシーの『フィードフォースでの映像制作について 』でした。彼らがつい二週間前にリリース(?)したシンゴジラのパロディムービーは、密かに今までで一番のお気に入りです。社内限定で今までのムービー見られないかなー。さて、私も表題の年齢になり、季節の変わり目はひどい肩こりや頭痛に悩まされる日が出てきました。普段は気になりませんが、この時だけはたまらず整体に行きます。あまりにひどいと寝込んでしまうことも。とは言え、昔から体だけは丈夫で、体調が悪くなることはそうそうありません。寝込むのは年に一度くらい。あと二日酔い。二日酔いツライ。ただ、体が冷えるとあっさり風邪を引くことが分かってきたので、会社では毛布モドキを被り、家では着ぐるみモドキ を履き、だいぶ気を付けています。10 月のあの日もそうでした。急に気温が下がり、肩がこり、こりゃ風邪引くかなーと思っていたところ、何の気なしに湯船にお湯を張り風呂に入りました。１年前に引っ越してから初めての風呂です（汚くはない）。そしたらびっくり。肩こりがすーっと消え、体もポカポカです。その日を境に、週に何度か風呂に入る日が始まりました。どのようにして風呂に入るか 詳しく説明させて頂きます。何はなくともまずは掃除です。今の部屋に引っ越してから、CaSy に月一で来てもらっている [2015-12-27-1] ので、基本的にはきれいです。でも入る前の掃除はもちろんします。掃除が終わったらお湯を溜めます。10 月だと 44 度、今だったら 45 度くらいを 10 分ですね。私は昔から熱い風呂は好きではないのですが、風呂の蓋は買ってないので設定温度は熱めです。未だにお湯張りタイマーの使い方が分かりません。一度、90 リットルのつもりが、90 度のお湯を溜めてしまい、泣きながら水で薄め続けました。お湯が溜まったら速やかに風呂に入ります。iPhone をドアの外に置き、静かな音楽をかけます。給水用のお茶や水も置きます。間違ってもついでの洗濯は止めましょう。静かな音楽が台無しです。軽くお湯で体を流し、湯船にゆっくりと浸かります。歯磨きをするのも良いでしょう。適度に暖まったら体を洗います。朝の忙しい時間ではないので、ゆっくり出来るのが良いですね。洗い終わったらまた湯船に浸かります。この辺で給水するのも良いでしょう。次は頭を洗います。最近は意識高いので、３日に一度はこちらで皮脂をズビっと落としています。リンスやコンディショナー必須。それ以外はこちらを使っています。逆に皮脂を落としすぎないシャンプーです。リンスやコンディショナー不要です。前々職の先輩に教えてもらいました。どちらも安くないですが、一日あたりに換算すると大したことないので、ここ数年使っています。顔を洗いつつ髭を剃ったら、最後の湯船です。風呂で髭を剃る人って、どのくらいいるのですかね？出る時に潔くお湯を捨てます。以前は洗濯に使っていましたが、水道代が","link":"https://masutaka.net/2016-12-14-1/","isoDate":"2016-12-14T00:00:00.000Z","dateMiliSeconds":1481673600000,"authorName":"masutaka"},{"title":"ドッグフーディングを始めてみた","content":"赤枠がソーシャルPLUS のコメントウィジェット。全然違和感がない。\n今までその下にある Zenback の Facebook コメントフォームを有効にし\nてましたが、使われませんし飽きてきました。ちなみにその前は DISQUS で[2010-05-03-1] 、その前はくっつきBBS でした[2008-09-29-1] 。\nまだ Twitter ログインにしか対応していませんが、これから各種ソーシャ\nルログインに対応していくかも？\n本当はメイン機能であるログインと繋ぎ込みをしたり、他のウィジェット\n（アクションボタン、シェアウィジェット、プロバイダーボタンバー、ア\nクティビティウィジェット等）もフルで使いたかったのですが、このブロ\nグが静的サイトということもあり面倒になって止めました。","contentSnippet":"赤枠がソーシャルPLUS のコメントウィジェット。全然違和感がない。今までその下にある Zenback の Facebook コメントフォームを有効にしてましたが、使われませんし飽きてきました。ちなみにその前は DISQUS で[2010-05-03-1] 、その前はくっつきBBS でした[2008-09-29-1] 。まだ Twitter ログインにしか対応していませんが、これから各種ソーシャルログインに対応していくかも？本当はメイン機能であるログインと繋ぎ込みをしたり、他のウィジェット（アクションボタン、シェアウィジェット、プロバイダーボタンバー、アクティビティウィジェット等）もフルで使いたかったのですが、このブログが静的サイトということもあり面倒になって止めました。","link":"https://masutaka.net/2015-07-02-1/","isoDate":"2015-07-02T00:00:00.000Z","dateMiliSeconds":1435795200000,"authorName":"masutaka"},{"title":"会社の技術ブログを書きました(3回目)","content":"[2014-10-20-1] に引き続き、会社の技術ブログを書きました。\nVagrantで簡単に作れる！！RubyやKyotoTycoonのrpmたち｜feedforce Engineers\u0026rsquo; blog CentOSを本番環境で使っている方は、Rubyのバージョンアップはどうして\nいるんですかね？\nrbenvを使っているところもあるのかな。記事にも書いたけど、それだと\nサーバのCIは使いものにならないけど。\n最近はサーバのCIやDockerのおかげか、低レイヤーな技術が見直されてい\nる気がします。前者は今回のrpm、後者はシェルスクリプト。\n個人的には地味な技術は好きなのでちょっとうれしい。","contentSnippet":"[2014-10-20-1] に引き続き、会社の技術ブログを書きました。Vagrantで簡単に作れる！！RubyやKyotoTycoonのrpmたち｜feedforce Engineers’ blog CentOSを本番環境で使っている方は、Rubyのバージョンアップはどうしているんですかね？rbenvを使っているところもあるのかな。記事にも書いたけど、それだとサーバのCIは使いものにならないけど。最近はサーバのCIやDockerのおかげか、低レイヤーな技術が見直されている気がします。前者は今回のrpm、後者はシェルスクリプト。個人的には地味な技術は好きなのでちょっとうれしい。","link":"https://masutaka.net/2014-12-11-1/","isoDate":"2014-12-11T00:00:00.000Z","dateMiliSeconds":1418256000000,"authorName":"masutaka"},{"title":"会社の技術ブログを書きました(2回目)","content":"[2014-08-09-1] に引き続き、会社の技術ブログを書きました。\nJenkinsでサーバのCIを始めました｜feedforce Engineers\u0026rsquo; blog ネタ的には新しくはないのですが、フィードフォースのエンジニアが今今\nどんなことをしているかを伝えたくて書きました。\nこういう記事を投稿し続けていけば、興味あるエンジニアの目に止まるん\nじゃないかと。\n弊社は最近採用に力を入れています。\n結構気軽に会いにいけるので、興味ある方はどうぞ☆\nフィードフォースは「会いにいける！」ベンチャーです！(社長指名可) - 株式会社フィードフォースの求人 - Wantedly Rubyで開発したいエンジニアをウォンテッド！（土日面談／スカイプ面談可） - 株式会社フィードフォースの求人 - Wantedly 【株式会社フィードフォースの求人】 【自社サービス開発／新規事業立ち上げ／残業10H以内／土日面談可】Webエンジニア - Forkwell Jobs ","contentSnippet":"[2014-08-09-1] に引き続き、会社の技術ブログを書きました。JenkinsでサーバのCIを始めました｜feedforce Engineers’ blog ネタ的には新しくはないのですが、フィードフォースのエンジニアが今今どんなことをしているかを伝えたくて書きました。こういう記事を投稿し続けていけば、興味あるエンジニアの目に止まるんじゃないかと。弊社は最近採用に力を入れています。結構気軽に会いにいけるので、興味ある方はどうぞ☆フィードフォースは「会いにいける！」ベンチャーです！(社長指名可) - 株式会社フィードフォースの求人 - Wantedly Rubyで開発したいエンジニアをウォンテッド！（土日面談／スカイプ面談可） - 株式会社フィードフォースの求人 - Wantedly 【株式会社フィードフォースの求人】 【自社サービス開発／新規事業立ち上げ／残業10H以内／土日面談可】Webエンジニア - Forkwell Jobs","link":"https://masutaka.net/2014-10-20-1/","isoDate":"2014-10-20T00:00:00.000Z","dateMiliSeconds":1413763200000,"authorName":"masutaka"},{"title":"初めて会社の技術ブログを書きました","content":"アジャイル開発で便利だったホワイトボードなどまとめ｜feedforce Engineers\u0026rsquo; blog 先週の話ですが。\n3月に入社して早5ヶ月。\n何度か書く書く詐欺してましたが、ようやく書きました。\n特に奇をてらったわけではなく、自分が興味あることをまとめただけ。\nこのブログも同じです。\n良い記事が書けると、何度も読み返したくなりますね。\n自分が一番の読者です。\n次回は技術の話を書く。","contentSnippet":"アジャイル開発で便利だったホワイトボードなどまとめ｜feedforce Engineers’ blog 先週の話ですが。3月に入社して早5ヶ月。何度か書く書く詐欺してましたが、ようやく書きました。特に奇をてらったわけではなく、自分が興味あることをまとめただけ。このブログも同じです。良い記事が書けると、何度も読み返したくなりますね。自分が一番の読者です。次回は技術の話を書く。","link":"https://masutaka.net/2014-08-09-1/","isoDate":"2014-08-09T00:00:00.000Z","dateMiliSeconds":1407542400000,"authorName":"masutaka"},{"title":"会社でルーキー賞に選ばれた","content":"3月に入社し[2014-03-09-1] 、先月が弊社フィードフォース の期の終わりで\nした。そして今日が納会(※)。運良く、ルーキー賞(の1人)に選ばれました。\n※ 納会が年末以外にもあることにビックリ。\n何度かお話しましたが、私の能力が云々という話では全くなくて、単純に\nタイミングが良かっただけだと感じています。\n納会を企画したイベントチーム、ならびに私を選んで頂いた方、業務でお\n世話になった方、その他もろもろありがとうございました。\n組み込み業界から前職ラングリッチ に飛び込んだ時[2011-04-22-1] 、意外\nにも今までの経験がちょいちょい役に立ちました。\n今のフィードフォースでは、あの時以上にタイミングよく、皆さんのお役\nに立てたようで嬉しいです。自分の成長と会社の成長が、いい感じに重なっ\nたというか。\n役に立ったと思われるのは以下のとおり。\n・アジャイル開発の経験\n・チームビルディング\n・GitHub的ななにか\n・Rails\u0026amp;Rspec全般\n・Chef\u0026amp;Serverspec全般\n・ELF的な知識\n地固めが出来たので、これからはより技術的なことに挑戦していきます。\nぶっちゃけ、そちらに関しては他の開発者の方のほうが詳しいので、その\n辺は教えを請いつつ学びつつ、チームの力を伸ばしていくことに集中します。\n私個人も成長しますが、チーム力を高めたほうがなにかと早いので。\n今後ともよろしくお願いします。","contentSnippet":"3月に入社し[2014-03-09-1] 、先月が弊社フィードフォース の期の終わりでした。そして今日が納会(※)。運良く、ルーキー賞(の1人)に選ばれました。※ 納会が年末以外にもあることにビックリ。何度かお話しましたが、私の能力が云々という話では全くなくて、単純にタイミングが良かっただけだと感じています。納会を企画したイベントチーム、ならびに私を選んで頂いた方、業務でお世話になった方、その他もろもろありがとうございました。組み込み業界から前職ラングリッチ に飛び込んだ時[2011-04-22-1] 、意外にも今までの経験がちょいちょい役に立ちました。今のフィードフォースでは、あの時以上にタイミングよく、皆さんのお役に立てたようで嬉しいです。自分の成長と会社の成長が、いい感じに重なったというか。役に立ったと思われるのは以下のとおり。・アジャイル開発の経験・チームビルディング・GitHub的ななにか・Rails\u0026Rspec全般・Chef\u0026Serverspec全般・ELF的な知識地固めが出来たので、これからはより技術的なことに挑戦していきます。ぶっちゃけ、そちらに関しては他の開発者の方のほうが詳しいので、その辺は教えを請いつつ学びつつ、チームの力を伸ばしていくことに集中します。私個人も成長しますが、チーム力を高めたほうがなにかと早いので。今後ともよろしくお願いします。","link":"https://masutaka.net/2014-06-13-1/","isoDate":"2014-06-13T00:00:00.000Z","dateMiliSeconds":1402617600000,"authorName":"masutaka"},{"title":"Railsセミナーに行ってきた #railssemi","content":"【学生無料！】【Railsセミナー】Why choose Ruby on Rails ? : ATND 弊社フィードフォースの応援要員として、メンバーズ様主催のRailsセミナーに行ってきました。メモ程度ですが軽く記録しときます。\n◆第1部 名刺管理アプリ「Eight」を育てるチームと技術\nSansan株式会社 宍倉功一さん\n法人向けのSanSanは.NETだが、個人向けのEightはRailsを採用。\nspider for MySQL使うとテーブル単位でDB分割できて便利。\nSLASHで効果測定。新人研修は徳島の一軒家で2週間。\n高負荷サービスの話聞けてよかった。\n◆第2部 Railsとアジャイルで変える受託開発\n株式会社メンバーズ 木村壮介さん\nCircleCIでfeature branchをHerokuに継続deploy - Masatomo Nakano Blog みたいなdeapというツール良かった。受託の関係でHerokuではなく、自社サーバを使うんだっけかな？\n◆第3部 変化を産み出すための組織文化作り\n株式会社フィードフォース 鈴木龍さん\n他の発表より生々しい感じで存在感を出せてた感。途中の「お金は大事だよー」の画像とか、HipChatの実際のチャットとか追加されてて、数日前の素振りよりもすごく良くなってた。\n◆第4部 国内最大級のクラウドソーシングサービス「クラウドワークス」のつくりかた\n株式会社クラウドワークス 大場光一郎さん\nCIはJenkinsツライのでSEMAPHORE を採用。\nAmazon Redshift(分散RDBS)を使用。\n分析用のプラットホームに向いてる Hadoopに似てる FlydataでRedShiftに転送\nなぜCircleCIじゃなくてSEMAPHOREを採用したのでしょう？と質問したら、無料期間中に最後までテスト出来たのがSEMAPHOREだけだったからとのこと。CircleCI含めた他のサービスはは15分以上かかるテストkillされてしまったらしい。 ◆懇親会\n何人かの方とお話出来た。弊社のメンバー多めだったけど。。\n大場さんと話すのがちょっとした目的だったので、ホント来た甲斐がありました。\nloading...\nloading...\nちなみに私が大場さんを認識したのは[2007-10-04-1] でした。しかもここ、メンバーズさんのサイトでした。いろいろ繋がります。ちょっと見ると、ソニックガーデン興す前の倉貫さんもいらっしゃる。","contentSnippet":"【学生無料！】【Railsセミナー】Why choose Ruby on Rails ? : ATND 弊社フィードフォースの応援要員として、メンバーズ様主催のRailsセミナーに行ってきました。メモ程度ですが軽く記録しときます。◆第1部 名刺管理アプリ「Eight」を育てるチームと技術Sansan株式会社 宍倉功一さん法人向けのSanSanは.NETだが、個人向けのEightはRailsを採用。spider for MySQL使うとテーブル単位でDB分割できて便利。SLASHで効果測定。新人研修は徳島の一軒家で2週間。高負荷サービスの話聞けてよかった。◆第2部 Railsとアジャイルで変える受託開発株式会社メンバーズ 木村壮介さんCircleCIでfeature branchをHerokuに継続deploy - Masatomo Nakano Blog みたいなdeapというツール良かった。受託の関係でHerokuではなく、自社サーバを使うんだっけかな？◆第3部 変化を産み出すための組織文化作り株式会社フィードフォース 鈴木龍さん他の発表より生々しい感じで存在感を出せてた感。途中の「お金は大事だよー」の画像とか、HipChatの実際のチャットとか追加されてて、数日前の素振りよりもすごく良くなってた。◆第4部 国内最大級のクラウドソーシングサービス「クラウドワークス」のつくりかた株式会社クラウドワークス 大場光一郎さんCIはJenkinsツライのでSEMAPHORE を採用。Amazon Redshift(分散RDBS)を使用。分析用のプラットホームに向いてる Hadoopに似てる FlydataでRedShiftに転送なぜCircleCIじゃなくてSEMAPHOREを採用したのでしょう？と質問したら、無料期間中に最後までテスト出来たのがSEMAPHOREだけだったからとのこと。CircleCI含めた他のサービスはは15分以上かかるテストkillされてしまったらしい。 ◆懇親会何人かの方とお話出来た。弊社のメンバー多めだったけど。。大場さんと話すのがちょっとした目的だったので、ホント来た甲斐がありました。loading...loading...ちなみに私が大場さんを認識したのは[2007-10-04-1] でした。しかもここ、メンバーズさんのサイトでした。いろいろ繋がります。ちょっと見ると、ソニックガーデン興す前の倉貫さんもいらっしゃる。","link":"https://masutaka.net/2014-05-12-2/","isoDate":"2014-05-12T01:00:00.000Z","dateMiliSeconds":1399856400000,"authorName":"masutaka"},{"title":"ラングリッチを退職し、フィードフォースに入社しました","content":"去年の11月14日にラングリッチ を退職しました。\n退職は人生２回目で[2011-04-22-1] のメタテクノ以来です。\n組み込み業界出身でWebの知識があまりない私を受け入れてくれたラングリッ\nチには、本当に感謝しております。\n今回の退職と転職活動では、多くの方にご心配とご迷惑をお掛けしました。\nこの場を借りてお礼とお詫びを申し上げます。\nラングリッチを振り返る 当時のラングリッチは会社設立からちょうど1年、サービスがローンチされ\nてから9ヶ月経ったあたりでした。\n社員はまだいなかったので、社員番号一桁 どころか社員第一号でした。\n社員番号などない的な。\n当時起きたことをまとめてみました。\n2010年7月17日 ラングリッチ誕生\n2010年8月5日 ラングリッチのプロモアカウントに捕捉される。 多分このツイート をした\nから。\n2010年8月25日 ラングリッチのレッスンを初受講。 滝のような汗は出たが、かなり面白かっ\nたのでレッスンを毎日受け続けることに！(元々私、ラングリッチの生徒だっ\nたんです。こんな記事も[2010-12-19-1] )\n2011年1月1日 ラングリッチのtomoyaさんにTwitterのダイレクトメッセージでコンタクト\nをとり、後日Skypeのチャットでいろいろお話。\n2011年3月2日 メタテクノ最終出社日\n2011年3月3日 有給消化期間を満喫し始める。\n2011年3月11日 14:46に東日本大震災発生。15:00からラングリッチのレッスンが始まって\nしまった(キャンセルはレッスン開始1時間前までw)。停電のためiPhoneの\nSkypeを使って、プライ先生に実況中継。\n2011年3月15日 地震の混乱が収まらない中、関西空港でtomoyaさんと落ち合いフィリピン\nはセブ島にGO!!\n2011年4月1日 サービスの裏側やフィリピンを体験して帰国。この辺からラングリッチの\nカスタマーサポートのお手伝い開始。開発にも着手し始める。\n2011年4月21日 メタテクノ退職日\n2011年4月27日 川崎から引っ越し。西明石行きの夜行バスに乗る。\n2011年4月28日 荷物が来るまでCEOの家に居候。\n2011年5月2日 荷物が来て、オフィス兼住居への引越し完了。\nラングリッチでは本当に色々なことを学びました。スタートアップの黎明\n期からの成長っぷりを体験できたことはもちろんですし、東京に進出して\nからは、アジャイル開発、TDD、まともなWebアプリケーションの作り方等、\nこれらは今も自分の資産となっております。\n最後の大きなプロジェクトはラングリッチへの恩返しのつもりで、全てを\n出し尽くしました。しかしこれが本当に大変で、期日までに終わるのかと\nいう不安があり昼夜問わず開発していたため、2ヶ月間の総コミット数は\n637にもなりました。\n※表示が変ですが、2013年8月31日から2013年11月1日の総コミット数です。\nもちろんこれは開発者の皆さんだけでなく、関係者全員のご協力のおかげ\nです。そもそもPull Request見てくれる人がいないと成立しないですし。\n開発内で言うと、セキュリティチェック、サーバ構築、フロントエンド、\n要件整理等、自然に役割分担されていきました。あ、オレこれやるわ的な。\n私はアプリ側を実装したため、コミット数が膨れ上がったというわけです。\n退職後 前回と違って、退職後は悠々自適の生活\u0026hellip;とはいかず、転職活動をしてい","contentSnippet":"去年の11月14日にラングリッチ を退職しました。退職は人生２回目で[2011-04-22-1] のメタテクノ以来です。組み込み業界出身でWebの知識があまりない私を受け入れてくれたラングリッチには、本当に感謝しております。今回の退職と転職活動では、多くの方にご心配とご迷惑をお掛けしました。この場を借りてお礼とお詫びを申し上げます。ラングリッチを振り返る 当時のラングリッチは会社設立からちょうど1年、サービスがローンチされてから9ヶ月経ったあたりでした。社員はまだいなかったので、社員番号一桁 どころか社員第一号でした。社員番号などない的な。当時起きたことをまとめてみました。2010年7月17日 ラングリッチ誕生2010年8月5日 ラングリッチのプロモアカウントに捕捉される。 多分このツイート をしたから。2010年8月25日 ラングリッチのレッスンを初受講。 滝のような汗は出たが、かなり面白かったのでレッスンを毎日受け続けることに！(元々私、ラングリッチの生徒だったんです。こんな記事も[2010-12-19-1] )2011年1月1日 ラングリッチのtomoyaさんにTwitterのダイレクトメッセージでコンタクトをとり、後日Skypeのチャットでいろいろお話。2011年3月2日 メタテクノ最終出社日2011年3月3日 有給消化期間を満喫し始める。2011年3月11日 14:46に東日本大震災発生。15:00からラングリッチのレッスンが始まってしまった(キャンセルはレッスン開始1時間前までw)。停電のためiPhoneのSkypeを使って、プライ先生に実況中継。2011年3月15日 地震の混乱が収まらない中、関西空港でtomoyaさんと落ち合いフィリピンはセブ島にGO!!2011年4月1日 サービスの裏側やフィリピンを体験して帰国。この辺からラングリッチのカスタマーサポートのお手伝い開始。開発にも着手し始める。2011年4月21日 メタテクノ退職日2011年4月27日 川崎から引っ越し。西明石行きの夜行バスに乗る。2011年4月28日 荷物が来るまでCEOの家に居候。2011年5月2日 荷物が来て、オフィス兼住居への引越し完了。ラングリッチでは本当に色々なことを学びました。スタートアップの黎明期からの成長っぷりを体験できたことはもちろんですし、東京に進出してからは、アジャイル開発、TDD、まともなWebアプリケーションの作り方等、これらは今も自分の資産となっております。最後の大きなプロジェクトはラングリッチへの恩返しのつもりで、全てを出し尽くしました。しかしこれが本当に大変で、期日までに終わるのかという不安があり昼夜問わず開発していたため、2ヶ月間の総コミット数は637にもなりました。※表示が変ですが、2013年8月31日から2013年11月1日の総コミット数です。もちろんこれは開発者の皆さんだけでなく、関係者全員のご協力のおかげです。そもそもPull Request見てくれる人がいないと成立しないですし。開発内で言うと、セキュリティチェック、サーバ構築、フロントエンド、要件整理等、自然に役割分担されていきました。あ、オレこれやるわ的な。私はアプリ側を実装したため、コミット数が膨れ上がったというわけです。退職後 前回と違って、退職後は悠々自適の生活…とはいかず、転職活動をしてい","link":"https://masutaka.net/2014-03-09-1/","isoDate":"2014-03-09T00:00:00.000Z","dateMiliSeconds":1394323200000,"authorName":"masutaka"}]},"__N_SSG":true},"page":"/members/[name]","query":{"name":"masutaka"},"buildId":"Q0Qmrf8WiaTHzSsDFhgps","nextExport":false,"isFallback":false,"gsp":true,"head":[["meta",{"name":"viewport","content":"width=device-width"}],["meta",{"charSet":"utf-8"}],["link",{"rel":"icon shortcut","type":"image/png","href":"https://engineers.feedforce.jp/logo.png"}],["link",{"rel":"stylesheet","href":"https://fonts.googleapis.com/css2?family=Inter:wght@400;700\u0026display=swap"}],["title",{"children":"masutaka | Feedforce Engineers' Blogs"}],["meta",{"property":"og:title","content":"masutaka"}],["meta",{"property":"og:url","content":"https://engineers.feedforce.jp/members/masutaka"}],["meta",{"name":"twitter:card","content":"summary_large_image"}],["meta",{"property":"og:site","content":"Feedforce Engineers' Blogs"}],["meta",{"property":"og:image","content":"https://engineers.feedforce.jp/og.png"}],["link",{"rel":"canonical","href":"https://engineers.feedforce.jp/members/masutaka"}],["link",{"rel":"alternate","type":"application/rss+xml","title":"Feedforce Engineers' Blogs","href":"https://engineers.feedforce.jp/rss.xml"}],["link",{"rel":"alternate","type":"application/atom+xml","title":"Feedforce Engineers' Blogs","href":"https://engineers.feedforce.jp/atom.xml"}]]}</script><script nomodule="" src="/_next/static/chunks/polyfills-fa276ba060a4a8ac7eef.js"></script><script src="/_next/static/chunks/main-8a83f0fd99327c4684a8.js" async=""></script><script src="/_next/static/chunks/webpack-e067438c4cf4ef2ef178.js" async=""></script><script src="/_next/static/chunks/framework.1daf1ec1ecf144ee9147.js" async=""></script><script src="/_next/static/chunks/commons.9e003f150a446b53bdd9.js" async=""></script><script src="/_next/static/chunks/pages/_app-99db904e083fc7f74e35.js" async=""></script><script src="/_next/static/chunks/588505f8033a39c9ef82bc46b1145ac9fd1db500.827e01289b5e6a2fdb97.js" async=""></script><script src="/_next/static/chunks/pages/members/%5Bname%5D-42a7756adc6c0800b4dc.js" async=""></script><script src="/_next/static/Q0Qmrf8WiaTHzSsDFhgps/_buildManifest.js" async=""></script><script src="/_next/static/Q0Qmrf8WiaTHzSsDFhgps/_ssgManifest.js" async=""></script></body></html>